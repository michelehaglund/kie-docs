<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE book [
<!ENTITY % sgml.features "IGNORE">
<!ENTITY % xml.features "INCLUDE">
<!ENTITY % DOCBOOK_ENTS PUBLIC "-//OASIS//ENTITIES DocBook Character Entities V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/dbcentx.mod">
%DOCBOOK_ENTS;
]>
<?asciidoc-toc?><?asciidoc-numbered?><book xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0">
<info>
<title>Managing Red Hat Process Automation Manager and KIE Server settings</title><subtitle>
</subtitle>

<date>2021-01-26</date>
<productname>Red Hat Process Automation Manager</productname>
<productnumber>7.10</productnumber>
<abstract>
	<para>This document describes how to modify Red Hat Process Automation Manager and KIE Server settings and properties to meet your business needs.</para>
</abstract>
<xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="Common_Content/Legal_Notice.xml"/>
</info>
<preface>
<title>Preface</title>
<simpara>As a developer or system administrator, you can modify Red Hat Process Automation Manager and KIE Server settings and properties to meet your business needs. You can modify the behavior of the Red Hat Process Automation Manager runtime, the Business Central interface, or the KIE Server.</simpara>
</preface>
<preface xml:id="snip-conscious-language_managing-settings">
<title>Making open source more inclusive</title>
<simpara>Red Hat is committed to replacing problematic language in our code, documentation, and web properties. We are beginning with these four terms: master, slave, blacklist, and whitelist. Because of the enormity of this endeavor, these changes will be implemented gradually over several upcoming releases. For more details, see <link xlink:href="https://www.redhat.com/en/blog/making-open-source-more-inclusive-eradicating-problematic-language"><emphasis>our CTO Chris Wright’s message</emphasis></link>.</simpara>
</preface>
<part xml:id="assembly-managing-and-monitoring-execution-server">
<title>Managing and monitoring KIE Server</title>
<partintro>
<simpara>As a system administrator, you can install, configure, and upgrade Red Hat Process Automation Manager for production environments, quickly and easily troubleshoot system failures, and ensure that systems are running optimally.</simpara>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>Red Hat JBoss Enterprise Application Platform 7.3 is installed. For more information, see  <link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.3/html-single/installation_guide/"><emphasis>Red Hat JBoss Enterprise Application Platform 7.3 Installation Guide</emphasis></link>.</simpara>
</listitem>
<listitem>
<simpara>Red Hat Process Automation Manager is installed. For more information, see <link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/installing_and_configuring_red_hat_process_automation_manager#assembly-planning"><emphasis>Planning a Red Hat Process Automation Manager installation</emphasis></link>.</simpara>
</listitem>
<listitem>
<simpara>Red Hat Process Automation Manager is running and you can log in to Business Central with the <literal>admin</literal> role. For more information, see <link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/installing_and_configuring_red_hat_process_automation_manager#assembly-planning"><emphasis>Planning a Red Hat Process Automation Manager installation</emphasis></link>.</simpara>
</listitem>
</itemizedlist>
</partintro>
<chapter xml:id="components-con_execution-server">
<title>Red Hat Process Automation Manager components</title>
<simpara>Red Hat Process Automation Manager is made up of Business Central and KIE Server.</simpara>
<itemizedlist>
<listitem>
<simpara>Business Central is the graphical user interface where you create and manage business rules. You can install Business Central in a Red Hat JBoss EAP instance or on the Red Hat OpenShift Container Platform (OpenShift).</simpara>
<simpara>Business Central is also available as a standalone JAR file. You can use the Business Central standalone JAR file to run Business Central without deploying it to an application server.</simpara>
</listitem>
<listitem>
<simpara>KIE Server is the server where rules and other artifacts are executed. It is used to instantiate and execute rules and solve planning problems. You can install KIE Server in a Red Hat JBoss EAP instance, in a Red Hat JBoss EAP cluster, on OpenShift, in an Oracle WebLogic server instance, in an IBM WebSphere Application Server instance, or as a part of Spring Boot application.</simpara>
<simpara>You can configure KIE Server to run in managed or unmanaged mode. If KIE Server is unmanaged, you must manually create and maintain KIE containers (deployment units). A KIE container is a specific version of a project. If KIE Server is managed, the Process Automation Manager controller manages the KIE Server configuration and you interact with the Process Automation Manager controller to create and maintain KIE containers.</simpara>
</listitem>
</itemizedlist>
</chapter>
<chapter xml:id="maven-integration-ref_execution-server">
<title>System integration with Maven</title>
<simpara>Red Hat Process Automation Manager is designed to be used with <link xlink:href="https://maven.repository.redhat.com/ga/">Red Hat JBoss Middleware Maven Repository</link> and Maven Central repository as dependency sources. Ensure that both the dependencies are available for projects builds.</simpara>
<simpara>Ensure that your project depends on specific versions of an artifact. <literal>LATEST</literal> or <literal>RELEASE</literal> are commonly used to specify and manage dependency versions in your application.</simpara>
<itemizedlist>
<listitem>
<simpara><literal>LATEST</literal> refers to the latest deployed (snapshot) version of an artifact.</simpara>
</listitem>
<listitem>
<simpara><literal>RELEASE</literal> refers to the last non-snapshot version release in the repository.</simpara>
</listitem>
</itemizedlist>
<simpara>By using <literal>LATEST</literal> or <literal>RELEASE</literal>, you do not have to update version numbers when a new release of a third-party library is released, however, you lose control over your build being affected by a software release.</simpara>
<section xml:id="preemptive-authentication-for-local-projects-proc_execution-server">
<title>Preemptive authentication for local projects</title>
<simpara>If your environment does not have access to the internet, set up an in-house Nexus and use it instead of Maven Central or other public repositories. To import JARs from the remote Maven repository of Red Hat Process Automation Manager server to a local Maven project, turn on pre-emptive authentication for the repository server. You can do this by configuring authentication for <literal>guvnor-m2-repo</literal> in the <literal>pom.xml</literal> file as shown below:</simpara>
<programlisting language="xml" linenumbering="unnumbered">&lt;server&gt;
  &lt;id&gt;guvnor-m2-repo&lt;/id&gt;
  &lt;username&gt;admin&lt;/username&gt;
  &lt;password&gt;admin&lt;/password&gt;
  &lt;configuration&gt;
    &lt;wagonProvider&gt;httpclient&lt;/wagonProvider&gt;
    	&lt;httpConfiguration&gt;
      	&lt;all&gt;
      	   &lt;usePreemptive&gt;true&lt;/usePreemptive&gt;
      	&lt;/all&gt;
    	&lt;/httpConfiguration&gt;
  &lt;/configuration&gt;
&lt;/server&gt;</programlisting>
<simpara>Alternatively, you can set Authorization HTTP header with Base64 encoded credentials:</simpara>
<programlisting language="xml" linenumbering="unnumbered">&lt;server&gt;
  &lt;id&gt;guvnor-m2-repo&lt;/id&gt;
  &lt;configuration&gt;
  	&lt;httpHeaders&gt;
  	   &lt;property&gt;
    	    &lt;name&gt;Authorization&lt;/name&gt;
    	    &lt;!-- Base64-encoded "admin:admin" --&gt;
    	    &lt;value&gt;Basic YWRtaW46YWRtaW4=&lt;/value&gt;
  	   &lt;/property&gt;
    &lt;/httpHeaders&gt;
  &lt;/configuration&gt;
&lt;/server&gt;</programlisting>
</section>
<section xml:id="project-duplicate-GAV-con_execution-server">
<title>Duplicate GAV detection in Business Central</title>
<simpara>In Business Central, all Maven repositories are checked for any duplicated <literal>GroupId</literal>, <literal>ArtifactId</literal>, and <literal>Version</literal> (GAV) values in a project. If a GAV duplicate exists, the performed operation is canceled.</simpara>
<note>
<simpara>Duplicate GAV detection is disabled for projects in <emphasis role="strong">Development Mode</emphasis>. To enable duplicate GAV detection in Business Central, go to project <emphasis role="strong">Settings</emphasis> → <emphasis role="strong">General Settings</emphasis> → <emphasis role="strong">Version</emphasis> and toggle the <emphasis role="strong">Development Mode</emphasis> option to <emphasis role="strong">OFF</emphasis> (if applicable).</simpara>
</note>
<simpara>Duplicate GAV detection is executed every time you perform the following operations:</simpara>
<itemizedlist>
<listitem>
<simpara>Save a project definition for the project.</simpara>
</listitem>
<listitem>
<simpara>Save the <literal>pom.xml</literal> file.</simpara>
</listitem>
<listitem>
<simpara>Install, build, or deploy a project.</simpara>
</listitem>
</itemizedlist>
<simpara>The following Maven repositories are checked for duplicate GAVs:</simpara>
<itemizedlist>
<listitem>
<simpara>Repositories specified in the <literal>&lt;repositories&gt;</literal> and <literal>&lt;distributionManagement&gt;</literal> elements of the <literal>pom.xml</literal> file.</simpara>
</listitem>
<listitem>
<simpara>Repositories specified in the Maven <literal>settings.xml</literal> configuration file.</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="project-duplicate-GAV-manage-proc_execution-server">
<title>Managing duplicate GAV detection settings in Business Central</title>
<simpara>Business Central users with the <literal>admin</literal> role can modify the list of repositories that are checked for duplicate <literal>GroupId</literal>, <literal>ArtifactId</literal>, and <literal>Version</literal> (GAV) values for a project.</simpara>
<note>
<simpara>Duplicate GAV detection is disabled for projects in <emphasis role="strong">Development Mode</emphasis>. To enable duplicate GAV detection in Business Central, go to project <emphasis role="strong">Settings</emphasis> → <emphasis role="strong">General Settings</emphasis> → <emphasis role="strong">Version</emphasis> and toggle the <emphasis role="strong">Development Mode</emphasis> option to <emphasis role="strong">OFF</emphasis> (if applicable).</simpara>
</note>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, go to <emphasis role="strong">Menu</emphasis> → <emphasis role="strong">Design</emphasis> → <emphasis role="strong">Projects</emphasis> and click the project name.</simpara>
</listitem>
<listitem>
<simpara>Click the project <emphasis role="strong">Settings</emphasis> tab and then click <emphasis role="strong">Validation</emphasis> to open the list of repositories.</simpara>
</listitem>
<listitem>
<simpara>Select or clear any of the listed repository options to enable or disable duplicate GAV detection.</simpara>
<simpara>In the future, duplicate GAVs will be reported for only the repositories you have enabled for validation.</simpara>
<note>
<simpara>To disable this feature, set the <literal>org.guvnor.project.gav.check.disabled</literal> system property to <literal>true</literal> for Business Central at system startup:</simpara>
<screen>$ ~/EAP_HOME/bin/standalone.sh -c standalone-full.xml
-Dorg.guvnor.project.gav.check.disabled=true</screen>
</note>
</listitem>
</orderedlist>
</section>
</chapter>
<chapter xml:id="patches-applying-proc_execution-server">
<title>Applying patch updates and minor release upgrades to Red Hat Process Automation Manager</title>
<simpara>Automated update tools are often provided with both patch updates and new minor versions of Red Hat Process Automation Manager to facilitate updating certain components of Red Hat Process Automation Manager, such as Business Central, KIE Server, and the headless Process Automation Manager controller. Other Red Hat Process Automation Manager artifacts, such as the decision engine and standalone Business Central, are released as new artifacts with each minor release and you must re-install them to apply the update.</simpara>
<simpara>You can use the same automated update tool to apply both patch updates and minor release upgrades to Red Hat Process Automation Manager 7.10. Patch updates of Red Hat Process Automation Manager, such as an update from version 7.10 to 7.10.1, include the latest security updates and bug fixes. Minor release upgrades of Red Hat Process Automation Manager, such as an upgrade from version 7.8.x to 7.9, include enhancements, security updates, and bug fixes.</simpara>
<note>
<simpara>Only updates for Red Hat Process Automation Manager are included in Red Hat Process Automation Manager update tools. Updates to Red Hat JBoss EAP must be applied using Red Hat JBoss EAP patch distributions. For more information about Red Hat JBoss EAP patching, see the  <link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.3/html/patching_and_upgrading_guide/"><emphasis>Red Hat JBoss EAP patching and upgrading guide</emphasis></link>.</simpara>
</note>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>Your Red Hat Process Automation Manager and KIE Server instances are not running. Do not apply updates while you are running an instance of Red Hat Process Automation Manager or KIE Server.</simpara>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>Navigate to the <link xlink:href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Software Downloads</link> page in the Red Hat Customer Portal (login required), and select the product and version from the drop-down options.</simpara>
<simpara>If you are upgrading to a new minor release of Red Hat Process Automation Manager, such as an upgrade from version 7.8.x to 7.9, first apply the latest patch update to your current version of Red Hat Process Automation Manager and then follow this procedure again to upgrade to the new minor release.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Patches</emphasis>, download the <emphasis role="strong">Red Hat Process Automation Manager [VERSION] Update Tool</emphasis>, and extract the downloaded <literal>rhpam-$VERSION-update.zip</literal> file to a temporary directory.</simpara>
<simpara>This update tool automates the update of certain components of Red Hat Process Automation Manager, such as Business Central, KIE Server, and the headless Process Automation Manager controller. Use this update tool first to apply updates and then install any other updates or new release artifacts that are relevant to your Red Hat Process Automation Manager distribution.</simpara>
</listitem>
<listitem>
<simpara>If you want to preserve any files from being updated by the update tool, navigate to the extracted <literal>rhpam-$VERSION-update</literal> folder, open the <literal>blacklist.txt</literal> file, and add the relative paths to the files that you do not want to be updated.</simpara>
<simpara>When a file is listed in the <literal>blacklist.txt</literal> file, the update script does not replace the file with the new version but instead leaves the file in place and in the same location adds the new version with a <literal>.new</literal> suffix. If you blacklist files that are no longer being distributed, the update tool creates an empty marker file with a <literal>.removed</literal> suffix. You can then choose to retain, merge, or delete these new files manually.</simpara>
<simpara>Example files to be excluded in <literal>blacklist.txt</literal> file:</simpara>
<screen>WEB-INF/web.xml  // Custom file
styles/base.css  // Obsolete custom file kept for record</screen>
<simpara>The contents of the blacklisted file directories after the update:</simpara>
<screen>$ ls WEB-INF
web.xml web.xml.new</screen>
<screen>$ ls styles
base.css base.css.removed</screen>
</listitem>
<listitem>
<simpara>In your command terminal, navigate to the temporary directory where you extracted the <literal>rhpam-$VERSION-update.zip</literal> file and run the <literal>apply-updates</literal> script in the following format:</simpara>
<important>
<simpara>Make sure that your Red Hat Process Automation Manager and KIE Server instances are not running before you apply updates. Do not apply updates while you are running an instance of Red Hat Process Automation Manager or KIE Server.</simpara>
</important>
<simpara>On Linux or Unix-based systems:</simpara>
<screen>$ ./apply-updates.sh $DISTRO_PATH $DISTRO_TYPE</screen>
<simpara>On Windows:</simpara>
<screen>$ .\apply-updates.bat $DISTRO_PATH $DISTRO_TYPE</screen>
<simpara>The <literal>$DISTRO_PATH</literal> portion is the path to the relevant distribution directory and the <literal>$DISTRO_TYPE</literal> portion is the type of distribution that you are updating with this update.</simpara>
<simpara>The following distribution types are supported in Red Hat Process Automation Manager update tool:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>rhpam-business-central-eap7-deployable</literal>: Updates Business Central (<literal>business-central.war</literal>)</simpara>
</listitem>
<listitem>
<simpara><literal>rhpam-kie-server-ee8</literal>: Updates KIE Server (<literal>kie-server.war</literal>)</simpara>
<note>
<simpara>The update tool will update and replace Red Hat JBoss EAP EE7 to Red Hat JBoss EAP EE8. Red Hat JBoss EAP EE7 is used for WebLogic and WebSphere, whereas version EE8 is used for Red Hat JBoss EAP. Make sure that the KIE Server on WebLogic and WebSphere is not updated by the update tool.</simpara>
</note>
</listitem>
<listitem>
<simpara><literal>rhpam-kie-server-jws</literal>: Updates KIE Server on Red Hat JBoss Web Server (<literal>kie-server.war</literal>)</simpara>
</listitem>
<listitem>
<simpara><literal>rhpam-controller-ee7</literal>: Updates the headless Process Automation Manager controller (<literal>controller.war</literal>)</simpara>
</listitem>
<listitem>
<simpara><literal>rhpam-controller-jws</literal>: Updates the headless Process Automation Manager controller on Red Hat JBoss Web Server (<literal>controller.war</literal>)</simpara>
<simpara>Example update to Business Central and KIE Server for a full Red Hat Process Automation Manager distribution on Red Hat JBoss EAP:</simpara>
<screen>./apply-updates.sh ~EAP_HOME/standalone/deployments/business-central.war rhpam-business-central-eap7-deployable

./apply-updates.sh ~EAP_HOME/standalone/deployments/kie-server.war rhpam-kie-server-ee8</screen>
<simpara>Example update to headless Process Automation Manager controller, if used:</simpara>
<screen>./apply-updates.sh ~EAP_HOME/standalone/deployments/controller.war rhpam-controller-ee7</screen>
<simpara>The update script creates a <literal>backup</literal> folder in the extracted <literal>rhpam-$VERSION-update</literal> folder with a copy of the specified distribution, and then proceeds with the update.</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>After the update tool completes, return to the <emphasis role="strong">Software Downloads</emphasis> page of the Red Hat Customer Portal where you downloaded the update tool and install any other updates or new release artifacts that are relevant to your Red Hat Process Automation Manager distribution.</simpara>
<simpara>For files that already exist in your Red Hat Process Automation Manager distribution, such as <literal>.jar</literal> files for the decision engine or other add-ons, replace the existing version of the file with the new version from the Red Hat Customer Portal.</simpara>
</listitem>
<listitem>
<simpara>If you use the standalone <emphasis role="strong">Red Hat Process Automation Manager 7.10.0 Maven Repository</emphasis> artifact (<literal>rhpam-7.10.0-maven-repository.zip</literal>), such as in air-gap environments, download <emphasis role="strong">Red Hat Process Automation Manager 7.10.x Maven Repository</emphasis> and extract the downloaded <literal>rhpam-7.10.x-maven-repository.zip</literal> file to your existing <literal>~/maven-repository</literal> directory to update the relevant contents.</simpara>
<simpara>Example Maven repository update:</simpara>
<screen>$ extract -o rhpam-7.10.x-maven-repository.zip 'rhba-7.10.1.GA-maven-repository/maven-repository/*' -d /tmp/rhbaMavenRepoUpdate

$ mv /tmp/rhbaMavenRepoUpdate/rhba-7.10.0.GA-maven-repository/maven-repository/ $REPO_PATH/</screen>
<note>
<simpara>You can remove the <literal>/tmp/rhbaMavenRepoUpdate</literal> folder after you complete the update.</simpara>
</note>
</listitem>
<listitem>
<simpara>After you finish applying all relevant updates, start Red Hat Process Automation Manager and KIE Server and log in to Business Central.</simpara>
</listitem>
<listitem>
<simpara>Verify that all project data is present and accurate in Business Central, and in the top-right corner of the Business Central window, click your profile name and click <emphasis role="strong">About</emphasis> to verify the updated product version number.</simpara>
<simpara>If you encounter errors or notice any missing data in Business Central, you can restore the contents in the <literal>backup</literal> folder within the <literal>rhpam-$VERSION-update</literal> folder to revert the update tool changes. You can also re-install the relevant release artifacts from your previous version of Red Hat Process Automation Manager in the Red Hat Customer Portal. After restoring your previous distribution, you can try again to run the update.</simpara>
</listitem>
</orderedlist>
</chapter>
<chapter xml:id="migration-configure-kie-server-proc">
<title>Configuring and starting KIE Server</title>
<simpara>You can configure your KIE Server location, user name, password, and other related properties by defining the necessary configurations when you start KIE Server.</simpara>
<formalpara>
<title>Procedure</title>
<para>Navigate to the Red Hat Process Automation Manager 7.10 <literal>bin</literal> directory and start the new KIE Server with the following properties. Adjust the specific properties according to your environment.</para>
</formalpara>
<screen>$ ~/EAP_HOME/bin/standalone.sh --server-config=standalone-full.xml <co xml:id="CO1-1"/>
-Dorg.kie.server.id=myserver <co xml:id="CO1-2"/>
-Dorg.kie.server.user=kie_server_username <co xml:id="CO1-3"/>
-Dorg.kie.server.pwd=kie_server_password <co xml:id="CO1-4"/>
-Dorg.kie.server.controller=http://localhost:8080/business-central/rest/controller <co xml:id="CO1-5"/>
-Dorg.kie.server.controller.user=controller_username <co xml:id="CO1-6"/>
-Dorg.kie.server.controller.pwd=controller_password <co xml:id="CO1-7"/>
-Dorg.kie.server.location=http://localhost:8080/kie-server/services/rest/server <co xml:id="CO1-8"/>
-Dorg.kie.server.persistence.dialect=org.hibernate.dialect.PostgreSQLDialect <co xml:id="CO1-9"/>
-Dorg.kie.server.persistence.ds=java:jboss/datasources/psjbpmDS <co xml:id="CO1-10"/></screen>
<calloutlist>
<callout arearefs="CO1-1">
<para>Start command with <literal>standalone-full.xml</literal> server profile</para>
</callout>
<callout arearefs="CO1-2">
<para>Server ID that must match the server configuration name defined in Business Central</para>
</callout>
<callout arearefs="CO1-3">
<para>User name to connect with KIE Server from the Process Automation Manager controller</para>
</callout>
<callout arearefs="CO1-4">
<para>Password to connect with KIE Server from the Process Automation Manager controller</para>
</callout>
<callout arearefs="CO1-5">
<para>Process Automation Manager controller location, Business Central URL with <literal>/rest/controller</literal> suffix</para>
</callout>
<callout arearefs="CO1-6">
<para>User name to connect to the Process Automation Manager controller REST API</para>
</callout>
<callout arearefs="CO1-7">
<para>Password to connect to the Process Automation Manager controller REST API</para>
</callout>
<callout arearefs="CO1-8">
<para>KIE Server location (on the same instance as Business Central in this example)</para>
</callout>
<callout arearefs="CO1-9">
<para>Hibernate dialect to be used</para>
</callout>
<callout arearefs="CO1-10">
<para>JNDI name of the data source used for your previous Red Hat JBoss BPM Suite database</para>
</callout>
</calloutlist>
<note>
<simpara>If Business Central and KIE Server are installed on separate application server instances (Red Hat JBoss EAP or other), use a separate port for the KIE Server location to avoid port conflicts with Business Central. If a separate KIE Server port has not already been configured, you can add a port offset and adjust the KIE Server port value accordingly in the KIE Server properties.</simpara>
<simpara>Example:</simpara>
<screen>-Djboss.socket.binding.port-offset=150
-Dorg.kie.server.location=http://localhost:8230/kie-server/services/rest/server</screen>
<simpara>If the Business Central port is 8080, as in this example, then the KIE Server port, with a defined offset of 150, is 8230.</simpara>
</note>
<simpara>KIE Server connects to the new Business Central and collects the list of deployment units (KIE containers) to be deployed.</simpara>
<note>
<simpara>When you use a class inside a dependency JAR file to access KIE Server from KIE Server client, you get the <literal>ConversionException</literal> and <literal>ForbiddenClassException</literal> in Business Central.
To avoid generating these exceptions in Business Central, do one of the following:</simpara>
<itemizedlist>
<listitem>
<simpara>If the exceptions are generated on the client-side, add following system property to the kie-server client:</simpara>
</listitem>
</itemizedlist>
<screen>System.setProperty("org.kie.server.xstream.enabled.packages", "org.example.**");</screen>
<itemizedlist>
<listitem>
<simpara>If the exceptions are generated on the server-side, open <literal>standalone-full.xml</literal> from the Red Hat Process Automation Manager installation directory, set the following property under the &lt;system-properties&gt; tag:</simpara>
</listitem>
</itemizedlist>
<screen>&lt;property name="org.kie.server.xstream.enabled.packages" value="org.example.**"/&gt;</screen>
<itemizedlist>
<listitem>
<simpara>Set the following JVM property:</simpara>
</listitem>
</itemizedlist>
<screen>-Dorg.kie.server.xstream.enabled.packages=org.example.**</screen>
<simpara>It is expected that you do not configure the classes that exists in KJAR using these system property. Ensure that only known classes are used in the system property to avoid any vulnerabilities.</simpara>
<simpara>The <literal>org.example</literal> is an example package, you can define any package that you want to use. You can specify multiple packages separated by comma , for example,
<literal>org.example1.* * , org.example2.* * , org.example3.* *</literal>.</simpara>
<simpara>You can also add specific classes , for example, <literal>org.example1.Mydata1, org.example2.Mydata2</literal>.</simpara>
</note>
</chapter>
<chapter xml:id="eap-data-source-add-proc_execution-server">
<title>Configuring JDBC data sources for KIE Server</title>
<simpara>A data source is an object that enables a Java Database Connectivity (JDBC) client, such as an application server, to establish a connection with a database. Applications look up the data source on the Java Naming and Directory Interface (JNDI) tree or in the local application context and request a database connection to retrieve data. You must configure data sources for KIE Server to ensure correct data exchange between the servers and the designated database.</simpara>
<note>
<simpara>For production environments, specify an actual data source. Do not use the example data source in production environments.</simpara>
</note>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>The JDBC providers that you want to use to create database connections are configured on all servers on which you want to deploy KIE Server, as described in the "Creating Datasources" and "JDBC Drivers" sections of the <link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.3/html/configuration_guide/index"><emphasis>Red Hat JBoss Enterprise Application Server Configuration Guide</emphasis></link>.</simpara>
</listitem>
<listitem>
<simpara>The <emphasis role="strong">Red Hat Process Automation Manager 7.10.0 Add Ons</emphasis> (<literal>rhpam-7.10.0-add-ons.zip</literal>) file is downloaded from the <link xlink:href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Software Downloads</link> page in the Red Hat Customer Portal.</simpara>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>Complete the following steps to prepare your database:</simpara>
<orderedlist numeration="loweralpha">
<listitem>
<simpara>Extract <literal>rhpam-7.10.0-add-ons.zip</literal> in a temporary directory, for example <literal>TEMP_DIR</literal>.</simpara>
</listitem>
<listitem>
<simpara>Extract <literal>TEMP_DIR/rhpam-7.10.0-migration-tool.zip</literal>.</simpara>
</listitem>
<listitem>
<simpara>Change your current directory to the <literal>TEMP_DIR/rhpam-7.10.0-migration-tool/ddl-scripts</literal> directory. This directory contains DDL scripts for several database types.</simpara>
</listitem>
<listitem>
<simpara>Import the DDL script for your database type into the database that you want to use.</simpara>
<variablelist>
<varlistentry>
<term>The following example creates jBPM database structures in PostreSQL</term>
<listitem>
<programlisting language="shell" linenumbering="unnumbered">psql jbpm &lt; /ddl-scripts/postgresql/postgresql-jbpm-schema.sql</programlisting>
<note>
<simpara>If you are using PostgreSQL or Oracle in conjunction with Spring Boot, you must import the respective Spring Boot DDL script, for example <literal>/ddl-scripts/oracle/oracle-springboot-jbpm-schema.sql</literal> or <literal>/ddl-scripts/postgresql/postgresql-springboot-jbpm-schema.sql</literal>.</simpara>
</note>
<note>
<simpara>The PostgreSQL DDL scripts create the PostgreSQL schema with auto-incrementing integer value (OID) columns for entity attributes annotated with <literal>@LOB</literal>. To use other binary column types such as BYTEA instead of OID, you must create the PostgreSQL schema with the <literal>postgresql-bytea-jbpm-schema.sql</literal> script and set the Red Hat Process Automation Manager <literal>org.kie.persistence.postgresql.useBytea=true</literal> flag. Do not use the <literal>postgresql-jbpm-lo-trigger-clob.sql</literal> script when creating a BYTEA-based schema. Red Hat Process Automation Manager does not provide a migration tool to change from an OID-based to a BYTEA-based schema.</simpara>
</note>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</orderedlist>
</listitem>
<listitem>
<simpara>Open <literal><emphasis>EAP_HOME</emphasis>/standalone/configuration/standalone-full.xml</literal> in a text editor and locate the <literal>&lt;system-properties&gt;</literal> tag.</simpara>
</listitem>
<listitem>
<simpara>Add the following properties to the <literal>&lt;system-properties&gt;</literal> tag where <literal>&lt;DATASOURCE&gt;</literal> is the JNDI name of your data source and <literal>&lt;HIBERNATE_DIALECT&gt;</literal> is the hibernate dialect for your database.</simpara>
<note>
<simpara>The default value of the <literal>org.kie.server.persistence.ds</literal> property is  <literal>java:jboss/datasources/ExampleDS</literal>. The default value of the <literal>org.kie.server.persistence.dialect</literal> property is <literal>org.hibernate.dialect.H2Dialect</literal>.</simpara>
</note>
<programlisting language="xml" linenumbering="unnumbered">&lt;property name="org.kie.server.persistence.ds" value="&lt;DATASOURCE&gt;"/&gt;
&lt;property name="org.kie.server.persistence.dialect" value="&lt;HIBERNATE_DIALECT&gt;"/&gt;</programlisting>
<simpara>The following example shows how to configure a datasource for the PostgreSQL hibernate dialect:</simpara>
<programlisting language="xml" linenumbering="unnumbered">&lt;system-properties&gt;
    &lt;property name="org.kie.server.repo" value="${jboss.server.data.dir}"/&gt;
    &lt;property name="org.kie.example" value="true"/&gt;
    &lt;property name="org.jbpm.designer.perspective" value="full"/&gt;
    &lt;property name="designerdataobjects" value="false"/&gt;
    &lt;property name="org.kie.server.user" value="rhpamUser"/&gt;
    &lt;property name="org.kie.server.pwd" value="rhpam123!"/&gt;
    &lt;property name="org.kie.server.location" value="http://localhost:8080/kie-server/services/rest/server"/&gt;
    &lt;property name="org.kie.server.controller" value="http://localhost:8080/business-central/rest/controller"/&gt;
    &lt;property name="org.kie.server.controller.user" value="kieserver"/&gt;
    &lt;property name="org.kie.server.controller.pwd" value="kieserver1!"/&gt;
    &lt;property name="org.kie.server.id" value="local-server-123"/&gt;

    &lt;!-- Data source properties. --&gt;
    &lt;property name="org.kie.server.persistence.ds" value="java:jboss/datasources/KieServerDS"/&gt;
    &lt;property name="org.kie.server.persistence.dialect" value="org.hibernate.dialect.PostgreSQLDialect"/&gt;
&lt;/system-properties&gt;</programlisting>
</listitem>
</orderedlist>
<simpara>The following dialects are supported:</simpara>
<itemizedlist>
<listitem>
<simpara>DB2: <literal>org.hibernate.dialect.DB2Dialect</literal></simpara>
</listitem>
<listitem>
<simpara>MSSQL: <literal>org.hibernate.dialect.SQLServer2012Dialect</literal></simpara>
</listitem>
<listitem>
<simpara>MySQL: <literal>org.hibernate.dialect.MySQL5InnoDBDialect</literal></simpara>
</listitem>
<listitem>
<simpara>MariaDB: <literal>org.hibernate.dialect.MySQL5InnoDBDialect</literal></simpara>
</listitem>
<listitem>
<simpara>Oracle: <literal>org.hibernate.dialect.Oracle10gDialect</literal></simpara>
</listitem>
<listitem>
<simpara>PostgreSQL: <literal>org.hibernate.dialect.PostgreSQL82Dialect</literal></simpara>
</listitem>
<listitem>
<simpara>PostgreSQL plus: <literal>org.hibernate.dialect.PostgresPlusDialect</literal></simpara>
</listitem>
<listitem>
<simpara>Sybase: <literal>org.hibernate.dialect.SybaseASE157Dialect</literal></simpara>
</listitem>
</itemizedlist>
</chapter>
<chapter xml:id="kie-server-managed-kie-server-con">
<title>Managed KIE Server</title>
<simpara>A managed instance requires an available Process Automation Manager controller to start the KIE Server.</simpara>
<simpara>A Process Automation Manager controller manages the KIE Server configuration in a centralized way. Each Process Automation Manager controller can manage multiple configurations at once, and there can be multiple Process Automation Manager controllers in the environment. Managed KIE Server can be configured with a list of Process Automation Manager controllers, but will only connect to one at a time.</simpara>
<important>
<simpara>All Process Automation Manager controllers should be synchronized to ensure that the same set of configuration is provided to the server, regardless of the Process Automation Manager controller to which it connects.</simpara>
</important>
<simpara>When the KIE Server is configured with a list of Process Automation Manager controllers, it will attempt to connect to each of them at startup until a connection is successfully established with one of them.
If a connection cannot be established, the server will not start, even if there is a local storage available with configuration.
This ensures consistency and prevents the server from running with redundant configuration.</simpara>
<note>
<simpara>To run the KIE Server in standalone mode without connecting to Process Automation Manager controllers, see <xref linkend="kie-server-unmanaged-server-config-proc"/>.</simpara>
</note>
</chapter>
<chapter xml:id="kie-server-unmanaged-server-config-proc">
<title>Unmanaged KIE Server</title>
<simpara>An unmanaged KIE Server is a standalone instance, and therefore must be configured individually using REST/JMS API from the KIE Server itself. The configuration is automatically persisted by the server into a file and that is used as the internal server state, in case of restarts.</simpara>
<simpara>The configuration is updated during the following operations:</simpara>
<itemizedlist>
<listitem>
<simpara>Deploy KIE container</simpara>
</listitem>
<listitem>
<simpara>Undeploy KIE container</simpara>
</listitem>
<listitem>
<simpara>Start KIE container</simpara>
</listitem>
<listitem>
<simpara>Stop KIE container</simpara>
</listitem>
</itemizedlist>
<note>
<simpara>If the KIE Server is restarted, it will attempt to re-establish the same state that was persisted before shutdown.
Therefore, KIE containers (deployment units) that were running will be started, but the ones that were stopped will not.</simpara>
</note>
</chapter>
<chapter xml:id="configuring-environment-mode-proc_execution-server">
<title>Configuring the environment mode in KIE Server and Business Central</title>
<simpara>You can set KIE Server to run in <literal>production</literal> mode or in <literal>development</literal> mode. Development mode provides a flexible deployment policy that enables you to update existing deployment units (KIE containers) while maintaining active process instances for small changes. It also enables you to reset the deployment unit state before updating active process instances for larger changes. Production mode is optimal for production environments, where each deployment creates a new deployment unit.</simpara>
<simpara>In a development environment, you can click <emphasis role="strong">Deploy</emphasis> in Business Central to deploy the built KJAR file to a KIE Server without stopping any running instances (if applicable), or click <emphasis role="strong">Redeploy</emphasis> to deploy the built KJAR file and replace all instances. The next time you deploy or redeploy the built KJAR, the previous deployment unit (KIE container) is automatically updated in the same target KIE Server.</simpara>
<simpara>In a production environment, the <emphasis role="strong">Redeploy</emphasis> option in Business Central is disabled and you can click only <emphasis role="strong">Deploy</emphasis> to deploy the built KJAR file to a new deployment unit (KIE container) on a KIE Server.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>To configure the KIE Server environment mode, set the <literal>org.kie.server.mode</literal> system property to <literal>org.kie.server.mode=development</literal> or <literal>org.kie.server.mode=production</literal>.</simpara>
</listitem>
<listitem>
<simpara>To configure the deployment behavior for a project in Business Central, go to project <emphasis role="strong">Settings</emphasis> → <emphasis role="strong">General Settings</emphasis> → <emphasis role="strong">Version</emphasis> and toggle the <emphasis role="strong">Development Mode</emphasis> option.</simpara>
<note>
<simpara>By default, KIE Server and all new projects in Business Central are in development mode.</simpara>
</note>
<simpara>You cannot deploy a project with <emphasis role="strong">Development Mode</emphasis> turned on or with a manually added <literal>SNAPSHOT</literal> version suffix to a KIE Server that is in production mode.</simpara>
</listitem>
</orderedlist>
</chapter>
<chapter xml:id="kie-server-configure-central-proc_execution-server">
<title>Configuring KIE Server to connect to Business Central</title>
<warning>
<simpara>This section provides a sample setup that you can use for testing purposes. Some of the values are unsuitable for a production environment, and are marked as such.</simpara>
</warning>
<simpara>If a KIE Server is not configured in your Red Hat Process Automation Manager environment, or if you require additional KIE Servers in your Red Hat Process Automation Manager environment, you must configure a KIE Server to connect to Business Central.</simpara>
<note>
<simpara>If you are deploying KIE Server on Red Hat OpenShift Container Platform, see the <link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_red_hat_process_automation_manager_on_red_hat_openshift_container_platform#assembly-openshift-operator"><emphasis>Deploying a Red Hat Process Automation Manager environment on Red Hat OpenShift Container Platform using Operators</emphasis></link> document for instructions about configuring it to connect to Business Central.</simpara>
</note>
<simpara>KIE Server can be managed or unmanaged. If KIE Server is unmanaged, you must manually create and maintain KIE containers (deployment units). If KIE Server is managed, the Process Automation Manager controller manages the KIE Server configuration and you interact with the Process Automation Manager controller to create and maintain the KIE containers.</simpara>
<note>
<simpara>Make the changes described in this section if KIE Server is managed by Business Central and you have installed Red Hat Process Automation Manager from the ZIP files.
If you have installed Business Central, you can use the headless Process Automation Manager controller to manage KIE Server, as described in <xref linkend="controller-con_execution-server"/>.</simpara>
</note>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>Business Central and KIE Server are installed in the base directory of the Red Hat JBoss EAP installation (<literal><emphasis>EAP_HOME</emphasis></literal>).</simpara>
</listitem>
</itemizedlist>
<note>
<simpara>You must install Business Central and KIE Server on different servers in production environments. In this sample situation, we use only one user named <literal>controllerUser</literal>, containing both <literal>rest-all</literal> and the <literal>kie-server</literal> roles. However, if you install KIE Server and Business Central on the same server, for example in a development environment, make the changes in the shared <literal>standalone-full.xml</literal> file as described in this section.</simpara>
</note>
<itemizedlist>
<listitem>
<simpara>Users with the following roles exist:</simpara>
<itemizedlist>
<listitem>
<simpara>In Business Central, a user with the role <literal>rest-all</literal></simpara>
</listitem>
<listitem>
<simpara>On the KIE Server, a user with the role <literal>kie-server</literal></simpara>
</listitem>
</itemizedlist>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In your Red Hat Process Automation Manager installation directory, navigate to the <literal>standalone-full.xml</literal> file. For example, if you use a Red Hat JBoss EAP installation for Red Hat Process Automation Manager, go to <literal>$EAP_HOME/standalone/configuration/standalone-full.xml</literal>.</simpara>
</listitem>
<listitem>
<simpara>Open the <literal>standalone-full.xml</literal> file and under the <literal>&lt;system-properties&gt;</literal> tag, set the following JVM properties:</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>JVM Properties for the KIE Server instance</title>
<tgroup cols="3">
<colspec colname="col_1" colwidth="33*"/>
<colspec colname="col_2" colwidth="33*"/>
<colspec colname="col_3" colwidth="33*"/>
<thead>
<row>
<entry align="left" valign="top">Property</entry>
<entry align="left" valign="top">Value</entry>
<entry align="left" valign="top">Note</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.id</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>default-kie-server</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The KIE Server ID.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.controller</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>http://localhost:8080/business-central/rest/controller</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The location of Business Central. The URL for connecting to the API of Business Central.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.controller.user</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>controllerUser</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The user name with the role <literal>rest-all</literal> who can log in to the Business Central.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.controller.pwd</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>controllerUser1234;</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The password of the user who can log in to the Business Central.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.location</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>http://localhost:8080/kie-server/services/rest/server</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The location of the KIE Server. The URL for connecting to the API of KIE Server.</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<table frame="all" rowsep="1" colsep="1">
<title>JVM Properties for the Business Central instance</title>
<tgroup cols="3">
<colspec colname="col_1" colwidth="33*"/>
<colspec colname="col_2" colwidth="33*"/>
<colspec colname="col_3" colwidth="33*"/>
<thead>
<row>
<entry align="left" valign="top">Property</entry>
<entry align="left" valign="top">Value</entry>
<entry align="left" valign="top">Note</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.user</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>controllerUser</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The user name with the role <literal>kie-server</literal>.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.pwd</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>controllerUser1234;</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The password of the user.</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<simpara>The following example shows how to configure a KIE Server instance:</simpara>
<programlisting language="xml" linenumbering="unnumbered">&lt;property name="org.kie.server.id" value="default-kie-server"/&gt;
&lt;property name="org.kie.server.controller" value="http://localhost:8080/business-central/rest/controller"/&gt;
&lt;property name="org.kie.server.controller.user" value="controllerUser"/&gt;
&lt;property name="org.kie.server.controller.pwd" value="controllerUser1234;"/&gt;
&lt;property name="org.kie.server.location" value="http://localhost:8080/kie-server/services/rest/server"/&gt;</programlisting>
<simpara>The following example shows how to configure a for Business Central instance:</simpara>
<programlisting language="xml" linenumbering="unnumbered">&lt;property name="org.kie.server.user" value="controllerUser"/&gt;
&lt;property name="org.kie.server.pwd" value="controllerUser1234;"/&gt;</programlisting>
</listitem>
<listitem>
<simpara>Send a GET request to <literal>http://<emphasis>SERVER:PORT</emphasis>/kie-server/services/rest/server/</literal> to verify that KIE Server started successfully. After authentication, you receive an XML response similar to the following example:</simpara>
<programlisting language="xml" linenumbering="unnumbered">&lt;response type="SUCCESS" msg="Kie Server info"&gt;
    &lt;kie-server-info&gt;
        &lt;capabilities&gt;KieServer&lt;/capabilities&gt;
        &lt;capabilities&gt;BRM&lt;/capabilities&gt;
        &lt;capabilities&gt;BPM&lt;/capabilities&gt;
        &lt;capabilities&gt;CaseMgmt&lt;/capabilities&gt;
        &lt;capabilities&gt;BPM-UI&lt;/capabilities&gt;
        &lt;capabilities&gt;BRP&lt;/capabilities&gt;
        &lt;capabilities&gt;DMN&lt;/capabilities&gt;
        &lt;capabilities&gt;Swagger&lt;/capabilities&gt;
        &lt;location&gt;http://localhost:8230/kie-server/services/rest/server&lt;/location&gt;
        &lt;messages&gt;
            &lt;content&gt;Server KieServerInfo{serverId='first-kie-server', version='7.5.1.Final-redhat-1', location='http://localhost:8230/kie-server/services/rest/server', capabilities=[KieServer, BRM, BPM, CaseMgmt, BPM-UI, BRP, DMN, Swagger]}started successfully at Mon Feb 05 15:44:35 AEST 2018&lt;/content&gt;
            &lt;severity&gt;INFO&lt;/severity&gt;
            &lt;timestamp&gt;2018-02-05T15:44:35.355+10:00&lt;/timestamp&gt;
        &lt;/messages&gt;
        &lt;name&gt;first-kie-server&lt;/name&gt;
        &lt;id&gt;first-kie-server&lt;/id&gt;
        &lt;version&gt;7.5.1.Final-redhat-1&lt;/version&gt;
    &lt;/kie-server-info&gt;
&lt;/response&gt;</programlisting>
</listitem>
<listitem>
<simpara>Verify successful registration:</simpara>
<orderedlist numeration="loweralpha">
<listitem>
<simpara>Log in to Business Central.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Menu</emphasis> → <emphasis role="strong">Deploy</emphasis> → <emphasis role="strong">Execution Servers</emphasis>.</simpara>
<simpara>If registration is successful, you will see the registered server ID.</simpara>
</listitem>
</orderedlist>
</listitem>
</orderedlist>
</chapter>
<chapter xml:id="controller-con_execution-server">
<title>Installing and running the headless Process Automation Manager controller</title>
<simpara>You can configure KIE Server to run in managed or unmanaged mode. If KIE Server is unmanaged, you must manually create and maintain KIE containers (deployment units). If KIE Server is managed, the Process Automation Manager controller manages the KIE Server configuration and you interact with the Process Automation Manager controller to create and maintain KIE containers.</simpara>
<simpara>Business Central has an embedded Process Automation Manager controller. If you install Business Central, use the <emphasis role="strong">Execution Server</emphasis> page to create and maintain KIE containers. If you want to automate KIE Server management without Business Central, you can use the headless Process Automation Manager controller.</simpara>
<section xml:id="installer-controller-eap-proc_execution-server">
<title>Using the installer to configure KIE Server with the Process Automation Manager controller</title>
<simpara>KIE Server can be managed by the Process Automation Manager controller or it can be unmanaged. If KIE Server is unmanaged, you must manually create and maintain KIE containers (deployment units). If KIE Server is managed, the Process Automation Manager controller manages the KIE Server configuration and you interact with the Process Automation Manager controller to create and maintain KIE containers.</simpara>
<simpara>The Process Automation Manager controller is integrated with Business Central. If you install Business Central, you can use the <emphasis role="strong">Execution Server</emphasis> page in Business Central to interact with the Process Automation Manager controller.</simpara>
<simpara>You can use the installer in interactive or CLI mode to install Business Central and KIE Server, and then configure KIE Server with the Process Automation Manager controller.</simpara>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>Two computers with backed-up Red Hat JBoss EAP 7.3  server installations are available.</simpara>
</listitem>
<listitem>
<simpara>Sufficient user permissions to complete the installation are granted.</simpara>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>On the first computer, run the installer in interactive mode or CLI mode.
See <link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/installing_and_configuring_red_hat_process_automation_manager#assembly-install-on-eap"><emphasis>Installing and configuring Red Hat Process Automation Manager on Red Hat JBoss EAP 7.3</emphasis></link> for more information.</simpara>
</listitem>
<listitem>
<simpara>On the <emphasis role="strong">Component Selection</emphasis> page, clear the <emphasis role="strong">KIE Server</emphasis> box.</simpara>
</listitem>
<listitem>
<simpara>Complete the Business Central installation.</simpara>
</listitem>
<listitem>
<simpara>On the second computer, run the installer in interactive mode or CLI mode.</simpara>
</listitem>
<listitem>
<simpara>On the <emphasis role="strong">Component Selection</emphasis> page, clear the <emphasis role="strong">Business Central</emphasis> box.</simpara>
</listitem>
<listitem>
<simpara>On the <emphasis role="strong">Configure Runtime Environment</emphasis> page, select <emphasis role="strong">Perform Advanced Configuration</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Select <emphasis role="strong">Customize KIE Server properties</emphasis> and click <emphasis role="strong">Next</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Enter the controller URL for Business Central and configure additional properties for KIE Server. The controller URL has the following form where <literal>&lt;HOST:PORT&gt;</literal> is the address of Business Central on the second computer:</simpara>
<screen>&lt;HOST:PORT&gt;/business-central/rest/controller</screen>
</listitem>
<listitem>
<simpara>Complete the installation.</simpara>
</listitem>
<listitem>
<simpara>To verify that the Process Automation Manager controller is now integrated with Business Central, go to the <emphasis role="strong">Execution Servers</emphasis> page in Business Central and confirm that the KIE Server that you configured appears under <emphasis role="strong">REMOTE SERVERS</emphasis>.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="controller-eap-install-proc_execution-server">
<title>Installing the headless Process Automation Manager controller</title>
<simpara>You can install the headless Process Automation Manager controller and use the REST API or the KIE Server Java Client API to interact with it.</simpara>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>A backed-up Red Hat JBoss EAP installation version 7.3 is available. The base directory of the Red Hat JBoss EAP installation is referred to as <literal><emphasis>EAP_HOME</emphasis></literal>.</simpara>
</listitem>
<listitem>
<simpara>Sufficient user permissions to complete the installation are granted.</simpara>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>Navigate to the <link xlink:href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Software Downloads</link> page in the Red Hat Customer Portal (login required), and select the product and version from the drop-down options:</simpara>
<itemizedlist>
<listitem>
<simpara><emphasis role="strong">Product:</emphasis> Process Automation Manager</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Version:</emphasis> 7.10</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>Download <emphasis role="strong">Red Hat Process Automation Manager 7.10.0 Add Ons</emphasis> (the <literal>rhpam-7.10.0-add-ons.zip</literal> file).</simpara>
</listitem>
<listitem>
<simpara>Extract the <literal>rhpam-7.10.0-add-ons.zip</literal> file. The <literal>rhpam-7.10.0-controller-ee7.zip</literal> file is in the extracted directory.</simpara>
</listitem>
<listitem>
<simpara>Extract the <literal>rhpam-7.10.0-controller-ee7</literal> archive to a temporary directory. In the following examples this directory is called <literal><emphasis>TEMP_DIR</emphasis></literal>.</simpara>
</listitem>
<listitem>
<simpara>Copy the <literal><emphasis>TEMP_DIR</emphasis>/rhpam-7.10.0-controller-ee7/controller.war</literal> directory to <literal><emphasis>EAP_HOME</emphasis>/standalone/deployments/</literal>.</simpara>
<warning>
<simpara>Ensure that the names of the headless Process Automation Manager controller deployments you copy do not conflict with your existing deployments in the Red Hat JBoss EAP instance.</simpara>
</warning>
</listitem>
<listitem>
<simpara>Copy the contents of the <literal><emphasis>TEMP_DIR</emphasis>/rhpam-7.10.0-controller-ee7/SecurityPolicy/</literal> directory to <literal><emphasis>EAP_HOME</emphasis>/bin</literal>.</simpara>
</listitem>
<listitem>
<simpara>When prompted to overwrite files, select <emphasis role="strong">Yes</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>In the <literal><emphasis>EAP_HOME</emphasis>/standalone/deployments/</literal> directory, create an empty file named <literal>controller.war.dodeploy</literal>. This file ensures that the headless Process Automation Manager controller is automatically deployed when the server starts.</simpara>
</listitem>
</orderedlist>
<section xml:id="controller-eap-users-create-proc_execution-server">
<title>Creating a headless Process Automation Manager controller user</title>
<simpara>Before you can use the headless Process Automation Manager controller, you must create a user that has the <literal>kie-server</literal> role.</simpara>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>The headless Process Automation Manager controller is installed in the base directory of the Red Hat JBoss EAP installation (<literal><emphasis>EAP_HOME</emphasis></literal>).</simpara>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In a terminal application, navigate to the <literal><emphasis>EAP_HOME</emphasis>/bin</literal> directory.</simpara>
</listitem>
<listitem>
<simpara>Enter the following command and replace <literal>&lt;USER_NAME&gt;</literal> and <literal>&lt;PASSWORD&gt;</literal> with the user name and password of your choice.</simpara>
<programlisting language="bash" linenumbering="unnumbered">$ ./add-user.sh -a --user &lt;USER_NAME&gt; --password &lt;PASSWORD&gt; --role kie-server</programlisting>
<note>
<simpara>Make sure that the specified user name is not the same as an existing user, role, or group. For example, do not create a user with the user name <literal>admin</literal>.</simpara>
<simpara>The password must have at least eight characters and must contain at least one number and one non-alphanumeric character, but not &amp; (ampersand).</simpara>
</note>
</listitem>
<listitem>
<simpara>Make a note of your user name and password.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="controller-eap-configure-proc_execution-server">
<title>Configuring KIE Server and the headless Process Automation Manager controller</title>
<simpara>If KIE Server will be managed by the headless Process Automation Manager controller, you must edit the <literal>standalone-full.xml</literal> file in KIE Server installation and the <literal>standalone.xml</literal> file in the headless Process Automation Manager controller installation.</simpara>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>KIE Server is installed in an <literal><emphasis>EAP_HOME</emphasis></literal>.</simpara>
</listitem>
<listitem>
<simpara>The headless Process Automation Manager controller is installed in an <literal><emphasis>EAP_HOME</emphasis></literal>.</simpara>
<note>
<simpara>You should install KIE Server and the headless Process Automation Manager controller
on different servers in production environments. However, if you install KIE Server and the headless Process Automation Manager controller on the same server, for example in a development environment, make these changes in the shared <literal>standalone-full.xml</literal> file.</simpara>
</note>
</listitem>
<listitem>
<simpara>On KIE Server nodes, a user with the <literal>kie-server</literal> role exists.</simpara>
</listitem>
<listitem>
<simpara>On the  server nodes, a user with the <literal>kie-server</literal> role exists.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In the   <literal><emphasis>EAP_HOME</emphasis>/standalone/configuration/standalone-full.xml</literal> file, add the following properties to the <literal>&lt;system-properties&gt;</literal> section and replace <literal>&lt;USERNAME&gt;</literal> and <literal>&lt;USER_PWD&gt;</literal> with the credentials of a user with the <literal>kie-server</literal> role:</simpara>
<programlisting language="xml" linenumbering="unnumbered">   &lt;property name="org.kie.server.user" value="&lt;USERNAME&gt;"/&gt;
   &lt;property name="org.kie.server.pwd" value="&lt;USER_PWD&gt;"/&gt;</programlisting>
</listitem>
<listitem>
<simpara>In the KIE Server  <literal><emphasis>EAP_HOME</emphasis>/standalone/configuration/standalone-full.xml</literal> file, add the following properties to the <literal>&lt;system-properties&gt;</literal> section:</simpara>
<programlisting language="xml" linenumbering="unnumbered">  &lt;property name="org.kie.server.controller.user" value="&lt;CONTROLLER_USER&gt;"/&gt;
  &lt;property name="org.kie.server.controller.pwd" value="&lt;CONTROLLER_PWD&gt;"/&gt;
  &lt;property name="org.kie.server.id" value="&lt;KIE_SERVER_ID&gt;"/&gt;
  &lt;property name="org.kie.server.location" value="http://&lt;HOST&gt;:&lt;PORT&gt;/kie-server/services/rest/server"/&gt;
  &lt;property name="org.kie.server.controller" value="&lt;CONTROLLER_URL&gt;"/&gt;</programlisting>
</listitem>
<listitem>
<simpara>In this file, replace the following values:</simpara>
</listitem>
</orderedlist>
</listitem>
<listitem>
<simpara>Replace <literal>&lt;CONTROLLER_USER&gt;</literal> and <literal>&lt;CONTROLLER_PWD&gt;</literal> with the credentials of a user with the <literal>kie-server</literal> role.</simpara>
</listitem>
<listitem>
<simpara>Replace <literal>&lt;KIE_SERVER_ID&gt;</literal> with the ID or name of the KIE Server installation, for example, <literal>rhpam-7.10.0-kie-server-1</literal>.</simpara>
</listitem>
<listitem>
<simpara>Replace <literal>&lt;HOST&gt;</literal> with the ID or name of the KIE Server host, for example, <literal>localhost</literal> or <literal>192.7.8.9</literal>.</simpara>
</listitem>
<listitem>
<simpara>Replace <literal>&lt;PORT&gt;</literal> with the port of the KIE Server host, for example, <literal>8080</literal>.</simpara>
<note>
<simpara>The <literal>org.kie.server.location</literal> property specifies the location of KIE Server.</simpara>
</note>
</listitem>
<listitem>
<simpara>Replace <literal>&lt;CONTROLLER_URL&gt;</literal> with the URL of the headless Process Automation Manager controller. KIE Server connects to this URL during startup.</simpara>
</listitem>
</itemizedlist>
</section>
</section>
<section xml:id="controller-eap-run-proc_execution-server">
<title>Running the headless Process Automation Manager controller</title>
<simpara>After you have installed the headless Process Automation Manager controller on Red Hat JBoss EAP, use this procedure to run the headless Process Automation Manager controller.</simpara>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>The headless Process Automation Manager controller is installed and configured in the base directory of the Red Hat JBoss EAP installation (<literal><emphasis>EAP_HOME</emphasis></literal>).</simpara>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In a terminal application, navigate to <literal><emphasis>EAP_HOME</emphasis>/bin</literal>.</simpara>
</listitem>
<listitem>
<simpara>If you installed the headless Process Automation Manager controller on the same Red Hat JBoss EAP instance as the Red Hat JBoss EAP instance where you installed the KIE Server, enter one of the following commands:</simpara>
<itemizedlist>
<listitem>
<simpara>On Linux or UNIX-based systems:</simpara>
<programlisting language="bash" linenumbering="unnumbered">$ ./standalone.sh -c standalone-full.xml</programlisting>
</listitem>
<listitem>
<simpara>On Windows:</simpara>
<programlisting language="bash" linenumbering="unnumbered">standalone.bat -c standalone-full.xml</programlisting>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>If you installed the headless Process Automation Manager controller on a separate Red Hat JBoss EAP instance from the Red Hat JBoss EAP instance where you installed the KIE Server, start the headless Process Automation Manager controller with the <literal>standalone.sh</literal> script:</simpara>
<note>
<simpara>In this case, ensure that you made all required configuration changes to the <literal>standalone.xml</literal> file.</simpara>
</note>
<itemizedlist>
<listitem>
<simpara>On Linux or UNIX-based systems:</simpara>
<programlisting language="bash" linenumbering="unnumbered">$ ./standalone.sh</programlisting>
</listitem>
<listitem>
<simpara>On Windows:</simpara>
<programlisting language="bash" linenumbering="unnumbered">standalone.bat</programlisting>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>To verify that the headless Process Automation Manager controller is working on Red Hat JBoss EAP, enter the following command where <literal>&lt;CONTROLLER&gt;</literal> and <literal>&lt;CONTROLLER_PWD&gt;</literal> is the user name and password. The output of this command provides information about the KIE Server instance.</simpara>
<screen>curl -X GET "http://&lt;HOST&gt;:&lt;PORT&gt;/controller/rest/controller/management/servers" -H  "accept: application/xml" -u '&lt;CONTROLLER&gt;:&lt;CONTROLLER_PWD&gt;'</screen>
</listitem>
</orderedlist>
<note>
<simpara>Alternatively, you can use the KIE Server Java API Client to access the headless Process Automation Manager controller.</simpara>
</note>
</section>
<section xml:id="clustering-headless-controller-proc_execution-server">
<title>Clustering KIE Servers with the headless Process Automation Manager controller</title>
<simpara>The Process Automation Manager controller is integrated with Business Central. However, if you do not install Business Central, you can install the headless Process Automation Manager controller and use the REST API or the KIE Server Java Client API to interact with it.</simpara>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>A backed-up Red Hat JBoss EAP installation version 7.3 or later is available. The base directory of the Red Hat JBoss EAP installation is referred to as <literal><emphasis>EAP_HOME</emphasis></literal>.</simpara>
</listitem>
<listitem>
<simpara>Sufficient user permissions to complete the installation are granted.</simpara>
</listitem>
<listitem>
<simpara>An NFS server with a shared folder is available as described in
<link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/installing_and_configuring_red_hat_process_automation_manager#nfs-server-configure-proc_clustering-dev"><emphasis>Installing and configuring Red Hat Process Automation Manager in a Red Hat JBoss EAP clustered environment</emphasis></link>.</simpara>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>Navigate to the <link xlink:href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Software Downloads</link> page in the Red Hat Customer Portal (login required), and select the product and version from the drop-down options:</simpara>
<itemizedlist>
<listitem>
<simpara><emphasis role="strong">Product: Process Automation Manager</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Version: 7.10</emphasis></simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>Download <emphasis role="strong">Red Hat Process Automation Manager 7.10.0 Add Ons</emphasis> (the <literal>rhpam-7.10.0-add-ons.zip</literal> file).</simpara>
</listitem>
<listitem>
<simpara>Extract the <literal>rhpam-7.10.0-add-ons.zip</literal> file. The <literal>rhpam-7.10.0-controller-ee7.zip</literal> file is in the extracted directory.</simpara>
</listitem>
<listitem>
<simpara>Extract the <literal>rhpam-7.10.0-controller-ee7</literal> archive to a temporary directory. In the following examples this directory is called <literal><emphasis>TEMP_DIR</emphasis></literal>.</simpara>
</listitem>
<listitem>
<simpara>Copy the <literal><emphasis>TEMP_DIR</emphasis>/rhpam-7.10.0-controller-ee7/controller.war</literal> directory to <literal><emphasis>EAP_HOME</emphasis>/standalone/deployments/</literal>.</simpara>
<warning>
<simpara>Ensure that the names of the headless Process Automation Manager controller deployments you copy do not conflict with your existing deployments in the Red Hat JBoss EAP instance.</simpara>
</warning>
</listitem>
<listitem>
<simpara>Copy the contents of the <literal><emphasis>TEMP_DIR</emphasis>/rhpam-7.10.0-controller-ee7/SecurityPolicy/</literal> directory to <literal><emphasis>EAP_HOME</emphasis>/bin</literal>.</simpara>
</listitem>
<listitem>
<simpara>When prompted to overwrite files, click <emphasis role="strong">Yes</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>In the <literal><emphasis>EAP_HOME</emphasis>/standalone/deployments/</literal> directory, create an empty file named <literal>controller.war.dodeploy</literal>. This file ensures that the headless Process Automation Manager controller is automatically deployed when the server starts.</simpara>
</listitem>
<listitem>
<simpara>Open the <literal><emphasis>EAP_HOME</emphasis>/standalone/configuration/standalone.xml</literal> file in a text editor.</simpara>
</listitem>
<listitem>
<simpara>Add the following properties to the <literal>&lt;system-properties&gt;</literal> element and replace <literal>&lt;NFS_STORAGE&gt;</literal> with the absolute path to the NFS storage where the template configuration is stored:</simpara>
<screen>&lt;system-properties&gt;
  &lt;property name="org.kie.server.controller.templatefile.watcher.enabled" value="true"/&gt;
  &lt;property name="org.kie.server.controller.templatefile" value="&lt;NFS_STORAGE&gt;"/&gt;
&lt;/system-properties&gt;</screen>
<simpara>Template files contain default configurations for specific deployment scenarios.</simpara>
<simpara>If the value of the <literal>org.kie.server.controller.templatefile.watcher.enabled</literal> property is set to true, a separate thread is started to watch for modifications of the template file. The default interval for these checks is 30000 milliseconds and can be further controlled by the <literal>org.kie.server.controller.templatefile.watcher.interval</literal> system property. If the value of this property is set to false, changes to the template file are detected only when the server restarts.</simpara>
</listitem>
<listitem>
<simpara>To start the headless Process Automation Manager controller, navigate to <literal><emphasis>EAP_HOME</emphasis>/bin</literal> and enter the following command:</simpara>
<itemizedlist>
<listitem>
<simpara>On Linux or UNIX-based systems:</simpara>
<programlisting language="bash" linenumbering="unnumbered">$ ./standalone.sh</programlisting>
</listitem>
<listitem>
<simpara>On Windows:</simpara>
<programlisting language="bash" linenumbering="unnumbered">standalone.bat</programlisting>
</listitem>
</itemizedlist>
</listitem>
</orderedlist>
<simpara>For more information about running Red Hat Process Automation Manager in a Red Hat JBoss Enterprise Application Platform clustered environment, see <link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/installing_and_configuring_red_hat_process_automation_manager#assembly-clustering-eap"><emphasis>Installing and configuring Red Hat Process Automation Manager in a Red Hat JBoss EAP clustered environment</emphasis></link>.</simpara>
</section>
</chapter>
<chapter xml:id="kie-server-smart-router-enable-tls-support-proc_execution-server">
<title>Configuring Smart Router for TLS support</title>
<simpara>You can configure Smart Router (KIE Server Router) for TLS support to allow HTTPS traffic.</simpara>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>KIE Server is installed on each node of a Red Hat JBoss EAP 7.3 cluster.</simpara>
</listitem>
<listitem>
<simpara>Smart Router is installed and configured. For more information, see
<link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/installing_and_configuring_red_hat_process_automation_manager#clustering-smart-router-install-proc_clustering-runtime-standalone">Installing and configuring Red Hat Process Automation Manager in a Red Hat JBoss EAP clustered environment</link>.</simpara>
</listitem>
</itemizedlist>
<itemizedlist>
<title>Procedure</title>
<listitem>
<simpara>To start Smart Router with TLS support and HTTPS enabled, use the TLS keystore properties, for example:</simpara>
<programlisting language="java" linenumbering="unnumbered">java  -Dorg.kie.server.router.tls.keystore = &lt;KEYSTORE_PATH&gt;
      -Dorg.kie.server.router.tls.keystore.password = &lt;KEYSTORE_PWD&gt;
      -Dorg.kie.server.router.tls.keystore.keyalias = &lt;KEYSTORE_ALIAS&gt;
      -Dorg.kie.server.router.tls.port = &lt;HTTPS_PORT&gt;
      -jar rhpam-7.9.0-smart-router.jar</programlisting>
<simpara><literal>org.kie.server.router.tls.port</literal> is a property used to configure the HTTPS port. The default HTTPS port value is <literal>9443</literal>.</simpara>
</listitem>
</itemizedlist>
</chapter>
<chapter xml:id="kie-server-deactivate-kie-containers-proc">
<title>Activating or deactivating a KIE container on KIE Server</title>
<simpara>You can now stop the creation of new process instances from a given container by deactivating it but at the same time continue working on its existing process instances and tasks. In case the deactivation is temporary, you can activate the container again later. The activation or deactivation of KIE containers do not require restarting of KIE server.</simpara>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>A KIE container has been created and configured in Business Central.</simpara>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>Log in to Business Central.</simpara>
</listitem>
<listitem>
<simpara>In the main menu, click <emphasis role="strong">Menu</emphasis> → <emphasis role="strong">Deploy</emphasis> → <emphasis role="strong">Execution Servers</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>From the <emphasis role="strong">Server Configurations</emphasis> pane, which is on the left of the page, select your server.</simpara>
</listitem>
<listitem>
<simpara>From the <emphasis role="strong">Deployment Units</emphasis> pane, select the deployment unit you want to activate or deactivate.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Activate</emphasis> or <emphasis role="strong">Deactivate</emphasis> in the upper-right corner of the deployment unit pane.</simpara>
<simpara>You cannot create a process instance from a KIE container once it is deactivated.</simpara>
</listitem>
</orderedlist>
</chapter>
<chapter xml:id="deployment_descriptors-con">
<title>Deployment descriptors</title>
<simpara>Processes and rules are stored in Apache Maven based packaging and are known as knowledge archives, or KJAR. The rules, processes, assets, and other project artifacts are part of a JAR file built and managed by Maven. A file kept inside the <literal>META-INF</literal> directory of the KJAR called <literal>kmodule.xml</literal> can be used to define the KIE bases and sessions. This <literal>kmodule.xml</literal> file, by default, is empty.</simpara>
<simpara>Whenever a runtime component such as KIE Server is about to process the KJAR, it looks up <literal>kmodule.xml</literal> to build the runtime representation.</simpara>
<simpara>Deployment descriptors supplement the <literal>kmodule.xml</literal> file and provide granular control over your deployment. The presence of these descriptors is optional and your deployment will proceed successfully without them. You can set purely technical properties using these descriptors, including meta values such as persistence, auditing, and runtime strategy.</simpara>
<simpara>These descriptors allow you to configure the KIE Server on multiple levels, including server level default, different deployment descriptor per KJAR, and other server configurations. You can use descriptors to make simple customizations to the default KIE Server configuration, possibly per KJAR.</simpara>
<simpara>You can define these descriptors in a file called <literal>kie-deployment-descriptor.xml</literal> and place this file next to your <literal>kmodule.xml</literal> file in the <literal>META-INF</literal> folder. You can change this default location and the file name by specifying it as a system parameter:</simpara>
<screen>-Dorg.kie.deployment.desc.location=file:/path/to/file/company-deployment-descriptor.xml</screen>
<section xml:id="deployment_descriptor_configuration" remap="_deployment_descriptor_configuration">
<title>Deployment descriptor configuration</title>
<simpara>Deployment descriptors allow the user to configure the execution server on multiple levels:</simpara>
<itemizedlist>
<listitem>
<simpara><emphasis>Server level</emphasis>: The main level and the one that applies to all KJARs deployed on the server.</simpara>
</listitem>
<listitem>
<simpara><emphasis>KJAR level</emphasis>: This enables you to configure descriptors on a per KJAR basis.</simpara>
</listitem>
<listitem>
<simpara><emphasis>Deploy time level</emphasis>: Descriptors that apply while a KJAR is being deployed.</simpara>
</listitem>
</itemizedlist>
<simpara>The granular configuration items specified by the deployment descriptors take precedence over the server level ones, except in case of configuration items that are collection based, which are merged. The hierarchy works like this: <emphasis>deploy time configuration &gt; KJAR configuration &gt; server configuration</emphasis>.</simpara>
<note>
<simpara>The deploy time configuration applies to deployments done via the REST API.</simpara>
</note>
<simpara>For example, if the persistence mode (one of the items you can configure) defined at the server level is <literal role="parameter">NONE</literal> but the same mode is specified as <literal role="parameter">JPA</literal> at the KJAR level, the actual mode will be <literal role="parameter">JPA</literal> for that KJAR. If nothing is specified for the persistence mode in the deployment descriptor for that KJAR (or if there is no deployment descriptor), it will fall back to the server level configuration, which in this case is <literal role="parameter">NONE</literal> (or to <literal role="parameter">JPA</literal> if there is no server level deployment descriptor).</simpara>
<bridgehead xml:id="what_can_you_configure" renderas="sect3" remap="_what_can_you_configure">What Can You Configure?</bridgehead>
<simpara>High level technical configuration details can be configured via deployment descriptors.
The following table lists these along with the permissible and default values for each.</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>Deployment Descriptors</title>
<tgroup cols="4">
<colspec colname="col_1" colwidth="25*"/>
<colspec colname="col_2" colwidth="25*"/>
<colspec colname="col_3" colwidth="25*"/>
<colspec colname="col_4" colwidth="25*"/>
<thead>
<row>
<entry align="left" valign="top">Configuration</entry>
<entry align="left" valign="top">XML Entry</entry>
<entry align="left" valign="top">Permissible Values</entry>
<entry align="left" valign="top">Default Value</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>Persistence unit name for runtime data</simpara></entry>
<entry align="left" valign="top"><simpara>persistence-unit</simpara></entry>
<entry align="left" valign="top"><simpara>Any valid persistence package name</simpara></entry>
<entry align="left" valign="top"><simpara>org.jbpm.domain</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Persistence unit name for audit data</simpara></entry>
<entry align="left" valign="top"><simpara>audit-persistence-unit</simpara></entry>
<entry align="left" valign="top"><simpara>Any valid persistence package name</simpara></entry>
<entry align="left" valign="top"><simpara>org.jbpm.domain</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Persistence mode</simpara></entry>
<entry align="left" valign="top"><simpara>persistence-mode</simpara></entry>
<entry align="left" valign="top"><simpara>JPA, NONE</simpara></entry>
<entry align="left" valign="top"><simpara>JPA</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Audit mode</simpara></entry>
<entry align="left" valign="top"><simpara>audit-mode</simpara></entry>
<entry align="left" valign="top"><simpara>JPA, JMS or NONE</simpara></entry>
<entry align="left" valign="top"><simpara>JPA</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Runtime Strategy</simpara></entry>
<entry align="left" valign="top"><simpara>runtime-strategy</simpara></entry>
<entry align="left" valign="top"><simpara>SINGLETON, PER_REQUEST or PER_PROCESS_INSTANCE</simpara></entry>
<entry align="left" valign="top"><simpara>SINGLETON</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>List of Event Listeners to be registered</simpara></entry>
<entry align="left" valign="top"><simpara>event-listeners</simpara></entry>
<entry align="left" valign="top"><simpara>Valid listener class names as <literal role="class">ObjectModel</literal></simpara></entry>
<entry align="left" valign="top"><simpara>No default value</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>List of Task Event Listeners to be registered</simpara></entry>
<entry align="left" valign="top"><simpara>task-event-listeners</simpara></entry>
<entry align="left" valign="top"><simpara>Valid listener class names as <literal role="class">ObjectModel</literal></simpara></entry>
<entry align="left" valign="top"><simpara>No default value</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>List of Work Item Handlers to be registered</simpara></entry>
<entry align="left" valign="top"><simpara>work-item-handlers</simpara></entry>
<entry align="left" valign="top"><simpara>Valid Work Item Handler classes given as <literal role="class">NamedObjectHandler</literal></simpara></entry>
<entry align="left" valign="top"><simpara>No default value</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>List of Globals to be registered</simpara></entry>
<entry align="left" valign="top"><simpara>globals</simpara></entry>
<entry align="left" valign="top"><simpara>Valid Global variables given as <literal role="class">NamedObjectModel</literal></simpara></entry>
<entry align="left" valign="top"><simpara>No default value</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Marshalling strategies to be registered (for pluggable variable persistence)</simpara></entry>
<entry align="left" valign="top"><simpara>marshalling-strategies</simpara></entry>
<entry align="left" valign="top"><simpara>Valid <literal role="class">ObjectModel</literal> classes</simpara></entry>
<entry align="left" valign="top"><simpara>No default value</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Required Roles to be granted access to the resources of the KJAR</simpara></entry>
<entry align="left" valign="top"><simpara>required-roles</simpara></entry>
<entry align="left" valign="top"><simpara>String role names</simpara></entry>
<entry align="left" valign="top"><simpara>No default value</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Additional Environment Entries for KIE session</simpara></entry>
<entry align="left" valign="top"><simpara>environment-entries</simpara></entry>
<entry align="left" valign="top"><simpara>Valid <literal role="class">NamedObjectModel</literal></simpara></entry>
<entry align="left" valign="top"><simpara>No default value</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Additional configuration options of KIE session</simpara></entry>
<entry align="left" valign="top"><simpara>configurations</simpara></entry>
<entry align="left" valign="top"><simpara>Valid <literal role="class">NamedObjectModel</literal></simpara></entry>
<entry align="left" valign="top"><simpara>No default value</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Classes used for serialization in the remote services</simpara></entry>
<entry align="left" valign="top"><simpara>remoteable-class</simpara></entry>
<entry align="left" valign="top"><simpara>Valid <literal>CustomClass</literal></simpara></entry>
<entry align="left" valign="top"><simpara>No default value</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<warning>
<simpara>Do not use the Singleton runtime strategy with the EJB Timer Scheduler (the default scheduler in KIE Server) in a production environment. This combination can result in Hibernate problems under load. Per process instance runtime strategy is recommended if there is no specific reason to use other strategies. For more information about this limitation, see <link xlink:href="https://access.redhat.com/solutions/4065521">Hibernate issues with Singleton strategy and EJBTimerScheduler</link>.</simpara>
</warning>
</section>
<section xml:id="deploymnet-descriptors-manage-con">
<title>Managing deployment descriptors</title>
<simpara>Deployment descriptors can be configured in Business Central in <emphasis role="strong">Menu</emphasis> → <emphasis role="strong">Design</emphasis> → <emphasis role="strong">$PROJECT_NAME</emphasis> → <emphasis role="strong">Settings</emphasis> → <emphasis role="strong">Deployments</emphasis>.</simpara>
<simpara>Every time a project is created, a stock <literal>kie-deployment-descriptor.xml</literal> file is generated with default values.</simpara>
<simpara>It is not necessary to provide a full deployment descriptor for all KJARs. Providing partial deployment descriptors is possible and recommended. For example, if you need to use a different audit mode, you can specify that for the KJAR only, all other properties will have the default value defined at the server level.</simpara>
<simpara>When using <literal>OVERRIDE_ALL</literal> merge mode, all configuration items must be specified, because the relevant KJAR will always use specified configuration and will not merge with any other deployment descriptor in the hierarchy.</simpara>
</section>
<section xml:id="deployment-descriptors-restricting-runtime-access-proc">
<title>Restricting access to the runtime engine</title>
<simpara>The <literal>required-roles</literal> configuration item can be edited in the deployment descriptors. This property restricts access to the runtime engine on a per-KJAR or per-server level by ensuring that access to certain processes is only granted to users that belong to groups defined by this property.</simpara>
<simpara>The security role can be used to restrict access to process definitions or restrict access at run time.</simpara>
<simpara>The default behavior is to add required roles to this property based on repository restrictions.
You can edit these properties manually if required by providing roles that match actual roles defined in the security realm.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>To open the project deployment descriptors configuration in Business Central, open <emphasis role="strong">Menu</emphasis> → <emphasis role="strong">Design</emphasis> → <emphasis role="strong">$PROJECT_NAME</emphasis> → <emphasis role="strong">Settings</emphasis> → <emphasis role="strong">Deployments</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>From the list of configuration settings, click <emphasis role="strong">Required Roles</emphasis>, then click <emphasis role="strong">Add Required Role</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">Add Required Role</emphasis> window, type the name of the role that you want to have permission to access this deployment, then click <emphasis role="strong">Add</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>To add more roles with permission to access the deployment, repeat the previous steps.</simpara>
</listitem>
<listitem>
<simpara>When you have finished adding all required roles, click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
</orderedlist>
</section>
</chapter>
<chapter xml:id="kie-server-accessing-runtime-data-proc">
<title>Accessing runtime data from Business Central</title>
<simpara>The following pages in Business Central allow you to view the runtime data of the KIE Server:</simpara>
<itemizedlist>
<listitem>
<simpara><emphasis role="strong">Process Reports</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Task Reports</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Process Definitions</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Process Instances</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Execution Errors</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Jobs</emphasis></simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Tasks</emphasis></simpara>
</listitem>
</itemizedlist>
<simpara>These pages use the credentials of the currently logged in user to load data from the KIE Server. Therefore, to be able to view the runtime data in Business Central, ensure that the following conditions are met:</simpara>
<itemizedlist>
<listitem>
<simpara>The user exists in the KIE container (deployment unit) running the Business Central application. This user must have <literal>admin</literal>, <literal>analyst</literal>, or <literal>developer</literal> roles assigned, in addition to the <literal>kie-server</literal> role, with full access to the runtime data. The <literal>manager</literal> and <literal>process_admin</literal> roles also allow access to runtime data pages in Business Central.</simpara>
</listitem>
<listitem>
<simpara>The user exists in the KIE container (deployment unit) running the KIE Server and has <literal>kie-server</literal> role assigned.</simpara>
</listitem>
<listitem>
<simpara>Communication between Business Central and the KIE Server is established. That is, the KIE Server is registered in the Process Automation Manager controller, which is part of Business Central.</simpara>
</listitem>
<listitem>
<simpara>The <literal>deployment.business-central.war</literal> login module is present in the <literal>standalone.xml</literal> configuration of the server running Business Central:</simpara>
<screen> &lt;login-module code="org.kie.security.jaas.KieLoginModule" flag="optional" module="deployment.business-central.war"/&gt;</screen>
</listitem>
</itemizedlist>
</chapter>
<chapter xml:id="execution-error-management-con_execution-server">
<title>Execution error management</title>
<simpara>When an execution error occurs for a business process, the process stops and reverts to the most recent stable state (the closest safe point) and continues its execution. If an error of any kind is not handled by the process the entire transaction rolls back, leaving the process instance in the previous wait state. Any trace of this is only visible in the logs, and usually displayed to the caller who sent the request to the process engine.</simpara>
<simpara>Users with process administrator (<literal>process-admin</literal>) or administrator (<literal>admin</literal>) roles are able to access error messages in Business Central. Execution error messaging provides the following primary benefits:</simpara>
<itemizedlist>
<listitem>
<simpara>Better traceability</simpara>
</listitem>
<listitem>
<simpara>Visibility in case of critical processes</simpara>
</listitem>
<listitem>
<simpara>Reporting and analytics based on error situations</simpara>
</listitem>
<listitem>
<simpara>External system error handling and compensation</simpara>
</listitem>
</itemizedlist>
<simpara>Configurable error handling is responsible for receiving any technical errors thrown throughout the process engine execution (including task service). The following technical exceptions apply:</simpara>
<itemizedlist>
<listitem>
<simpara>Anything that extends <literal>java.lang.Throwable</literal></simpara>
</listitem>
<listitem>
<simpara>Process level error handling and any other exceptions not previously handled</simpara>
</listitem>
</itemizedlist>
<simpara>There are several components that make up the error handling mechanism and allow a pluggable approach to extend its capabilities.</simpara>
<simpara>The process engine entry point for error handling is the <literal>ExecutionErrorManager</literal>. This is integrated with <literal>RuntimeManager</literal>, which is then responsible for providing it to the underlying <literal>KieSession</literal> and <literal>TaskService</literal>.</simpara>
<simpara>From an API point of view, <literal>ExecutionErrorManager</literal> provides access to the following components:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>ExecutionErrorHandler</literal>: The primary mechanism for error handling</simpara>
</listitem>
<listitem>
<simpara><literal>ExecutionErrorStorage</literal>: Pluggable storage for execution error information</simpara>
</listitem>
</itemizedlist>
<section xml:id="manage-execution-errors-proc-execution-server">
<title>Managing execution errors</title>
<simpara>By definition, every process error that is detected and stored is unacknowledged and must be handled by someone or something (in case of automatic error recovery). Errors are filtered on the basis of whether or not they have been acknowledged. Acknowledging an error saves the user information and time stamp for traceability. You can access the <emphasis role="strong">Error Management</emphasis> view at any time.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, go to <emphasis role="strong">Menu</emphasis> → <emphasis role="strong">Manage</emphasis> → <emphasis role="strong">Execution Errors</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Select an error from the list to open the <emphasis role="strong">Details</emphasis> tab. This displays information about the error or errors.</simpara>
</listitem>
<listitem>
<simpara>Click the <emphasis role="strong">Acknowledge</emphasis> button to acknowledge and clear the error. You can view the error later by selecting <emphasis role="strong">Yes</emphasis> on the <emphasis role="strong">Acknowledged</emphasis> filter in the <emphasis role="strong">Manage Execution Errors</emphasis> page.</simpara>
<simpara>If the error was related to a task, a <emphasis role="strong">Go to Task</emphasis> button is displayed.</simpara>
</listitem>
<listitem>
<simpara>Click the <emphasis role="strong">Go to Task</emphasis> button, if applicable, to view the associated job information in the <emphasis role="strong">Manage Tasks</emphasis> page.</simpara>
<simpara>In the <emphasis role="strong">Manage Tasks</emphasis> page, you can restart, reschedule, or retry the corresponding task.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="exectionerrorhandler-con">
<title>The ExecutionErrorHandler</title>
<simpara>The <literal>ExecutionErrorHandler</literal> is the primary mechanism for all process error handling. It is bound to the life cycle of RuntimeEngine; meaning it is created when a new runtime engine is created, and is destroyed when RuntimeEngine is disposed. A single instance of the <literal>ExecutionErrorHandler</literal> is used within a given execution context or transaction. Both <literal>KieSession</literal> and <literal>TaskService</literal> use that instance to inform the error handling about processed nodes/tasks. <literal>ExecutionErrorHandler</literal> is informed about:</simpara>
<itemizedlist>
<listitem>
<simpara>Starting of processing of a given node instance.</simpara>
</listitem>
<listitem>
<simpara>Completion of processing of a given node instance.</simpara>
</listitem>
<listitem>
<simpara>Starting of processing of a given task instance.</simpara>
</listitem>
<listitem>
<simpara>Completion of processing of a given task instance.</simpara>
</listitem>
</itemizedlist>
<simpara>This information is mainly used for errors that are of unknown type; that is, errors that do not provide information about the process context. For example, upon commit time, database exceptions do not carry any process information.</simpara>
</section>
<section xml:id="execution-error-storage-con">
<title>Execution error storage</title>
<simpara><literal>ExecutionErrorStorage</literal> is a pluggable strategy that permits various ways of persisting information about execution errors. Storage is used directly by the handler that gets an instance of the store when it is created (when RuntimeEngine is created). Default storage implementation is based on the database table, which stores every error and includes all of the available information. Some errors may not contain details, as this depends on the type of error and whether or not it is possible to extract specific information.</simpara>
</section>
<section xml:id="error-types-and-filters-ref">
<title>Error types and filters</title>
<simpara>Error handling attempts to catch and handle any kind of error, therefore it needs a way to categorize errors. By doing this, it is able to properly extract information from the error and make it pluggable, as some users may require specific types of errors to be thrown and handled in different ways than what is provided by default.</simpara>
<simpara>Error categorization and filtering is based on <literal>ExecutionErrorFilters</literal>. This interface is solely responsible for building instances of <literal>ExecutionError</literal>, which are later stored by way of the <literal>ExecutionErrorStorage</literal> strategy. It has following methods:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>accept</literal>: indicates if given error can be handled by the filter.</simpara>
</listitem>
<listitem>
<simpara><literal>filter</literal>: where the actual filtering, handling, and so on happens.</simpara>
</listitem>
<listitem>
<simpara><literal>getPriority</literal>: indicates the priority that is used when calling filters.</simpara>
</listitem>
</itemizedlist>
<simpara>Filters process one error at a time and use a priority system to avoid having multiple filters returning alternative “views” of the same error. Priority enables more specialized filters to see if the error can be accepted, or otherwise allow another filter to handle it.</simpara>
<simpara><literal>ExecutionErrorFilter</literal> can be provided using the <literal>ServiceLoader</literal> mechanism, which enables the capability of error handling to be easily extended.</simpara>
<simpara>Red Hat Process Automation Manager ships with the following <literal>ExecutionErrorFilters</literal> :</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>ExecutionErrorFilters</title>
<tgroup cols="3">
<colspec colname="col_1" colwidth="60*"/>
<colspec colname="col_2" colwidth="20*"/>
<colspec colname="col_3" colwidth="20*"/>
<thead>
<row>
<entry align="left" valign="top">Class name</entry>
<entry align="left" valign="top">Type</entry>
<entry align="left" valign="top">Priority</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>org.jbpm.runtime.manager.impl.error.filters.ProcessExecutionErrorFilter</simpara></entry>
<entry align="left" valign="top"><simpara>Process</simpara></entry>
<entry align="left" valign="top"><simpara>100</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>org.jbpm.runtime.manager.impl.error.filters.TaskExecutionErrorFilter</simpara></entry>
<entry align="left" valign="top"><simpara>Task</simpara></entry>
<entry align="left" valign="top"><simpara>80</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>org.jbpm.runtime.manager.impl.error.filters.DBExecutionErrorFilter</simpara></entry>
<entry align="left" valign="top"><simpara>DB</simpara></entry>
<entry align="left" valign="top"><simpara>200</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>org.jbpm.executor.impl.error.JobExecutionErrorFilter</simpara></entry>
<entry align="left" valign="top"><simpara>Job</simpara></entry>
<entry align="left" valign="top"><simpara>100</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<simpara>Filters are given a higher execution order based on the lowest value of the priority. In the above table, filters are invoked in the following order:</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Task</simpara>
</listitem>
<listitem>
<simpara>Process</simpara>
</listitem>
<listitem>
<simpara>Job</simpara>
</listitem>
<listitem>
<simpara>DB</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="autoacknowledge-execution-errors-proc">
<title>Auto acknowledging execution errors</title>
<simpara>When executions errors occur they are unacknowledged by default, and require a manual acknowledgment to be performed otherwise they are always seen as information that requires attention. In case of larger volumes, manual actions can be time consuming and not suitable in some situations.</simpara>
<simpara>Auto acknowledgment resolves this issue. It is based on scheduled jobs by way of the <literal>jbpm-executor</literal>, with the following three types of jobs available:</simpara>
<variablelist>
<varlistentry>
<term><literal>org.jbpm.executor.commands.error.JobAutoAckErrorCommand</literal></term>
<listitem>
<simpara>Responsible for finding jobs that previously failed but now are either canceled, completed, or rescheduled for another execution. This job only acknowledges execution errors of type <literal>Job</literal>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><literal>org.jbpm.executor.commands.error.TaskAutoAckErrorCommand</literal></term>
<listitem>
<simpara>Responsible for auto acknowledgment of user task execution errors for tasks that previously failed but now are in one of the exit states (completed, failed, exited, obsolete). This job only acknowledges execution errors of type <literal>Task</literal>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term><literal>org.jbpm.executor.commands.error.ProcessAutoAckErrorCommand</literal></term>
<listitem>
<simpara>Responsible for auto acknowledgment of process instances that have errors attached. It acknowledges errors where the process instance is already finished (completed or aborted), or the task that the error originated from is already finished. This is based on <literal>init_activity_id</literal> value. This job acknowledges any type of execution error that matches the above criteria.</simpara>
</listitem>
</varlistentry>
</variablelist>
<simpara>Jobs can be registered on the KIE Server. In Business Central you can configure auto acknowledge jobs for errors:</simpara>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>Execution errors of one or more type have accumulated during processes execution but require no further attention.</simpara>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, click <emphasis role="strong">Menu</emphasis> → <emphasis role="strong">Manage</emphasis> → <emphasis role="strong">Jobs</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>In the top right of the screen, click <emphasis role="strong">New Job</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Type the process correlation key into the <emphasis role="strong">Business Key</emphasis> field.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">Type</emphasis> field, add type of the auto acknowledge job type from the list above.</simpara>
</listitem>
<listitem>
<simpara>Select a <emphasis role="strong">Due On</emphasis> time for the job to be completed:</simpara>
<orderedlist numeration="loweralpha">
<listitem>
<simpara>To run the job immediately, select the <literal>Run now</literal> option.</simpara>
</listitem>
<listitem>
<simpara>To run the job at a specific time, select <literal>Run later</literal>. A date and time field appears next to the <literal>Run later</literal> option. Click the field to open the calendar and schedule a specific time and date for the job.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="images/_images/admin-and-config/auto_acknowledge_error_job1.png"/>
</imageobject>
<textobject><phrase>auto acknowledge error job1</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
</orderedlist>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Create</emphasis> to create the job and return to the <emphasis role="strong">Manage Jobs</emphasis> page.</simpara>
</listitem>
</orderedlist>
<simpara>The following steps are optional, and allow you to configure auto acknowledge jobs to run either once (<literal>SingleRun</literal>), on specific time intervals (<literal>NextRun</literal>), or using the custom name of an entity manager factory to search for jobs to acknowledge (<literal>EmfName</literal>).</simpara>
<orderedlist numeration="arabic">
<listitem>
<simpara>Click the <emphasis role="strong">Advanced</emphasis> tab.</simpara>
</listitem>
<listitem>
<simpara>Click the <emphasis role="strong">Add Parameter</emphasis> button.</simpara>
</listitem>
<listitem>
<simpara>Enter the configuration parameter you want to apply to the job:</simpara>
<orderedlist numeration="loweralpha">
<listitem>
<simpara><literal>SingleRun</literal>: <literal>true</literal> or <literal>false</literal></simpara>
</listitem>
<listitem>
<simpara><literal>NextRun</literal>: time expression, such as 2h, 5d, 1m, and so on.</simpara>
</listitem>
<listitem>
<simpara><literal>EmfName</literal>: custom entity manager factory name.</simpara>
<informalfigure>
<mediaobject>
<imageobject>
<imagedata fileref="images/_images/admin-and-config/auto_acknowledge_error_job2.png"/>
</imageobject>
<textobject><phrase>auto acknowledge error job2</phrase></textobject>
</mediaobject>
</informalfigure>
</listitem>
</orderedlist>
</listitem>
</orderedlist>
</section>
<section xml:id="error-list-cleanup-ref">
<title>Cleaning up the error list</title>
<simpara>The <literal>ExecutionErrorInfo</literal> error list table can be cleaned up to remove redundant information. Depending on the life cycle of the process, errors may remain in the list for some time, and there is no direct API with which to clean up the list. Instead, the <literal>ExecutionErrorCleanupCommand</literal> command can be scheduled to periodically clean up errors.</simpara>
<simpara>The following parameters can be set for the clean up command. The command is restricted to deleting execution errors of already completed or aborted process instances:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>DateFormat</literal></simpara>
<itemizedlist>
<listitem>
<simpara>Date format for further date related parameters - if not given <literal>yyyy-MM-dd</literal> is used (pattern of <literal>SimpleDateFormat</literal> class).</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara><literal>EmfName</literal></simpara>
<itemizedlist>
<listitem>
<simpara>Name of the entity manager factory to be used for queries (valid persistence unit name).</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara><literal>SingleRun</literal></simpara>
<itemizedlist>
<listitem>
<simpara>Indicates if execution should be single run only (<literal>true</literal>|<literal>false</literal>).</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara><literal>NextRun</literal></simpara>
<itemizedlist>
<listitem>
<simpara>Provides next execution time (valid time expression, for example: 1d, 5h, and so on)</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara><literal>OlderThan</literal></simpara>
<itemizedlist>
<listitem>
<simpara>Indicates what errors should be deleted - older than given date.</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara><literal>OlderThanPeriod</literal></simpara>
<itemizedlist>
<listitem>
<simpara>Indicated what errors should be deleted older than given time expression (valid time expression e.g. 1d, 5h, and so on)</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara><literal>ForProcess</literal></simpara>
<itemizedlist>
<listitem>
<simpara>Indicates errors to be deleted only for given process definition.</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara><literal>ForProcessInstance</literal></simpara>
<itemizedlist>
<listitem>
<simpara>Indicates errors to be deleted only for given process instance.</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara><literal>ForDeployment</literal></simpara>
<itemizedlist>
<listitem>
<simpara>Indicates errors to be deleted that are from given deployment ID.</simpara>
</listitem>
</itemizedlist>
</listitem>
</itemizedlist>
</section>
</chapter>
<chapter xml:id="prometheus-monitoring-con_execution-server">
<title>Prometheus metrics monitoring in Red Hat Process Automation Manager</title>
<simpara>Prometheus is an open-source systems monitoring toolkit that you can use with Red Hat Process Automation Manager to collect and store metrics related to the execution of business rules, processes, Decision Model and Notation (DMN) models, and other Red Hat Process Automation Manager assets. You can access the stored metrics through a REST API call to the KIE Server, through the Prometheus expression browser, or using a data-graphing tool such as Grafana.</simpara>
<simpara>You can configure Prometheus metrics monitoring for an on-premise KIE Server instance, for KIE Server on Spring Boot, or for a KIE Server deployment on Red Hat OpenShift Container Platform.</simpara>
<simpara>For the list of available metrics that KIE Server exposes with Prometheus,
download the <emphasis role="strong">Red Hat Process Automation Manager 7.10.0 Source Distribution</emphasis> from the <link xlink:href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Red Hat Customer Portal</link> and navigate to <literal>~/rhpam-7.10.0-sources/src/droolsjbpm-integration-$VERSION/kie-server-parent/kie-server-services/kie-server-services-prometheus/src/main/java/org/kie/server/services/prometheus</literal>.</simpara>
<important>
<simpara>Red Hat support for Prometheus is limited to the setup and configuration recommendations provided in Red Hat product documentation.</simpara>
</important>
<section xml:id="prometheus-monitoring-proc_execution-server">
<title>Configuring Prometheus metrics monitoring for KIE Server</title>
<simpara>You can configure your KIE Server instances to use Prometheus to collect and store metrics related to your business asset activity in Red Hat Process Automation Manager. For the list of available metrics that KIE Server exposes with Prometheus,
download the <emphasis role="strong">Red Hat Process Automation Manager 7.10.0 Source Distribution</emphasis> from the <link xlink:href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Red Hat Customer Portal</link> and navigate to <literal>~/rhpam-7.10.0-sources/src/droolsjbpm-integration-$VERSION/kie-server-parent/kie-server-services/kie-server-services-prometheus/src/main/java/org/kie/server/services/prometheus</literal>.</simpara>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>KIE Server is installed.</simpara>
</listitem>
<listitem>
<simpara>You have <literal>kie-server</literal> user role access to KIE Server.</simpara>
</listitem>
<listitem>
<simpara>Prometheus is installed. For information about downloading and using Prometheus, see the <link xlink:href="https://prometheus.io/docs/introduction/overview/">Prometheus documentation page</link>.</simpara>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In your KIE Server instance, set the <literal>org.kie.prometheus.server.ext.disabled</literal> system property to <literal>false</literal> to enable the Prometheus extension. You can define this property when you start KIE Server or in the <literal>standalone.xml</literal> or <literal>standalone-full.xml</literal> file of Red Hat Process Automation Manager distribution.</simpara>
</listitem>
<listitem>
<simpara>If you are running Red Hat Process Automation Manager on Spring Boot, configure the required key in the <literal>application.properties</literal> system property:</simpara>
<formalpara>
<title>Spring Boot application.properties key for Red Hat Process Automation Manager and Prometheus</title>
<para>
<programlisting language="xml" linenumbering="unnumbered">kieserver.jbpm.enabled=true
kieserver.drools.enabled=true
kieserver.dmn.enabled=true
kieserver.prometheus.enabled=true</programlisting>
</para>
</formalpara>
</listitem>
<listitem>
<simpara>In the <literal>prometheus.yaml</literal> file of your Prometheus distribution, add the following settings in the <literal>scrape_configs</literal> section to configure Prometheus to scrape metrics from KIE Server:</simpara>
<formalpara>
<title>Scrape configurations in prometheus.yaml file</title>
<para>
<programlisting language="yaml" linenumbering="unnumbered">scrape_configs:
  - job_name: 'kie-server'
    metrics_path: /SERVER_PATH/services/rest/metrics
    basicAuth:
      username: USER_NAME
      password: PASSWORD
    static_configs:
      - targets: ["HOST:PORT"]</programlisting>
</para>
</formalpara>
<formalpara>
<title>Scrape configurations in prometheus.yaml file for Spring Boot (if applicable)</title>
<para>
<programlisting language="yaml" linenumbering="unnumbered">scrape_configs:
  - job_name: 'kie'
    metrics_path: /rest/metrics
    static_configs:
      - targets: ["HOST:PORT"]</programlisting>
</para>
</formalpara>
<simpara>Replace the values according to your KIE Server location and settings.</simpara>
</listitem>
<listitem>
<simpara>Start the KIE Server instance.</simpara>
<formalpara>
<title>Example start command for Red Hat Process Automation Manager on Red Hat JBoss EAP</title>
<para>
<screen>$ cd ~/EAP_HOME/bin
$ ./standalone.sh --c standalone-full.xml</screen>
</para>
</formalpara>
<simpara>After you start the configured KIE Server instance, Prometheus begins collecting metrics and KIE Server publishes the metrics to the REST API endpoint <literal>http://HOST:PORT/SERVER/services/rest/metrics</literal> (or on Spring Boot, to <literal>http://HOST:PORT/rest/metrics</literal>).</simpara>
</listitem>
<listitem>
<simpara>In a REST client or curl utility, send a REST API request with the following components to verify that KIE Server is publishing the metrics:</simpara>
<simpara>For REST client:</simpara>
<itemizedlist>
<listitem>
<simpara><emphasis role="strong">Authentication</emphasis>: Enter the user name and password of the KIE Server user with the <literal>kie-server</literal> role.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">HTTP Headers</emphasis>: Set the following header:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>Accept</literal>: <literal>application/json</literal></simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara><emphasis role="strong">HTTP method</emphasis>: Set to <literal>GET</literal>.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">URL</emphasis>: Enter the KIE Server REST API base URL and metrics endpoint, such as <literal>http://localhost:8080/kie-server/services/rest/metrics</literal> (or on Spring Boot, <literal>http://localhost:8080/rest/metrics</literal>).</simpara>
</listitem>
</itemizedlist>
<simpara>For curl utility:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>-u</literal>: Enter the user name and password of the KIE Server user with the <literal>kie-server</literal> role.</simpara>
</listitem>
<listitem>
<simpara><literal>-H</literal>: Set the following header:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>accept</literal>: <literal>application/json</literal></simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara><literal>-X</literal>: Set to <literal>GET</literal>.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">URL</emphasis>: Enter the KIE Server REST API base URL and metrics endpoint, such as <literal>http://localhost:8080/kie-server/services/rest/metrics</literal> (or on Spring Boot, <literal>http://localhost:8080/rest/metrics</literal>).</simpara>
</listitem>
</itemizedlist>
<formalpara>
<title>Example curl command for Red Hat Process Automation Manager on Red Hat JBoss EAP</title>
<para>
<screen>curl -u 'baAdmin:password@1' -X GET "http://localhost:8080/kie-server/services/rest/metrics"</screen>
</para>
</formalpara>
<formalpara>
<title>Example curl command for Red Hat Process Automation Manager on Spring Boot</title>
<para>
<screen>curl -u 'baAdmin:password@1' -X GET "http://localhost:8080/rest/metrics"</screen>
</para>
</formalpara>
<formalpara>
<title>Example server response</title>
<para>
<screen># HELP kie_server_container_started_total Kie Server Started Containers
# TYPE kie_server_container_started_total counter
kie_server_container_started_total{container_id="task-assignment-kjar-1.0",} 1.0
# HELP solvers_running Number of solvers currently running
# TYPE solvers_running gauge
solvers_running 0.0
# HELP dmn_evaluate_decision_nanosecond DMN Evaluation Time
# TYPE dmn_evaluate_decision_nanosecond histogram
# HELP solver_duration_seconds Time in seconds it took solver to solve the constraint problem
# TYPE solver_duration_seconds summary
solver_duration_seconds_count{solver_id="100tasks-5employees.xml",} 1.0
solver_duration_seconds_sum{solver_id="100tasks-5employees.xml",} 179.828255925
solver_duration_seconds_count{solver_id="24tasks-8employees.xml",} 1.0
solver_duration_seconds_sum{solver_id="24tasks-8employees.xml",} 179.995759653
# HELP drl_match_fired_nanosecond Drools Firing Time
# TYPE drl_match_fired_nanosecond histogram
# HELP dmn_evaluate_failed_count DMN Evaluation Failed
# TYPE dmn_evaluate_failed_count counter
# HELP kie_server_start_time Kie Server Start Time
# TYPE kie_server_start_time gauge
kie_server_start_time{name="myapp-kieserver",server_id="myapp-kieserver",location="http://myapp-kieserver-demo-monitoring.127.0.0.1.nip.io:80/services/rest/server",version="7.4.0.redhat-20190428",} 1.557221271502E12
# HELP kie_server_container_running_total Kie Server Running Containers
# TYPE kie_server_container_running_total gauge
kie_server_container_running_total{container_id="task-assignment-kjar-1.0",} 1.0
# HELP solver_score_calculation_speed Number of moves per second for a particular solver solving the constraint problem
# TYPE solver_score_calculation_speed summary
solver_score_calculation_speed_count{solver_id="100tasks-5employees.xml",} 1.0
solver_score_calculation_speed_sum{solver_id="100tasks-5employees.xml",} 6997.0
solver_score_calculation_speed_count{solver_id="24tasks-8employees.xml",} 1.0
solver_score_calculation_speed_sum{solver_id="24tasks-8employees.xml",} 19772.0
# HELP kie_server_case_started_total Kie Server Started Cases
# TYPE kie_server_case_started_total counter
kie_server_case_started_total{case_definition_id="itorders.orderhardware",} 1.0
# HELP kie_server_case_running_total Kie Server Running Cases
# TYPE kie_server_case_running_total gauge
kie_server_case_running_total{case_definition_id="itorders.orderhardware",} 2.0
# HELP kie_server_data_set_registered_total Kie Server Data Set Registered
# TYPE kie_server_data_set_registered_total gauge
kie_server_data_set_registered_total{name="jbpmProcessInstanceLogs::CUSTOM",uuid="jbpmProcessInstanceLogs",} 1.0
kie_server_data_set_registered_total{name="jbpmRequestList::CUSTOM",uuid="jbpmRequestList",} 1.0
kie_server_data_set_registered_total{name="tasksMonitoring::CUSTOM",uuid="tasksMonitoring",} 1.0
kie_server_data_set_registered_total{name="jbpmHumanTasks::CUSTOM",uuid="jbpmHumanTasks",} 1.0
kie_server_data_set_registered_total{name="jbpmHumanTasksWithUser::FILTERED_PO_TASK",uuid="jbpmHumanTasksWithUser",} 1.0
kie_server_data_set_registered_total{name="jbpmHumanTasksWithVariables::CUSTOM",uuid="jbpmHumanTasksWithVariables",} 1.0
kie_server_data_set_registered_total{name="jbpmProcessInstancesWithVariables::CUSTOM",uuid="jbpmProcessInstancesWithVariables",} 1.0
kie_server_data_set_registered_total{name="jbpmProcessInstances::CUSTOM",uuid="jbpmProcessInstances",} 1.0
kie_server_data_set_registered_total{name="jbpmExecutionErrorList::CUSTOM",uuid="jbpmExecutionErrorList",} 1.0
kie_server_data_set_registered_total{name="processesMonitoring::CUSTOM",uuid="processesMonitoring",} 1.0
kie_server_data_set_registered_total{name="jbpmHumanTasksWithAdmin::FILTERED_BA_TASK",uuid="jbpmHumanTasksWithAdmin",} 1.0
# HELP kie_server_execution_error_total Kie Server Execution Errors
# TYPE kie_server_execution_error_total counter
# HELP kie_server_task_completed_total Kie Server Completed Tasks
# TYPE kie_server_task_completed_total counter
# HELP kie_server_container_running_total Kie Server Running Containers
# TYPE kie_server_container_running_total gauge
kie_server_container_running_total{container_id="itorders_1.0.0-SNAPSHOT",} 1.0
# HELP kie_server_job_cancelled_total Kie Server Cancelled Jobs
# TYPE kie_server_job_cancelled_total counter
# HELP kie_server_process_instance_started_total Kie Server Started Process Instances
# TYPE kie_server_process_instance_started_total counter
kie_server_process_instance_started_total{container_id="itorders_1.0.0-SNAPSHOT",process_id="itorders.orderhardware",} 1.0
# HELP solver_duration_seconds Time in seconds it took solver to solve the constraint problem
# TYPE solver_duration_seconds summary
# HELP kie_server_task_skipped_total Kie Server Skipped Tasks
# TYPE kie_server_task_skipped_total counter
# HELP kie_server_data_set_execution_time_seconds Kie Server Data Set Execution Time
# TYPE kie_server_data_set_execution_time_seconds summary
kie_server_data_set_execution_time_seconds_count{uuid="jbpmProcessInstances",} 8.0
kie_server_data_set_execution_time_seconds_sum{uuid="jbpmProcessInstances",} 0.05600000000000001
# HELP kie_server_job_scheduled_total Kie Server Started Jobs
# TYPE kie_server_job_scheduled_total counter
# HELP kie_server_data_set_execution_total Kie Server Data Set Execution
# TYPE kie_server_data_set_execution_total counter
kie_server_data_set_execution_total{uuid="jbpmProcessInstances",} 8.0
# HELP kie_server_process_instance_completed_total Kie Server Completed Process Instances
# TYPE kie_server_process_instance_completed_total counter
# HELP kie_server_job_running_total Kie Server Running Jobs
# TYPE kie_server_job_running_total gauge
# HELP kie_server_task_failed_total Kie Server Failed Tasks
# TYPE kie_server_task_failed_total counter
# HELP kie_server_task_exited_total Kie Server Exited Tasks
# TYPE kie_server_task_exited_total counter
# HELP dmn_evaluate_decision_nanosecond DMN Evaluation Time
# TYPE dmn_evaluate_decision_nanosecond histogram
# HELP kie_server_data_set_lookups_total Kie Server Data Set Running Lookups
# TYPE kie_server_data_set_lookups_total gauge
kie_server_data_set_lookups_total{uuid="jbpmProcessInstances",} 0.0
# HELP kie_server_process_instance_duration_seconds Kie Server Process Instances Duration
# TYPE kie_server_process_instance_duration_seconds summary
# HELP kie_server_case_duration_seconds Kie Server Case Duration
# TYPE kie_server_case_duration_seconds summary
# HELP dmn_evaluate_failed_count DMN Evaluation Failed
# TYPE dmn_evaluate_failed_count counter
# HELP kie_server_task_added_total Kie Server Added Tasks
# TYPE kie_server_task_added_total counter
kie_server_task_added_total{deployment_id="itorders_1.0.0-SNAPSHOT",process_id="itorders.orderhardware",task_name="Prepare hardware spec",} 1.0
# HELP drl_match_fired_nanosecond Drools Firing Time
# TYPE drl_match_fired_nanosecond histogram
# HELP kie_server_container_started_total Kie Server Started Containers
# TYPE kie_server_container_started_total counter
kie_server_container_started_total{container_id="itorders_1.0.0-SNAPSHOT",} 1.0
# HELP kie_server_process_instance_sla_violated_total Kie Server Process Instances SLA Violated
# TYPE kie_server_process_instance_sla_violated_total counter
# HELP kie_server_task_duration_seconds Kie Server Task Duration
# TYPE kie_server_task_duration_seconds summary
# HELP kie_server_job_executed_total Kie Server Executed Jobs
# TYPE kie_server_job_executed_total counter
# HELP kie_server_deployments_active_total Kie Server Active Deployments
# TYPE kie_server_deployments_active_total gauge
kie_server_deployments_active_total{deployment_id="itorders_1.0.0-SNAPSHOT",} 1.0
# HELP kie_server_process_instance_running_total Kie Server Running Process Instances
# TYPE kie_server_process_instance_running_total gauge
kie_server_process_instance_running_total{container_id="itorders_1.0.0-SNAPSHOT",process_id="itorders.orderhardware",} 2.0
# HELP solvers_running Number of solvers currently running
# TYPE solvers_running gauge
solvers_running 0.0
# HELP kie_server_work_item_duration_seconds Kie Server Work Items Duration
# TYPE kie_server_work_item_duration_seconds summary
# HELP kie_server_job_duration_seconds Kie Server Job Duration
# TYPE kie_server_job_duration_seconds summary
# HELP solver_score_calculation_speed Number of moves per second for a particular solver solving the constraint problem
# TYPE solver_score_calculation_speed summary
# HELP kie_server_start_time Kie Server Start Time
# TYPE kie_server_start_time gauge
kie_server_start_time{name="sample-server",server_id="sample-server",location="http://localhost:8080/kie-server/services/rest/server",version="7.49.0-SNAPSHOT",} 1.557285486469E12</screen>
</para>
</formalpara>
<simpara>If the metrics are not available in KIE Server, review and verify the KIE Server and Prometheus configurations described in this section.</simpara>
<simpara>You can also interact with your collected metrics in the Prometheus expression browser at <literal>http://HOST:PORT/graph</literal>, or integrate your Prometheus data source with a data-graphing tool such as Grafana:</simpara>
<figure>
<title>Prometheus expression browser with KIE Server metrics</title>
<mediaobject>
<imageobject>
<imagedata fileref="images/_images/KieServer/prometheus-expression-browser-data.png"/>
</imageobject>
<textobject><phrase>prometheus expression browser data</phrase></textobject>
</mediaobject>
</figure>
<figure>
<title>Prometheus expression browser with KIE Server target</title>
<mediaobject>
<imageobject>
<imagedata fileref="images/_images/KieServer/prometheus-expression-browser-targets.png"/>
</imageobject>
<textobject><phrase>prometheus expression browser targets</phrase></textobject>
</mediaobject>
</figure>
<figure>
<title>Grafana dashboard with KIE Server metrics for DMN models</title>
<mediaobject>
<imageobject>
<imagedata fileref="images/_images/KieServer/prometheus-grafana-data-dmn.png"/>
</imageobject>
<textobject><phrase>prometheus grafana data dmn</phrase></textobject>
</mediaobject>
</figure>
<figure>
<title>Grafana dashboard with KIE Server metrics for solvers</title>
<mediaobject>
<imageobject>
<imagedata fileref="images/_images/KieServer/prometheus-grafana-data-optimizer.png"/>
</imageobject>
<textobject><phrase>prometheus grafana data optimizer</phrase></textobject>
</mediaobject>
</figure>
<figure>
<title>Grafana dashboard with KIE Server metrics for processes, cases, and tasks</title>
<mediaobject>
<imageobject>
<imagedata fileref="images/_images/KieServer/prometheus-grafana-data-jbpm.png"/>
</imageobject>
<textobject><phrase>prometheus grafana data jbpm</phrase></textobject>
</mediaobject>
</figure>
</listitem>
</orderedlist>
<itemizedlist>
<title>Additional resources</title>
<listitem>
<simpara><link xlink:href="https://prometheus.io/docs/prometheus/latest/getting_started/">Getting Started with Prometheus</link></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://prometheus.io/docs/visualization/grafana/">Grafana Support for Prometheus</link></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://grafana.com/docs/features/datasources/prometheus/">Using Prometheus in Grafana</link></simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="prometheus-monitoring-ocp-proc_execution-server">
<title>Configuring Prometheus metrics monitoring for KIE Server on Red Hat OpenShift Container Platform</title>
<simpara>You can configure your KIE Server deployment on Red Hat OpenShift Container Platform to use Prometheus to collect and store metrics related to your business asset activity in Red Hat Process Automation Manager. For the list of available metrics that KIE Server exposes with Prometheus,
download the <emphasis role="strong">Red Hat Process Automation Manager 7.10.0 Source Distribution</emphasis> from the <link xlink:href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Red Hat Customer Portal</link> and navigate to <literal>~/rhpam-7.10.0-sources/src/droolsjbpm-integration-$VERSION/kie-server-parent/kie-server-services/kie-server-services-prometheus/src/main/java/org/kie/server/services/prometheus</literal>.</simpara>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>KIE Server is installed and deployed on Red Hat OpenShift Container Platform. For more information about KIE Server on OpenShift, see the relevant OpenShift deployment option in the <link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/">Product documentation for Red Hat Process Automation Manager 7.10</link>.</simpara>
</listitem>
<listitem>
<simpara>You have <literal>kie-server</literal> user role access to KIE Server.</simpara>
</listitem>
<listitem>
<simpara>Prometheus Operator is installed. For information about downloading and using Prometheus Operator, see the <link xlink:href="https://github.com/coreos/prometheus-operator">Prometheus Operator</link> project in GitHub.</simpara>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In the <literal>DeploymentConfig</literal> object of your KIE Server deployment on OpenShift, set the <literal>PROMETHEUS_SERVER_EXT_DISABLED</literal> environment variable to <literal>false</literal> to enable the Prometheus extension. You can set this variable in the OpenShift web console or use the <literal>oc</literal> command in a command terminal:</simpara>
<screen>oc set env dc/&lt;dc_name&gt; PROMETHEUS_SERVER_EXT_DISABLED=false -n &lt;namespace&gt;</screen>
<simpara>If you have not yet deployed your KIE Server on OpenShift, then in the OpenShift template that you plan to use for your OpenShift deployment (for example, <literal>rhpam710-prod-immutable-kieserver.yaml</literal>), you can set the <literal>PROMETHEUS_SERVER_EXT_DISABLED</literal> template parameter to <literal>false</literal> to enable the Prometheus extension.</simpara>
<simpara>If you are using the OpenShift Operator to deploy KIE Server on OpenShift, then in your KIE Server configuration, set the <literal>PROMETHEUS_SERVER_EXT_DISABLED</literal> environment variable to <literal>false</literal> to enable the Prometheus extension:</simpara>
<programlisting language="yaml" linenumbering="unnumbered">apiVersion: app.kiegroup.org/v1
kind: KieApp
metadata:
  name: enable-prometheus
spec:
  environment: rhpam-trial
  objects:
    servers:
    - env:
      - name: PROMETHEUS_SERVER_EXT_DISABLED
        value: "false"</programlisting>
</listitem>
<listitem>
<simpara>Create a <literal>service-metrics.yaml</literal> file to add a service that exposes the metrics from KIE Server to Prometheus:</simpara>
<programlisting language="yaml" linenumbering="unnumbered">apiVersion: v1
kind: Service
metadata:
  annotations:
    description: RHPAM Prometheus metrics exposed
  labels:
    app: myapp-kieserver
    application: myapp-kieserver
    template: myapp-kieserver
    metrics: rhpam
  name: rhpam-app-metrics
spec:
  ports:
    - name: web
      port: 8080
      protocol: TCP
      targetPort: 8080
  selector:
    deploymentConfig: myapp-kieserver
  sessionAffinity: None
  type: ClusterIP</programlisting>
</listitem>
<listitem>
<simpara>In a command terminal, use the <literal>oc</literal> command to apply the <literal>service-metrics.yaml</literal> file to your OpenShift deployment:</simpara>
<programlisting language="yaml" linenumbering="unnumbered">oc apply -f service-metrics.yaml</programlisting>
</listitem>
<listitem>
<simpara>Create an OpenShift secret, such as <literal>metrics-secret</literal>, to access the Prometheus metrics on KIE Server. The secret must contain the "username" and "password" elements with KIE Server user credentials. For information about OpenShift secrets, see the <link xlink:href="https://access.redhat.com/documentation/en-us/openshift_container_platform/3.11/html/developer_guide/dev-guide-secrets">Secrets</link> chapter in the OpenShift <emphasis>Developer Guide</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Create a <literal>service-monitor.yaml</literal> file that defines the <literal>ServiceMonitor</literal> object. A service monitor enables Prometheus to connect to the KIE Server metrics service.</simpara>
<programlisting language="yaml" linenumbering="unnumbered">apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: rhpam-service-monitor
  labels:
    team: frontend
spec:
  selector:
    matchLabels:
      metrics: rhpam
  endpoints:
    - port: web
      path: /services/rest/metrics
      basicAuth:
        password:
          name: metrics-secret
          key: password
        username:
          name: metrics-secret
          key: username</programlisting>
</listitem>
<listitem>
<simpara>In a command terminal, use the <literal>oc</literal> command to apply the <literal>service-monitor.yaml</literal> file to your OpenShift deployment:</simpara>
<programlisting language="yaml" linenumbering="unnumbered">oc apply -f service-monitor.yaml</programlisting>
<simpara>After you complete these configurations, Prometheus begins collecting metrics and KIE Server publishes the metrics to the REST API endpoint <literal>http://HOST:PORT/kie-server/services/rest/metrics</literal>.</simpara>
<simpara>You can interact with your collected metrics in the Prometheus expression browser at <literal>http://HOST:PORT/graph</literal>, or integrate your Prometheus data source with a data-graphing tool such as Grafana.</simpara>
<simpara>The host and port for the Prometheus expression browser location <literal>http://HOST:PORT/graph</literal> was defined in the route where you exposed the Prometheus web console when you installed the Prometheus Operator. For information about OpenShift routes, see the <link xlink:href="https://access.redhat.com/documentation/en-us/openshift_container_platform/3.11/html/architecture/networking#architecture-core-concepts-routes">Routes</link> chapter in the OpenShift <emphasis>Architecture</emphasis> documentation.</simpara>
<figure>
<title>Prometheus expression browser with KIE Server metrics</title>
<mediaobject>
<imageobject>
<imagedata fileref="images/_images/KieServer/prometheus-expression-browser-data.png"/>
</imageobject>
<textobject><phrase>prometheus expression browser data</phrase></textobject>
</mediaobject>
</figure>
<figure>
<title>Prometheus expression browser with KIE Server target</title>
<mediaobject>
<imageobject>
<imagedata fileref="images/_images/KieServer/prometheus-expression-browser-targets-ocp.png"/>
</imageobject>
<textobject><phrase>prometheus expression browser targets ocp</phrase></textobject>
</mediaobject>
</figure>
<figure>
<title>Grafana dashboard with KIE Server metrics for DMN models</title>
<mediaobject>
<imageobject>
<imagedata fileref="images/_images/KieServer/prometheus-grafana-data-dmn.png"/>
</imageobject>
<textobject><phrase>prometheus grafana data dmn</phrase></textobject>
</mediaobject>
</figure>
<figure>
<title>Grafana dashboard with KIE Server metrics for solvers</title>
<mediaobject>
<imageobject>
<imagedata fileref="images/_images/KieServer/prometheus-grafana-data-optimizer.png"/>
</imageobject>
<textobject><phrase>prometheus grafana data optimizer</phrase></textobject>
</mediaobject>
</figure>
<figure>
<title>Grafana dashboard with KIE Server metrics for processes, cases, and tasks</title>
<mediaobject>
<imageobject>
<imagedata fileref="images/_images/KieServer/prometheus-grafana-data-jbpm.png"/>
</imageobject>
<textobject><phrase>prometheus grafana data jbpm</phrase></textobject>
</mediaobject>
</figure>
</listitem>
</orderedlist>
<itemizedlist>
<title>Additional resources</title>
<listitem>
<simpara><link xlink:href="https://github.com/coreos/prometheus-operator">Prometheus Operator</link></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://github.com/coreos/prometheus-operator/blob/master/Documentation/user-guides/getting-started.md">Getting started with the Prometheus Operator</link></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://github.com/coreos/prometheus-operator/blob/master/Documentation/rbac.md">Prometheus RBAC</link></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://prometheus.io/docs/visualization/grafana/">Grafana Support for Prometheus</link></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://grafana.com/docs/features/datasources/prometheus/">Using Prometheus in Grafana</link></simpara>
</listitem>
<listitem>
<simpara>OpenShift deployment options in <link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/">Product documentation for Red Hat Process Automation Manager 7.10</link></simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="prometheus-monitoring-custom-proc_execution-server">
<title>Extending Prometheus metrics monitoring in KIE Server with custom metrics</title>
<simpara>After you configure your KIE Server instance to use Prometheus metrics monitoring, you can extend the Prometheus functionality in KIE Server to use custom metrics according to your business needs. Prometheus then collects and stores your custom metrics along with the default metrics that KIE Server exposes with Prometheus.</simpara>
<simpara>As an example, this procedure defines custom Decision Model and Notation (DMN) metrics to be collected and stored by Prometheus.</simpara>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>Prometheus metrics monitoring is configured for your KIE Server instance. For information about Prometheus configuration with KIE Server on-premise, see
<xref linkend="prometheus-monitoring-proc_execution-server"/>. For information about Prometheus configuration with KIE Server on Red Hat OpenShift Container Platform, see <xref linkend="prometheus-monitoring-ocp-proc_execution-server"/>.</simpara>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>Create an empty Maven project and define the following packaging type and dependencies in the <literal>pom.xml</literal> file for the project:</simpara>
<formalpara>
<title>Example pom.xml file in the sample project</title>
<para>
<programlisting language="xml" linenumbering="unnumbered">&lt;packaging&gt;jar&lt;/packaging&gt;

&lt;properties&gt;
  &lt;version.org.kie&gt;7.48.0.Final-redhat-00002&lt;/version.org.kie&gt;
&lt;/properties&gt;

&lt;dependencies&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.kie&lt;/groupId&gt;
    &lt;artifactId&gt;kie-api&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.kie.server&lt;/groupId&gt;
    &lt;artifactId&gt;kie-server-api&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.kie.server&lt;/groupId&gt;
    &lt;artifactId&gt;kie-server-services-common&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.kie.server&lt;/groupId&gt;
    &lt;artifactId&gt;kie-server-services-drools&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.kie.server&lt;/groupId&gt;
    &lt;artifactId&gt;kie-server-services-prometheus&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.kie&lt;/groupId&gt;
    &lt;artifactId&gt;kie-dmn-api&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.kie&lt;/groupId&gt;
    &lt;artifactId&gt;kie-dmn-core&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.jbpm&lt;/groupId&gt;
    &lt;artifactId&gt;jbpm-services-api&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.jbpm&lt;/groupId&gt;
    &lt;artifactId&gt;jbpm-executor&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.optaplanner&lt;/groupId&gt;
    &lt;artifactId&gt;optaplanner-core&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;io.prometheus&lt;/groupId&gt;
    &lt;artifactId&gt;simpleclient&lt;/artifactId&gt;
    &lt;version&gt;0.5.0&lt;/version&gt;
  &lt;/dependency&gt;
&lt;/dependencies&gt;</programlisting>
</para>
</formalpara>
</listitem>
<listitem>
<simpara>Implement the relevant listener from the <literal>org.kie.server.services.prometheus.PrometheusMetricsProvider</literal> interface as part of the custom listener class that defines your custom Prometheus metrics, as shown in the following example:</simpara>
<formalpara>
<title>Sample implementation of the <literal>DMNRuntimeEventListener</literal> listener in a custom listener class</title>
<para>
<programlisting language="java" linenumbering="unnumbered">package org.kie.server.ext.prometheus;

import io.prometheus.client.Gauge;
import org.kie.dmn.api.core.ast.DecisionNode;
import org.kie.dmn.api.core.event.AfterEvaluateBKMEvent;
import org.kie.dmn.api.core.event.AfterEvaluateContextEntryEvent;
import org.kie.dmn.api.core.event.AfterEvaluateDecisionEvent;
import org.kie.dmn.api.core.event.AfterEvaluateDecisionServiceEvent;
import org.kie.dmn.api.core.event.AfterEvaluateDecisionTableEvent;
import org.kie.dmn.api.core.event.BeforeEvaluateBKMEvent;
import org.kie.dmn.api.core.event.BeforeEvaluateContextEntryEvent;
import org.kie.dmn.api.core.event.BeforeEvaluateDecisionEvent;
import org.kie.dmn.api.core.event.BeforeEvaluateDecisionServiceEvent;
import org.kie.dmn.api.core.event.BeforeEvaluateDecisionTableEvent;
import org.kie.dmn.api.core.event.DMNRuntimeEventListener;
import org.kie.server.api.model.ReleaseId;
import org.kie.server.services.api.KieContainerInstance;

public class ExampleCustomPrometheusMetricListener implements DMNRuntimeEventListener {

    private final KieContainerInstance kieContainer;

    private final Gauge randomGauge = Gauge.build()
            .name("random_gauge_nanosecond")
            .help("Random gauge as an example of custom KIE Prometheus metric")
            .labelNames("container_id", "group_id", "artifact_id", "version", "decision_namespace", "decision_name")
            .register();

    public ExampleCustomPrometheusMetricListener(KieContainerInstance containerInstance) {
        kieContainer = containerInstance;
    }

    public void beforeEvaluateDecision(BeforeEvaluateDecisionEvent e) {
    }

    public void afterEvaluateDecision(AfterEvaluateDecisionEvent e) {
        DecisionNode decisionNode = e.getDecision();
        ReleaseId releaseId = kieContainer.getResource().getReleaseId();
        randomGauge.labels(kieContainer.getContainerId(), releaseId.getGroupId(),
                           releaseId.getArtifactId(), releaseId.getVersion(),
                           decisionNode.getModelName(), decisionNode.getModelNamespace())
                .set((int) (Math.random() * 100));
    }

    public void beforeEvaluateBKM(BeforeEvaluateBKMEvent event) {
    }

    public void afterEvaluateBKM(AfterEvaluateBKMEvent event) {
    }

    public void beforeEvaluateContextEntry(BeforeEvaluateContextEntryEvent event) {
    }

    public void afterEvaluateContextEntry(AfterEvaluateContextEntryEvent event) {
    }

    public void beforeEvaluateDecisionTable(BeforeEvaluateDecisionTableEvent event) {
    }

    public void afterEvaluateDecisionTable(AfterEvaluateDecisionTableEvent event) {
    }

    public void beforeEvaluateDecisionService(BeforeEvaluateDecisionServiceEvent event) {
    }

    public void afterEvaluateDecisionService(AfterEvaluateDecisionServiceEvent event) {
    }
}</programlisting>
</para>
</formalpara>
<simpara>The <literal>PrometheusMetricsProvider</literal> interface contains the required listeners for collecting Prometheus metrics. The interface is incorporated by the <literal>kie-server-services-prometheus</literal> dependency that you declared in your project <literal>pom.xml</literal> file.</simpara>
<simpara>In this example, the <literal>ExampleCustomPrometheusMetricListener</literal> class implements the <literal>DMNRuntimeEventListener</literal> listener (from the <literal>PrometheusMetricsProvider</literal> interface) and defines the custom DMN metrics to be collected and stored by Prometheus.</simpara>
</listitem>
<listitem>
<simpara>Implement the <literal>PrometheusMetricsProvider</literal> interface as part of a custom metrics provider class that associates your custom listener with the <literal>PrometheusMetricsProvider</literal> interface, as shown in the following example:</simpara>
<formalpara>
<title>Sample implementation of the <literal>PrometheusMetricsProvider</literal> interface in a custom metrics provider class</title>
<para>
<programlisting language="java" linenumbering="unnumbered">package org.kie.server.ext.prometheus;

import org.jbpm.executor.AsynchronousJobListener;
import org.jbpm.services.api.DeploymentEventListener;
import org.kie.api.event.rule.AgendaEventListener;
import org.kie.api.event.rule.DefaultAgendaEventListener;
import org.kie.dmn.api.core.event.DMNRuntimeEventListener;
import org.kie.server.services.api.KieContainerInstance;
import org.kie.server.services.prometheus.PrometheusMetricsProvider;
import org.optaplanner.core.impl.phase.event.PhaseLifecycleListener;
import org.optaplanner.core.impl.phase.event.PhaseLifecycleListenerAdapter;

public class MyPrometheusMetricsProvider implements PrometheusMetricsProvider {

    public DMNRuntimeEventListener createDMNRuntimeEventListener(KieContainerInstance kContainer) {
        return new ExampleCustomPrometheusMetricListener(kContainer);
    }

    public AgendaEventListener createAgendaEventListener(String kieSessionId, KieContainerInstance kContainer) {
        return new DefaultAgendaEventListener();
    }

    public PhaseLifecycleListener createPhaseLifecycleListener(String solverId) {
        return new PhaseLifecycleListenerAdapter() {
        };
    }

    public AsynchronousJobListener createAsynchronousJobListener() {
        return null;
    }

    public DeploymentEventListener createDeploymentEventListener() {
        return null;
    }
}</programlisting>
</para>
</formalpara>
<simpara>In this example, the <literal>MyPrometheusMetricsProvider</literal> class implements the <literal>PrometheusMetricsProvider</literal> interface and includes your custom <literal>ExampleCustomPrometheusMetricListener</literal> listener class.</simpara>
</listitem>
<listitem>
<simpara>To make the new metrics provider discoverable for KIE Server, create a <literal>META-INF/services/org.kie.server.services.prometheus.PrometheusMetricsProvider</literal> file in your Maven project and add the fully qualified class name of the <literal>PrometheusMetricsProvider</literal> implementation class within the file. For this example, the file contains the single line <literal>org.kie.server.ext.prometheus.MyPrometheusMetricsProvider</literal>.</simpara>
</listitem>
<listitem>
<simpara>Build your project and copy the resulting JAR file into the <literal>~/kie-server.war/WEB-INF/lib</literal> directory of your project.
For example, on Red Hat JBoss EAP, the path to this directory is <literal><emphasis>EAP_HOME</emphasis>/standalone/deployments/kie-server.war/WEB-INF/lib</literal>.</simpara>
</listitem>
<listitem>
<simpara>Start the KIE Server and deploy the built project to the running KIE Server. You can deploy the project using the Business Central interface or the KIE Server REST API (a <literal>PUT</literal> request to <literal>http://SERVER:PORT/kie-server/services/rest/server/containers/{containerId}</literal>).</simpara>
<simpara>After your project is deployed on a running KIE Server, Prometheus begins collecting metrics and KIE Server publishes the metrics to the REST API endpoint <literal>http://HOST:PORT/SERVER/services/rest/metrics</literal> (or on Spring Boot, to <literal>http://HOST:PORT/rest/metrics</literal>).</simpara>
</listitem>
</orderedlist>
</section>
</chapter>
<chapter xml:id="configuring-openshift-connection-timeout-proc">
<title>Configuring OpenShift connection timeout</title>
<simpara>By default, the OpenShift route is configured to time out HTTP requests that are longer than 30 seconds. This may cause session timeout issues in Business Central resulting in the following behaviors:</simpara>
<itemizedlist>
<listitem>
<simpara>"Unable to complete your request. The following exception occurred: (TypeError) : Cannot read property 'indexOf' of null."</simpara>
</listitem>
<listitem>
<simpara>"Unable to complete your request. The following exception occurred: (TypeError) : b is null."</simpara>
</listitem>
<listitem>
<simpara>A blank page is displayed when clicking the <emphasis role="strong">Project</emphasis> or <emphasis role="strong">Server</emphasis> links in Business Central.</simpara>
</listitem>
</itemizedlist>
<simpara>All Business Central templates already include extended timeout configuration.</simpara>
<simpara>To configure longer timeout on Business Central OpenShift routes, add the <literal>haproxy.router.openshift.io/timeout: 60s</literal> annotation on the target route:</simpara>
<programlisting language="yaml" linenumbering="unnumbered">  - kind: Route
    apiVersion: v1
    id: "$APPLICATION_NAME-rhpamcentr-http"
    metadata:
      name: "$APPLICATION_NAME-rhpamcentr"
      labels:
        application: "$APPLICATION_NAME"
      annotations:
        description: Route for Business Central's http service.
        haproxy.router.openshift.io/timeout: 60s
    spec:
      host: "$BUSINESS_CENTRAL_HOSTNAME_HTTP"
      to:
        name: "$APPLICATION_NAME-rhpamcentr"</programlisting>
<simpara>For a full list of global route-specific timeout annotations, see the <link xlink:href="https://docs.openshift.com/container-platform/3.3/architecture/core_concepts/routes.html#route-specific-timeouts">OpenShift Documentation</link>.</simpara>
</chapter>
<chapter xml:id="persistence-con">
<title>Persistence</title>
<simpara>Binary persistence, or marshaling, converts the state of the process instance into a binary data set. Binary persistence is a mechanism used to store and retrieve information persistently. The same mechanism is also applied to the session state and work item states.</simpara>
<simpara>When you enable persistence of a process instance:</simpara>
<itemizedlist>
<listitem>
<simpara>Red Hat Process Automation Manager transforms the process instance information into binary data. Custom serialization is used instead of Java serialization for performance reasons.</simpara>
</listitem>
<listitem>
<simpara>The binary data is stored together with other process instance metadata, such as process instance ID, process ID, and the process start date.</simpara>
</listitem>
</itemizedlist>
<simpara>The session can also store other forms of state, such as the state of timer jobs, or data required for business rules evaluation. Session state is stored separately as a binary data set along with the ID of the session and metadata. You can restore the session state by reloading a session with given ID. Use <literal>ksession.getId()</literal> to get the session ID.</simpara>
<simpara>Red Hat Process Automation Manager will persist the following when persistence is configured:</simpara>
<itemizedlist>
<listitem>
<simpara><emphasis>Session state</emphasis>: This includes the session ID, date of last modification, the session data that business rules would need for evaluation, state of timer jobs.</simpara>
</listitem>
<listitem>
<simpara><emphasis>Process instance state</emphasis>: This includes the process instance ID, process ID, date of last modification, date of last read access, process instance start date, runtime data (the execution status including the node being executed, variable values, and other process instance data) and the event types.</simpara>
</listitem>
<listitem>
<simpara><emphasis>Work item runtime state</emphasis>: This includes the work item ID, creation date, name, process instance ID, and the work item state itself.</simpara>
</listitem>
</itemizedlist>
<simpara>Based on the persisted data, you can restore the state of execution of all running process instances in case of failure or to temporarily remove running instances from memory and restore them later.</simpara>
<section xml:id="safe-points-configuring-proc">
<title>Configuring safe points</title>
<simpara>To allow persistence, add the <literal>jbpm-persistence</literal> JAR files to the classpath of your application and configure the process engine to use persistence. The process engine automatically stores the runtime state in the storage when the process engine reaches a safe point.</simpara>
<simpara>Safe points are points where the process instance has paused. When a process instance invocation reaches a safe point in the process engine, the process engine stores any changes to the process instance as a snapshot of the process runtime data. However, when a process instance is completed, the persisted snapshot of process instance runtime data is automatically deleted.</simpara>
<simpara>BPMN2 safe point nodes ensure that the process engine saves the state of the process definition at the point where the execution stops and the transaction is committed. The following BPMN2 nodes are considered safe points:</simpara>
<itemizedlist>
<listitem>
<simpara>All intermediate CATCH events</simpara>
<itemizedlist>
<listitem>
<simpara>Timer Intermediate event</simpara>
</listitem>
<listitem>
<simpara>Error Intermediate event</simpara>
</listitem>
<listitem>
<simpara>Conditional Intermediate event</simpara>
</listitem>
<listitem>
<simpara>Compensation Intermediate event</simpara>
</listitem>
<listitem>
<simpara>Signal Intermediate event</simpara>
</listitem>
<listitem>
<simpara>Escalation Intermediate event</simpara>
</listitem>
<listitem>
<simpara>Message Intermediate event</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>User tasks</simpara>
</listitem>
<listitem>
<simpara>Custom (defined by the user) service tasks that do not complete the task in the handler</simpara>
</listitem>
</itemizedlist>
<simpara>If a failure occurs and you need to restore the process engine runtime from the storage, the process instances are automatically restored and their execution resumes so there is no need to reload and trigger the process instances manually.</simpara>
<simpara>Consider the runtime persistence data to be internal to the process engine. You should not access persisted runtime data or modify them directly because this might have unexpected side effects.</simpara>
<simpara>For more information about the current execution state, refer to the history log. Query the database for runtime data only if absolutely necessary.</simpara>
</section>
<section xml:id="session-persistence-entities-ref">
<title>Session persistence entities</title>
<simpara>Sessions are persisted as <literal>SessionInfo</literal> entities. These persist the state of the runtime KIE session, and store the following data:</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>SessionInfo</title>
<tgroup cols="3">
<colspec colname="col_1" colwidth="35*"/>
<colspec colname="col_2" colwidth="35*"/>
<colspec colname="col_3" colwidth="30*"/>
<thead>
<row>
<entry align="left" valign="top">Field</entry>
<entry align="left" valign="top">Description</entry>
<entry align="left" valign="top">Nullable</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal>id</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The primary key.</simpara></entry>
<entry align="left" valign="top"><simpara>NOT NULL</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>lastModificationDate</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The last time that entity was saved to a database.</simpara></entry>
<entry align="left" valign="top"/>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>rulesByteArray</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The state of a session.</simpara></entry>
<entry align="left" valign="top"><simpara>NOT NULL</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>startDate</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The session start time.</simpara></entry>
<entry align="left" valign="top"/>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>OPTLOCK</literal></simpara></entry>
<entry align="left" valign="top"><simpara>A version field containing a lock value.</simpara></entry>
<entry align="left" valign="top"/>
</row>
</tbody>
</tgroup>
</table>
</section>
<section xml:id="process-instance-persistence-entities-ref">
<title>Process instance persistence entities</title>
<simpara>Process instances are persisted as <literal>ProcessInstanceInfo</literal> entities, which persist the state of a process instance on runtime and store the following data:</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>ProcessInstanceInfo</title>
<tgroup cols="3">
<colspec colname="col_1" colwidth="35*"/>
<colspec colname="col_2" colwidth="35*"/>
<colspec colname="col_3" colwidth="30*"/>
<thead>
<row>
<entry align="left" valign="top">Field</entry>
<entry align="left" valign="top">Description</entry>
<entry align="left" valign="top">Nullable</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal>instanceId</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The primary key.</simpara></entry>
<entry align="left" valign="top"><simpara>NOT NULL</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>lastModificationDate</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The last time that the entity was saved to a database.</simpara></entry>
<entry align="left" valign="top"/>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>lastReadDate</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The last time that the entity was retrieved from the database.</simpara></entry>
<entry align="left" valign="top"/>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>processId</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The ID of the process.</simpara></entry>
<entry align="left" valign="top"/>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>processInstanceByteArray</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The state of a process instance in form of a binary data set.</simpara></entry>
<entry align="left" valign="top"><simpara>NOT NULL</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>startDate</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The start time of the process.</simpara></entry>
<entry align="left" valign="top"/>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>state</literal></simpara></entry>
<entry align="left" valign="top"><simpara>An integer representing the state of a process instance.</simpara></entry>
<entry align="left" valign="top"><simpara>NOT NULL</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>OPTLOCK</literal></simpara></entry>
<entry align="left" valign="top"><simpara>A version field containing a lock value.</simpara></entry>
<entry align="left" valign="top"/>
</row>
</tbody>
</tgroup>
</table>
<simpara><literal>ProcessInstanceInfo</literal> has a 1:N relationship to the <literal>EventTypes</literal> entity.</simpara>
<simpara>The <literal>EventTypes</literal> entity contains the following data:</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>EventTypes</title>
<tgroup cols="3">
<colspec colname="col_1" colwidth="35*"/>
<colspec colname="col_2" colwidth="35*"/>
<colspec colname="col_3" colwidth="30*"/>
<thead>
<row>
<entry align="left" valign="top">Field</entry>
<entry align="left" valign="top">Description</entry>
<entry align="left" valign="top">Nullable</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal>instanceId</literal></simpara></entry>
<entry align="left" valign="top"><simpara>A reference to the <literal>ProcessInstanceInfo</literal> primary key and foreign key constraint on this column.</simpara></entry>
<entry align="left" valign="top"><simpara>NOT NULL</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>element</literal></simpara></entry>
<entry align="left" valign="top"><simpara>A finished event in the process.</simpara></entry>
<entry align="left" valign="top"/>
</row>
</tbody>
</tgroup>
</table>
</section>
<section xml:id="workitem-entities-ref">
<title>Work item persistence entities</title>
<simpara>Work items are persisted as <literal>workiteminfo</literal> entities, which persist the state of the particular work item instance on runtime and store the following data:</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>WorkItemInfo</title>
<tgroup cols="3">
<colspec colname="col_1" colwidth="35*"/>
<colspec colname="col_2" colwidth="35*"/>
<colspec colname="col_3" colwidth="30*"/>
<thead>
<row>
<entry align="left" valign="top">Field</entry>
<entry align="left" valign="top">Description</entry>
<entry align="left" valign="top">Nullable</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal>workItemId</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The primary key.</simpara></entry>
<entry align="left" valign="top"><simpara>NOT NULL</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>name</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The name of the work item.</simpara></entry>
<entry align="left" valign="top"/>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>processInstanceId</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The (primary key) ID of the process. There is no foreign key constraint on this field.</simpara></entry>
<entry align="left" valign="top"><simpara>NOT NULL</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>state</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The state of a work item.</simpara></entry>
<entry align="left" valign="top"><simpara>NOT NULL</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>OPTLOCK</literal></simpara></entry>
<entry align="left" valign="top"><simpara>A version field containing a lock value.</simpara></entry>
<entry align="left" valign="top"/>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>workitembytearay</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The work item state in as a binary data set.</simpara></entry>
<entry align="left" valign="top"><simpara>NOT NULL</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
</section>
<section xml:id="correlationkey-entities-ref">
<title>Correlation key entities</title>
<simpara>The <literal>CorrelationKeyInfo</literal> entity contains information about the correlation key assigned to the given process instance. This table is optional. Use it only when you require correlation capabilities.</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>CorrelationKeyInfo</title>
<tgroup cols="3">
<colspec colname="col_1" colwidth="35*"/>
<colspec colname="col_2" colwidth="35*"/>
<colspec colname="col_3" colwidth="30*"/>
<thead>
<row>
<entry align="left" valign="top">Field</entry>
<entry align="left" valign="top">Description</entry>
<entry align="left" valign="top">Nullable</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal>keyId</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The primary key.</simpara></entry>
<entry align="left" valign="top"><simpara>NOT NULL</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>name</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The assigned name of the correlation key.</simpara></entry>
<entry align="left" valign="top"/>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>processInstanceId</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The ID of the process instance which is assigned to the correlation key.</simpara></entry>
<entry align="left" valign="top"><simpara>NOT NULL</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>OPTLOCK</literal></simpara></entry>
<entry align="left" valign="top"><simpara>A version field containing a lock value.</simpara></entry>
<entry align="left" valign="top"/>
</row>
</tbody>
</tgroup>
</table>
<simpara>The <literal>CorrelationPropertyInfo</literal> entity contains information about correlation properties for a correlation key assigned the process instance.</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>CorrelationPropertyInfo</title>
<tgroup cols="3">
<colspec colname="col_1" colwidth="35*"/>
<colspec colname="col_2" colwidth="35*"/>
<colspec colname="col_3" colwidth="30*"/>
<thead>
<row>
<entry align="left" valign="top">Field</entry>
<entry align="left" valign="top">Description</entry>
<entry align="left" valign="top">Nullable</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal>propertyId</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The primary key.</simpara></entry>
<entry align="left" valign="top"><simpara>NOT NULL</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>name</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The name of the property.</simpara></entry>
<entry align="left" valign="top"/>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>value</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The value of the property.</simpara></entry>
<entry align="left" valign="top"><simpara>NOT NULL</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>OPTLOCK</literal></simpara></entry>
<entry align="left" valign="top"><simpara>A version field containing a lock value.</simpara></entry>
<entry align="left" valign="top"/>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>correlationKey_keyId</literal></simpara></entry>
<entry align="left" valign="top"><simpara>A foreign key mapped to the correlation key.</simpara></entry>
<entry align="left" valign="top"><simpara>NOT NULL</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
</section>
<section xml:id="contextmapping-entities-ref">
<title>Context mapping entity</title>
<simpara>The <literal>ContextMappingInfo</literal> entity contains information about the contextual information mapped to a <literal>KieSession</literal>. This is an internal part of <literal>RuntimeManager</literal> and can be considered optional when <literal>RuntimeManager</literal> is not used.</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>ContextMappingInfo</title>
<tgroup cols="3">
<colspec colname="col_1" colwidth="35*"/>
<colspec colname="col_2" colwidth="35*"/>
<colspec colname="col_3" colwidth="30*"/>
<thead>
<row>
<entry align="left" valign="top">Field</entry>
<entry align="left" valign="top">Description</entry>
<entry align="left" valign="top">Nullable</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal>mappingId</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The primary key.</simpara></entry>
<entry align="left" valign="top"><simpara>NOT NULL</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>CONTEXT_ID</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The context identifier.</simpara></entry>
<entry align="left" valign="top"><simpara>NOT NULL</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>KSESSION_ID</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The <literal>KieSession</literal> identifier.</simpara></entry>
<entry align="left" valign="top"><simpara>NOT NULL</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>OPTLOCK</literal></simpara></entry>
<entry align="left" valign="top"><simpara>A version field containing a lock value.</simpara></entry>
<entry align="left" valign="top"/>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>OWNER_ID</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Holds the identifier of the deployment unit that the given mapping is associated with</simpara></entry>
<entry align="left" valign="top"/>
</row>
</tbody>
</tgroup>
</table>
</section>
<section xml:id="pessimistic-locking-proc">
<title>Pessimistic Locking Support</title>
<simpara>The default locking mechanism for persistence of processes is <emphasis>optimistic</emphasis>. With multi-thread high concurrency to the same process instance, this locking strategy can result in bad performance.</simpara>
<simpara>This can be changed at runtime to allow the user to set locking on a per process basis and to allow it to be <emphasis>pessimistic</emphasis> (the change can be made at a per KIE Session level or Runtime Manager level as well and not just at the process level).</simpara>
<simpara>To set a process to use pessimistic locking, use the following configuration in the runtime environment:</simpara>
<screen>import org.kie.api.runtime.Environment;
import org.kie.api.runtime.EnvironmentName;
import org.kie.api.runtime.manager.RuntimeManager;
import org.kie.api.runtime.manager.RuntimeManagerFactory;

...

env.set(EnvironmentName.USE_PESSIMISTIC_LOCKING, true);  <co xml:id="CO2-1"/>

RuntimeManager manager = RuntimeManagerFactory.Factory.get().newPerRequestRuntimeManager(environment);  <co xml:id="CO2-2"/></screen>
<calloutlist>
<callout arearefs="CO2-1">
<para><literal>env</literal> is an instance of <literal>org.kie.api.runtime.Environment</literal>.</para>
</callout>
<callout arearefs="CO2-2">
<para>Create your Runtime Manager by using this environment.</para>
</callout>
</calloutlist>
</section>
<section xml:id="process-variables-persist-proc_execution-server">
<title>Persisting process variables in a separate database schema in Red Hat Process Automation Manager</title>
<simpara>When you create process variables to use within the processes that you define, Red Hat Process Automation Manager stores those process variables as binary data in a default database schema. You can persist process variables in a separate database schema for greater flexibility in maintaining and implementing your process data.</simpara>
<simpara>For example, persisting your process variables in a separate database schema can help you perform the following tasks:</simpara>
<itemizedlist>
<listitem>
<simpara>Maintain process variables in human-readable format</simpara>
</listitem>
<listitem>
<simpara>Make the variables available to services outside of Red Hat Process Automation Manager</simpara>
</listitem>
<listitem>
<simpara>Clear the log of the default database tables in Red Hat Process Automation Manager without losing process variable data</simpara>
</listitem>
</itemizedlist>
<note>
<simpara>This procedure applies to process variables only. This procedure does not apply to case variables.</simpara>
</note>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>You have defined processes in Red Hat Process Automation Manager for which you want to implement variables.</simpara>
</listitem>
<listitem>
<simpara>If you want to persist variables in a database schema outside of Red Hat Process Automation Manager, you have created a data source and the separate database schema that you want to use. For information about creating data sources, see
<link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/managing_red_hat_process_automation_manager_and_kie_server_settings#managing-business-central-data-sources-con"><emphasis>Configuring Business Central settings and properties</emphasis></link>.</simpara>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In the data object file that you use as a process variable, add the following elements to configure variable persistence:</simpara>
<formalpara>
<title>Example Person.java object configured for variable persistence</title>
<para>
<programlisting language="java" linenumbering="unnumbered">@javax.persistence.Entity  <co xml:id="CO3-1"/>
@javax.persistence.Table(name = "Person")  <co xml:id="CO3-2"/>
public class Person extends org.drools.persistence.jpa.marshaller.VariableEntity  <co xml:id="CO3-3"/>
implements java.io.Serializable {  <co xml:id="CO3-4"/>

	static final long serialVersionUID = 1L;

	@javax.persistence.GeneratedValue(strategy = javax.persistence.GenerationType.AUTO, generator = "PERSON_ID_GENERATOR")
	@javax.persistence.Id  <co xml:id="CO3-5"/>
	@javax.persistence.SequenceGenerator(name = "PERSON_ID_GENERATOR", sequenceName = "PERSON_ID_SEQ")
	private java.lang.Long id;

	private java.lang.String name;

	private java.lang.Integer age;

	public Person() {
	}

	public java.lang.Long getId() {
		return this.id;
	}

	public void setId(java.lang.Long id) {
		this.id = id;
	}

	public java.lang.String getName() {
		return this.name;
	}

	public void setName(java.lang.String name) {
		this.name = name;
	}

	public java.lang.Integer getAge() {
		return this.age;
	}

	public void setAge(java.lang.Integer age) {
		this.age = age;
	}

	public Person(java.lang.Long id, java.lang.String name,
			java.lang.Integer age) {
		this.id = id;
		this.name = name;
		this.age = age;
	}

}</programlisting>
</para>
</formalpara>
<calloutlist>
<callout arearefs="CO3-1">
<para>Configures the data object as a persistence entity.</para>
</callout>
<callout arearefs="CO3-2">
<para>Defines the database table name used for the data object.</para>
</callout>
<callout arearefs="CO3-3">
<para>Creates a separate <literal>MappedVariable</literal> mapping table that maintains the relationship between this data object and the associated process instance. If you do not need this relationship maintained, you do not need to extend the <literal>VariableEntity</literal> class. Without this extension, the data object is still persisted, but contains no additional data.</para>
</callout>
<callout arearefs="CO3-4">
<para>Configures the data object as a serializable object.</para>
</callout>
<callout arearefs="CO3-5">
<para>Sets a persistence ID for the object.</para>
</callout>
</calloutlist>
<simpara>To make the data object persistable using Business Central, navigate to the data object file in your project, click the <emphasis role="strong">Persistence</emphasis> icon in the upper-right corner of the window, and configure the persistence behavior:</simpara>
<figure>
<title>Persistence configuration in Business Central</title>
<mediaobject>
<imageobject>
<imagedata fileref="images/_images/Persistence/persistence-in-central.png"/>
</imageobject>
<textobject><phrase>persistence in central</phrase></textobject>
</mediaobject>
</figure>
</listitem>
<listitem>
<simpara>In the <literal>pom.xml</literal> file of your project, add the following dependency for persistence support. This dependency contains the <literal>VariableEntity</literal> class that you configured in your data object.</simpara>
<formalpara>
<title>Project dependency for persistence</title>
<para>
<programlisting language="xml" linenumbering="unnumbered">&lt;dependency&gt;
  &lt;groupId&gt;org.drools&lt;/groupId&gt;
  &lt;artifactId&gt;drools-persistence-jpa&lt;/artifactId&gt;
  &lt;version&gt;${rhpam.version}&lt;/version&gt;
  &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;</programlisting>
</para>
</formalpara>
</listitem>
<listitem>
<simpara>In the <literal>~/META-INF/kie-deployment-descriptor.xml</literal> file of your project, configure the JPA marshalling strategy and a persistence unit to be used with the marshaller. The JPA marshalling strategy and persistence unit are required for objects defined as entities.</simpara>
<formalpara>
<title>JPA marshaller and persistence unit configured in the kie-deployment-descriptor.xml file</title>
<para>
<programlisting language="xml" linenumbering="unnumbered">&lt;marshalling-strategy&gt;
  &lt;resolver&gt;mvel&lt;/resolver&gt;
  &lt;identifier&gt;new org.drools.persistence.jpa.marshaller.JPAPlaceholderResolverStrategy("myPersistenceUnit", classLoader)&lt;/identifier&gt;
  &lt;parameters/&gt;
&lt;/marshalling-strategy&gt;</programlisting>
</para>
</formalpara>
</listitem>
<listitem>
<simpara>In the <literal>~/META-INF</literal> directory of your project, create a <literal>persistence.xml</literal> file that specifies in which data source you want to persist the process variable:</simpara>
<formalpara>
<title>Example persistence.xml file with data source configuration</title>
<para>
<programlisting language="xml" linenumbering="unnumbered">&lt;persistence xmlns="http://java.sun.com/xml/ns/persistence" xmlns:orm="http://java.sun.com/xml/ns/persistence/orm" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="2.0" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd http://java.sun.com/xml/ns/persistence/orm http://java.sun.com/xml/ns/persistence/orm_2_0.xsd"&gt;
    &lt;persistence-unit name="myPersistenceUnit" transaction-type="JTA"&gt;
        &lt;provider&gt;org.hibernate.jpa.HibernatePersistenceProvider&lt;/provider&gt;
        &lt;jta-data-source&gt;java:jboss/datasources/ExampleDS&lt;/jta-data-source&gt;  <co xml:id="CO4-1"/>
        &lt;class&gt;org.space.example.Person&lt;/class&gt;
        &lt;exclude-unlisted-classes&gt;true&lt;/exclude-unlisted-classes&gt;
        &lt;properties&gt;
            &lt;property name="hibernate.dialect" value="org.hibernate.dialect.PostgreSQLDialect"/&gt;
            &lt;property name="hibernate.max_fetch_depth" value="3"/&gt;
            &lt;property name="hibernate.hbm2ddl.auto" value="update"/&gt;
            &lt;property name="hibernate.show_sql" value="true"/&gt;
            &lt;property name="hibernate.id.new_generator_mappings" value="false"/&gt;
            &lt;property name="hibernate.transaction.jta.platform" value="org.hibernate.service.jta.platform.internal.JBossAppServerJtaPlatform"/&gt;
        &lt;/properties&gt;
    &lt;/persistence-unit&gt;
&lt;/persistence&gt;</programlisting>
</para>
</formalpara>
<calloutlist>
<callout arearefs="CO4-1">
<para>Sets the data source in which the process variable is persisted</para>
</callout>
</calloutlist>
<simpara>To configure the marshalling strategy, persistence unit, and data source using Business Central, navigate to project <emphasis role="strong">Settings</emphasis> → <emphasis role="strong">Deployments</emphasis> → <emphasis role="strong">Marshalling Strategies</emphasis> and to project <emphasis role="strong">Settings</emphasis> → <emphasis role="strong">Persistence</emphasis>:</simpara>
<figure>
<title>JPA marshaller configuration in Business Central</title>
<mediaobject>
<imageobject>
<imagedata fileref="images/_images/Persistence/jpa-marhsalling-strategy.png"/>
</imageobject>
<textobject><phrase>jpa marhsalling strategy</phrase></textobject>
</mediaobject>
</figure>
<figure>
<title>Persistence unit and data source configuration in Business Central</title>
<mediaobject>
<imageobject>
<imagedata fileref="images/_images/Persistence/persistence-unit.png"/>
</imageobject>
<textobject><phrase>persistence unit</phrase></textobject>
</mediaobject>
</figure>
</listitem>
</orderedlist>
</section>
</chapter>
<chapter xml:id="ldap-login-domain-proc">
<title>Define the LDAP login domain</title>
<simpara>When you are setting up Red Hat Process Automation Manager to use LDAP for authentication and authorization, define the LDAP login domain because the Git SSH authentication may use another security domain.</simpara>
<simpara>To define the LDAP login domain, use the  <literal>org.uberfire.domain</literal> system property. For example, on Red Hat JBoss Enterprise Application Platform, add this property in the <literal>standalone.xml</literal> file as shown:</simpara>
<screen> &lt;system-properties&gt;
   &lt;!-- other system properties --&gt;
   &lt;property name="org.uberfire.domain" value="LDAPAuth"/&gt;
 &lt;/system-properties&gt;</screen>
<simpara>Ensure that the authenticated user has appropriate roles (<literal>admin</literal>,<literal>analyst</literal>,<literal>reviewer</literal>) associated with it in LDAP.</simpara>
</chapter>
<chapter xml:id="sso-third-party-proc_execution-server">
<title>Authenticating third-party clients through RH-SSO</title>
<simpara>To use the different remote services provided by Business Central or by KIE Server, your client, such as curl, wget, web browser, or a custom REST client, must authenticate through the RH-SSO server and have a valid token to perform the requests. To use the remote services, the authenticated user must have the following roles:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>rest-all</literal> for using Business Central remote services.</simpara>
</listitem>
<listitem>
<simpara><literal>kie-server</literal> for using the KIE Server remote services.</simpara>
</listitem>
</itemizedlist>
<simpara>Use the RH-SSO Admin Console to create these roles and assign them to the users that will consume the remote services.</simpara>
<simpara>Your client can authenticate through RH-SSO using one of these options:</simpara>
<itemizedlist>
<listitem>
<simpara>Basic authentication, if it is supported by the client</simpara>
</listitem>
<listitem>
<simpara>Token-based authentication</simpara>
</listitem>
</itemizedlist>
<section xml:id="sso-basic-auth-proc_execution-server">
<title>Basic authentication</title>
<simpara>If you enabled basic authentication in the RH-SSO client adapter configuration for both Business Central and KIE Server, you can avoid the token grant and refresh calls and call the services as shown in the following examples:</simpara>
<itemizedlist>
<listitem>
<simpara>For web based remote repositories endpoint:</simpara>
<screen>curl http://admin:password@localhost:8080/business-central/rest/repositories</screen>
</listitem>
<listitem>
<simpara>For KIE Server:</simpara>
<screen>curl http://admin:password@localhost:8080/kie-server/services/rest/server/</screen>
</listitem>
</itemizedlist>
</section>
</chapter>
<chapter xml:id="kie-server-system-properties-ref_execution-server">
<title>KIE Server system properties</title>
<simpara>The KIE Server accepts the following system properties (bootstrap switches) to configure the behavior of the server:</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>System properties for disabling KIE Server extensions</title>
<tgroup cols="4">
<colspec colname="col_1" colwidth="29*"/>
<colspec colname="col_2" colwidth="14*"/>
<colspec colname="col_3" colwidth="14*"/>
<colspec colname="col_4" colwidth="43*"/>
<thead>
<row>
<entry align="left" valign="top">Property</entry>
<entry align="left" valign="top">Values</entry>
<entry align="left" valign="top">Default</entry>
<entry align="left" valign="top">Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal>org.drools.server.ext.disabled</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>true</literal>, <literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara>If set to <literal>true</literal>, disables the Business Rule Management (BRM) support (for example, rules support).</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.jbpm.server.ext.disabled</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>true</literal>, <literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara>If set to <literal>true</literal>, disables the Red Hat Process Automation Manager support (for example, processes support).</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.jbpm.ui.server.ext.disabled</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>true</literal>, <literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara>If set to <literal>true</literal>, disables the Red Hat Process Automation Manager UI extension.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.jbpm.case.server.ext.disabled</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>true</literal>, <literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara>If set to <literal>true</literal>, disables the Red Hat Process Automation Manager case management extension.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.optaplanner.server.ext.disabled</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>true</literal>, <literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara>If set to <literal>true</literal>, disables the Red Hat Business Optimizer support.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.prometheus.server.ext.disabled</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>true</literal>, <literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>true</literal></simpara></entry>
<entry align="left" valign="top"><simpara>If set to <literal>true</literal>, disables the Prometheus Server extension.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.scenariosimulation.server.ext.disabled</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>true</literal>, <literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>true</literal></simpara></entry>
<entry align="left" valign="top"><simpara>If set to <literal>true</literal>, disables the Test scenario Server extension.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.dmn.server.ext.disabled</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>true</literal>, <literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara>If set to <literal>true</literal>, disables the KIE Server DMN support.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.swagger.server.ext.disabled</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>true</literal>, <literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara>If set to <literal>true</literal>, disables the KIE Server swagger documentation support</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<note>
<simpara>Some Process Automation Manager controller properties listed in the following table are marked as required. Set these properties when you create or remove KIE Server containers in Business Central. If you use the KIE Server separately without any interaction with Business Central, you do not need to set the required properties.</simpara>
</note>
<table frame="all" rowsep="1" colsep="1">
<title>System properties required for Process Automation Manager controller</title>
<tgroup cols="4">
<colspec colname="col_1" colwidth="29*"/>
<colspec colname="col_2" colwidth="14*"/>
<colspec colname="col_3" colwidth="14*"/>
<colspec colname="col_4" colwidth="43*"/>
<thead>
<row>
<entry align="left" valign="top">Property</entry>
<entry align="left" valign="top">Values</entry>
<entry align="left" valign="top">Default</entry>
<entry align="left" valign="top">Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.id</literal></simpara></entry>
<entry align="left" valign="top"><simpara>String</simpara></entry>
<entry align="left" valign="top"><simpara>N/A</simpara></entry>
<entry align="left" valign="top"><simpara>An arbitrary ID to be assigned to the server. If a headless Process Automation Manager controller is configured outside of Business Central, this is the ID under which the server connects to the headless Process Automation Manager controller to fetch the KIE container configurations. If not provided, the ID is automatically generated.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.user</literal></simpara></entry>
<entry align="left" valign="top"><simpara>String</simpara></entry>
<entry align="left" valign="top"><simpara><literal>kieserver</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The user name used to connect with the KIE Server from the Process Automation Manager controller, required when running in managed mode. Set this property in Business Central system properties. Set this property when using a Process Automation Manager controller.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.pwd</literal></simpara></entry>
<entry align="left" valign="top"><simpara>String</simpara></entry>
<entry align="left" valign="top"><simpara><literal>kieserver1!</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The password used to connect with the KIE Server from the Process Automation Manager controller, required when running in managed mode. Set this property in Business Central system properties. Set this property when using a Process Automation Manager controller.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.token</literal></simpara></entry>
<entry align="left" valign="top"><simpara>String</simpara></entry>
<entry align="left" valign="top"><simpara>N/A</simpara></entry>
<entry align="left" valign="top"><simpara>A property that enables you to use token-based authentication between the Process Automation Manager controller and the KIE Server instead of the basic user name and password authentication. The Process Automation Manager controller sends the token as a parameter in the request header. The server requires long-lived access tokens because the tokens are not refreshed.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.location</literal></simpara></entry>
<entry align="left" valign="top"><simpara>URL</simpara></entry>
<entry align="left" valign="top"><simpara>N/A</simpara></entry>
<entry align="left" valign="top"><simpara>The URL of the KIE Server instance used by the Process Automation Manager controller to call back on this server, for example, <literal>http://localhost:8230/kie-server/services/rest/server</literal>. Setting this property is required when using a Process Automation Manager controller.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.controller</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Comma-separated list</simpara></entry>
<entry align="left" valign="top"><simpara>N/A</simpara></entry>
<entry align="left" valign="top"><simpara>A comma-separated list of URLs to the Process Automation Manager controller REST endpoints, for example, <literal>http://localhost:8080/business-central/rest/controller</literal>. Setting this property is required when using a Process Automation Manager controller.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.controller.user</literal></simpara></entry>
<entry align="left" valign="top"><simpara>String</simpara></entry>
<entry align="left" valign="top"><simpara><literal>kieserver</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The user name to connect to the Process Automation Manager controller REST API. Setting this property is required when using a Process Automation Manager controller.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.controller.pwd</literal></simpara></entry>
<entry align="left" valign="top"><simpara>String</simpara></entry>
<entry align="left" valign="top"><simpara><literal>kieserver1!</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The password to connect to the Process Automation Manager controller REST API. Setting this property is required when using a Process Automation Manager controller.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.controller.token</literal></simpara></entry>
<entry align="left" valign="top"><simpara>String</simpara></entry>
<entry align="left" valign="top"><simpara>N/A</simpara></entry>
<entry align="left" valign="top"><simpara>A property that enables you to use token-based authentication between the KIE Server and the Process Automation Manager controller instead of the basic user name and password authentication. The server sends the token as a parameter in the request header. The server requires long-lived access tokens because the tokens are not refreshed.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.controller.connect</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Long</simpara></entry>
<entry align="left" valign="top"><simpara><literal>10000</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The waiting time in milliseconds between repeated attempts to connect the KIE Server to the Process Automation Manager controller when the server starts.</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<table frame="all" rowsep="1" colsep="1">
<title>Persistence system properties</title>
<tgroup cols="4">
<colspec colname="col_1" colwidth="29*"/>
<colspec colname="col_2" colwidth="14*"/>
<colspec colname="col_3" colwidth="14*"/>
<colspec colname="col_4" colwidth="43*"/>
<thead>
<row>
<entry align="left" valign="top">Property</entry>
<entry align="left" valign="top">Values</entry>
<entry align="left" valign="top">Default</entry>
<entry align="left" valign="top">Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.persistence.ds</literal></simpara></entry>
<entry align="left" valign="top"><simpara>String</simpara></entry>
<entry align="left" valign="top"><simpara>N/A</simpara></entry>
<entry align="left" valign="top"><simpara>A data source JNDI name. Set this property when enabling the BPM support.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.persistence.tm</literal></simpara></entry>
<entry align="left" valign="top"><simpara>String</simpara></entry>
<entry align="left" valign="top"><simpara>N/A</simpara></entry>
<entry align="left" valign="top"><simpara>A transaction manager platform for Hibernate properties. Set this property when enabling the BPM support.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.persistence.dialect</literal></simpara></entry>
<entry align="left" valign="top"><simpara>String</simpara></entry>
<entry align="left" valign="top"><simpara>N/A</simpara></entry>
<entry align="left" valign="top"><simpara>The Hibernate dialect to be used. Set this property when enabling the BPM support.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.persistence.schema</literal></simpara></entry>
<entry align="left" valign="top"><simpara>String</simpara></entry>
<entry align="left" valign="top"><simpara>N/A</simpara></entry>
<entry align="left" valign="top"><simpara>The database schema to be used.</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<table frame="all" rowsep="1" colsep="1">
<title>Executor system properties</title>
<tgroup cols="4">
<colspec colname="col_1" colwidth="29*"/>
<colspec colname="col_2" colwidth="14*"/>
<colspec colname="col_3" colwidth="14*"/>
<colspec colname="col_4" colwidth="43*"/>
<thead>
<row>
<entry align="left" valign="top">Property</entry>
<entry align="left" valign="top">Values</entry>
<entry align="left" valign="top">Default</entry>
<entry align="left" valign="top">Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.executor.interval</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Integer</simpara></entry>
<entry align="left" valign="top"><simpara><literal>0</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The time between the moment the Red Hat Process Automation Manager executor finishes a job and the moment it starts a new one, in a time unit specified in the <literal>org.kie.executor.timeunit</literal> property.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.executor.timeunit</literal></simpara></entry>
<entry align="left" valign="top"><simpara><link xlink:href="https://docs.oracle.com/javase/8/docs/api/index.html?java/util/concurrent/TimeUnit.html"><literal>java.util.concurrent.TimeUnit</literal></link> constant</simpara></entry>
<entry align="left" valign="top"><simpara><literal>SECONDS</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The time unit in which the <literal>org.kie.executor.interval</literal> property is specified.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.executor.pool.size</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Integer</simpara></entry>
<entry align="left" valign="top"><simpara><literal>1</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The number of threads used by the Red Hat Process Automation Manager executor.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.executor.retry.count</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Integer</simpara></entry>
<entry align="left" valign="top"><simpara><literal>3</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The number of retries the Red Hat Process Automation Manager executor attempts on a failed job.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.executor.jms.queue</literal></simpara></entry>
<entry align="left" valign="top"><simpara>String</simpara></entry>
<entry align="left" valign="top"><simpara><literal>queue/KIE.SERVER.EXECUTOR</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Job executor JMS queue for KIE Server.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.executor.disabled</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>true</literal>, <literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara>If set to <literal>true</literal>, disables the KIE Server executor.</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<table frame="all" rowsep="1" colsep="1">
<title>Human task system properties</title>
<tgroup cols="4">
<colspec colname="col_1" colwidth="29*"/>
<colspec colname="col_2" colwidth="14*"/>
<colspec colname="col_3" colwidth="14*"/>
<colspec colname="col_4" colwidth="43*"/>
<thead>
<row>
<entry align="left" valign="top">Property</entry>
<entry align="left" valign="top">Values</entry>
<entry align="left" valign="top">Default</entry>
<entry align="left" valign="top">Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal>org.jbpm.ht.callback</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>mvel</literal></simpara>
<simpara><literal>ldap</literal></simpara>
<simpara><literal>db</literal></simpara>
<simpara><literal>jaas</literal></simpara>
<simpara><literal>props</literal></simpara>
<simpara><literal>custom</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>jaas</literal></simpara></entry>
<entry align="left" valign="top"><simpara>A property that specifies the implementation of user group callback to be used:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>mvel</literal>: Default; mostly used for testing.</simpara>
</listitem>
<listitem>
<simpara><literal>ldap</literal>: LDAP; requires additional configuration in the <literal>jbpm.usergroup.callback.properties</literal> file.</simpara>
</listitem>
<listitem>
<simpara><literal>db</literal>: Database; requires additional configuration in the <literal>jbpm.usergroup.callback.properties</literal> file.</simpara>
</listitem>
<listitem>
<simpara><literal>jaas</literal>: JAAS; delegates to the container to fetch information about user data.</simpara>
</listitem>
<listitem>
<simpara><literal>props</literal>: A simple property file; requires additional file that keeps all information (users and groups).</simpara>
</listitem>
<listitem>
<simpara><literal>custom</literal>: A custom implementation; specify the fully qualified name of the class in the <literal>org.jbpm.ht.custom.callback</literal> property.</simpara>
</listitem>
</itemizedlist></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.jbpm.ht.custom.callback</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Fully qualified name</simpara></entry>
<entry align="left" valign="top"><simpara>N/A</simpara></entry>
<entry align="left" valign="top"><simpara>A custom implementation of the <literal>UserGroupCallback</literal> interface in case the <literal>org.jbpm.ht.callback</literal> property is set to <literal>custom</literal>.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.jbpm.task.cleanup.enabled</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>true</literal>, <literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>true</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Enables task cleanup job listener to remove tasks once the process instance is completed.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.jbpm.task.bam.enabled</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>true</literal>, <literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>true</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Enables task BAM module to store task related information.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.jbpm.ht.admin.user</literal></simpara></entry>
<entry align="left" valign="top"><simpara>String</simpara></entry>
<entry align="left" valign="top"><simpara><literal>Administrator</literal></simpara></entry>
<entry align="left" valign="top"><simpara>User who can access all the tasks from KIE Server.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.jbpm.ht.admin.group</literal></simpara></entry>
<entry align="left" valign="top"><simpara>String</simpara></entry>
<entry align="left" valign="top"><simpara><literal>Administrators</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The group that users must belong to in order to view all the tasks from KIE Server.</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<table frame="all" rowsep="1" colsep="1">
<title>System properties for loading keystore</title>
<tgroup cols="4">
<colspec colname="col_1" colwidth="29*"/>
<colspec colname="col_2" colwidth="14*"/>
<colspec colname="col_3" colwidth="14*"/>
<colspec colname="col_4" colwidth="43*"/>
<thead>
<row>
<entry align="left" valign="top">Property</entry>
<entry align="left" valign="top">Values</entry>
<entry align="left" valign="top">Default</entry>
<entry align="left" valign="top">Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal>kie.keystore.keyStoreURL</literal></simpara></entry>
<entry align="left" valign="top"><simpara>URL</simpara></entry>
<entry align="left" valign="top"><simpara>N/A</simpara></entry>
<entry align="left" valign="top"><simpara>The URL is used to load a Java Cryptography Extension KeyStore (JCEKS). For example, <literal><link xlink:href="file:///home/kie/keystores/keystore.jceks">file:///home/kie/keystores/keystore.jceks</link></literal>.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>kie.keystore.keyStorePwd</literal></simpara></entry>
<entry align="left" valign="top"><simpara>String</simpara></entry>
<entry align="left" valign="top"><simpara>N/A</simpara></entry>
<entry align="left" valign="top"><simpara>The password is used for the JCEKS.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>kie.keystore.key.server.alias</literal></simpara></entry>
<entry align="left" valign="top"><simpara>String</simpara></entry>
<entry align="left" valign="top"><simpara>N/A</simpara></entry>
<entry align="left" valign="top"><simpara>The alias name of the key for REST services where the password is stored.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>kie.keystore.key.server.pwd</literal></simpara></entry>
<entry align="left" valign="top"><simpara>String</simpara></entry>
<entry align="left" valign="top"><simpara>N/A</simpara></entry>
<entry align="left" valign="top"><simpara>The password of an alias for REST services.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>kie.keystore.key.ctrl.alias</literal></simpara></entry>
<entry align="left" valign="top"><simpara>String</simpara></entry>
<entry align="left" valign="top"><simpara>N/A</simpara></entry>
<entry align="left" valign="top"><simpara>The alias of the key for default REST Process Automation Manager controller.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>kie.keystore.key.ctrl.pwd</literal></simpara></entry>
<entry align="left" valign="top"><simpara>String</simpara></entry>
<entry align="left" valign="top"><simpara>N/A</simpara></entry>
<entry align="left" valign="top"><simpara>The password of an alias for default REST Process Automation Manager controller.</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<table frame="all" rowsep="1" colsep="1">
<title>Other system properties</title>
<tgroup cols="4">
<colspec colname="col_1" colwidth="30*"/>
<colspec colname="col_2" colwidth="20*"/>
<colspec colname="col_3" colwidth="20*"/>
<colspec colname="col_4" colwidth="30*"/>
<thead>
<row>
<entry align="left" valign="top">Property</entry>
<entry align="left" valign="top">Values</entry>
<entry align="left" valign="top">Default</entry>
<entry align="left" valign="top">Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal>kie.maven.settings.custom</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Path</simpara></entry>
<entry align="left" valign="top"><simpara>N/A</simpara></entry>
<entry align="left" valign="top"><simpara>The location of a custom <literal>settings.xml</literal> file for Maven configuration.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>kie.server.jms.queues.response</literal></simpara></entry>
<entry align="left" valign="top"><simpara>String</simpara></entry>
<entry align="left" valign="top"><simpara><literal>queue/KIE.SERVER.RESPONSE</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The response queue JNDI name for JMS.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.drools.server.filter.classes</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>true</literal>, <literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara>When set to <literal>true</literal>, the Drools KIE Server extension accepts custom classes annotated by the <literal>XmlRootElement</literal> or <literal>Remotable</literal> annotations only.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.bypass.auth.user</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>true</literal>, <literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara>A property that enables you to bypass the authenticated user for task-related operations, for example queries.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.jbpm.rule.task.firelimit</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Integer</simpara></entry>
<entry align="left" valign="top"><simpara><literal>10000</literal></simpara></entry>
<entry align="left" valign="top"><simpara>This property specifies the maximum number of executed rules to avoid situations where rules run into an infinite loop and make the server completely unresponsive.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.jbpm.ejb.timer.local.cache</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>true</literal>, <literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>true</literal></simpara></entry>
<entry align="left" valign="top"><simpara>This property turns off the EJB Timers local cache.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.domain</literal></simpara></entry>
<entry align="left" valign="top"><simpara>String</simpara></entry>
<entry align="left" valign="top"><simpara>N/A</simpara></entry>
<entry align="left" valign="top"><simpara>The JAAS <literal>LoginContext</literal> domain used to authenticate users when using JMS.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.repo</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Path</simpara></entry>
<entry align="left" valign="top"><simpara><literal>.</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The location where KIE Server state files are stored.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.sync.deploy</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>true</literal>, <literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara>A property that instructs the KIE Server to hold the deployment until the Process Automation Manager controller provides the container deployment configuration. This property only affects servers running in managed mode. The following options are available:</simpara><simpara>* <literal>false</literal>: The connection to the Process Automation Manager controller is asynchronous. The application starts, connects to the Process Automation Manager controller, and once successful, deploys the containers. The application accepts requests even before the containers are available.
* <literal>true</literal>: The deployment of the server application joins the Process Automation Manager controller connection thread with the main deployment and awaits its completion. This option can lead to a potential deadlock in case more applications are on the same server. Use only one application on one server instance.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.startup.strategy</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>ControllerBasedStartupStrategy</literal>, <literal>LocalContainersStartupStrategy</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>ControllerBasedStartupStrategy</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The Startup strategy of KIE Server used to control the KIE containers that are deployed and the order in which they are deployed.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.mgmt.api.disabled</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>true</literal>, <literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara>When set to <literal>true</literal>, disables KIE Server management API.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.xstream.enabled.packages</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Java packages like <literal>org.kie.example</literal>. You can also specify wildcard expressions like <literal>org.kie.example.*</literal>.</simpara></entry>
<entry align="left" valign="top"><simpara>N/A</simpara></entry>
<entry align="left" valign="top"><simpara>A property that specifies additional packages to whitelist for marshalling using XStream.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.store.services.class</literal></simpara></entry>
<entry align="left" valign="top"><simpara>String</simpara></entry>
<entry align="left" valign="top"><simpara><literal>org.drools.persistence.jpa.KnowledgeStoreServiceImpl</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Fully qualified name of the class that implements <literal>KieStoreServices</literal> that are responsible for bootstrapping KieSession instances.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>org.kie.server.strict.id.format</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>true</literal>, <literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>false</literal></simpara></entry>
<entry align="left" valign="top"><simpara>While using JSON marshalling, if the property is set to <literal>true</literal>, it will always return a response in the proper JSON format. For example, if the original response contains only a single number, then the response is wrapped in a JSON format. For example, <emphasis role="strong">{"value" : 1}</emphasis>.</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
</chapter>
<chapter xml:id="kie-server-extensions-con_execution-server">
<title>KIE Server capabilities and extensions</title>
<simpara>The capabilities in KIE Server are determined by plug-in extensions that you can enable, disable, or further extend to meet your business needs. KIE Server supports the following default capabilities and extensions:</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>KIE Server capabilities and extensions</title>
<tgroup cols="3">
<colspec colname="col_1" colwidth="20*"/>
<colspec colname="col_2" colwidth="20*"/>
<colspec colname="col_3" colwidth="60*"/>
<thead>
<row>
<entry align="left" valign="top">Capability name</entry>
<entry align="left" valign="top">Extension name</entry>
<entry align="left" valign="top">Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal>KieServer</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>KieServer</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Provides the core capabilities of KIE Server, such as creating and disposing KIE containers on your server instance</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>BRM</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>Drools</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Provides the Business Rule Management (BRM) capabilities, such as inserting facts and executing business rules</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>BPM</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>jBPM</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Provides the Business Process Management (BPM) capabilities, such as managing user tasks and executing business processes</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>BPM-UI</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>jBPM-UI</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Provides additional user-interface capabilities related to business processes, such as rendering XML forms and SVG images in process diagrams</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>CaseMgmt</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>Case-Mgmt</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Provides the case management capabilities for business processes, such as managing case definitions and milestones</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>BRP</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>OptaPlanner</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Provides the Business Resource Planning (BRP) capabilities, such as implementing solvers</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>DMN</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>DMN</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Provides the Decision Model and Notation (DMN) capabilities, such as managing DMN data types and executing DMN models</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>Swagger</literal></simpara></entry>
<entry align="left" valign="top"><simpara><literal>Swagger</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Provides the Swagger web-interface capabilities for interacting with the KIE Server REST API</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<simpara>To view the supported extensions of a running KIE Server instance, send a <literal>GET</literal> request to the following REST API endpoint and review the XML or JSON server response:</simpara>
<formalpara>
<title>Base URL for GET request for KIE Server information</title>
<para>
<screen>http://SERVER:PORT/kie-server/services/rest/server</screen>
</para>
</formalpara>
<formalpara>
<title>Example JSON response with KIE Server information</title>
<para>
<programlisting language="json" linenumbering="unnumbered">{
  "type": "SUCCESS",
  "msg": "Kie Server info",
  "result": {
    "kie-server-info": {
      "id": "test-kie-server",
      "version": "7.26.0.20190818-050814",
      "name": "test-kie-server",
      "location": "http://localhost:8080/kie-server/services/rest/server",
      "capabilities": [
        "KieServer",
        "BRM",
        "BPM",
        "CaseMgmt",
        "BPM-UI",
        "BRP",
        "DMN",
        "Swagger"
      ],
      "messages": [
        {
          "severity": "INFO",
          "timestamp": {
            "java.util.Date": 1566169865791
          },
          "content": [
            "Server KieServerInfo{serverId='test-kie-server', version='7.26.0.20190818-050814', name='test-kie-server', location='http:/localhost:8080/kie-server/services/rest/server', capabilities=[KieServer, BRM, BPM, CaseMgmt, BPM-UI, BRP, DMN, Swagger]', messages=null', mode=DEVELOPMENT}started successfully at Sun Aug 18 23:11:05 UTC 2019"
          ]
        }
      ],
      "mode": "DEVELOPMENT"
    }
  }
}</programlisting>
</para>
</formalpara>
<simpara>To enable or disable KIE Server extensions, configure the related <literal>*.server.ext.disabled</literal> KIE Server system property. For example, to disable the <literal>BRM</literal> capability, set the system property <literal>org.drools.server.ext.disabled=true</literal>. For all KIE Server system properties, see
<xref linkend="kie-server-system-properties-ref_execution-server"/>.</simpara>
<simpara>By default, KIE Server extensions are exposed through REST or JMS data transports and use predefined client APIs. You can extend existing KIE Server capabilities with additional REST endpoints, extend supported transport methods beyond REST or JMS, or extend functionality in the KIE Server client.</simpara>
<simpara>This flexibility in KIE Server functionality enables you to adapt your KIE Server instances to your business needs, instead of adapting your business needs to the default KIE Server capabilities.</simpara>
<important>
<simpara>If you extend KIE Server functionality, Red Hat does not support the custom code that you use as part of your custom implementations and extensions.</simpara>
</important>
<section xml:id="kie-server-extensions-endpoint-proc_execution-server">
<title>Extending an existing KIE Server capability with a custom REST API endpoint</title>
<simpara>The KIE Server REST API enables you to interact with your KIE containers and business assets (such as business rules, processes, and solvers) in Red Hat Process Automation Manager without using the Business Central user interface. The available REST endpoints are determined by the capabilities enabled in your KIE Server system properties (for example, <literal>org.drools.server.ext.disabled=false</literal> for the <literal>BRM</literal> capability). You can extend an existing KIE Server capability with a custom REST API endpoint to further adapt the KIE Server REST API to your business needs.</simpara>
<simpara>As an example, this procedure extends the <literal>Drools</literal> KIE Server extension (for the <literal>BRM</literal> capability) with the following custom REST API endpoint:</simpara>
<formalpara>
<title>Example custom REST API endpoint</title>
<para>
<screen>/server/containers/instances/{containerId}/ksession/{ksessionId}</screen>
</para>
</formalpara>
<simpara>This example custom endpoint accepts a list of facts to be inserted into the working memory of the decision engine, automatically executes all rules, and retrieves all objects from the KIE session in the specified KIE container.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>Create an empty Maven project and define the following packaging type and dependencies in the <literal>pom.xml</literal> file for the project:</simpara>
<formalpara>
<title>Example pom.xml file in the sample project</title>
<para>
<programlisting language="xml" linenumbering="unnumbered">&lt;packaging&gt;jar&lt;/packaging&gt;

&lt;properties&gt;
  &lt;version.org.kie&gt;7.48.0.Final-redhat-00002&lt;/version.org.kie&gt;
&lt;/properties&gt;

&lt;dependencies&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.kie&lt;/groupId&gt;
    &lt;artifactId&gt;kie-api&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.kie&lt;/groupId&gt;
    &lt;artifactId&gt;kie-internal&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.kie.server&lt;/groupId&gt;
    &lt;artifactId&gt;kie-server-api&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.kie.server&lt;/groupId&gt;
    &lt;artifactId&gt;kie-server-services-common&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.kie.server&lt;/groupId&gt;
    &lt;artifactId&gt;kie-server-services-drools&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.kie.server&lt;/groupId&gt;
    &lt;artifactId&gt;kie-server-rest-common&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.drools&lt;/groupId&gt;
    &lt;artifactId&gt;drools-core&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.drools&lt;/groupId&gt;
    &lt;artifactId&gt;drools-compiler&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
    &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;
    &lt;version&gt;1.7.25&lt;/version&gt;
  &lt;/dependency&gt;
&lt;/dependencies&gt;</programlisting>
</para>
</formalpara>
</listitem>
<listitem>
<simpara>Implement the <literal>org.kie.server.services.api.KieServerApplicationComponentsService</literal> interface in a Java class in your project, as shown in the following example:</simpara>
<formalpara>
<title>Sample implementation of the <literal>KieServerApplicationComponentsService</literal> interface</title>
<para>
<programlisting language="java" linenumbering="unnumbered">public class CusomtDroolsKieServerApplicationComponentsService implements KieServerApplicationComponentsService {  <co xml:id="CO5-1"/>

    private static final String OWNER_EXTENSION = "Drools";  <co xml:id="CO5-2"/>

    public Collection&lt;Object&gt; getAppComponents(String extension, SupportedTransports type, Object... services) {  <co xml:id="CO5-3"/>
        // Do not accept calls from extensions other than the owner extension:
        if ( !OWNER_EXTENSION.equals(extension) ) {
            return Collections.emptyList();
        }

        RulesExecutionService rulesExecutionService = null;  <co xml:id="CO5-4"/>
        KieServerRegistry context = null;

        for( Object object : services ) {
            if( RulesExecutionService.class.isAssignableFrom(object.getClass()) ) {
                rulesExecutionService = (RulesExecutionService) object;
                continue;
            } else if( KieServerRegistry.class.isAssignableFrom(object.getClass()) ) {
                context = (KieServerRegistry) object;
                continue;
            }
        }

        List&lt;Object&gt; components = new ArrayList&lt;Object&gt;(1);
        if( SupportedTransports.REST.equals(type) ) {
            components.add(new CustomResource(rulesExecutionService, context));  <co xml:id="CO5-5"/>
        }

        return components;
    }

}</programlisting>
</para>
</formalpara>
<calloutlist>
<callout arearefs="CO5-1">
<para>Delivers REST endpoints to the KIE Server infrastructure that is deployed when the application starts.</para>
</callout>
<callout arearefs="CO5-2">
<para>Specifies the extension that you are extending, such as the <literal>Drools</literal> extension in this example.</para>
</callout>
<callout arearefs="CO5-3">
<para>Returns all resources that the REST container must deploy. Each extension that is enabled in your KIE Server instance calls the <literal>getAppComponents</literal> method, so the <literal>if ( !OWNER_EXTENSION.equals(extension) )</literal> call returns an empty collection for any extensions other than the specified <literal>OWNER_EXTENSION</literal> extension.</para>
</callout>
<callout arearefs="CO5-4">
<para>Lists the services from the specified extension that you want to use, such as the <literal>RulesExecutionService</literal> and <literal>KieServerRegistry</literal> services from the <literal>Drools</literal> extension in this example.</para>
</callout>
<callout arearefs="CO5-5">
<para>Specifies the transport type for the extension, either <literal>REST</literal> or <literal>JMS</literal> (<literal>REST</literal> in this example), and the <literal>CustomResource</literal> class that returns the resource as part of the <literal>components</literal> list.</para>
</callout>
</calloutlist>
</listitem>
<listitem>
<simpara>Implement the <literal>CustomResource</literal> class that the KIE Server can use to provide the additional functionality for the new REST resource, as shown in the following example:</simpara>
<formalpara>
<title>Sample implementation of the <literal>CustomResource</literal> class</title>
<para>
<programlisting language="java" linenumbering="unnumbered">// Custom base endpoint:
@Path("server/containers/instances/{containerId}/ksession")
public class CustomResource {

    private static final Logger logger = LoggerFactory.getLogger(CustomResource.class);

    private KieCommands commandsFactory = KieServices.Factory.get().getCommands();

    private RulesExecutionService rulesExecutionService;
    private KieServerRegistry registry;

    public CustomResource() {

    }

    public CustomResource(RulesExecutionService rulesExecutionService, KieServerRegistry registry) {
        this.rulesExecutionService = rulesExecutionService;
        this.registry = registry;
    }

    // Supported HTTP method, path parameters, and data formats:
    @POST
    @Path("/{ksessionId}")
    @Consumes({MediaType.APPLICATION_XML, MediaType.APPLICATION_JSON})
    @Produces({MediaType.APPLICATION_XML, MediaType.APPLICATION_JSON})
    public Response insertFireReturn(@Context HttpHeaders headers,
            @PathParam("containerId") String id,
            @PathParam("ksessionId") String ksessionId,
            String cmdPayload) {

        Variant v = getVariant(headers);
        String contentType = getContentType(headers);

        // Marshalling behavior and supported actions:
        MarshallingFormat format = MarshallingFormat.fromType(contentType);
        if (format == null) {
            format = MarshallingFormat.valueOf(contentType);
        }
        try {
            KieContainerInstance kci = registry.getContainer(id);

            Marshaller marshaller = kci.getMarshaller(format);

            List&lt;?&gt; listOfFacts = marshaller.unmarshall(cmdPayload, List.class);

            List&lt;Command&lt;?&gt;&gt; commands = new ArrayList&lt;Command&lt;?&gt;&gt;();
            BatchExecutionCommand executionCommand = commandsFactory.newBatchExecution(commands, ksessionId);

            for (Object fact : listOfFacts) {
                commands.add(commandsFactory.newInsert(fact, fact.toString()));
            }
            commands.add(commandsFactory.newFireAllRules());
            commands.add(commandsFactory.newGetObjects());

            ExecutionResults results = rulesExecutionService.call(kci, executionCommand);

            String result = marshaller.marshall(results);


            logger.debug("Returning OK response with content '{}'", result);
            return createResponse(result, v, Response.Status.OK);
        } catch (Exception e) {
            // If marshalling fails, return the `call-container` response to maintain backward compatibility:
            String response = "Execution failed with error : " + e.getMessage();
            logger.debug("Returning Failure response with content '{}'", response);
            return createResponse(response, v, Response.Status.INTERNAL_SERVER_ERROR);
        }

    }
}</programlisting>
</para>
</formalpara>
<simpara>In this example, the <literal>CustomResource</literal> class for the custom endpoint specifies the following data and behavior:</simpara>
<itemizedlist>
<listitem>
<simpara>Uses the base endpoint <literal>server/containers/instances/{containerId}/ksession</literal></simpara>
</listitem>
<listitem>
<simpara>Uses <literal>POST</literal> HTTP method</simpara>
</listitem>
<listitem>
<simpara>Expects the following data to be given in REST requests:</simpara>
<itemizedlist>
<listitem>
<simpara>The <literal>containerId</literal> as a path argument</simpara>
</listitem>
<listitem>
<simpara>The <literal>ksessionId</literal> as a path argument</simpara>
</listitem>
<listitem>
<simpara>List of facts as a message payload</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>Supports all KIE Server data formats:</simpara>
<itemizedlist>
<listitem>
<simpara>XML (JAXB, XStream)</simpara>
</listitem>
<listitem>
<simpara>JSON</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>Unmarshals the payload into a <literal>List&lt;?&gt;</literal> collection and, for each item in the list, creates an <literal>InsertCommand</literal> instance followed by <literal>FireAllRules</literal> and <literal>GetObject</literal> commands.</simpara>
</listitem>
<listitem>
<simpara>Adds all commands to the <literal>BatchExecutionCommand</literal> instance that calls to the decision engine.</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>To make the new endpoint discoverable for KIE Server, create a <literal>META-INF/services/org.kie.server.services.api.KieServerApplicationComponentsService</literal> file in your Maven project and add the fully qualified class name of the <literal>KieServerApplicationComponentsService</literal> implementation class within the file. For this example, the file contains the single line <literal>org.kie.server.ext.drools.rest.CusomtDroolsKieServerApplicationComponentsService</literal>.</simpara>
</listitem>
<listitem>
<simpara>Build your project and copy the resulting JAR file into the <literal>~/kie-server.war/WEB-INF/lib</literal> directory of your project.
For example, on Red Hat JBoss EAP, the path to this directory is <literal><emphasis>EAP_HOME</emphasis>/standalone/deployments/kie-server.war/WEB-INF/lib</literal>.</simpara>
</listitem>
<listitem>
<simpara>Start the KIE Server and deploy the built project to the running KIE Server. You can deploy the project using either the Business Central interface or the KIE Server REST API (a <literal>PUT</literal> request to <literal>http://SERVER:PORT/kie-server/services/rest/server/containers/{containerId}</literal>).</simpara>
<simpara>After your project is deployed on a running KIE Server, you can start interacting with your new REST endpoint.</simpara>
<simpara>For this example, you can use the following information to invoke the new endpoint:</simpara>
<itemizedlist>
<listitem>
<simpara><emphasis role="strong">Example request URL:</emphasis> <literal>http://localhost:8080/kie-server/services/rest/server/containers/instances/demo/ksession/defaultKieSession</literal></simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">HTTP method:</emphasis> <literal>POST</literal></simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">HTTP headers:</emphasis></simpara>
<itemizedlist>
<listitem>
<simpara><literal>Content-Type: application/json</literal></simpara>
</listitem>
<listitem>
<simpara><literal>Accept: application/json</literal></simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara><emphasis role="strong">Example message payload:</emphasis></simpara>
<programlisting language="json" linenumbering="unnumbered">[
  {
    "org.jbpm.test.Person": {
      "name": "john",
      "age": 25
    }
  },
  {
    "org.jbpm.test.Person": {
      "name": "mary",
      "age": 22
    }
  }
]</programlisting>
</listitem>
<listitem>
<simpara><emphasis role="strong">Example server response:</emphasis> <literal>200</literal> (success)</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Example server log output:</emphasis></simpara>
<screen>13:37:20,347 INFO  [stdout] (default task-24) Hello mary
13:37:20,348 INFO  [stdout] (default task-24) Hello john</screen>
</listitem>
</itemizedlist>
</listitem>
</orderedlist>
</section>
<section xml:id="kie-server-extensions-transport-proc_execution-server">
<title>Extending KIE Server to use a custom data transport</title>
<simpara>By default, KIE Server extensions are exposed through REST or JMS data transports. You can extend KIE Server to support a custom data transport to adapt KIE Server transport protocols to your business needs.</simpara>
<simpara>As an example, this procedure adds a custom data transport to KIE Server that uses the <literal>Drools</literal> extension and that is based on Apache MINA, an open-source Java network-application framework. The example custom MINA transport exchanges string-based data that relies on existing marshalling operations and supports only JSON format.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>Create an empty Maven project and define the following packaging type and dependencies in the <literal>pom.xml</literal> file for the project:</simpara>
<formalpara>
<title>Example pom.xml file in the sample project</title>
<para>
<programlisting language="xml" linenumbering="unnumbered">&lt;packaging&gt;jar&lt;/packaging&gt;

&lt;properties&gt;
  &lt;version.org.kie&gt;7.48.0.Final-redhat-00002&lt;/version.org.kie&gt;
&lt;/properties&gt;

&lt;dependencies&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.kie&lt;/groupId&gt;
    &lt;artifactId&gt;kie-api&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.kie&lt;/groupId&gt;
    &lt;artifactId&gt;kie-internal&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.kie.server&lt;/groupId&gt;
    &lt;artifactId&gt;kie-server-api&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.kie.server&lt;/groupId&gt;
    &lt;artifactId&gt;kie-server-services-common&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.kie.server&lt;/groupId&gt;
    &lt;artifactId&gt;kie-server-services-drools&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.drools&lt;/groupId&gt;
    &lt;artifactId&gt;drools-core&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.drools&lt;/groupId&gt;
    &lt;artifactId&gt;drools-compiler&lt;/artifactId&gt;
    &lt;version&gt;${version.org.kie}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
    &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;
    &lt;version&gt;1.7.25&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.apache.mina&lt;/groupId&gt;
    &lt;artifactId&gt;mina-core&lt;/artifactId&gt;
    &lt;version&gt;2.1.3&lt;/version&gt;
  &lt;/dependency&gt;
&lt;/dependencies&gt;</programlisting>
</para>
</formalpara>
</listitem>
<listitem>
<simpara>Implement the <literal>org.kie.server.services.api.KieServerExtension</literal> interface in a Java class in your project, as shown in the following example:</simpara>
<formalpara>
<title>Sample implementation of the <literal>KieServerExtension</literal> interface</title>
<para>
<programlisting language="java" linenumbering="unnumbered">public class MinaDroolsKieServerExtension implements KieServerExtension {

    private static final Logger logger = LoggerFactory.getLogger(MinaDroolsKieServerExtension.class);

    public static final String EXTENSION_NAME = "Drools-Mina";

    private static final Boolean disabled = Boolean.parseBoolean(System.getProperty("org.kie.server.drools-mina.ext.disabled", "false"));
    private static final String MINA_HOST = System.getProperty("org.kie.server.drools-mina.ext.port", "localhost");
    private static final int MINA_PORT = Integer.parseInt(System.getProperty("org.kie.server.drools-mina.ext.port", "9123"));

    // Taken from dependency on the `Drools` extension:
    private KieContainerCommandService batchCommandService;

    // Specific to MINA:
    private IoAcceptor acceptor;

    public boolean isActive() {
        return disabled == false;
    }

    public void init(KieServerImpl kieServer, KieServerRegistry registry) {

        KieServerExtension droolsExtension = registry.getServerExtension("Drools");
        if (droolsExtension == null) {
            logger.warn("No Drools extension available, quitting...");
            return;
        }

        List&lt;Object&gt; droolsServices = droolsExtension.getServices();
        for( Object object : droolsServices ) {
            // If the given service is null (not configured), continue to the next service:
            if (object == null) {
                continue;
            }
            if( KieContainerCommandService.class.isAssignableFrom(object.getClass()) ) {
                batchCommandService = (KieContainerCommandService) object;
                continue;
            }
        }
        if (batchCommandService != null) {
            acceptor = new NioSocketAcceptor();
            acceptor.getFilterChain().addLast( "codec", new ProtocolCodecFilter( new TextLineCodecFactory( Charset.forName( "UTF-8" ))));

            acceptor.setHandler( new TextBasedIoHandlerAdapter(batchCommandService) );
            acceptor.getSessionConfig().setReadBufferSize( 2048 );
            acceptor.getSessionConfig().setIdleTime( IdleStatus.BOTH_IDLE, 10 );
            try {
                acceptor.bind( new InetSocketAddress(MINA_HOST, MINA_PORT) );

                logger.info("{} -- Mina server started at {} and port {}", toString(), MINA_HOST, MINA_PORT);
            } catch (IOException e) {
                logger.error("Unable to start Mina acceptor due to {}", e.getMessage(), e);
            }

        }
    }

    public void destroy(KieServerImpl kieServer, KieServerRegistry registry) {
        if (acceptor != null) {
            acceptor.dispose();
            acceptor = null;
        }
        logger.info("{} -- Mina server stopped", toString());
    }

    public void createContainer(String id, KieContainerInstance kieContainerInstance, Map&lt;String, Object&gt; parameters) {
        // Empty, already handled by the `Drools` extension

    }

    public void disposeContainer(String id, KieContainerInstance kieContainerInstance, Map&lt;String, Object&gt; parameters) {
      // Empty, already handled by the `Drools` extension

    }

    public List&lt;Object&gt; getAppComponents(SupportedTransports type) {
        // Nothing for supported transports (REST or JMS)
        return Collections.emptyList();
    }

    public &lt;T&gt; T getAppComponents(Class&lt;T&gt; serviceType) {

        return null;
    }

    public String getImplementedCapability() {
        return "BRM-Mina";
    }

    public List&lt;Object&gt; getServices() {
        return Collections.emptyList();
    }

    public String getExtensionName() {
        return EXTENSION_NAME;
    }

    public Integer getStartOrder() {
        return 20;
    }

    @Override
    public String toString() {
        return EXTENSION_NAME + " KIE Server extension";
    }
}</programlisting>
</para>
</formalpara>
<simpara>The <literal>KieServerExtension</literal> interface is the main extension interface that KIE Server can use to provide the additional functionality for the new MINA transport. The interface consists of the following components:</simpara>
<formalpara>
<title>Overview of the <literal>KieServerExtension</literal> interface</title>
<para>
<programlisting language="java" linenumbering="unnumbered">public interface KieServerExtension {

    boolean isActive();

    void init(KieServerImpl kieServer, KieServerRegistry registry);

    void destroy(KieServerImpl kieServer, KieServerRegistry registry);

    void createContainer(String id, KieContainerInstance kieContainerInstance, Map&lt;String, Object&gt; parameters);

    void disposeContainer(String id, KieContainerInstance kieContainerInstance, Map&lt;String, Object&gt; parameters);

    List&lt;Object&gt; getAppComponents(SupportedTransports type);

    &lt;T&gt; T getAppComponents(Class&lt;T&gt; serviceType);

    String getImplementedCapability();  <co xml:id="CO6-1"/>

    List&lt;Object&gt; getServices();

    String getExtensionName();  <co xml:id="CO6-2"/>

    Integer getStartOrder();  <co xml:id="CO6-3"/>
}</programlisting>
</para>
</formalpara>
<calloutlist>
<callout arearefs="CO6-1">
<para>Specifies the capability that is covered by this extension. The capability must be unique within KIE Server.</para>
</callout>
<callout arearefs="CO6-2">
<para>Defines a human-readable name for the extension.</para>
</callout>
<callout arearefs="CO6-3">
<para>Determines when the specified extension should be started. For extensions that have dependencies on other extensions, this setting must not conflict with the parent setting. For example, in this case, this custom extension depends on the <literal>Drools</literal> extension, which has <literal>StartOrder</literal> set to <literal>0</literal>, so this custom add-on extension must be greater than <literal>0</literal> (set to <literal>20</literal> in the sample implementation).</para>
</callout>
</calloutlist>
<simpara>In the previous <literal>MinaDroolsKieServerExtension</literal> sample implementation of this interface, the <literal>init</literal> method is the main element for collecting services from the <literal>Drools</literal> extension and for bootstrapping the MINA server. All other methods in the <literal>KieServerExtension</literal> interface can remain with the standard implementation to fulfill interface requirements.</simpara>
<simpara>The <literal>TextBasedIoHandlerAdapter</literal> class is the handler on the MINA server that reacts to incoming requests.</simpara>
</listitem>
<listitem>
<simpara>Implement the <literal>TextBasedIoHandlerAdapter</literal> handler for the MINA server, as shown in the following example:</simpara>
<formalpara>
<title>Sample implementation of the <literal>TextBasedIoHandlerAdapter</literal> handler</title>
<para>
<programlisting language="java" linenumbering="unnumbered">public class TextBasedIoHandlerAdapter extends IoHandlerAdapter {

    private static final Logger logger = LoggerFactory.getLogger(TextBasedIoHandlerAdapter.class);

    private KieContainerCommandService batchCommandService;

    public TextBasedIoHandlerAdapter(KieContainerCommandService batchCommandService) {
        this.batchCommandService = batchCommandService;
    }

    @Override
    public void messageReceived( IoSession session, Object message ) throws Exception {
        String completeMessage = message.toString();
        logger.debug("Received message '{}'", completeMessage);
        if( completeMessage.trim().equalsIgnoreCase("quit") || completeMessage.trim().equalsIgnoreCase("exit") ) {
            session.close(false);
            return;
        }

        String[] elements = completeMessage.split("\\|");
        logger.debug("Container id {}", elements[0]);
        try {
            ServiceResponse&lt;String&gt; result = batchCommandService.callContainer(elements[0], elements[1], MarshallingFormat.JSON, null);

            if (result.getType().equals(ServiceResponse.ResponseType.SUCCESS)) {
                session.write(result.getResult());
                logger.debug("Successful message written with content '{}'", result.getResult());
            } else {
                session.write(result.getMsg());
                logger.debug("Failure message written with content '{}'", result.getMsg());
            }
        } catch (Exception e) {

        }
    }
}</programlisting>
</para>
</formalpara>
<simpara>In this example, the handler class receives text messages and executes them in the <literal>Drools</literal> service.</simpara>
<simpara>Consider the following handler requirements and behavior when you use the <literal>TextBasedIoHandlerAdapter</literal> handler implementation:</simpara>
<itemizedlist>
<listitem>
<simpara>Anything that you submit to the handler must be a single line because each incoming transport request is a single line.</simpara>
</listitem>
<listitem>
<simpara>You must pass a KIE container ID in this single line so that the handler expects the format <literal>containerID|payload</literal>.</simpara>
</listitem>
<listitem>
<simpara>You can set a response in the way that it is produced by the marshaller. The response can be multiple lines.</simpara>
</listitem>
<listitem>
<simpara>The handler supports a <emphasis>stream mode</emphasis> that enables you to send commands without disconnecting from a KIE Server session. To end a KIE Server session in stream mode, send either an <literal>exit</literal> or <literal>quit</literal> command to the server.</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>To make the new data transport discoverable for KIE Server, create a <literal>META-INF/services/org.kie.server.services.api.KieServerExtension</literal> file in your Maven project and add the fully qualified class name of the <literal>KieServerExtension</literal> implementation class within the file. For this example, the file contains the single line <literal>org.kie.server.ext.mina.MinaDroolsKieServerExtension</literal>.</simpara>
</listitem>
<listitem>
<simpara>Build your project and copy the resulting JAR file and the <literal>mina-core-2.0.9.jar</literal> file (which the extension depends on in this example) into the <literal>~/kie-server.war/WEB-INF/lib</literal> directory of your project.
For example, on Red Hat JBoss EAP, the path to this directory is <literal><emphasis>EAP_HOME</emphasis>/standalone/deployments/kie-server.war/WEB-INF/lib</literal>.</simpara>
</listitem>
<listitem>
<simpara>Start the KIE Server and deploy the built project to the running KIE Server. You can deploy the project using either the Business Central interface or the KIE Server REST API (a <literal>PUT</literal> request to <literal>http://SERVER:PORT/kie-server/services/rest/server/containers/{containerId}</literal>).</simpara>
<simpara>After your project is deployed on a running KIE Server, you can view the status of the new data transport in your KIE Server log and start using your new data transport:</simpara>
<formalpara>
<title>New data transport in the server log</title>
<para>
<screen>Drools-Mina KIE Server extension -- Mina server started at localhost and port 9123
Drools-Mina KIE Server extension has been successfully registered as server extension</screen>
</para>
</formalpara>
<simpara>For this example, you can use Telnet to interact with the new MINA-based data transport in KIE Server:</simpara>
<formalpara>
<title>Starting Telnet and connecting to KIE Server on port 9123 in a command terminal</title>
<para>
<programlisting language="shell" linenumbering="unnumbered">telnet 127.0.0.1 9123</programlisting>
</para>
</formalpara>
<formalpara>
<title>Example interactions with KIE Server in a command terminal</title>
<para>
<programlisting language="shell" linenumbering="unnumbered">Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.

# Request body:
demo|{"lookup":"defaultKieSession","commands":[{"insert":{"object":{"org.jbpm.test.Person":{"name":"john","age":25}}}},{"fire-all-rules":""}]}

# Server response:
{
  "results" : [ {
    "key" : "",
    "value" : 1
  } ],
  "facts" : [ ]
}

demo|{"lookup":"defaultKieSession","commands":[{"insert":{"object":{"org.jbpm.test.Person":{"name":"mary","age":22}}}},{"fire-all-rules":""}]}
{
  "results" : [ {
    "key" : "",
    "value" : 1
  } ],
  "facts" : [ ]
}

demo|{"lookup":"defaultKieSession","commands":[{"insert":{"object":{"org.jbpm.test.Person":{"name":"james","age":25}}}},{"fire-all-rules":""}]}
{
  "results" : [ {
    "key" : "",
    "value" : 1
  } ],
  "facts" : [ ]
}
exit
Connection closed by foreign host.</programlisting>
</para>
</formalpara>
<formalpara>
<title>Example server log output</title>
<para>
<screen>16:33:40,206 INFO  [stdout] (NioProcessor-2) Hello john
16:34:03,877 INFO  [stdout] (NioProcessor-2) Hello mary
16:34:19,800 INFO  [stdout] (NioProcessor-2) Hello james</screen>
</para>
</formalpara>
</listitem>
</orderedlist>
</section>
<section xml:id="kie-server-extensions-client-proc_execution-server">
<title>Extending the KIE Server client with a custom client API</title>
<simpara>KIE Server uses predefined client APIs that you can interact with to use KIE Server services. You can extend the KIE Server client with a custom client API to adapt KIE Server services to your business needs.</simpara>
<simpara>As an example, this procedure adds a custom client API to KIE Server to accommodate a custom data transport (configured previously for this scenario) that is based on Apache MINA, an open-source Java network-application framework.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>Create an empty Maven project and define the following packaging type and dependencies in the <literal>pom.xml</literal> file for the project:</simpara>
<formalpara>
<title>Example pom.xml file in the sample project</title>
<para>
<programlisting language="xml" linenumbering="unnumbered">&lt;packaging&gt;jar&lt;/packaging&gt;

&lt;properties&gt;
   &lt;version.org.kie&gt;7.48.0.Final-redhat-00002&lt;/version.org.kie&gt;
 &lt;/properties&gt;

 &lt;dependencies&gt;
   &lt;dependency&gt;
     &lt;groupId&gt;org.kie.server&lt;/groupId&gt;
     &lt;artifactId&gt;kie-server-api&lt;/artifactId&gt;
     &lt;version&gt;${version.org.kie}&lt;/version&gt;
   &lt;/dependency&gt;
   &lt;dependency&gt;
      &lt;groupId&gt;org.kie.server&lt;/groupId&gt;
      &lt;artifactId&gt;kie-server-client&lt;/artifactId&gt;
      &lt;version&gt;${version.org.kie}&lt;/version&gt;
    &lt;/dependency&gt;
   &lt;dependency&gt;
     &lt;groupId&gt;org.drools&lt;/groupId&gt;
     &lt;artifactId&gt;drools-compiler&lt;/artifactId&gt;
     &lt;version&gt;${version.org.kie}&lt;/version&gt;
   &lt;/dependency&gt;
 &lt;/dependencies&gt;</programlisting>
</para>
</formalpara>
</listitem>
<listitem>
<simpara>Implement the relevant <literal>ServicesClient</literal> interface in a Java class in your project, as shown in the following example:</simpara>
<formalpara>
<title>Sample <literal>RulesMinaServicesClient</literal> interface</title>
<para>
<programlisting language="java" linenumbering="unnumbered">public interface RulesMinaServicesClient extends RuleServicesClient {

}</programlisting>
</para>
</formalpara>
<simpara>A specific interface is required because you must register client implementations based on the interface, and you can have only one implementation for a given interface.</simpara>
<simpara>For this example, the custom MINA-based data transport uses the <literal>Drools</literal> extension, so this example <literal>RulesMinaServicesClient</literal> interface extends the existing <literal>RuleServicesClient</literal> client API from the <literal>Drools</literal> extension.</simpara>
</listitem>
<listitem>
<simpara>Implement the <literal>RulesMinaServicesClient</literal> interface that the KIE Server can use to provide the additional client functionality for the new MINA transport, as shown in the following example:</simpara>
<formalpara>
<title>Sample implementation of the <literal>RulesMinaServicesClient</literal> interface</title>
<para>
<programlisting language="java" linenumbering="unnumbered">public class RulesMinaServicesClientImpl implements RulesMinaServicesClient {

    private String host;
    private Integer port;

    private Marshaller marshaller;

    public RulesMinaServicesClientImpl(KieServicesConfiguration configuration, ClassLoader classloader) {
        String[] serverDetails = configuration.getServerUrl().split(":");

        this.host = serverDetails[0];
        this.port = Integer.parseInt(serverDetails[1]);

        this.marshaller = MarshallerFactory.getMarshaller(configuration.getExtraJaxbClasses(), MarshallingFormat.JSON, classloader);
    }

    public ServiceResponse&lt;String&gt; executeCommands(String id, String payload) {

        try {
            String response = sendReceive(id, payload);
            if (response.startsWith("{")) {
                return new ServiceResponse&lt;String&gt;(ResponseType.SUCCESS, null, response);
            } else {
                return new ServiceResponse&lt;String&gt;(ResponseType.FAILURE, response);
            }
        } catch (Exception e) {
            throw new KieServicesException("Unable to send request to KIE Server", e);
        }
    }

    public ServiceResponse&lt;String&gt; executeCommands(String id, Command&lt;?&gt; cmd) {
        try {
            String response = sendReceive(id, marshaller.marshall(cmd));
            if (response.startsWith("{")) {
                return new ServiceResponse&lt;String&gt;(ResponseType.SUCCESS, null, response);
            } else {
                return new ServiceResponse&lt;String&gt;(ResponseType.FAILURE, response);
            }
        } catch (Exception e) {
            throw new KieServicesException("Unable to send request to KIE Server", e);
        }
    }

    protected String sendReceive(String containerId, String content) throws Exception {

        // Flatten the content to be single line:
        content = content.replaceAll("\\n", "");

        Socket minaSocket = null;
        PrintWriter out = null;
        BufferedReader in = null;

        StringBuffer data = new StringBuffer();
        try {
            minaSocket = new Socket(host, port);
            out = new PrintWriter(minaSocket.getOutputStream(), true);
            in = new BufferedReader(new InputStreamReader(minaSocket.getInputStream()));

            // Prepare and send data:
            out.println(containerId + "|" + content);
            // Wait for the first line:
            data.append(in.readLine());
            // Continue as long as data is available:
            while (in.ready()) {
                data.append(in.readLine());
            }

            return data.toString();
        } finally {
            out.close();
            in.close();
            minaSocket.close();
        }
    }
}</programlisting>
</para>
</formalpara>
<simpara>This example implementation specifies the following data and behavior:</simpara>
<itemizedlist>
<listitem>
<simpara>Uses socket-based communication for simplicity</simpara>
</listitem>
<listitem>
<simpara>Relies on default configurations from the KIE Server client and uses <literal>ServerUrl</literal> for providing the host and port of the MINA server</simpara>
</listitem>
<listitem>
<simpara>Specifies JSON as the marshalling format</simpara>
</listitem>
<listitem>
<simpara>Requires received messages to be JSON objects that start with an open bracket <literal>{</literal></simpara>
</listitem>
<listitem>
<simpara>Uses direct socket communication with a blocking API while waiting for the first line of the response and then reads all lines that are available</simpara>
</listitem>
<listitem>
<simpara>Does not use <emphasis>stream mode</emphasis> and therefore disconnects the KIE Server session after invoking a command</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>Implement the <literal>org.kie.server.client.helper.KieServicesClientBuilder</literal> interface in a Java class in your project, as shown in the following example:</simpara>
<formalpara>
<title>Sample implementation of the <literal>KieServicesClientBuilder</literal> interface</title>
<para>
<programlisting language="java" linenumbering="unnumbered">public class MinaClientBuilderImpl implements KieServicesClientBuilder {  <co xml:id="CO7-1"/>

    public String getImplementedCapability() {  <co xml:id="CO7-2"/>
        return "BRM-Mina";
    }

    public Map&lt;Class&lt;?&gt;, Object&gt; build(KieServicesConfiguration configuration, ClassLoader classLoader) {  <co xml:id="CO7-3"/>
        Map&lt;Class&lt;?&gt;, Object&gt; services = new HashMap&lt;Class&lt;?&gt;, Object&gt;();

        services.put(RulesMinaServicesClient.class, new RulesMinaServicesClientImpl(configuration, classLoader));

        return services;
    }

}</programlisting>
</para>
</formalpara>
<calloutlist>
<callout arearefs="CO7-1">
<para>Enables you to provide additional client APIs to the generic KIE Server client infrastructure</para>
</callout>
<callout arearefs="CO7-2">
<para>Defines the KIE Server capability (extension) that the client uses</para>
</callout>
<callout arearefs="CO7-3">
<para>Provides a map of the client implementations, where the key is the interface and the value is the fully initialized implementation</para>
</callout>
</calloutlist>
</listitem>
<listitem>
<simpara>To make the new client API discoverable for the KIE Server client, create a <literal>META-INF/services/org.kie.server.client.helper.KieServicesClientBuilder</literal> file in your Maven project and add the fully qualified class name of the <literal>KieServicesClientBuilder</literal> implementation class within the file. For this example, the file contains the single line <literal>org.kie.server.ext.mina.client.MinaClientBuilderImpl</literal>.</simpara>
</listitem>
<listitem>
<simpara>Build your project and copy the resulting JAR file into the <literal>~/kie-server.war/WEB-INF/lib</literal> directory of your project.
For example, on Red Hat JBoss EAP, the path to this directory is <literal><emphasis>EAP_HOME</emphasis>/standalone/deployments/kie-server.war/WEB-INF/lib</literal>.</simpara>
</listitem>
<listitem>
<simpara>Start the KIE Server and deploy the built project to the running KIE Server. You can deploy the project using either the Business Central interface or the KIE Server REST API (a <literal>PUT</literal> request to <literal>http://SERVER:PORT/kie-server/services/rest/server/containers/{containerId}</literal>).</simpara>
<simpara>After your project is deployed on a running KIE Server, you can start interacting with your new KIE Server client. You use your new client in the same way as the standard KIE Server client, by creating the client configuration and client instance, retrieving the service client by type, and invoking client methods.</simpara>
<simpara>For this example, you can create a <literal>RulesMinaServiceClient</literal> client instance and invoke operations on KIE Server through the MINA transport:</simpara>
<formalpara>
<title>Sample implementation to create the <literal>RulesMinaServiceClient</literal> client</title>
<para>
<programlisting language="java" linenumbering="unnumbered">protected RulesMinaServicesClient buildClient() {
    KieServicesConfiguration configuration = KieServicesFactory.newRestConfiguration("localhost:9123", null, null);
    List&lt;String&gt; capabilities = new ArrayList&lt;String&gt;();
    // Explicitly add capabilities (the MINA client does not respond to `get-server-info` requests):
    capabilities.add("BRM-Mina");

    configuration.setCapabilities(capabilities);
    configuration.setMarshallingFormat(MarshallingFormat.JSON);

    configuration.addJaxbClasses(extraClasses);

    KieServicesClient kieServicesClient =  KieServicesFactory.newKieServicesClient(configuration);

    RulesMinaServicesClient rulesClient = kieServicesClient.getServicesClient(RulesMinaServicesClient.class);

    return rulesClient;
}</programlisting>
</para>
</formalpara>
<formalpara>
<title>Sample configuration to invoke operations on KIE Server through the MINA transport</title>
<para>
<programlisting language="java" linenumbering="unnumbered">RulesMinaServicesClient rulesClient = buildClient();

List&lt;Command&lt;?&gt;&gt; commands = new ArrayList&lt;Command&lt;?&gt;&gt;();
BatchExecutionCommand executionCommand = commandsFactory.newBatchExecution(commands, "defaultKieSession");

Person person = new Person();
person.setName("mary");
commands.add(commandsFactory.newInsert(person, "person"));
commands.add(commandsFactory.newFireAllRules("fired"));

ServiceResponse&lt;String&gt; response = rulesClient.executeCommands(containerId, executionCommand);
Assert.assertNotNull(response);

Assert.assertEquals(ResponseType.SUCCESS, response.getType());

String data = response.getResult();

Marshaller marshaller = MarshallerFactory.getMarshaller(extraClasses, MarshallingFormat.JSON, this.getClass().getClassLoader());

ExecutionResultImpl results = marshaller.unmarshall(data, ExecutionResultImpl.class);
Assert.assertNotNull(results);

Object personResult = results.getValue("person");
Assert.assertTrue(personResult instanceof Person);

Assert.assertEquals("mary", ((Person) personResult).getName());
Assert.assertEquals("JBoss Community", ((Person) personResult).getAddress());
Assert.assertEquals(true, ((Person) personResult).isRegistered());</programlisting>
</para>
</formalpara>
</listitem>
</orderedlist>
</section>
</chapter>
<chapter xml:id="performance-tuning-kie-server-ref_execution-server">
<title>Performance tuning considerations with KIE Server</title>
<simpara>The following key concepts or suggested practices can help you optimize KIE Server performance. These concepts are summarized in this section as a convenience and are explained in more detail in the cross-referenced documentation, where applicable. This section will expand or change as needed with new releases of Red Hat Process Automation Manager.</simpara>
<variablelist>
<varlistentry>
<term>Ensure that development mode is enabled during development</term>
<listitem>
<simpara>You can set KIE Server or specific projects in Business Central to use <literal>production</literal> mode or <literal>development</literal> mode. By default, KIE Server and all new projects in Business Central are in development mode. This mode provides features that facilitate your development experience, such as flexible project deployment policies, and features that optimize KIE Server performance during development, such as disabled duplicate GAV detection. Use development mode until your Red Hat Process Automation Manager environment is established and completely ready for production mode.</simpara>
<simpara>For more information about configuring the environment mode or duplicate GAV detection, see the following resources:</simpara>
<itemizedlist>
<listitem>
<simpara><xref linkend="configuring-environment-mode-proc_execution-server"/></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#project-duplicate-GAV-con_packaging-deploying"><emphasis>Packaging and deploying a Red Hat Process Automation Manager project</emphasis></link></simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>Adapt KIE Server capabilities and extensions to your specific needs</term>
<listitem>
<simpara>The capabilities in KIE Server are determined by plug-in extensions that you can enable, disable, or further extend to meet your business needs. By default, KIE Server extensions are exposed through REST or JMS data transports and use predefined client APIs. You can extend existing KIE Server capabilities with additional REST endpoints, extend supported transport methods beyond REST or JMS, or extend functionality in the KIE Server client.</simpara>
<simpara>This flexibility in KIE Server functionality enables you to adapt your KIE Server instances to your business needs, instead of adapting your business needs to the default KIE Server capabilities.</simpara>
<simpara>For information about enabling, disabling, or extending KIE Server capabilities, see
<xref linkend="kie-server-extensions-con_execution-server"/>.</simpara>
</listitem>
</varlistentry>
</variablelist>
</chapter>
<chapter xml:id="additional_resources" remap="_additional_resources">
<title>Additional resources</title>
<itemizedlist>
<listitem>
<simpara><link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/installing_and_configuring_red_hat_process_automation_manager#assembly-install-on-eap"><emphasis>Installing and configuring Red Hat Process Automation Manager on Red Hat JBoss EAP 7.3</emphasis></link></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/installing_and_configuring_red_hat_process_automation_manager#assembly-planning"><emphasis>Planning a Red Hat Process Automation Manager installation</emphasis></link></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/installing_and_configuring_red_hat_process_automation_manager#assembly-install-on-eap"><emphasis>Installing and configuring Red Hat Process Automation Manager on Red Hat JBoss EAP 7.3</emphasis></link></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_red_hat_process_automation_manager_on_red_hat_openshift_container_platform#assembly-openshift-operator"><emphasis>Deploying a Red Hat Process Automation Manager environment on Red Hat OpenShift Container Platform using Operators</emphasis></link></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_red_hat_process_automation_manager_on_red_hat_openshift_container_platform#assembly-openshift-templates"><emphasis>Deploying a Red Hat Process Automation Manager environment on Red Hat OpenShift Container Platform using templates</emphasis></link></simpara>
</listitem>
</itemizedlist>
</chapter>
</part>
<part xml:id="assembly-configuring-central">
<title>Configuring Business Central settings and properties</title>
<partintro>
<simpara>As an administrator, you can customize the following on the admin <emphasis role="strong">Settings</emphasis> page:</simpara>
<itemizedlist>
<listitem>
<simpara><emphasis role="strong">Roles</emphasis>: Set the home page, priority, and permissions of a role.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Groups</emphasis>: Set the home page, priority, and permissions of a group as well as create and delete groups.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Users</emphasis>: Create and delete users, add or remove groups and roles from users, and view user permissions.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Artifacts</emphasis>: View M2 repository artifacts, upload artifacts, view, and download JAR files.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Data Sources</emphasis>: Add, update, or delete data sources and database drivers.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Data Sets</emphasis>: Create, modify, or delete data sets.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Projects</emphasis>: View and edit project preferences such as file export properties, space properties, default values, and advanced GAV properties.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Artifact Repository</emphasis>: Manage artifact repository properties.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Languages</emphasis>: Set the Business Central language.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Process Administration</emphasis>: Set the default pagination option in Business Central.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Process Designer</emphasis>: Set diagram editor properties.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">SSH Keys</emphasis>: Add or delete SSH keys.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Service Tasks Administration</emphasis>: Enable or disable default service tasks and upload custom service tasks.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Profiles</emphasis>: Set the workbench profile as <emphasis role="strong">Planner and Rules</emphasis> or <emphasis role="strong">Full</emphasis>.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Archetype</emphasis>: View, add, validate, set as default, and delete the archetypes. Used as a template when creating a new project in Business Central.</simpara>
</listitem>
</itemizedlist>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>Red Hat JBoss Enterprise Application Platform 7.3.4 is installed. For more information, see <link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.3/html-single/installation_guide/"><emphasis>Red Hat JBoss Enterprise Application Platform 7.3 Installation Guide</emphasis></link>.</simpara>
</listitem>
<listitem>
<simpara>Red Hat Process Automation Manager is installed and running. For more information, see <link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/installing_and_configuring_red_hat_process_automation_manager#assembly-install-on-eap"><emphasis>Installing and configuring Red Hat Process Automation Manager on Red Hat JBoss EAP 7.3</emphasis></link>.</simpara>
</listitem>
<listitem>
<simpara>You are logged in to Business Central with the <literal>admin</literal> user role.</simpara>
</listitem>
</itemizedlist>
</partintro>
<chapter xml:id="managing-business-central-user-management-con">
<title>User management</title>
<simpara>Business Central defines three types of entities for security management: users, groups, and roles. You can assign permissions to both roles and groups. You can assign the following roles in Business Central:</simpara>
<itemizedlist>
<listitem>
<simpara>process-admin</simpara>
</listitem>
<listitem>
<simpara>manager</simpara>
</listitem>
<listitem>
<simpara>admin</simpara>
</listitem>
<listitem>
<simpara>analyst</simpara>
</listitem>
<listitem>
<simpara>developer</simpara>
</listitem>
<listitem>
<simpara>user</simpara>
</listitem>
</itemizedlist>
<note>
<simpara>User roles in the application Role Registry have a role identifier, whereas user groups do not.</simpara>
</note>
<simpara>Use Business Central to create and manage as many users and groups as you require. A user must be assigned to at least one user-specific role to log in to Business Central. User privileges depend on permissions from the groups and roles that the user is a member of. Note that the role or group priority is considered if a user has several roles or groups assigned to it.</simpara>
<section xml:id="business-central-settings-creating-new-users-proc_configuring-central">
<title>Creating users</title>
<simpara>User privileges and settings are controlled by the roles assigned to a user and the groups that a user belongs to. You can create any number of users in Business Central.</simpara>
<note>
<simpara>Do not create a user called <literal>unknown</literal> in process engine or KIE Server. The <literal>unknown</literal> user account is a reserved system name with superuser access. The <literal>unknown</literal> user account performs tasks related to the SLA violation listener when there are no users logged in.</simpara>
</note>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Users</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">New user</emphasis>, enter a user name, and then click <emphasis role="strong">Next</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>To assign roles to the user, click the <emphasis role="strong">Roles</emphasis> tab, click <emphasis role="strong">Add Roles</emphasis>, select the desired roles, and click <emphasis role="strong">Add to selected roles</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Optional: To assign groups to the user, click the <emphasis role="strong">Groups</emphasis> tab, click <emphasis role="strong">Add to groups</emphasis>, select the desired groups, and click <emphasis role="strong">Add to selected groups</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Create</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Yes</emphasis> to set a password for the user, enter a desired password, and click <emphasis role="strong">Change</emphasis>.</simpara>
</listitem>
</orderedlist>
<note>
<simpara>The user must have at least one role to access Business Central.</simpara>
</note>
</section>
<section xml:id="managing-business-central-editing-users-proc">
<title>Editing users</title>
<simpara>You can change the group and role of a user using the <emphasis role="strong">Users</emphasis> option on the Business Central <emphasis role="strong">Settings</emphasis> page. All user permissions are based on the group and role permissions of the user. You can view the user permissions from the <emphasis role="strong">Permissions</emphasis> tab.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Users</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>From the <emphasis role="strong">All users</emphasis> list, click the user you want to edit. The user details display in the right pane.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Edit</emphasis> to perform any of the following tasks:</simpara>
<itemizedlist>
<listitem>
<simpara>To change the groups of a user, click the <emphasis role="strong">Groups</emphasis> tab, click <emphasis role="strong">Add to groups</emphasis>, select the groups you want the user to be part of, click <emphasis role="strong">Add to selected groups</emphasis>, and click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>To change the roles of a user, click the <emphasis role="strong">Roles</emphasis> tab, click <emphasis role="strong">Add roles</emphasis>, select the roles you want to assign to the user, click <emphasis role="strong">Add to selected roles</emphasis>, and click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>To view the user permissions, click the <emphasis role="strong">Permissions</emphasis> tab and expand the attributes.</simpara>
</listitem>
<listitem>
<simpara>To change the password, click <emphasis role="strong">Change Password</emphasis>, enter the new password, and click <emphasis role="strong">Change</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>To delete the user, click <emphasis role="strong">Delete</emphasis> and then click <emphasis role="strong">Yes</emphasis> to confirm removal.</simpara>
</listitem>
</itemizedlist>
</listitem>
</orderedlist>
</section>
<section xml:id="managing-business-central-creating-new-groups-proc">
<title>Creating groups</title>
<simpara>In Business Central, you can use groups to control permissions for a collection of users. You can create as many groups as you want but a group must have at least one user.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Groups</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">New group</emphasis>, enter a group name, and then click <emphasis role="strong">Next</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Select the users that you want to add to this group, and then click <emphasis role="strong">Add selected users</emphasis>.</simpara>
<simpara>The newly created group is listed under <emphasis role="strong">All groups</emphasis>.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="managing-business-central-editing-groups-proc">
<title>Editing groups</title>
<simpara>You can edit the attribute of a group such as home page, priority, and permissions according to your requirements. From the <emphasis role="strong">Groups</emphasis> option on the Business Central <emphasis role="strong">Settings</emphasis> page, you can modify or delete a group.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Groups</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>From the <emphasis role="strong">All groups</emphasis> list, click the group that you want to edit. The user details display in the right pane.</simpara>
</listitem>
<listitem>
<simpara>Select the home page from the <emphasis role="strong">Home Page</emphasis> list.</simpara>
</listitem>
<listitem>
<simpara>Select the priority from the <emphasis role="strong">Priority</emphasis> list.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">Permissions</emphasis> section, expand the resource attribute and change its permission.</simpara>
<note>
<simpara>You can add exceptions to <emphasis role="strong">Pages</emphasis>, <emphasis role="strong">Editor</emphasis>, <emphasis role="strong">Spaces</emphasis>, and <emphasis role="strong">Projects</emphasis> permissions.</simpara>
</note>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis> to apply the changes.</simpara>
</listitem>
</orderedlist>
</section>
</chapter>
<chapter xml:id="business-central-settings-security-proc_configuring-central">
<title>Security management</title>
<simpara>You can perform security and permission management tasks from the <emphasis role="strong">Security management</emphasis> page. To access the <emphasis role="strong">Security management</emphasis> page, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and click <emphasis role="strong">Roles</emphasis>, <emphasis role="strong">Groups</emphasis>, or <emphasis role="strong">Users</emphasis> on the Business Central <emphasis role="strong">Settings</emphasis> page. Depending on which icon you click, the <emphasis role="strong">Security management</emphasis> page opens for the respective tab. Use roles and groups to manage privileges and settings for users. Any changes apply to all users with the affected role or group.</simpara>
<section xml:id="business-central-settings-changing-permissions-proc_configuring-central">
<title>Changing permissions for groups and roles</title>
<simpara>You cannot change permissions for an individual user. However, you can change permissions for groups and roles. The changed permissions apply to users that have the role or belong to the group that you changed.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Roles</emphasis> or <emphasis role="strong">Groups</emphasis> to open the corresponding list.</simpara>
</listitem>
<listitem>
<simpara>From the list, click the role or group you want to edit. All details are displayed in the right pane.</simpara>
</listitem>
<listitem>
<simpara>Set the <emphasis role="strong">Home Page</emphasis> or <emphasis role="strong">Priority</emphasis> under the <emphasis role="strong">Settings</emphasis> section.</simpara>
</listitem>
<listitem>
<simpara>Set the Business Central, page, editor, space, and project permissions under the <emphasis role="strong">Permissions</emphasis> section.</simpara>
<simpara>You can expand the resource type whose permissions you want to change.</simpara>
</listitem>
<listitem>
<simpara>Optional: To add an item not listed, click <emphasis role="strong">Add Exception</emphasis> and then set the permissions as required.</simpara>
<note>
<simpara>You cannot add an exception to the Business Central resource type.</simpara>
</note>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
</orderedlist>
<note>
<simpara>Any changes you make to roles or groups affect all of the users associated with that role or group.</simpara>
</note>
</section>
</chapter>
<chapter xml:id="managing-business-central-artifacts-con">
<title>Artifact management</title>
<simpara>You can manage artifacts from the <emphasis role="strong">Artifacts</emphasis> page in Business Central. The artifact repository is a local Maven repository and there is only one Maven repository for each installation. Business Central recommends using Maven repository solutions like <emphasis>Sonatype Nexus™</emphasis>, <emphasis>Apache Archiva™</emphasis>, or <emphasis>JFrog Artifactory™</emphasis>.</simpara>
<simpara>The <emphasis role="strong">Artifacts</emphasis> page lists all the artifacts in the Maven repository. You can upload artifacts to the Maven repository.</simpara>
<note>
<simpara>You can only upload JAR, KJAR, and <literal>pom.xml</literal> files to the <emphasis role="strong">Artifacts</emphasis> repository.</simpara>
</note>
<section xml:id="managing-business-central-view-artifacts-proc">
<title>Viewing an artifact</title>
<simpara>You can view all the content of the local maven repository from the <emphasis role="strong">Artifacts</emphasis> page.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Artifacts</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Open</emphasis> to view the artifact details.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Ok</emphasis> to go back to the <emphasis role="strong">Artifacts</emphasis> page.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="managing-business-central-download-artifacts-proc">
<title>Downloading an artifact</title>
<simpara>You can download and save an artifact from Business Central repository to the local storage of a project.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Artifacts</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Download</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Browse to the directory where you want to save the artifact.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="managing-business-central-upload-artifacts-proc">
<title>Uploading an artifact</title>
<simpara>You can upload an artifact from the local storage to a project in Business Central.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Artifacts</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Upload</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Choose File</emphasis> and browse to the directory from where you want to upload the artifact.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Upload</emphasis>.</simpara>
<note>
<simpara>If you are using a non-Maven artifact, first deploy the artifact to the Maven repository using the <literal>mvn deploy</literal> command and then refresh the artifact list in Business Central.</simpara>
</note>
</listitem>
</orderedlist>
</section>
</chapter>
<chapter xml:id="managing-business-central-data-sources-con">
<title>Data source management</title>
<simpara>Business Central provides data source management features that enable you to define data sources for accessing a database. These data sources are then used by other Business Central components such as the data sets. A database driver enables communication between a data source and the targeted database.</simpara>
<simpara>From the <emphasis role="strong">Data Source Authoring</emphasis> page you can add data sources and database drivers to Business Central.</simpara>
<note>
<simpara>Business Central provides a default data source that can be used but cannot be edited or deleted.</simpara>
</note>
<section xml:id="managing-business-central-adding-database-driver-proc">
<title>Adding a database driver</title>
<simpara>You can add a new database driver to Business Central.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Data Sources</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">DataSource Explorer</emphasis> pane, click <emphasis role="strong">Add Driver</emphasis>. The <emphasis role="strong">New driver</emphasis> window opens.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">New driver</emphasis> window, enter the <emphasis role="strong">Name</emphasis>, <emphasis role="strong">Driver Class Name</emphasis>, <emphasis role="strong">Group Id</emphasis>, <emphasis role="strong">Artifact Id</emphasis>, and <emphasis role="strong">Version</emphasis> of the database driver.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Finish</emphasis> to add the driver to Business Central.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="managing-business-central-editing-database-driver-proc">
<title>Editing a database driver</title>
<simpara>You can update the properties of a database driver from the <emphasis role="strong">Driver Definition</emphasis> pane.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Data Sources</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">DataSource Explorer</emphasis> pane, select the driver you want to edit.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">Driver Definition</emphasis> pane, make the necessary changes to the <emphasis role="strong">Name</emphasis>, <emphasis role="strong">Driver Class Name</emphasis>, <emphasis role="strong">Group Id</emphasis>, <emphasis role="strong">Artifact Id</emphasis>, and the <emphasis role="strong">Version</emphasis> fields.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Update</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Yes</emphasis> to save the changes to the driver.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="managing-business-central-deleting-database-driver-proc">
<title>Deleting a database driver</title>
<simpara>You can remove database drivers from the <emphasis role="strong">Data Source Definition</emphasis> pane of Business Central.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Data Sources</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">DataSource Explorer</emphasis> pane, select the driver you want to delete.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Remove</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Delete</emphasis> to delete the driver.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="managing-business-central-adding-data-sources-proc">
<title>Adding a data source</title>
<simpara>You can add a new data source to Business Central from the <emphasis role="strong">Data Sources Authoring</emphasis> page.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Data Sources</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">DataSource Explorer</emphasis> pane, click <emphasis role="strong">Add DataSource</emphasis>. The <emphasis role="strong">New data source</emphasis> window opens.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">New data source</emphasis> window, enter the data source <emphasis role="strong">Name</emphasis>, database <emphasis role="strong">Connection URL</emphasis>, <emphasis role="strong">User</emphasis> and <emphasis role="strong">Password</emphasis>, and <emphasis role="strong">Driver</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Test Connection</emphasis> to verify the connection to the database.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Finish</emphasis> to add the data source to Business Central.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="managing-business-central-editing-data-sources-proc">
<title>Editing a data source</title>
<simpara>You can edit the properties of a data source and also test its connection to the database in Business Central.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Data Sources</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">DataSource Explorer</emphasis> pane, click the data source you want to edit.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">Data Source Definition</emphasis> pane, make the necessary changes to the <emphasis role="strong">Name</emphasis>, <emphasis role="strong">Connection URL</emphasis>, <emphasis role="strong">User</emphasis>, <emphasis role="strong">Password</emphasis>, and the <emphasis role="strong">Driver</emphasis> fields.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Test Connection</emphasis> to verify the connection to the database.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Update</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis> to confirm the changes to the data source.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="managing-business-central-deleting-data-sources-proc">
<title>Deleting a data source</title>
<simpara>You can delete an existing data source from the <emphasis role="strong">DataSource Explorer</emphasis> pane in Business Central.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Data Sources</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">DataSource Explorer</emphasis> pane, click the data source you want to delete.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Remove</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Delete</emphasis> to confirm the deletion of the data source.</simpara>
</listitem>
</orderedlist>
</section>
</chapter>
<chapter xml:id="data_sets_con_configuring-central">
<title>Data sets authoring</title>
<simpara>A data set is a collection of related sets of information. It can be stored in many ways, such as in a database, in a Microsoft Excel file, or in memory. A data set definition instructs Business Central methods to access, read, and parse a data set. Business Central does not store data. It enables you to define access to a data set regardless of where the data is stored.</simpara>
<simpara>For example, if data is stored in a database, a valid data set could contain the entire database or a subset of the database as a result of an SQL query. In both cases, the data is used as input for the reporting components of Business Central which then displays the information.</simpara>
<simpara>To access a data set, you must create and register a data set definition. This data set definition specifies the location of the data set, the ways to access it, read it, and parse it, and the columns that it contains.</simpara>
<note>
<simpara>The <emphasis role="strong">Data Sets</emphasis> page is visible only to users with the <emphasis role="strong">admin</emphasis> role.</simpara>
</note>
<section xml:id="data_sets_add_proc_configuring-central">
<title>Adding data sets</title>
<simpara>You can create a data set to fetch data from an external data source and use that data for the reporting components.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, go to <emphasis role="strong">Admin</emphasis> → <emphasis role="strong">Data Sets</emphasis>. The <emphasis role="strong">Data Set Explorer</emphasis> page opens.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">New Data Set</emphasis> and select one of the following provider types:</simpara>
<itemizedlist>
<listitem>
<simpara><emphasis role="strong">Bean:</emphasis> Use to generate a data set from a Java class</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">CSV:</emphasis> Use to generate a data set from a remote or local CSV file</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">SQL:</emphasis> Use to generate a data set from an ANSI-SQL compliant database</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Elastic Search:</emphasis> Use to generate a data set from Elastic Search nodes</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Execution Server:</emphasis> Use to generate a data set using the custom query feature of an Execution Server</simpara>
<note>
<simpara><emphasis role="strong">KIE Server</emphasis> must be configured with this option.</simpara>
</note>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>Complete the <emphasis role="strong">Data Set Creation Wizard</emphasis> and click <emphasis role="strong">Test</emphasis>.</simpara>
<note>
<simpara>The configuration steps differ based on the provider you chose.</simpara>
</note>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="data_sets_edit_proc_configuring-central">
<title>Editing data sets</title>
<simpara>You can edit existing data sets to ensure that the data fetched to the reporting components is up-to-date.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, go to <emphasis role="strong">Admin</emphasis> → <emphasis role="strong">Data Sets</emphasis>. The <emphasis role="strong">Data Set Explorer</emphasis> page opens.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">Data Set Explorer</emphasis> pane, search for the data set you want to edit and click <emphasis role="strong">Edit</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">Data Set Editor</emphasis> pane, use the appropriate tab to edit the data as required. The tabs differ based on the data set provider type you chose.</simpara>
<simpara>For example, the following changes are applicable for editing a <emphasis role="strong">CSV</emphasis> data provider:</simpara>
<itemizedlist>
<listitem>
<simpara><emphasis role="strong">CSV Configuration:</emphasis> Enables you to change the name of the data set definition, the source file, the separator, and other properties.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Preview:</emphasis> Enables you to preview the data. After you click <emphasis role="strong">Test</emphasis> in the <emphasis role="strong">CSV Configuration</emphasis> tab, the system executes the data set lookup call and if the data is available, a preview appears. Note that the <emphasis role="strong">Preview</emphasis> tab has two sub-tabs:</simpara>
<itemizedlist>
<listitem>
<simpara><emphasis role="strong">Data columns:</emphasis> Enables you to specify what columns are part of your data set definition.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Filter:</emphasis> Enables you to add a new filter.</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara><emphasis role="strong">Advanced:</emphasis> Enables you to manage the following configurations:</simpara>
<itemizedlist>
<listitem>
<simpara><emphasis role="strong">Caching:</emphasis> See <xref linkend="data_sets_caching_con_building-custom-dashboard-widgets"/> for more information.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Cache life-cycle</emphasis> Enables you to specify an interval of time after which a data set (or data) is refreshed. The <emphasis role="strong">Refresh on stale data</emphasis> feature refreshes the cached data when the back-end data changes.</simpara>
</listitem>
</itemizedlist>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>After making the required changes, click <emphasis role="strong">Validate</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="data_sets_refresh_con_configuring-central">
<title>Data refresh</title>
<simpara>The data refresh feature enables you to specify an interval of time after which a data set (or data) is refreshed.
The <emphasis role="strong">Refresh on stale data</emphasis> feature refreshes the cached data when the back-end data changes.</simpara>
</section>
<section xml:id="data_sets_caching_con_configuring-central">
<title>Caching</title>
<simpara>Business Central provides caching mechanisms for storing data sets and performing data operations using in-memory data. Caching data reduces network traffic, remote system payload, and processing time. To avoid performance issues, configure the cache settings in Business Central.</simpara>
<simpara>For any data lookup call that results in a data set, the caching method determines where the data lookup call is executed and where the resulting data set is stored. An example of a data lookup call would be all the mortgage applications whose locale parameter is set as "Urban".</simpara>
<simpara>Business Central data set functionality provides two cache levels:</simpara>
<itemizedlist>
<listitem>
<simpara>Client level</simpara>
</listitem>
<listitem>
<simpara>Back-end level</simpara>
</listitem>
</itemizedlist>
<bridgehead xml:id="client_cache" renderas="sect3" remap="_client_cache">Client cache</bridgehead>
<simpara>When the cache is turned on, the data set is cached in a web browser during the lookup operation and further lookup operations do not perform requests to the back-end. Data set operations like grouping, aggregations, filtering, and sorting are processed in the web browser. Enable client caching only if the data set size is small, for example, for data sets with less than 10 MB of data. For large data sets, browser issues such as slow performance or intermittent freezing can occur. Client caching reduces the number of back-end requests including requests to the storage system.</simpara>
<bridgehead xml:id="back_end_cache" renderas="sect3" remap="_back_end_cache">Back-end cache</bridgehead>
<simpara>When the cache is enabled, the decision engine caches the data set. This reduces the number of back-end requests to the remote storage system. All data set operations are performed in the decision engine using in-memory data. Enable back-end caching only if the data set size is not updated frequently and it can be stored and processed in memory. Using back-end caching is also useful in cases with low latency connectivity issues with the remote storage.</simpara>
<note>
<simpara>Back-end cache settings are not always visible in the <emphasis role="strong">Advanced</emphasis> tab of the <emphasis role="strong">Data Set Editor</emphasis> because Java and CSV data providers rely on back-end caching (data set must be in the memory) in order to resolve any data lookup operation using the in-memory decision engine.</simpara>
</note>
</section>
</chapter>
<chapter xml:id="managing-business-central-archetype-con">
<title>Archetype management</title>
<simpara>Business Central provides an archetype management feature that enables you to list, add, validate, set as default, and delete the archetypes. You can manage archetypes from the <emphasis role="strong">Archetypes</emphasis> page in Business Central. Archetypes are projects that are installed in Apache Maven repositories in which a template structure is set or can be created if required.</simpara>
<simpara>For the most up-to-date and detailed information about archetypes, see the <link xlink:href="https://maven.apache.org/guides/introduction/introduction-to-archetypes.html">Introduction to Archetypes page</link>.</simpara>
<section xml:id="managing-business-central-listing-archetype-proc">
<title>Listing archetypes</title>
<simpara>The <emphasis role="strong">Archetypes</emphasis> page lists all the archetypes that are added in Business Central. This list provides the detailed information about <emphasis role="strong">Group ID</emphasis>, <emphasis role="strong">Artifact ID</emphasis>, <emphasis role="strong">Version</emphasis>, <emphasis role="strong">Created Date</emphasis>, <emphasis role="strong">Status</emphasis>, and <emphasis role="strong">Actions</emphasis> of an archetype.</simpara>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>You have created an archetype and listed it in the Business Central <emphasis role="strong">Settings</emphasis> from the maven repository.</simpara>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Archetypes</emphasis>.</simpara>
<simpara>In the <emphasis role="strong">Status</emphasis> column, green icon indicates it is a valid archetype, red icon indicates it is an invalid archetype whereas blue icon indicates the corresponding archetype is the default one for the new spaces.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="managing-business-central-adding-archetype-proc">
<title>Adding an archetype</title>
<simpara>You can add a new archetype to Business Central.</simpara>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>You have installed an archetype in the Maven repository.</simpara>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Archetypes</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Add Archetype</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">Add Archetype</emphasis> panel, enter the GAV attributes in the <emphasis role="strong">Group ID</emphasis>, <emphasis role="strong">Artifact ID</emphasis>, and <emphasis role="strong">Version</emphasis> fields respectively.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Add</emphasis>.</simpara>
</listitem>
</orderedlist>
<simpara>Business Central validates the newly added archetype and make it available to be used as a template in all the spaces.</simpara>
</section>
<section xml:id="managing-business-central-additional-features-archetype-proc">
<title>Managing additional features of an archetype</title>
<simpara>You can delete, set a default, and validate the archetypes from the <emphasis role="strong">Archetypes</emphasis> page in Business Central.</simpara>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>You have created an archetype and listed in the Business Central <emphasis role="strong">Settings</emphasis> from the Maven repository.</simpara>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Archetypes</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>From the <emphasis role="strong">Actions</emphasis> column, click the <inlinemediaobject>
<imageobject>
<imagedata fileref="images/_images/project-data/dots.png"/>
</imageobject>
<textobject><phrase>dots</phrase></textobject>
</inlinemediaobject> icon on the right side of an archetype.</simpara>
<itemizedlist>
<listitem>
<simpara>Select <emphasis role="strong">Delete</emphasis> from the drop-down menu to delete an archetype from the list.</simpara>
</listitem>
<listitem>
<simpara>Select <emphasis role="strong">Validate</emphasis> from the drop-down menu to validate whether the archetype is valid or not.</simpara>
<note>
<simpara>When the Business Central is starting up, all the registered archetypes are automatically validated.</simpara>
</note>
</listitem>
<listitem>
<simpara>Select <emphasis role="strong">Set as default</emphasis> from the drop-down menu to set an archetype as a default for the new spaces.</simpara>
</listitem>
</itemizedlist>
</listitem>
</orderedlist>
</section>
<section xml:id="managing-business-central-creating-archetype-project-proc">
<title>Creating a project using archetypes</title>
<simpara>You can use archetypes to create a project in Business Central. When you create a project in Business Central, it is added to the Git repository that is connected to your Red Hat Process Automation Manager installation.</simpara>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>You have created an archetype and listed it in the Business Central <emphasis role="strong">Settings</emphasis> from the Maven repository.</simpara>
</listitem>
<listitem>
<simpara>You have set an archetype as default in your space in the Business Central.</simpara>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, go to <emphasis role="strong">Menu</emphasis> → <emphasis role="strong">Design</emphasis> → <emphasis role="strong">Projects</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Select or create the space into which you want to add a new project from an archetype template.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Add Project</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Type the project name and description in the <emphasis role="strong">Name</emphasis> and <emphasis role="strong">Description</emphasis> fields respectively.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Configure Advanced Options</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Select the <emphasis role="strong">Based on template</emphasis> check box.</simpara>
</listitem>
<listitem>
<simpara>Select the archetype from drop-down options if required. The default archetype is selected that is already set in the space.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Add</emphasis>.</simpara>
</listitem>
</orderedlist>
<simpara>The <emphasis role="strong">Assets</emphasis> view of the project opens based on the selected archetype template.</simpara>
</section>
<section xml:id="managing-business-central-archetype-space-settings-proc">
<title>Managing archetypes using space settings in Business Central</title>
<simpara>When you add the archetypes to Business Central, they can be used as a templates in all the spaces. You can manage all the archetypes from the <emphasis role="strong">Settings</emphasis> tab which is available in the space. This tab is visible only to users with the <literal>admin</literal> role.</simpara>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>You have installed an archetype in the Maven repository.</simpara>
</listitem>
<listitem>
<simpara>You have created an archetype and listed it in the Business Central <emphasis role="strong">Settings</emphasis> from the Maven repository.</simpara>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, go to <emphasis role="strong">Menu</emphasis> → <emphasis role="strong">Design</emphasis> → <emphasis role="strong">Projects</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Select or create the space into which you want to manage the archetypes. The default space is <emphasis role="strong">MySpace</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Settings</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>To include or exclude the archetypes in the space, select the <emphasis role="strong">Include</emphasis> check box.</simpara>
</listitem>
<listitem>
<simpara>From the <emphasis role="strong">Actions</emphasis> column, click the <inlinemediaobject>
<imageobject>
<imagedata fileref="images/_images/project-data/dots.png"/>
</imageobject>
<textobject><phrase>dots</phrase></textobject>
</inlinemediaobject> icon on the right side of an archetype and select <emphasis role="strong">Set as default</emphasis> from the drop-down menu to set an archetype as a default for the space.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
</orderedlist>
</section>
</chapter>
<chapter xml:id="managing-business-central-project-preferences-proc">
<title>Customizing project preferences</title>
<simpara>A project stores assets and is part of a space. A space can hold multiple projects.</simpara>
<simpara>For example, an organization has many departments, such as HR, Payroll, Engineering, R&amp;D, and so on. Each department maps to a space and every department can have its own projects.</simpara>
<simpara>You can create a new project from scratch or clone projects from an existing Git repository.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Projects</emphasis>. The <emphasis role="strong">Projects</emphasis> page opens.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">Project Preferences</emphasis> pane, click the preference you want to modify. The following preferences are available:</simpara>
<itemizedlist>
<listitem>
<simpara><emphasis role="strong">File exporting</emphasis>: This preference has the following properties:</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>File exporting properties</title>
<tgroup cols="2">
<colspec colname="col_1" colwidth="50*"/>
<colspec colname="col_2" colwidth="50*"/>
<thead>
<row>
<entry align="left" valign="top">Field</entry>
<entry align="left" valign="top">Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>PDF orientation</simpara></entry>
<entry align="left" valign="top"><simpara>Determines whether the PDF orientation is portrait or landscape.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>PDF units</simpara></entry>
<entry align="left" valign="top"><simpara>Determines whether the PDF unit is <emphasis>PT</emphasis>, <emphasis>MM</emphasis>, <emphasis>CN</emphasis> or <emphasis>IN</emphasis>.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>PDF page format</simpara></entry>
<entry align="left" valign="top"><simpara>Determines whether the PDF page format is <emphasis>A[0-10]</emphasis>, <emphasis>B[0-10]</emphasis>, or <emphasis>C[0-10]</emphasis>.</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
</listitem>
<listitem>
<simpara><emphasis role="strong">Spaces</emphasis>: This preference has the following properties:</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>Spaces properties</title>
<tgroup cols="2">
<colspec colname="col_1" colwidth="50*"/>
<colspec colname="col_2" colwidth="50*"/>
<thead>
<row>
<entry align="left" valign="top">Field</entry>
<entry align="left" valign="top">Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>Name</simpara></entry>
<entry align="left" valign="top"><simpara>The default name of the space that is created automatically if none exists.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Owner</simpara></entry>
<entry align="left" valign="top"><simpara>The default owner of the space that is created automatically if none exists.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Group ID</simpara></entry>
<entry align="left" valign="top"><simpara>The default group ID of the space that is created automatically if none exists.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Alias (in singular)</simpara></entry>
<entry align="left" valign="top"><simpara>Determines the customized alias (singular) of the space.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Alias (in plural)</simpara></entry>
<entry align="left" valign="top"><simpara>Determines the customized alias (plural) of the space.</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
</listitem>
<listitem>
<simpara><emphasis role="strong">Default values</emphasis>: This preference has the following properties:</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>Default values properties</title>
<tgroup cols="2">
<colspec colname="col_1" colwidth="50*"/>
<colspec colname="col_2" colwidth="50*"/>
<thead>
<row>
<entry align="left" valign="top">Field</entry>
<entry align="left" valign="top">Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>Version</simpara></entry>
<entry align="left" valign="top"><simpara>The default version number of a project when creating projects using the Quick setup option.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Description</simpara></entry>
<entry align="left" valign="top"><simpara>The default description of a project when creating projects using the Quick setup option.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Branch</simpara></entry>
<entry align="left" valign="top"><simpara>The default branch to be used when using a Git repository.</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
</listitem>
<listitem>
<simpara><emphasis role="strong">Advanced GAV preferences</emphasis>: This preference has the following properties:</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>Advanced GAV preference properties</title>
<tgroup cols="2">
<colspec colname="col_1" colwidth="50*"/>
<colspec colname="col_2" colwidth="50*"/>
<thead>
<row>
<entry align="left" valign="top">Field</entry>
<entry align="left" valign="top">Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>Disable GAV conflict check?</simpara></entry>
<entry align="left" valign="top"><simpara>Determines whether to enable or disable the GAV conflict check. Disabling this feature allows projects to have the same GAV (Group ID, Artifact, Version).</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Allow child GAV edition?</simpara></entry>
<entry align="left" valign="top"><simpara>Determines whether to allow child/sub-projects to have GAV edition.</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<note>
<simpara>Duplicate GAV detection is disabled for projects in <emphasis role="strong">Development Mode</emphasis>. To enable duplicate GAV detection for a project in Business Central, go to project <emphasis role="strong">Settings</emphasis> → <emphasis role="strong">General Settings</emphasis> → <emphasis role="strong">Version</emphasis> and toggle the <emphasis role="strong">Development Mode</emphasis> option to <emphasis role="strong">OFF</emphasis> (if applicable).</simpara>
</note>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
</orderedlist>
</chapter>
<chapter xml:id="managing-business-central-artifact-repository-proc">
<title>Customizing artifact repository properties</title>
<simpara>In some cases, projects need to resolve external dependencies to build domain model JAR files. A repository contains the needed artifacts and has the following features:</simpara>
<itemizedlist>
<listitem>
<simpara>The repository is a Maven repository.</simpara>
</listitem>
<listitem>
<simpara>All snapshots are time stamped.</simpara>
</listitem>
<listitem>
<simpara>Assets are stored mostly in the local hard drive.</simpara>
</listitem>
</itemizedlist>
<simpara>By default, the artifact repository is in <literal>$WORKING_DIRECTORY/repositories/kie</literal>.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Artifact Repository</emphasis>. The <emphasis role="strong">Artifact Repository</emphasis> page opens.</simpara>
</listitem>
<listitem>
<simpara>Make selections and enter information in the <emphasis role="strong">Properties</emphasis> section.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
</orderedlist>
</chapter>
<chapter xml:id="managing-business-central-languages-proc">
<title>Customizing language settings</title>
<simpara>You can change the language on the Business Central <emphasis role="strong">Settings</emphasis> page. Business Central supports the following languages:</simpara>
<itemizedlist>
<listitem>
<simpara>English</simpara>
</listitem>
<listitem>
<simpara>German</simpara>
</listitem>
<listitem>
<simpara>Spanish</simpara>
</listitem>
<listitem>
<simpara>French</simpara>
</listitem>
<listitem>
<simpara>Japanese</simpara>
</listitem>
<listitem>
<simpara>Portuguese</simpara>
</listitem>
<listitem>
<simpara>Chinese(Simplified)</simpara>
</listitem>
</itemizedlist>
<simpara>The default language is English.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Languages</emphasis>. The <emphasis role="strong">Language Selector</emphasis> window opens.</simpara>
</listitem>
<listitem>
<simpara>Select the desired language from the <emphasis role="strong">Language</emphasis> list.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Ok</emphasis>.</simpara>
</listitem>
</orderedlist>
</chapter>
<chapter xml:id="managing-business-central-process-administration-proc">
<title>Customizing process administration</title>
<simpara>You can customize the default pagination option in Business Central by editing the <emphasis role="strong">Default items per page</emphasis> property on the <emphasis role="strong">Process Administration</emphasis> page.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Process Administration</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>From the <emphasis role="strong">Properties</emphasis> section, update the <emphasis role="strong">Default items per page</emphasis> property and click <emphasis role="strong">Save</emphasis>.</simpara>
<note>
<simpara>You can specify 10, 20, 50, or 100 items to display on each page.</simpara>
</note>
</listitem>
</orderedlist>
</chapter>
<chapter xml:id="managing-business-central-process-designer-proc">
<title>Customizing the process designer</title>
<simpara>You can customize the process designer in Business Central by editing the properties of the diagram editor on the Business Central <emphasis role="strong">Settings</emphasis> page.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Process Designer</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">Properties</emphasis> section, update any of the following properties:</simpara>
<itemizedlist>
<listitem>
<simpara>Select the <emphasis role="strong">Auto hide category panel</emphasis> check box to automatically hide a category toolbar panel.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">Drawing area width</emphasis> field, enter an integer value between 2800 and 5600 to set the width of the drawing area.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">Drawing area height</emphasis> field, enter an integer value between 1400 and 2800 to set the height of the drawing area.</simpara>
</listitem>
<listitem>
<simpara>Select the <emphasis role="strong">Enable HiDPI</emphasis> check box if you are using a high resolution display and are seeing blurry text and objects. This option is disabled by default.</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
</orderedlist>
</chapter>
<chapter xml:id="managing-business-central-ssh-keys-con">
<title>SSH Keys</title>
<simpara>Business Central provides an SSH keystore service to enable user SSH authentication. Business Central provides a configurable default SSH keystore, extensible APIs (for custom implementations), and support for multiple SSH public key formats.</simpara>
<simpara>You can access the <emphasis role="strong">SSH Keys</emphasis> option on the Business Central <emphasis role="strong">Settings</emphasis> page to register your SSH public keys.</simpara>
<section xml:id="managing-business-central-ssh-keystore-default-con">
<title>Default SSH keystore</title>
<simpara>The default SSH keystore included with Business Central provides a file-based storage mechanism to store a user’s public keys. By default, Business Central uses the <literal>*.security</literal> folder as the root directory. However, you can also use a custom storage path by setting the value of the <literal>appformer.ssh.keys.storage.folder</literal> system property to point to a different folder.</simpara>
<simpara>The SSH public keys are stored in the <literal>{securityFolderPath}/pkeys/{userName}/</literal> folder structure.</simpara>
<simpara>Each SSH public key consists of the following files, located in the storage folder:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>{keyId}.pub</literal>: This file contains the SSH public key content. As the file name determines the logic key ID on the system, ensure that the file name is not modified during run time.</simpara>
<simpara>For example:</simpara>
<screen>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDmak4Wu23RZ6XmN94bOsqecZxuTa4RRhhQmHmTZjMB7HM57/90u/B/gB/GhsPEu1nAXL0npY56tT/MPQ8vRm2C2W9A7CzN5+z5yyL3W01YZy3kzslk77CjULjfhrcfQSL3b2sPG5jv5E5/nyC/swSytucwT/PE7aXTS9H6cHIKUdYPzIt94SHoBxWRIK7PJi9d+eLB+hmDzvbVa1ezu5a8yu2kcHi6NxxfI5iRj2rsceDTp0imC1jMoC6ZDfBvZSxL9FXTMwFdNnmTlJveBtv9nAbnAvIWlilS0VOkdj1s3GxBxeZYAcKbcsK9sJzusptk5dxGsG2Z8vInaglN6OaOQ7b7tcomzCYYwviGQ9gRX8sGsVrw39gsDIGYP2tA4bRr7ecHnlNg1b0HCchA5+QCDk4Hbz1UrnHmPA2Lg9c3WGm2qedvQdVJXuS3mlwYOqL40aXPs6890PvFJUlpiVSznF50djPnwsMxJZEf1HdTXgZD1Bh54ogZf7czyUNfkNkE69yJDbTHjpQd0cKUQnu9tVxqmBzhX31yF4VcsMeADcf2Z8wlA3n4LZnC/GwonYlq5+G93zJpFOkPhme8c2XuPuCXF795lsxyJ8SB/AlwPJAhEtm0y0s0l1l4eWqxsDxkBOgN+ivU0czrVMssHJEJb4o0FLf7iHhOW56/iMdD9w== userName</screen>
</listitem>
<listitem>
<simpara><literal>.{keyId}.pub.meta</literal>: This file contains the key metadata in JSON format. A new metadata file is dynamically generated if a key has no metadata.</simpara>
<simpara>For example:</simpara>
<screen>{
  "name":"Key",
  "creationDate":"Oct 10, 2018 10:10:50 PM",
  "lastTimeUsed":"Oct 11, 2018 12:11:23 PM"
}</screen>
</listitem>
</itemizedlist>
</section>
<section xml:id="managing-business-central-ssh-keystore-custom-con">
<title>Custom SSH keystore</title>
<simpara>You can extend and customize the default SSH keystore according to your requirements. Use the <literal>appformer.ssh.keystore</literal> system property to specify the Java class name of the SSH service to use. If this property is not defined or it contains an incorrect value, then the default SSH keystore is loaded.</simpara>
<note>
<simpara>To create a custom implementation of the SSH keystore, your Java class must implement the <literal>org.uberfire.ssh.service.backend.keystore.SSHKeyStore</literal> class defined in the <literal>uberfire-ssh-api</literal> module.</simpara>
</note>
</section>
<section xml:id="managing-business-central-ssh-keys-create-proc">
<title>Creating an SSH key</title>
<simpara>Before you can add or register SSH keys to Business Central, you must generate an SSH key on your system.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>Open a command terminal on your system.</simpara>
</listitem>
<listitem>
<simpara>Run the <literal>ssh-keygen</literal> command to create the SSH key as shown in the following example, where <literal>&lt;user_login&gt;</literal> is your user name:</simpara>
<screen>ssh-keygen -t rsa -b 4096 -C "&lt;user_login&gt;"</screen>
<note>
<simpara>The SSH key formats supported by Business Central keystore are <literal>ssh-rsa</literal>, <literal>ssh-dss</literal>, <literal>ecdsa-sha2-nistp256</literal>, <literal>ecdsa-sha2-nistp384</literal>, and <literal>ecdsa-sha2-nistp521</literal>.</simpara>
</note>
</listitem>
<listitem>
<simpara>When prompted, press Enter and accept the default key file location as shown in the following example, where <literal>&lt;user_login&gt;</literal> is your user name:</simpara>
<screen>Enter a file in which to save the key (/home/&lt;user_login&gt;/.ssh/id_rsa): [Press enter]</screen>
</listitem>
<listitem>
<simpara>At the command prompt, enter and confirm the passphrase:</simpara>
<screen>Enter passphrase (empty for no passphrase): [Type a passphrase]
Enter same passphrase again: [Type passphrase again]</screen>
</listitem>
<listitem>
<simpara>Start the <literal>ssh-agent</literal>:</simpara>
<screen>eval "$(ssh-agent -s)"
Agent pid &lt;any-number-here&gt;</screen>
</listitem>
<listitem>
<simpara>Add the new SSH private key to the <literal>ssh-agent</literal>. If you have used a different key name, replace <literal>id_rsa</literal> in that code:</simpara>
<screen>ssh-add ~/.ssh/id_rsa</screen>
</listitem>
</orderedlist>
</section>
<section xml:id="managing-business-central-ssh-keys-register-proc">
<title>Registering your SSH public key with the SSH keystore</title>
<simpara>You must register your newly created SSH public key with the Business Central keystore.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>Open a command terminal on your system.</simpara>
</listitem>
<listitem>
<simpara>Run the <literal>cat</literal> command as shown in the following example, where <literal>id_rsa</literal> is your key name:</simpara>
<screen>cat ~/.ssh/id_rsa.pub</screen>
</listitem>
<listitem>
<simpara>Copy the contents of your SSH public key.</simpara>
</listitem>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">SSH Keys</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>On the <emphasis role="strong">SSH Keys</emphasis> page, click <emphasis role="strong">Add SSH Key</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">Add SSH Key</emphasis> window, enter a name in the <emphasis role="strong">Name</emphasis> field and copy the contents of the SSH public key to the <emphasis role="strong">Key</emphasis> field.</simpara>
<note>
<simpara>The <emphasis role="strong">Name</emphasis> and the <emphasis role="strong">Key</emphasis> fields are mandatory.</simpara>
</note>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Add SSH Key</emphasis> to register the key.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="managing-business-central-ssh-keys-delete-proc">
<title>Deleting an SSH key</title>
<simpara>You can delete an SSH key from Business Central by from the <emphasis role="strong">SSH Keys</emphasis> page.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">SSH Keys</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>On the <emphasis role="strong">SSH Keys</emphasis> page, click the delete icon of the SSH key you want to delete.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Delete SSH Key</emphasis> to confirm the deletion.</simpara>
</listitem>
</orderedlist>
</section>
</chapter>
<chapter xml:id="manage-service-tasks-proc_configuring-central">
<title>Managing custom tasks in Business Central</title>
<simpara>Custom tasks (work items) are tasks that you can customize and reuse across multiple business processes or across all projects in Business Central. Red Hat Process Automation Manager provides a set of custom tasks within the custom task repository in Business Central. You can enable or disable the default custom tasks and upload custom tasks into Business Central to implement the tasks in the relevant processes.</simpara>
<note>
<simpara>Red Hat Process Automation Manager includes a limited set of supported custom tasks. Custom tasks that are not included in Red Hat Process Automation Manager are not supported.</simpara>
</note>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, click <inlinemediaobject>
<imageobject>
<imagedata fileref="images/_images/project-data/gear-icon.png"/>
</imageobject>
<textobject><phrase>gear icon</phrase></textobject>
</inlinemediaobject> in the upper-right corner and select <emphasis role="strong">Custom Tasks Administration</emphasis>.</simpara>
<simpara>This page lists the custom task installation settings and available custom tasks for processes in projects throughout Business Central. The custom tasks that you enable on this page become available in the project-level settings where you can then install each custom task to be used in processes. The way in which the custom tasks are installed in a project is determined by the global settings that you enable or disable under <emphasis role="strong">Settings</emphasis> on this <emphasis role="strong">Custom Tasks Administration</emphasis> page.</simpara>
</listitem>
<listitem>
<simpara>Under <emphasis role="strong">Settings</emphasis>, enable or disable each setting to determine how the available custom tasks are implemented when a user installs them at the project level.</simpara>
<simpara>The following custom task settings are available:</simpara>
<itemizedlist>
<listitem>
<simpara><emphasis role="strong">Install as Maven artifact</emphasis>: Uploads the custom task JAR file to the Maven repository that is configured with Business Central, if the file is not already present.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Install custom task dependencies into project</emphasis>: Adds any custom task dependencies to the <literal>pom.xml</literal> file of the project where the task is installed.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Use version range when installing custom task into project</emphasis>: Uses a version range instead of a fixed version of a custom task that is added as a project dependency. Example: <literal>[7.16,)</literal> instead of <literal>7.16.0.Final</literal></simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>Enable or disable (set to <emphasis role="strong">ON</emphasis> or <emphasis role="strong">OFF</emphasis>) any available custom tasks as needed. Custom tasks that you enable are displayed in project-level settings for all projects in Business Central.</simpara>
<figure>
<title>Enable custom tasks and custom task settings</title>
<mediaobject>
<imageobject>
<imagedata fileref="images/_images/admin-and-config/manage-service-tasks.png"/>
</imageobject>
<textobject><phrase>Custom Tasks Administration page</phrase></textobject>
</mediaobject>
</figure>
</listitem>
<listitem>
<simpara>To add a custom task, click <emphasis role="strong">Add Custom Task</emphasis>, browse to the relevant JAR file, and click the <emphasis role="strong">Upload</emphasis> icon. The JAR file must contain work item handler implementations annotated with <literal>@Wid</literal>.</simpara>
</listitem>
<listitem>
<simpara>Optional: To remove a custom task, click <emphasis role="strong">remove</emphasis> on the row of the custom task you want to remove and click <emphasis role="strong">Ok</emphasis> to confirm removal.</simpara>
</listitem>
<listitem>
<simpara>After you configure all required custom tasks, navigate to a project in Business Central and go to the project <emphasis role="strong">Settings</emphasis> → <emphasis role="strong">Custom Tasks</emphasis> page to view the available custom tasks that you enabled.</simpara>
</listitem>
<listitem>
<simpara>For each custom task, click <emphasis role="strong">Install</emphasis> to make the task available to the processes in that project or click <emphasis role="strong">Uninstall</emphasis> to exclude the task from the processes in the project.</simpara>
</listitem>
<listitem>
<simpara>If you are prompted for additional information when you install a custom task, enter the required information and click <emphasis role="strong">Install</emphasis> again.</simpara>
<simpara>The required parameters for the custom task depend on the type of task. For example, rule and decision tasks require artifact GAV information (Group ID, Artifact ID, Version), email tasks require host and port access information, and REST tasks require API credentials. Other custom tasks might not require any additional parameters.</simpara>
<figure>
<title>Install custom tasks for use in processes</title>
<mediaobject>
<imageobject>
<imagedata fileref="images/_images/admin-and-config/manage-service-tasks-project.png"/>
</imageobject>
<textobject><phrase>Project-level custom task settings</phrase></textobject>
</mediaobject>
</figure>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Return to the project page, select or add a business process in the project, and in the process designer palette, select the <emphasis role="strong">Custom Tasks</emphasis> option to view the available custom tasks that you enabled and installed:</simpara>
<figure>
<title>Access installed custom tasks in process designer</title>
<mediaobject>
<imageobject>
<imagedata fileref="images/_images/admin-and-config/manage-service-tasks-process.png"/>
</imageobject>
<textobject><phrase>Custom tasks in process designer</phrase></textobject>
</mediaobject>
</figure>
</listitem>
</orderedlist>
</chapter>
<chapter xml:id="exporting-importing-dashbuilder-data-proc-configuring-central">
<title>Exporting and importing Dashbuilder data</title>
<simpara>Dashbuilder is a dashboard and reporting tool integrated in Business Central and is used by the Datasets editor and Content Manager page. There are three data types:</simpara>
<itemizedlist>
<listitem>
<simpara>Datasets</simpara>
</listitem>
<listitem>
<simpara>Pages</simpara>
</listitem>
<listitem>
<simpara>Navigation</simpara>
</listitem>
</itemizedlist>
<simpara>You can import and export Dashbuilder data as ZIP files in Business Central.</simpara>
<important>
<simpara>This feature is only accessible by administrator users.</simpara>
</important>
<section xml:id="exporting_dashbuilder_data" remap="_exporting_dashbuilder_data">
<title>Exporting Dashbuilder data</title>
<simpara>You can export the dashbuilder related data such as datasets, pages, and navigation from Business Central as a ZIP file.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Dashbuilder Data Transfer</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>To export the dashbuilder related data, do any of the following tasks:</simpara>
<simpara>If you want to export all dashbuilder data as a ZIP file, do the following tasks:</simpara>
<orderedlist numeration="lowerroman">
<listitem>
<simpara>On the <emphasis role="strong">Dashbuilder Data Transfer</emphasis> page, click <emphasis role="strong">Export all</emphasis>.</simpara>
<simpara>An <literal>export.zip</literal> file containing all dashbuilder data is downloaded. The <literal>export.zip</literal> file structure is separated by data type. For example:</simpara>
<screen>dashbuilder/datasets/definitions/dataset-example1.dset
dashbuilder/datasets/definitions/dataset-example2.dset
dashbuilder/datasets/readme.md
dashbuilder/perspectives/page1/perspective_layout
dashbuilder/perspectives/page1/perspective_layout.plugin
dashbuilder/perspectives/page2/perspective_layout
dashbuilder/perspectives/page2/perspective_layout.plugin
dashbuilder/perspectives/readme.md
dashbuilder/navigation/navigation/navtree.json
dashbuilder/navigation/readme.md
VERSION</screen>
</listitem>
</orderedlist>
<simpara>If you want to export customized user created dashbuilder data as a ZIP file, do the following tasks:</simpara>
<orderedlist numeration="lowerroman">
<listitem>
<simpara>On the <emphasis role="strong">Dashbuilder Data Transfer</emphasis> page, click <emphasis role="strong">Custom export</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>In <emphasis role="strong">Export Wizard</emphasis> panel, select the datasets that you want to include in the ZIP file and click <emphasis role="strong">Next</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Select the pages that you want to include in the ZIP file and click <emphasis role="strong">Next</emphasis>.</simpara>
<simpara>The <emphasis role="strong">Export Wizard</emphasis> panel validates the selected datasets and pages. The summary of the datasets and pages is available on the panel.</simpara>
<note>
<simpara>Navigation is always included in the exported <literal>ZIP</literal> file.</simpara>
</note>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Download</emphasis> if your export is ready.</simpara>
<simpara>An <literal>export.zip</literal> file containing customized dashbuilder data is downloaded.</simpara>
<note>
<simpara>You must select the pages and the datasets associated with those pages in the <emphasis role="strong">Export Wizard</emphasis> panel. You must select at least one page. If you fail to select both datasets and pages, an export error is generated and you can not download the <literal>export.zip</literal> file.</simpara>
</note>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Finish</emphasis>.</simpara>
</listitem>
</orderedlist>
</listitem>
</orderedlist>
</section>
<section xml:id="importing_dashbuilder_data" remap="_importing_dashbuilder_data">
<title>Importing Dashbuilder data</title>
<simpara>You can import Dashbuilder data to Business Central from a ZIP file if the archive is structured in the same way as the following example:</simpara>
<screen>dashbuilder/datasets/definitions/dataset-example1.dset
dashbuilder/datasets/definitions/dataset-example2.dset
dashbuilder/datasets/readme.md
dashbuilder/perspectives/page1/perspective_layout
dashbuilder/perspectives/page1/perspective_layout.plugin
dashbuilder/perspectives/page2/perspective_layout
dashbuilder/perspectives/page2/perspective_layout.plugin
dashbuilder/perspectives/readme.md
dashbuilder/navigation/navigation/navtree.json
dashbuilder/navigation/readme.md
VERSION</screen>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Dashbuilder Data Transfer</emphasis>.</simpara>
<warning>
<simpara>You should only import Dashbuilder data to a clean installation of Red Hat Process Automation Manager in order to avoid overwriting data on an existing system.</simpara>
</warning>
</listitem>
<listitem>
<simpara>On the <emphasis role="strong">Dashbuilder Data Transfer</emphasis> page, click the <emphasis role="strong">Choose File</emphasis> icon.</simpara>
</listitem>
<listitem>
<simpara>Navigate to the ZIP file you want to import and select the file.</simpara>
</listitem>
<listitem>
<simpara>Click the <emphasis role="strong">Upload</emphasis> icon.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Import</emphasis>.</simpara>
</listitem>
</orderedlist>
</section>
</chapter>
<chapter xml:id="managing-business-central-ldap-connection-con">
<title>LDAP connection</title>
<simpara>Business Central provides a dedicated <literal>UserGroupCallback</literal> implementation for LDAP servers with Red Hat Process Automation Manager to enable the user task service to retrieve information on users, groups, and roles directly from an LDAP service.</simpara>
<simpara>You can configure the following LDAP <literal>UserGroupCallback</literal> implementation properties:</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>LDAP UserGroupCallback properties</title>
<tgroup cols="2">
<colspec colname="col_1" colwidth="50*"/>
<colspec colname="col_2" colwidth="50*"/>
<thead>
<row>
<entry align="left" valign="top">Property</entry>
<entry align="left" valign="top">Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal><emphasis role="strong">ldap.bind.user</emphasis></literal></simpara></entry>
<entry align="left" valign="top"><simpara>User name for connecting to the LDAP server.</simpara><simpara>This property is optional if it is not specified and the LDAP server accepts anonymous access.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal><emphasis role="strong">ldap.bind.pwd</emphasis></literal></simpara></entry>
<entry align="left" valign="top"><simpara>Password for connecting to the LDAP server.</simpara><simpara>This property is optional if it is not specified and the LDAP server accepts anonymous access.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal><emphasis role="strong">ldap.user.ctx</emphasis></literal></simpara></entry>
<entry align="left" valign="top"><simpara>Context in LDAP with user information.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal><emphasis role="strong">ldap.role.ctx</emphasis></literal></simpara></entry>
<entry align="left" valign="top"><simpara>Context in LDAP with group and role.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal><emphasis role="strong">ldap.user.roles.ctx</emphasis></literal></simpara></entry>
<entry align="left" valign="top"><simpara>Context in LDAP with user group and role membership information.</simpara><simpara>This property is optional if it is not specified and the <literal>ldap.role.ctx</literal> property is used instead.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal><emphasis role="strong">ldap.user.filter</emphasis></literal></simpara></entry>
<entry align="left" valign="top"><simpara>Filter for searching user information.</simpara><simpara>This property usually contains substitution keys {0} that are replaced with parameters.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal><emphasis role="strong">ldap.role.filter</emphasis></literal></simpara></entry>
<entry align="left" valign="top"><simpara>Filter for searching group and role information.</simpara><simpara>This property usually contains substitution keys {0} that are replaced with parameters.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal><emphasis role="strong">ldap.user.roles.filter</emphasis></literal></simpara></entry>
<entry align="left" valign="top"><simpara>Filter for searching user group and role membership information.</simpara><simpara>This property usually contains substitution keys {0} that are replaced with parameters.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal><emphasis role="strong">ldap.user.attr.id</emphasis></literal></simpara></entry>
<entry align="left" valign="top"><simpara>Attribute name of the user ID in LDAP.</simpara><simpara>This property is optional if it is not specified and the <literal>uid</literal> property is used instead.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal><emphasis role="strong">ldap.roles.attr.id</emphasis></literal></simpara></entry>
<entry align="left" valign="top"><simpara>Attribute name of the group and role ID in LDAP.</simpara><simpara>This property is optional if it is not specified and the <literal>cn</literal> property is used instead.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal><emphasis role="strong">ldap.user.id.dn</emphasis></literal></simpara></entry>
<entry align="left" valign="top"><simpara>User ID in a DN, instructs the callback to query for user DN before searching for roles. This is optional and is <literal>false</literal> by default.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal><emphasis role="strong">java.naming.factory.initial</emphasis></literal></simpara></entry>
<entry align="left" valign="top"><simpara>Initial context factory class name; is <literal>com.sun.jndi.ldap.LdapCtxFactory</literal> by default.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal><emphasis role="strong">java.naming.security.authentication</emphasis></literal></simpara></entry>
<entry align="left" valign="top"><simpara>Authentication type where the possible values are <literal>none</literal>, <literal>simple</literal>, and <literal>strong</literal>. This is <literal>simple</literal> by default.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal><emphasis role="strong">java.naming.security.protocol</emphasis></literal></simpara></entry>
<entry align="left" valign="top"><simpara>Security protocol to be used, for example, <literal>ssl</literal>.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal><emphasis role="strong">java.naming.provider.url</emphasis></literal></simpara></entry>
<entry align="left" valign="top"><simpara>LDAP url (by default <literal>ldap://localhost:389</literal>; if the protocol is set to <emphasis>ssl</emphasis> then <literal>ldap://localhost:636</literal>)</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<section xml:id="managing-business-central-using-usergroupcallback-ref">
<title>LDAP UserGroupCallback implementation</title>
<simpara>You can use the LDAP <literal>UserGroupCallback</literal> implementation by configuring the respective LDAP properties in one of the following ways:</simpara>
<itemizedlist>
<listitem>
<simpara>Programmatically: Build a properties object with the respective <literal>LDAPUserGroupCallbackImpl</literal> properties and create <literal>LDAPUserGroupCallbackImpl</literal> using the same properties object as its parameter.</simpara>
<simpara>For example:</simpara>
<screen>import org.kie.api.PropertiesConfiguration;
import org.kie.api.task.UserGroupCallback;
...
Properties properties = new Properties();
properties.setProperty(LDAPUserGroupCallbackImpl.USER_CTX, "ou=People,dc=my-domain,dc=com");
properties.setProperty(LDAPUserGroupCallbackImpl.ROLE_CTX, "ou=Roles,dc=my-domain,dc=com");
properties.setProperty(LDAPUserGroupCallbackImpl.USER_ROLES_CTX, "ou=Roles,dc=my-domain,dc=com");
properties.setProperty(LDAPUserGroupCallbackImpl.USER_FILTER, "(uid={0})");
properties.setProperty(LDAPUserGroupCallbackImpl.ROLE_FILTER, "(cn={0})");
properties.setProperty(LDAPUserGroupCallbackImpl.USER_ROLES_FILTER, "(member={0})");

UserGroupCallback ldapUserGroupCallback = new LDAPUserGroupCallbackImpl(properties);

UserGroupCallbackManager.getInstance().setCallback(ldapUserGroupCallback);</screen>
</listitem>
<listitem>
<simpara>Declaratively: Create the <literal>jbpm.usergroup.callback.properties</literal> file in the root of your application or specify the file location as a system property.</simpara>
<simpara>For example:</simpara>
<simpara><literal>-Djbpm.usergroup.callback.properties=FILE_LOCATION_ON_CLASSPATH</literal></simpara>
<simpara>Ensure that you register the LDAP callback when starting the user task server.</simpara>
<simpara>For example:</simpara>
<screen>#ldap.bind.user=
#ldap.bind.pwd=
ldap.user.ctx=ou\=People,dc\=my-domain,dc\=com
ldap.role.ctx=ou\=Roles,dc\=my-domain,dc\=com
ldap.user.roles.ctx=ou\=Roles,dc\=my-domain,dc\=com
ldap.user.filter=(uid\={0})
ldap.role.filter=(cn\={0})
ldap.user.roles.filter=(member\={0})
#ldap.user.attr.id=
#ldap.roles.attr.id=</screen>
</listitem>
</itemizedlist>
<bridgehead xml:id="additional_resources_2" renderas="sect3" remap="_additional_resources_2">Additional resources</bridgehead>
<itemizedlist>
<listitem>
<simpara><link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/installing_and_configuring_red_hat_process_automation_manager#roles-users-con_install-on-eap"><emphasis>Roles and users</emphasis></link></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_single_sign-on/7.4/html-single/server_administration_guide/"><emphasis>Red Hat Single Sign-On Server Administration Guide</emphasis></link></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/managing_red_hat_process_automation_manager_and_kie_server_settings#ldap-login-domain-proc"><emphasis>Defining LDAP login domain</emphasis></link></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.3/html-single/login_module_reference/index#ldap_login_module"><emphasis>LDAP login module</emphasis></link></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.3/html-single/login_module_reference/index#ldapextended_login_module"><emphasis>LDAPExtended login module</emphasis></link></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.3/html-single/login_module_reference/index#advancedldap_login_module"><emphasis>AdvancedLDAP login module</emphasis></link></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.3/html-single/login_module_reference/index#advancedadldap_login_module"><emphasis>AdvancedAdLDAP login module</emphasis></link></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.3/html-single/login_module_reference/index#ldap_connectivity_options"><emphasis>LDAP connectivity options</emphasis></link></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.3/html-single/login_module_reference/index#ldapusers_login_module"><emphasis>LDAPUsers login module</emphasis></link></simpara>
</listitem>
</itemizedlist>
</section>
</chapter>
<chapter xml:id="managing-business-central-database-connection-con">
<title>Database connection</title>
<simpara>Business Central provides a dedicated <literal>UserGroupCallback</literal> implementation for database server with Red Hat Process Automation Manager to enable the user task service. The user task service helps in retrieving information on users and groups (roles) directly from databases.</simpara>
<simpara>You can configure the following database <literal>UserGroupCallback</literal> implementation properties:</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>Database UserGroupCallback properties</title>
<tgroup cols="2">
<colspec colname="col_1" colwidth="50*"/>
<colspec colname="col_2" colwidth="50*"/>
<thead>
<row>
<entry align="left" valign="top">Property</entry>
<entry align="left" valign="top">Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal><emphasis role="strong">db.ds.jndi.name</emphasis></literal></simpara></entry>
<entry align="left" valign="top"><simpara>JNDI name of the data source used for connections</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal><emphasis role="strong">db.user.query</emphasis></literal></simpara></entry>
<entry align="left" valign="top"><simpara>Verifies the user existence</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal><emphasis role="strong">db.user.roles.query</emphasis></literal></simpara></entry>
<entry align="left" valign="top"><simpara>Collects the groups for a given user</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal><emphasis role="strong">db.roles.query</emphasis></literal></simpara></entry>
<entry align="left" valign="top"><simpara>Verifies the group existence</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<section xml:id="managing-business-central-using-DB-usergroupcallback-ref">
<title>Database UserGroupCallback implementation</title>
<simpara>In database <literal>UserGroupCallback</literal> implementation, you must create the required database. You can use this implementation by configuring the respective database properties in one of the following ways:</simpara>
<itemizedlist>
<listitem>
<simpara>Programmatically: Build a properties object with the respective <literal>DBUserGroupCallbackImpl</literal> properties and create <literal>DBUserGroupCallbackImpl</literal> using the same properties object as its parameter.</simpara>
<simpara>For example:</simpara>
<screen>import static org.jbpm.services.task.identity.DBUserGroupCallbackImpl.DS_JNDI_NAME;
import static org.jbpm.services.task.identity.DBUserGroupCallbackImpl.PRINCIPAL_QUERY;
import static org.jbpm.services.task.identity.DBUserGroupCallbackImpl.ROLES_QUERY;
import static org.jbpm.services.task.identity.DBUserGroupCallbackImpl.USER_ROLES_QUERY;
...
props = new Properties();
props.setProperty(DS_JNDI_NAME, "jdbc/jbpm-ds");
props.setProperty(PRINCIPAL_QUERY, "select userId from Users where userId = ?");
props.setProperty(ROLES_QUERY, "select groupId from UserGroups where groupId = ?");
props.setProperty(USER_ROLES_QUERY, "select groupId from UserGroups where userId = ?");

callback = new DBUserGroupCallbackImpl(props);</screen>
</listitem>
<listitem>
<simpara>Declaratively: Create the <literal>jbpm.usergroup.callback.properties</literal> file in the root of your application or specify the file location as a system property.</simpara>
<simpara>For example:</simpara>
<simpara><literal>-Djbpm.usergroup.callback.properties=FILE_LOCATION_ON_CLASSPATH</literal></simpara>
<simpara>Ensure that you register the database callback when starting the user task server.</simpara>
<simpara>For example:</simpara>
<screen>System.setProperty("jbpm.usergroup.callback.properties", "/jbpm.usergroup.callback.db.properties");
callback = new DBUserGroupCallbackImpl(true);
...
db.ds.jndi.name = jdbc/jbpm-ds
db.user.query = select userId from Users where userId = ?
db.roles.query = select groupId from UserGroups where groupId = ?
db.user.roles.query = select groupId from UserGroups where userId = ?</screen>
</listitem>
</itemizedlist>
<bridgehead xml:id="additional_resources_3" renderas="sect3" remap="_additional_resources_3">Additional resources</bridgehead>
<itemizedlist>
<listitem>
<simpara><link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/installing_and_configuring_red_hat_process_automation_manager#roles-users-con_install-on-eap"><emphasis>Roles and users</emphasis></link></simpara>
</listitem>
</itemizedlist>
</section>
</chapter>
<chapter xml:id="managing-business-central-using-settings-xml-ref">
<title>Configuring Maven using settings.xml file</title>
<simpara>Java application development uses the Apache Maven build automation tool to build and manage software projects. Maven uses Project Object Model (POM) configuration XML files to define both, the project properties and the build process.</simpara>
<simpara>Maven uses repositories to store Java libraries, plug-ins, and other build artifacts. Repositories can be either local or remote. A local repository is a download of artifacts from a remote repository cached on a local machine. A remote repository is any other repository accessed using common protocols, such as <literal>http://</literal> when located on an HTTP server, or <literal>file://</literal> when located on a file server. The default repository is the public remote Maven 2 Central Repository.
Configuration of Maven is performed by modifying the settings.xml file. You can either configure global Maven settings in the <literal>M2_HOME/conf/settings.xml</literal> file, or user-level settings in the <literal>USER_HOME/.m2/settings.xml</literal> file.</simpara>
<bridgehead xml:id="additional_resources_4" renderas="sect2" remap="_additional_resources_4">Additional resources</bridgehead>
<itemizedlist>
<listitem>
<simpara><link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#maven-external-configure-proc_packaging-deploying"><emphasis>Configuring an external Maven repository for Business Central and KIE Server</emphasis></link></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#project-build-deploy-maven-proc_packaging-deploying"><emphasis>Packaging and deploying a Red Hat Process Automation Manager project in Maven</emphasis></link></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/installing_and_configuring_red_hat_process_automation_manager#maven-repo-using-con_install-on-eap"><emphasis>Maven settings and repositories for Red Hat Process Automation Manager</emphasis></link></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/managing_red_hat_process_automation_manager_and_kie_server_settings#maven-integration-ref_execution-server"><emphasis>System integration with Maven</emphasis></link></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="http://maven.apache.org/"><emphasis>Welcome to Apache Maven</emphasis></link></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://maven.apache.org/guides/introduction/introduction-to-repositories.html"><emphasis>Apache Maven Project - Introduction to Repositories</emphasis></link></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://maven.apache.org/pom/index.html"><emphasis>Apache Maven Parent POMs Reference</emphasis></link>.</simpara>
</listitem>
</itemizedlist>
</chapter>
<chapter xml:id="managing-business-central-GAV-checks-proc">
<title>GAV check management</title>
<simpara>In Business Central, projects are identified by the <emphasis role="strong">Group ID</emphasis>, <emphasis role="strong">Artifact ID</emphasis>, and <emphasis role="strong">Version</emphasis> (GAV) Maven naming convention. GAV values differentiate projects and project versions as well as identify dependencies with particular projects.</simpara>
<simpara>By default, Business Central detects duplicate GAVs. This feature can be disabled by users with the <emphasis>admin</emphasis> role.</simpara>
<section xml:id="configuring_gav_checks_and_child_gav_edition" remap="_configuring_gav_checks_and_child_gav_edition">
<title>Configuring GAV checks and child GAV edition</title>
<simpara>This procedure describes how to configure GAV checks in Business Central.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, go to <emphasis role="strong">Menu</emphasis> → <emphasis role="strong">Design</emphasis> → <emphasis role="strong">Projects</emphasis> and click the project name.</simpara>
</listitem>
<listitem>
<simpara>In the project window, click the <emphasis role="strong">Settings</emphasis> tab.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">General Settings</emphasis> tab, perform any of the following tasks:</simpara>
<itemizedlist>
<listitem>
<simpara>To enable other projects to have the same GAV, select the <emphasis role="strong">Disable GAV conflict check</emphasis> check box.</simpara>
</listitem>
<listitem>
<simpara>To enable child projects to have GAV edition, select the <emphasis role="strong">Allow child GAV edition</emphasis> check box.</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis>.</simpara>
<note>
<simpara>You can click <emphasis role="strong">Reset</emphasis> to undo all changes.</simpara>
</note>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis> to confirm the changes.</simpara>
</listitem>
</orderedlist>
<note>
<simpara>Duplicate GAV detection is disabled for projects in <emphasis role="strong">Development Mode</emphasis>. To enable duplicate GAV detection in Business Central, go to project <emphasis role="strong">Settings</emphasis> → <emphasis role="strong">General Settings</emphasis> → <emphasis role="strong">Version</emphasis> and toggle the <emphasis role="strong">Development Mode</emphasis> option to <emphasis role="strong">OFF</emphasis> (if applicable).</simpara>
</note>
</section>
<section xml:id="configuring_gav_checks_for_all_projects" remap="_configuring_gav_checks_for_all_projects">
<title>Configuring GAV checks for all projects</title>
<simpara>This procedure describes how to configure GAV checks for all projects in Business Central. You can also disable GAV checks at system startup.</simpara>
<orderedlist numeration="arabic">
<title>Procedures</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Projects</emphasis>. The <emphasis role="strong">Projects</emphasis> window opens.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">Advanced GAV preferences</emphasis> tab, perform any of the following tasks:</simpara>
<itemizedlist>
<listitem>
<simpara>To enable other projects to have the same GAV, select the <emphasis role="strong">Disable GAV conflict check</emphasis> check box.</simpara>
</listitem>
<listitem>
<simpara>To enable child projects to have GAV edition, select the <emphasis role="strong">Allow child GAV edition</emphasis> check box.</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
</orderedlist>
<note>
<simpara>You can also disable the duplicate GAV detection feature by setting the <literal>org.guvnor.project.gav.check.disabled</literal> system property to <emphasis>true</emphasis> for Business Central at system startup:</simpara>
<screen>$ ~/EAP_HOME/bin/standalone.sh -c standalone-full.xml
-Dorg.guvnor.project.gav.check.disabled=true</screen>
</note>
</section>
</chapter>
<chapter xml:id="configuring-environment-mode-proc_configuring-central">
<title>Configuring the environment mode in KIE Server and Business Central</title>
<simpara>You can set KIE Server to run in <literal>production</literal> mode or in <literal>development</literal> mode. Development mode provides a flexible deployment policy that enables you to update existing deployment units (KIE containers) while maintaining active process instances for small changes. It also enables you to reset the deployment unit state before updating active process instances for larger changes. Production mode is optimal for production environments, where each deployment creates a new deployment unit.</simpara>
<simpara>In a development environment, you can click <emphasis role="strong">Deploy</emphasis> in Business Central to deploy the built KJAR file to a KIE Server without stopping any running instances (if applicable), or click <emphasis role="strong">Redeploy</emphasis> to deploy the built KJAR file and replace all instances. The next time you deploy or redeploy the built KJAR, the previous deployment unit (KIE container) is automatically updated in the same target KIE Server.</simpara>
<simpara>In a production environment, the <emphasis role="strong">Redeploy</emphasis> option in Business Central is disabled and you can click only <emphasis role="strong">Deploy</emphasis> to deploy the built KJAR file to a new deployment unit (KIE container) on a KIE Server.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>To configure the KIE Server environment mode, set the <literal>org.kie.server.mode</literal> system property to <literal>org.kie.server.mode=development</literal> or <literal>org.kie.server.mode=production</literal>.</simpara>
</listitem>
<listitem>
<simpara>To configure the deployment behavior for a project in Business Central, go to project <emphasis role="strong">Settings</emphasis> → <emphasis role="strong">General Settings</emphasis> → <emphasis role="strong">Version</emphasis> and toggle the <emphasis role="strong">Development Mode</emphasis> option.</simpara>
<note>
<simpara>By default, KIE Server and all new projects in Business Central are in development mode.</simpara>
</note>
<simpara>You cannot deploy a project with <emphasis role="strong">Development Mode</emphasis> turned on or with a manually added <literal>SNAPSHOT</literal> version suffix to a KIE Server that is in production mode.</simpara>
</listitem>
</orderedlist>
</chapter>
<chapter xml:id="managing-business-central-git-hooks-con">
<title>Git hooks and remote Git repository integration</title>
<simpara>Git hooks are bash scripts that execute before or after Git events such as <literal>git commit</literal> or <literal>git push</literal>. In Business Central, you can use Git hooks to configure repositories to trigger specified actions every time events happen. For more information about Git hooks, see <link xlink:href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks/"><emphasis>Customizing Git Hooks</emphasis></link>.</simpara>
<simpara>You can integrate remote Git repositories with Business Central by using post-commit Git hooks. This enables you to automate content replication between Business Central and remote repositories. For example, you can implement a real-time backup strategy where changes you make to your Business Central projects are replicated to your remote Git repositories.</simpara>
<note>
<simpara>Business Central only supports post-commit Git hooks.</simpara>
<simpara>A post-commit Git hook executes after every commit as a sync operation. Business Central waits for the post-commit bash to complete and no other write operation occurs in the repository.</simpara>
</note>
<section xml:id="managing-business-central-creating-git-hooks-proc-configuring-central">
<title>Creating post-commit Git hooks</title>
<simpara>You can create a post-commit Git hook bash script file that executes code contained in that file or execute code from a different file such as a Java program.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>Create a <literal>post-commit</literal> Git hook file:</simpara>
<screen>$ touch post-commit</screen>
</listitem>
<listitem>
<simpara>Set the permissions of the <literal>post-commit</literal> file to <literal>755</literal>:</simpara>
<screen>$ chmod 755 post-commit</screen>
</listitem>
<listitem>
<simpara>Add <literal>#!/bin/bash</literal> and any required code to the <literal>post-commit</literal> file, for example:</simpara>
<itemizedlist>
<listitem>
<simpara>To push all changes to a remote repository:</simpara>
<screen>#!/bin/bash
git push origin +master</screen>
</listitem>
<listitem>
<simpara>To log a message:</simpara>
<screen>#!/bin/bash
echo 'Hello World'</screen>
</listitem>
<listitem>
<simpara>To execute code of another file:</simpara>
<screen>#!/bin/bash
java -jar _EAP_HOME_/bin/.niogit/&lt;SPACE&gt;/&lt;PROJECT_NAME&gt;.git/hooks/git-push.jar</screen>
<note>
<simpara>To use post-commit Git hooks that execute Java code, you must use the following Java libraries:</simpara>
<itemizedlist>
<listitem>
<simpara><link xlink:href="https://www.eclipse.org/jgit/">JGit</link>: Used to interact with internal Business Central Git repositories.</simpara>
</listitem>
<listitem>
<simpara><link xlink:href="http://github-api.kohsuke.org/">GitHub API for Java</link>: Used to communicate with GitHub.</simpara>
</listitem>
</itemizedlist>
</note>
<simpara>For more information about post-commit Git hook and Java code examples, see <link xlink:href="https://github.com/kiegroup/bc-git-integration-push"><emphasis>Business Central post-commit Git Hooks Integration</emphasis></link>.</simpara>
</listitem>
</itemizedlist>
</listitem>
</orderedlist>
</section>
<section xml:id="managing-business-central-importing-remote-Git-repository-proc">
<title>Importing remote Git repositories</title>
<simpara>You can import a remote Git repository in to Business Central and configure a post-commit Git hook to automatically push changes to that remote repository.</simpara>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>Red Hat Process Automation Manager is installed in a Red Hat JBoss EAP 7.3 server instance.</simpara>
</listitem>
<listitem>
<simpara>Red Hat Process Automation Manager projects exist in an external Git repository.</simpara>
</listitem>
<listitem>
<simpara>Read access credentials for the external Git repository.</simpara>
</listitem>
<listitem>
<simpara>(For Windows) Cygwin is installed with the Git package added during installation and the path to the Cygwin <literal>/bin</literal> folder is added to your environment <literal>PATH</literal> variable. For example, <literal>C:\cygwin64\bin</literal>. For more information about Cygwin installation, see <link xlink:href="http://www.cygwin.com/install.html">Installing and Updating Cygwin Packages</link>.</simpara>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, go to <emphasis role="strong">Menu</emphasis> → <emphasis role="strong">Projects</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Select or create the space that you want to import the Git projects into.</simpara>
</listitem>
<listitem>
<simpara>Click <inlinemediaobject>
<imageobject>
<imagedata fileref="images/_images/project-data/dots.png"/>
</imageobject>
<textobject><phrase>dots</phrase></textobject>
</inlinemediaobject> on the right side of the screen and select <emphasis role="strong">Import Project</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">Import Project</emphasis> window, enter the URL of your Git repository, for example, <literal><link xlink:href="https://github.com/USERNAME/REPOSITORY_NAME.git">https://github.com/USERNAME/REPOSITORY_NAME.git</link></literal>, and the credentials for the Git repository.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Import</emphasis>.</simpara>
<simpara>The project is added to the Business Central Git repository and is then available in the space.</simpara>
<important>
<simpara>Use the HTTPS or Git protocol instead of a SCP-style SSH URL. Business Central does not support the basic SSH URL and an error appears if you use this URL.</simpara>
<simpara>You must have your public ssh key configured in your Git provider.</simpara>
<simpara>The Git repository must be a KJAR project, containing only a single KJAR that is compatible with the Red Hat Process Automation Manager version. The KJAR content must be in the root of the repository.</simpara>
</important>
</listitem>
<listitem>
<simpara>In a command terminal, navigate to the <literal>hooks</literal> folder located in the repository Git folder of the project. For example:</simpara>
<screen>$ cd _EAP_HOME_/bin/.niogit/&lt;SPACE&gt;/&lt;PROJECT_NAME&gt;.git/hooks</screen>
</listitem>
<listitem>
<simpara>Create a <literal>post-commit</literal> file that pushes changes to the remote Git repository. For example:</simpara>
<screen>#!/bin/sh
git push origin +master</screen>
<simpara>For more information about creating post-commit Git hooks, see <xref linkend="managing-business-central-creating-git-hooks-proc-configuring-central"/>.</simpara>
</listitem>
<listitem>
<simpara>Optional: To check that the configuration was successful, create a guided rule in Business Central:</simpara>
<orderedlist numeration="loweralpha">
<listitem>
<simpara>In Business Central go to <emphasis role="strong">Menu</emphasis> → <emphasis role="strong">Projects</emphasis> → <emphasis role="strong">Add Asset</emphasis> → <emphasis role="strong">Guided Rule</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>On the <emphasis role="strong">Create new Guided Rule</emphasis> page, enter the required information.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Ok</emphasis>.</simpara>
<simpara>Business Central automatically pushes all changes to the remote repository.</simpara>
</listitem>
</orderedlist>
</listitem>
</orderedlist>
<itemizedlist>
<title>Additional resources</title>
<listitem>
<simpara><link xlink:href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks/"><emphasis>Customizing Git - Git Hooks</emphasis></link></simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="managing-business-central-configuring-git-hooks-existing-remote-repositories-proc-configuring-central">
<title>Configuring Git hooks for existing remote Git project repositories</title>
<simpara>If you have an existing remote Git repository project you can create a post-commit Git hook in a remote Git repository of that existing project and integrate the remote Git repository with Business Central.</simpara>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>Red Hat Process Automation Manager is installed in a Red Hat JBoss EAP 7.3 server instance.</simpara>
</listitem>
<listitem>
<simpara>Red Hat Process Automation Manager projects exist in an external Git repository.</simpara>
</listitem>
<listitem>
<simpara>Read access credentials for the external Git repository.</simpara>
</listitem>
<listitem>
<simpara>(For Windows operating system) Cygwin is installed with the Git package added during installation and the path to the Cygwin <literal>/bin</literal> folder is added to your environment <literal>PATH</literal> variable. For example, <literal>C:\cygwin64\bin</literal>. For more information about Cygwin installation, see <link xlink:href="http://www.cygwin.com/install.html">Installing and Updating Cygwin Packages</link>.</simpara>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In a command terminal, navigate to the <literal>hooks</literal> folder located in the repository Git folder of the project. For example:</simpara>
<screen>$ cd _EAP_HOME_/bin/.niogit/&lt;SPACE&gt;/&lt;PROJECT_NAME&gt;.git/hooks</screen>
</listitem>
<listitem>
<simpara>Create a <literal>post-commit</literal> file that pushes changes to the remote Git repository. For example:</simpara>
<screen>#!/bin/sh
git push origin +master</screen>
<simpara>For more information about creating post-commit Git hooks, see <xref linkend="managing-business-central-creating-git-hooks-proc-configuring-central"/>.</simpara>
</listitem>
<listitem>
<simpara>Optional: To check that the configuration was successful, create a guided rule in Business Central:</simpara>
<orderedlist numeration="loweralpha">
<listitem>
<simpara>In Business Central go to <emphasis role="strong">Menu</emphasis> → <emphasis role="strong">Projects</emphasis> → <emphasis role="strong">Add Asset</emphasis> → <emphasis role="strong">Guided Rule</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>On the <emphasis role="strong">Create new Guided Rule</emphasis> page, enter the required information.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Ok</emphasis>.</simpara>
<simpara>Business Central automatically pushes all changes to the remote repository.</simpara>
</listitem>
</orderedlist>
</listitem>
</orderedlist>
</section>
<section xml:id="managing-business-central-configuring-git-hooks-system-property-proc-configuring-central">
<title>Configuring Git hooks as a system property for Business Central</title>
<simpara>If you do not have an existing Git repository project or if you want to apply post-commit Git hooks to a large number of project repositories you can specify a directory containing a hook file for the value of the <literal>org.uberfire.nio.git.hooks</literal> system property. This directory is copied to the Git repositories.</simpara>
<note>
<simpara>If you specify the <literal>org.uberfire.nio.git.hooks</literal> system property, all Business Central internal repositories and project repositories use the post-commit Git hook. You should only use fully qualified paths in your script.</simpara>
</note>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>Red Hat Process Automation Manager is installed in a Red Hat JBoss EAP 7.3 server instance.</simpara>
</listitem>
<listitem>
<simpara>(For Windows operating system) Cygwin is installed with the Git package added during installation and the path to the Cygwin <literal>/bin</literal> folder is added to your environment <literal>PATH</literal> variable. For example, <literal>C:\cygwin64\bin</literal>. For more information about Cygwin installation, see <link xlink:href="http://www.cygwin.com/install.html">Installing and Updating Cygwin Packages</link>.</simpara>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>Create a post-commit Git hook in a directory on your local system.</simpara>
<simpara>For more information about creating post-commit Git hooks, see <xref linkend="managing-business-central-creating-git-hooks-proc-configuring-central"/>.</simpara>
</listitem>
<listitem>
<simpara>To specify the directory with the hook file for the value of the <literal>org.uberfire.nio.git.hooks</literal> system property, do one of the following tasks:</simpara>
<itemizedlist>
<listitem>
<simpara>Add the <literal>org.uberfire.nio.git.hooks</literal> system property to the <literal>standalone.xml</literal> file. For example:</simpara>
<screen>&lt;system-properties&gt;
  &lt;property name="org.uberfire.nio.git.hooks" value="_EAP_HOME_/hooks"&gt;
  &lt;/property&gt;
  ...
&lt;/system-properties&gt;</screen>
</listitem>
<listitem>
<simpara>Use the <literal>-Dorg.uberfire.nio.git.hooks</literal> environment variable when executing Business Central. For example:</simpara>
<screen>$ ./standalone.sh -c standalone-full.xml -Dorg.uberfire.nio.git.hooks=_EAP_HOME_/hooks</screen>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>Start Business Central.</simpara>
<simpara>The post-commit Git hook is copied to all Business Central internal repositories and project repositories.</simpara>
</listitem>
</orderedlist>
<itemizedlist>
<title>Additional resources</title>
<listitem>
<simpara><link xlink:href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks/"><emphasis>Customizing Git - Git Hooks</emphasis></link></simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="managing-business-central-integrating-remote-git-repositories-proc-configuring-central">
<title>Integrating remote Git repositories</title>
<simpara>In the following example, you use a post-commit Git hook and Java code to integrate Business Central with a remote Git repository. For the Java code example, see <link xlink:href="https://github.com/kiegroup/bc-git-integration-push"><emphasis>Business Central post-commit Git Hooks Integration</emphasis></link>. The example provides the following functionality:</simpara>
<itemizedlist>
<listitem>
<simpara>Automatic generation of the template <literal>.gitremote</literal> configuration file</simpara>
</listitem>
<listitem>
<simpara>Validation of the <literal>.gitremote</literal> configuration file for required parameters</simpara>
</listitem>
<listitem>
<simpara>Patterns defined in the ignore parameter of the <literal>.gitremote</literal> file are ignored by Git</simpara>
</listitem>
<listitem>
<simpara>Message and notification output to users</simpara>
</listitem>
<listitem>
<simpara>Support for GitLab and GitHub token authentication</simpara>
</listitem>
<listitem>
<simpara>Support for GitLab group and subgroup project creation</simpara>
</listitem>
<listitem>
<simpara>Support for GitHub organization repository creation</simpara>
</listitem>
</itemizedlist>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>Red Hat Process Automation Manager is installed in a Red Hat JBoss EAP 7.3 server instance.</simpara>
</listitem>
<listitem>
<simpara>Java Development Kit (JDK) 8 is installed.</simpara>
</listitem>
<listitem>
<simpara>Maven is installed.</simpara>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In a terminal window, clone the GitHub repository to your system:</simpara>
<screen>$ git clone https://github.com/kiegroup/bc-git-integration-push.git</screen>
</listitem>
<listitem>
<simpara>Navigate to the cloned repository:</simpara>
<screen>$ cd bc-git-integration-push</screen>
</listitem>
<listitem>
<simpara>Execute a Maven clean install:</simpara>
<screen>$ mvn clean install</screen>
</listitem>
<listitem>
<simpara>Create a <literal>/hooks</literal> folder in your <literal><emphasis>EAP_HOME</emphasis></literal> directory:</simpara>
<screen>$ mkdir -p _EAP_HOME_/hooks/</screen>
</listitem>
<listitem>
<simpara>Copy the <literal>git-push-2.1-SNAPSHOT.jar</literal> to the <literal><emphasis>EAP_HOME</emphasis>/hooks/</literal> folder:</simpara>
<screen>$ cp bc-git-integration-push/target/git-push-2.1-SNAPSHOT.jar _EAP_HOME_/hooks/</screen>
</listitem>
<listitem>
<simpara>Optional: To create a template <literal>.gitremote</literal> configuration file, run <literal>git-push-2.1-SNAPSHOT.jar</literal>:</simpara>
<screen>$ java -jar git-push-2.1-SNAPSHOT.jar</screen>
<formalpara>
<title>Example template <literal>.gitremote</literal> configuration file</title>
<para>
<screen>#This is an auto generated template empty property file
provider=GIT_HUB
login=
password=
token=
remoteGitUrl=https://api.github.com/
useSSH=false
ignore=.*demo.*, test.*
githubOrg=OrgName
gitlabGroup=Group/subgroup</screen>
</para>
</formalpara>
</listitem>
<listitem>
<simpara>Modify the <literal>.gitremote</literal> configuration file parameters.</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>Example <literal>.gitremote</literal> parameters</title>
<tgroup cols="2">
<colspec colname="col_1" colwidth="25*"/>
<colspec colname="col_2" colwidth="75*"/>
<thead>
<row>
<entry align="left" valign="top">Parameter</entry>
<entry align="left" valign="top">Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal>provider</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The Git provider. Only two values are accepted: GIT_HUB and GIT_LAB. Required</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>login</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The user name for the Git provider. Required</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>password</literal></simpara></entry>
<entry align="left" valign="top"><simpara>A plain text password. Not required if a <literal>token</literal> is provided.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>token</literal></simpara></entry>
<entry align="left" valign="top"><simpara>A generated token to replace the <literal>username</literal> and <literal>password</literal> based unsecured connection. Note: If this is not set a warning is displayed that you are using an unsecured connection. Not required if a <literal>password</literal> is provided. Note: GitLab only supports token authentication.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>remoteGitUrl</literal></simpara></entry>
<entry align="left" valign="top"><simpara>A public provider URL or a locally hosted enterprise for any provider. Required. Note: The public GitHub URL should be the API URL. For example, api.github.com.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>useSSH</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Boolean to allow the SSH protocol to push changes to the remote repository. Optional. Default = false. Note: This parameter uses the local <literal>~/.ssh/</literal> directory to obtain the SSH configuration.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>ignore</literal></simpara></entry>
<entry align="left" valign="top"><simpara>A comma separated regular expressions to ignore project names that match any of these expressions. Optional.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>githubOrg</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Defines the repository organization if GitHub is used as the provider. Optional.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>gitlabGroup</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Defines the repository group and subgroup if GitLab is used as the provider Optional.</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
</listitem>
<listitem>
<simpara>Create a <literal>post-commit</literal> Git hook file in <literal><emphasis>EAP_HOME</emphasis>/hooks</literal>:</simpara>
<screen>$ touch post-commit</screen>
</listitem>
<listitem>
<simpara>Set the permissions of the <literal>post-commit</literal> file to <literal>755</literal>:</simpara>
<screen>$ chmod 755 post-commit</screen>
</listitem>
<listitem>
<simpara>Add <literal>#!/bin/bash</literal> and code to execute <literal>git-push-2.1-SNAPSHOT.jar</literal> to the <literal>post-commit</literal> file:</simpara>
<screen>$ echo "#\!/bin/bash\njava -jar $APP_SERVER_HOME/hooks/git-push-2.1-SNAPSHOT.jar" &gt; hooks/post-commit</screen>
</listitem>
<listitem>
<simpara>Start Business Central with the <literal>-Dorg.uberfire.nio.git.hooks</literal> environment variable set. For example:</simpara>
<screen>$ ./standalone.sh -c standalone-full.xml -Dorg.uberfire.nio.git.hooks=_EAP_HOME_/hooks</screen>
</listitem>
</orderedlist>
<note>
<simpara>To use post-commit Git hooks that execute Java code, you must use the following Java libraries:</simpara>
<itemizedlist>
<listitem>
<simpara><link xlink:href="https://www.eclipse.org/jgit/">JGit</link>: Used to interact with internal Business Central Git repositories.</simpara>
</listitem>
<listitem>
<simpara><link xlink:href="http://github-api.kohsuke.org/">GitHub API for Java</link>: Used to communicate with GitHub.</simpara>
</listitem>
</itemizedlist>
</note>
<simpara>For more information about post-commit Git hook and Java code examples, see <link xlink:href="https://github.com/kiegroup/bc-git-integration-push"><emphasis>Business Central post-commit Git Hooks Integration</emphasis></link>.</simpara>
</section>
<section xml:id="managing-business-central-githook-exit-codes-con">
<title>Git hook exit codes</title>
<simpara>When a Git hook exits an integer value is returned which determines the status of the Git hook execution. This integer value is known as a Git hook exit code. The execution status can be a success (1), warning (2 to 30) or error (31 to 255).</simpara>
</section>
<section xml:id="managing-business-central-customizing-githook-notifications-proc">
<title>Customizing Git hook notifications</title>
<simpara>Business Central provides a mechanism that enables users to receive customized Git hook notifications based on the hook exit codes.</simpara>
<simpara>To enable the notification mechanism you must create a <literal>*.properties</literal> file containing the custom messages and then specify the path to that file as the value of the <literal>appformer.git.hooks.bundle</literal> system property.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>Create the <literal>*.properties</literal> file and add a line for each exit code with a corresponding message in the following format:</simpara>
<simpara><literal>&lt;exit_code&gt;=&lt;display_message&gt;</literal></simpara>
<simpara>The <literal>&lt;exit_code&gt;</literal> is the Git hook exit code and the <literal>&lt;display_message&gt;</literal> is the custom message that is displayed to a user.</simpara>
<simpara>For example:</simpara>
<screen>0=Success! All working as expected.
1=Warning! Please check the logs and advise your admin.
.
.
31=Error! Please advise your admin immediately.</screen>
<note>
<simpara>It is not necessary to define all the possible exit codes in the *.properties file. Notifications appear only for the exit codes defined in the *.properties file.</simpara>
</note>
<important>
<simpara>The notification service only supports the <literal>ISO 8859-1</literal> (<literal>LATIN 1</literal>) character set in the properties file. If you want to use extended characters, please use their escaped Unicode character code sequences.</simpara>
</important>
</listitem>
<listitem>
<simpara>To enable Git hook notifications, specify the path to the file as the value of the <literal>appformer.git.hooks.bundle</literal> system property.</simpara>
<simpara>See the following example of a <literal>standalone.xml</literal> file with the setting that points to a <literal>Messages.properties</literal> file:</simpara>
<screen>&lt;system-properties&gt;
  &lt;property name="appformer.git.hooks.bundle" value="/opt/jboss-as/git-hooks-messages/Messages.properties"&gt;
  &lt;/property&gt;
  ...
&lt;/system-properties&gt;</screen>
</listitem>
</orderedlist>
<section xml:id="managing-business-central-githook-notifications-exit-codes-types-con">
<title>Git hook notifications in Business Central</title>
<simpara>You can view Git hook notifications in Business Central. There are three Git hook exit code notification types.</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>Git hook UI notification types</title>
<tgroup cols="3">
<colspec colname="col_1" colwidth="17*"/>
<colspec colname="col_2" colwidth="67*"/>
<colspec colname="col_3" colwidth="17*"/>
<thead>
<row>
<entry align="left" valign="top">Exit code</entry>
<entry align="left" valign="top">Customized message</entry>
<entry align="left" valign="top">UI notification color</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal>0</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Success! All working as expected.</simpara></entry>
<entry align="left" valign="top"><simpara><phrase role="Green">Green</phrase></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>1 to 30</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Warning! Please check the logs and advise your admin.</simpara></entry>
<entry align="left" valign="top"><simpara><phrase role="Orange">Orange</phrase></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>31 to 255</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Error! Please advise your admin immediately.</simpara></entry>
<entry align="left" valign="top"><simpara><phrase role="Red">Red</phrase></simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<important>
<simpara><emphasis role="strong">UNIX</emphasis> machines only support error codes between 0 (success) to 255 (error), any exit code outside of this range will
end up being converted into a different code which may cause showing a wrong notification message.</simpara>
<simpara><emphasis role="strong">Windows</emphasis> machines don’t have this limitation and support a wide range of exit codes.</simpara>
</important>
</section>
<section xml:id="managing-business-central-githook-notifications-internationalize-con">
<title>Git hook notification internationalization support</title>
<simpara>You can internationalize notification messages by placing additional properties files in the same path as the original properties file specified as the <literal>appformer.git.hooks.bundle</literal> system property.</simpara>
<simpara>The name of the different localized files must be <literal>&lt;filename&gt;_&lt;lang&gt;.properties</literal>, where the <literal>&lt;filename&gt;</literal> is the same as the original. For example, where the system property points to <literal>Messages.properties</literal>, you can create <literal>Messages_en.properties</literal> for English, <literal>Messages_fr.properties</literal> for French, or <literal>Messages_it.properties</literal> for Italian.</simpara>
<simpara>The notification service will choose the properties file based on the user’s language, if there are no available translations for that language it will use the entries from the original <literal>Messages.properties</literal> file.</simpara>
</section>
</section>
</chapter>
<chapter xml:id="role-based-access">
<title>Role-based access control for branches in Business Central</title>
<simpara>Business Central provides the option for users to restrict the access for a target branch for a specific collaborator type. The security check uses both the <emphasis role="strong">Security Management</emphasis> screen and contributors sources to grant or deny permissions to spaces and  projects. For example, if a user has the security permission to update a project and has write permission on that branch, based on the contributor type, then they are able to create new assets.</simpara>
<section xml:id="define-role-based-access">
<title>Customizing role-based branch access</title>
<simpara>You can customize contributor role permissions for each branch of a project in Business Central. For example, you can set <emphasis role="strong">Read</emphasis>, <emphasis role="strong">Write</emphasis>, <emphasis role="strong">Delete</emphasis>, and <emphasis role="strong">Deploy</emphasis> access for each role assigned to a branch.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, go to <emphasis role="strong">Menu</emphasis> → <emphasis role="strong">Design</emphasis> → <emphasis role="strong">Projects</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>If needed, add a new contributor:</simpara>
<orderedlist numeration="loweralpha">
<listitem>
<simpara>Click the project name and then click the <emphasis role="strong">Contributors</emphasis> tab.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Add Contributor</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Enter user name in the text field.</simpara>
</listitem>
<listitem>
<simpara>Select the <emphasis role="strong">Contributor</emphasis> role type from the drop-down list.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Ok</emphasis>.</simpara>
</listitem>
</orderedlist>
</listitem>
<listitem>
<simpara>Customize role-based branch access for the relevant contributor:</simpara>
<orderedlist numeration="loweralpha">
<listitem>
<simpara>Click <emphasis role="strong">Settings</emphasis> → <emphasis role="strong">Branch Management</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Select the branch name from the drop-down list.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">Role Access</emphasis> section, select or deselect the permissions check boxes to specify role-based branch access for each available role type.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis> and click <emphasis role="strong">Save</emphasis> again to confirm your changes.</simpara>
</listitem>
</orderedlist>
</listitem>
</orderedlist>
</section>
</chapter>
<chapter xml:id="managing-business-central-using-process-instances-logs-proc">
<title>Viewing process instance logs</title>
<simpara>You can view all the process events of an instance from its <emphasis role="strong">Logs</emphasis> tab. The instance logs list all the current and previous process states. Business Central has two types of logs for process instances, <emphasis role="strong">Business</emphasis> and <emphasis role="strong">Technical</emphasis> logs.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, go to <emphasis role="strong">Menu</emphasis> → <emphasis role="strong">Manage</emphasis> → <emphasis role="strong">Process Instances</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>On the <emphasis role="strong">Manage Process Instances</emphasis> page, click the process instance whose log you want to view.</simpara>
</listitem>
<listitem>
<simpara>Select the <emphasis role="strong">Logs</emphasis> tab:</simpara>
<itemizedlist>
<listitem>
<simpara>Click <emphasis role="strong">Business</emphasis> to view the business events log.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Technical</emphasis> to view the technical events log.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Asc</emphasis> or <emphasis role="strong">Desc</emphasis> to change the order of the log files.</simpara>
</listitem>
</itemizedlist>
</listitem>
</orderedlist>
</chapter>
<chapter xml:id="business-central-system-properties-ref_configuring-central">
<title>Business Central system properties</title>
<simpara>The Business Central system properties listed in this section are passed to <literal>standalone*.xml</literal> files.</simpara>
<variablelist>
<varlistentry>
<term>Git directory</term>
<listitem>
<simpara>Use the following properties to set the location and name for the Business Central Git directory:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>org.uberfire.nio.git.dir</literal>: Location of the Business Central Git directory.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.dirname</literal>: Name of the Business Central Git directory. Default value: <literal>.niogit</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.ketch</literal>: Enables or disables Git ketch.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.hooks</literal>: Location of the Git hooks directory.</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>Git over HTTP</term>
<listitem>
<simpara>Use the following properties to configure access to the Git repository over HTTP:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>org.uberfire.nio.git.proxy.ssh.over.http</literal>: Specifies whether SSH should use an HTTP proxy. Default value: <literal>false</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>http.proxyHost</literal>: Defines the host name of the HTTP proxy. Default value: <literal>null</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>http.proxyPort</literal>: Defines the host port (integer value) of the HTTP proxy. Default value: <literal>null</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>http.proxyUser</literal>: Defines the user name of the HTTP proxy.</simpara>
</listitem>
<listitem>
<simpara><literal>http.proxyPassword</literal>: Defines the user password of the HTTP proxy.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.http.enabled</literal>: Enables or disables the HTTP daemon. Default value: <literal>true</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.http.host</literal>: If the HTTP daemon is enabled, it uses this property as the host identifier. This is an informative property that is used to display how to access the Git repository over HTTP.  The HTTP still relies on the servlet container. Default value: <literal>localhost</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.http.hostname</literal>: If the HTTP daemon is enabled, it uses this property as the host name identifier. This is an informative property that is used to display how to access the Git repository over HTTP.  The HTTP still relies on the servlet container. Default value: <literal>localhost</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.http.port</literal>: If the HTTP daemon is enabled, it uses this property as the port number. This is an informative property that is used to display how to access the Git repository over HTTP.  The HTTP still relies on the servlet container. Default value: <literal>8080</literal>.</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>Git over HTTPS</term>
<listitem>
<simpara>Use the following properties to configure access to the Git repository over HTTPS:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>org.uberfire.nio.git.proxy.ssh.over.https</literal>: Specifies whether SSH uses an HTTPS proxy. Default value: <literal>false</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>https.proxyHost</literal>: Defines the host name of the HTTPS proxy. Default value: <literal>null</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>https.proxyPort</literal>: Defines the host port (integer value) of the HTTPS proxy. Default value: <literal>null</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>https.proxyUser</literal>: Defines the user name of the HTTPS proxy.</simpara>
</listitem>
<listitem>
<simpara><literal>https.proxyPassword</literal>: Defines the user password of the HTTPS proxy.</simpara>
</listitem>
<listitem>
<simpara><literal>user.dir</literal>: Location of the user directory.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.https.enabled</literal>: Enables or disables the HTTPS daemon. Default value: <literal>false</literal></simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.https.host</literal>: If the HTTPS daemon is enabled, it uses this property as the host identifier. This is an informative property that is used to display how to access the Git repository over HTTPS.  The HTTPS still relies on the servlet container. Default value: <literal>localhost</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.https.hostname</literal>: If the HTTPS daemon is enabled, it uses this property as the host name identifier. This is an informative property that is used to display how to access the Git repository over HTTPS.  The HTTPS still relies on the servlet container. Default value: <literal>localhost</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.https.port</literal>: If the HTTPS daemon is enabled, it uses this property as the port number. This is an informative property that is used to display how to access the Git repository over HTTPS.  The HTTPS still relies on the servlet container. Default value: <literal>8080</literal>.</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>JGit</term>
<listitem>
<itemizedlist>
<listitem>
<simpara><literal>org.uberfire.nio.jgit.cache.instances</literal>: Defines the JGit cache size.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.jgit.cache.overflow.cleanup.size</literal>: Defines the JGit cache overflow cleanup size.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.jgit.remove.eldest.iterations</literal>: Enables or disables whether to remove eldest JGit iterations.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.jgit.cache.evict.threshold.duration</literal>: Defines the JGit evict threshold duration.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.jgit.cache.evict.threshold.time.unit</literal>: Defines the JGit evict threshold time unit.</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>Git daemon</term>
<listitem>
<simpara>Use the following properties to enable and configure the Git daemon:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>org.uberfire.nio.git.daemon.enabled</literal>: Enables or disables the Git daemon. Default value: <literal>true</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.daemon.host</literal>: If the Git daemon is enabled, it uses this property as the local host identifier. Default value: <literal>localhost</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.daemon.hostname</literal>: If the Git daemon is enabled, it uses this property as the local host name identifier. Default value: <literal>localhost</literal></simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.daemon.port</literal>: If the Git daemon is enabled, it uses this property as the port number. Default value: <literal>9418</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.http.sslVerify</literal>: Enables or disables SSL certificate checking for Git repositories. Default value: <literal>true</literal>.</simpara>
<note>
<simpara>If the default or assigned port is already in use, a new port is automatically selected. Ensure that the ports are available and check the log for more information.</simpara>
</note>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>Git SSH</term>
<listitem>
<simpara>Use the following properties to enable and configure the Git SSH daemon:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>org.uberfire.nio.git.ssh.enabled</literal>: Enables or disables the SSH daemon. Default value: <literal>true</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.ssh.host</literal>: If the SSH daemon enabled, it uses this property as the local host identifier. Default value: <literal>localhost</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.ssh.hostname</literal>: If the SSH daemon is enabled, it uses this property as local host name identifier. Default value: <literal>localhost</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.ssh.port</literal>: If the SSH daemon is enabled, it uses this property as the port number. Default value: <literal>8001</literal>.</simpara>
<note>
<simpara>If the default or assigned port is already in use, a new port is automatically selected. Ensure that the ports are available and check the log for more information.</simpara>
</note>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.ssh.cert.dir</literal>: Location of the <literal>.security</literal> directory where local certificates are stored. Default value: Working directory.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.ssh.idle.timeout</literal>: Sets the SSH idle timeout.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.ssh.passphrase</literal>: Pass phrase used to access the public key store of your operating system when cloning git repositories with SCP style URLs. Example: <literal>git@github.com:user/repository.git</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.ssh.algorithm</literal>: Algorithm used by SSH. Default value: <literal>RSA</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.gc.limit</literal>: Sets the GC limit.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.ssh.ciphers</literal>: A comma-separated string of ciphers. The available ciphers are <literal>aes128-ctr</literal>, <literal>aes192-ctr</literal>, <literal>aes256-ctr</literal>, <literal>arcfour128</literal>, <literal>arcfour256</literal>, <literal>aes192-cbc</literal>, <literal>aes256-cbc</literal>. If the property is not used, all available ciphers are loaded.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.nio.git.ssh.macs</literal>: A comma-separated string of message authentication codes (MACs). The available MACs are <literal>hmac-md5</literal>, <literal>hmac-md5-96</literal>, <literal>hmac-sha1</literal>, <literal>hmac-sha1-96</literal>, <literal>hmac-sha2-256</literal>, <literal>hmac-sha2-512</literal>. If the property is not used, all available MACs are loaded.</simpara>
<note>
<simpara>If you plan to use RSA or any algorithm other than DSA, make sure you set up your application server to use the Bouncy Castle JCE library.</simpara>
</note>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>KIE Server nodes and Process Automation Manager controller</term>
<listitem>
<simpara>Use the following properties to configure the connections with the KIE Server nodes from the Process Automation Manager controller:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>org.kie.server.controller</literal>: The URL is used to connect to the Process Automation Manager controller. For example, <literal>ws://localhost:8080/business-central/websocket/controller</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.kie.server.user</literal>: User name used to connect to the KIE Server nodes from the Process Automation Manager controller. This property is only required when using this Business Central installation as a Process Automation Manager controller.</simpara>
</listitem>
<listitem>
<simpara><literal>org.kie.server.pwd</literal>: Password used to connect to the KIE Server nodes from the Process Automation Manager controller. This property is only required when using this Business Central installation as a Process Automation Manager controller.</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>Maven and miscellaneous</term>
<listitem>
<simpara>Use the following properties to configure Maven and other miscellaneous functions:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>kie.maven.offline.force</literal>: Forces Maven to behave as if offline. If true, disables online dependency resolution. Default value: <literal>false</literal>.</simpara>
<note>
<simpara>Use this property for Business Central only. If you share a runtime environment with any other component, isolate the configuration and apply it only to Business Central.</simpara>
</note>
</listitem>
<listitem>
<simpara><literal>org.uberfire.gzip.enable</literal>: Enables or disables Gzip compression on the <literal>GzipFilter</literal> compression filter. Default value: <literal>true</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.kie.workbench.profile</literal>: Selects the Business Central profile. Possible values are <literal>FULL</literal> or <literal>PLANNER_AND_RULES</literal>. A prefix <literal>FULL_</literal> sets the profile and hides the profile preferences from the administrator preferences. Default value: <literal>FULL</literal></simpara>
</listitem>
<listitem>
<simpara><literal>org.appformer.m2repo.url</literal>: Business Central uses the default location of the Maven repository when looking for dependencies. It directs to the Maven repository inside Business Central, for example, <literal>http://localhost:8080/business-central/maven2</literal>. Set this property before starting Business Central. Default value: File path to the inner <literal>m2</literal> repository.</simpara>
</listitem>
<listitem>
<simpara><literal>appformer.ssh.keystore</literal>: Defines the custom SSH keystore to be used with Business Central by specifying a class name. If the property is not available, the default SSH keystore is used.</simpara>
</listitem>
<listitem>
<simpara><literal>appformer.ssh.keys.storage.folder</literal>: When using the default SSH keystore, this property defines the storage folder for the user’s SSH public keys. If the property is not available, the keys are stored in the Business Central <literal>.security</literal> folder.</simpara>
</listitem>
<listitem>
<simpara><literal>appformer.experimental.features</literal>: Enables the experimental features framework. Default value: <literal>false</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.kie.demo</literal>: Enables an external clone of a demo application from GitHub.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.metadata.index.dir</literal>: Place where the Lucene <literal>.index</literal> directory is stored. Default value: Working directory.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.ldap.regex.role_mapper</literal>: Regex pattern used to map LDAP principal names to the application role name. Note that the variable role must be a part of the pattern as the application role name substitutes the variable role when matching a principle value and role name.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.sys.repo.monitor.disabled</literal>: Disables the configuration monitor. Do not disable unless you are sure. Default value: <literal>false</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.secure.key</literal>: Password used by password encryption. Default value: <literal>org.uberfire.admin</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.secure.alg</literal>: Crypto algorithm used by password encryption. Default value: <literal>PBEWithMD5AndDES</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.uberfire.domain</literal>: Security-domain name used by uberfire. Default value: <literal>ApplicationRealm</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.guvnor.m2repo.dir</literal>: Place where the Maven repository folder is stored. Default value: <literal>&lt;working-directory&gt;/repositories/kie</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.guvnor.project.gav.check.disabled</literal>: Disables group ID, artifact ID, and version (GAV) checks. Default value: <literal>false</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.kie.build.disable-project-explorer</literal>: Disables automatic build of a selected project in Project Explorer. Default value: <literal>false</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.kie.builder.cache.size</literal>: Defines the cache size of the project builder. Default value: <literal>20</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.kie.verification.disable-dtable-realtime-verification</literal>: Disables the real-time validation and verification of decision tables. Default value: <literal>false</literal>.</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>Process Automation Manager controller</term>
<listitem>
<simpara>Use the following properties to configure how to connect to the Process Automation Manager controller:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>org.kie.workbench.controller</literal>: The URL used to connect to the Process Automation Manager controller, for example, <literal>ws://localhost:8080/kie-server-controller/websocket/controller</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.kie.workbench.controller.user</literal>: The Process Automation Manager controller user. Default value: <literal>kieserver</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.kie.workbench.controller.pwd</literal>: The Process Automation Manager controller password. Default value: <literal>kieserver1!</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.kie.workbench.controller.token</literal>: The token string used to connect to the Process Automation Manager controller.</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>Java Cryptography Extension KeyStore (JCEKS)</term>
<listitem>
<simpara>Use the following properties to configure JCEKS:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>kie.keystore.keyStoreURL</literal>: The URL used to load a Java Cryptography Extension KeyStore (JCEKS). For example, <literal>file:///home/kie/keystores/keystore.jceks.</literal></simpara>
</listitem>
<listitem>
<simpara><literal>kie.keystore.keyStorePwd</literal>: The password used for the JCEKS.</simpara>
</listitem>
<listitem>
<simpara><literal>kie.keystore.key.ctrl.alias</literal>: The alias of the key for the default REST Process Automation Manager controller.</simpara>
</listitem>
<listitem>
<simpara><literal>kie.keystore.key.ctrl.pwd</literal>: The password of the alias for the default REST Process Automation Manager controller.</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>Rendering</term>
<listitem>
<simpara>Use the following properties to switch between Business Central and KIE Server rendered forms:</simpara>
<itemizedlist>
<listitem>
<simpara><literal>org.jbpm.wb.forms.renderer.ext</literal>: Switches the form rendering between Business Central and KIE Server. By default, the form rendering is performed by Business Central. Default value: <literal>false</literal>.</simpara>
</listitem>
<listitem>
<simpara><literal>org.jbpm.wb.forms.renderer.name</literal>: Enables you to switch between Business Central and KIE Server rendered forms. Default value: <literal>workbench</literal>.</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
</variablelist>
</chapter>
<chapter xml:id="performance-tuning-business-central-ref_configuring-central">
<title>Performance tuning considerations with Business Central</title>
<simpara>The following key concepts or suggested practices can help you optimize Business Central configuration and Red Hat Process Automation Manager performance. These concepts are summarized in this section as a convenience and are explained in more detail in the cross-referenced documentation, where applicable. This section will expand or change as needed with new releases of Red Hat Process Automation Manager.</simpara>
<variablelist>
<varlistentry>
<term>Ensure that development mode is enabled during development</term>
<listitem>
<simpara>You can set KIE Server or specific projects in Business Central to use <literal>production</literal> mode or <literal>development</literal> mode. By default, KIE Server and all new projects in Business Central are in development mode. This mode provides features that facilitate your development experience, such as flexible project deployment policies, and features that optimize KIE Server performance during development, such as disabled duplicate GAV detection. Use development mode until your Red Hat Process Automation Manager environment is established and completely ready for production mode.</simpara>
<simpara>For more information about configuring the environment mode or duplicate GAV detection, see the following resources:</simpara>
<itemizedlist>
<listitem>
<simpara><xref linkend="configuring-environment-mode-proc_configuring-central"/></simpara>
</listitem>
<listitem>
<simpara><link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#project-duplicate-GAV-con_packaging-deploying"><emphasis>Packaging and deploying a Red Hat Process Automation Manager project</emphasis></link></simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
<varlistentry>
<term>Disable verification and validation of complex guided decision tables</term>
<listitem>
<simpara>The decision table verification and validation feature of Business Central is enabled by default. This feature helps you validate your guided decision tables, but with complex guided decision tables, this feature can hinder decision engine performance. You can disable this feature by setting the <literal>org.kie.verification.disable-dtable-realtime-verification</literal> system property value to <literal>true</literal>.</simpara>
<simpara>For more information about guided decision table validation, see
<link xlink:href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#guided-decision-tables-validation-disable-proc"><emphasis>Designing a decision service using guided decision tables</emphasis></link>.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>Disable automatic builds if you have many large projects</term>
<listitem>
<simpara>In Business Central, when you navigate between projects in the <emphasis role="strong">Project Explorer</emphasis> side panel, the selected project is built automatically so that the <emphasis role="strong">Alerts</emphasis> window is updated to show any build errors for the project. If you have large projects or frequently switch between many projects that are under active development, this feature can hinder Business Central and decision engine performance.</simpara>
<simpara>To disable automatic project builds, set the <literal>org.kie.build.disable-project-explorer</literal> system property to <literal>true</literal>.</simpara>
</listitem>
</varlistentry>
</variablelist>
</chapter>
</part>
<part xml:id="assembly-using-standalone-perspectives">
<title>Using standalone perspectives in Business Central</title>
<partintro>
<simpara>As a business rules developer, you can embed standalone perspectives from Business Central in your web application and then use them to edit rules, processes, decision tables, and other assets.</simpara>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>Business Central is deployed and is running on a web/application server.</simpara>
</listitem>
<listitem>
<simpara>You are logged in to Business Central.</simpara>
</listitem>
</itemizedlist>
</partintro>
<chapter xml:id="using-standalone-perspectives-intro-con">
<title>Standalone perspectives in Business Central</title>
<simpara>Business Central provides specialized editors for authoring assets based on the asset’s format. Business Central has a feature that enables you to use these editors individually. This feature is known as the standalone perspective mode of the editor or simply the <emphasis>standalone perspectives</emphasis>.</simpara>
<simpara>As a business rules developer, you can embed a standalone perspective in your web application and then use it to edit rules, processes, decision tables, and other assets. After embedding a perspective you can edit an asset in your own application without switching to Business Central. You can use this feature to customize your web application. In addition to standalone perspectives you can also embed standalone custom pages (dashboards) in your applications.</simpara>
<simpara>You can access a standalone perspective by using a specific web address in a browser with the <literal>standalone</literal> and <literal>perspective</literal> parameters. A standalone perspective’s web address may also contain additional parameters.</simpara>
</chapter>
<chapter xml:id="using-standalone-perspectives-library-proc">
<title>Using the standalone library perspective</title>
<simpara>You can use the library perspective of Business Central to select a project you want to edit. You can also perform all the authoring functions on the selected project.</simpara>
<simpara>The standalone library perspective can be used in two ways, <emphasis>with</emphasis> and <emphasis>without</emphasis> using the <literal>header=UberfireBreadcrumbsContainer</literal> parameter. The difference is that the address with the <emphasis role="strong"><emphasis>header</emphasis></emphasis> parameter will display a breadcrumb trail on top of the library perspective. Using this link you can create additional <emphasis role="strong">Spaces</emphasis> for your projects.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>Log in to Business Central.</simpara>
</listitem>
<listitem>
<simpara>In a web browser, enter the appropriate web address:</simpara>
<orderedlist numeration="loweralpha">
<listitem>
<simpara>For accessing the standalone library perspective <emphasis>without</emphasis> the <literal>header</literal> parameter</simpara>
<simpara><literal>http://localhost:8080/business-central/kie-wb.jsp?standalone=true&amp;perspective=LibraryPerspective</literal></simpara>
<simpara>The standalone library perspective without the breadcrumb trail opens in the browser.</simpara>
</listitem>
<listitem>
<simpara>For accessing the standalone library perspective <emphasis>with</emphasis> the <literal>header</literal> parameter</simpara>
<simpara><literal>http://localhost:8080/business-central/kie-wb.jsp?standalone=true&amp;perspective=LibraryPerspective&amp;header=UberfireBreadcrumbsContainer</literal></simpara>
<simpara>The standalone library perspective with the breadcrumb trail opens in the browser.</simpara>
</listitem>
</orderedlist>
</listitem>
</orderedlist>
</chapter>
<chapter xml:id="using-standalone-perspectives-standalone-editor-proc">
<title>Using the standalone editor perspective</title>
<simpara>You can use the standalone editor perspective of Business Central to access an asset’s specific editor. By using this perspective, you can open an asset’s editor and can modify the asset as required.</simpara>
<simpara>The web address for accessing an asset’s standalone editor perspective contains the <literal>standalone</literal> and <literal>path</literal> parameters. The <literal>path</literal> parameter must contain the complete path to the asset and the web address can end with <literal><emphasis>#StandaloneEditorPerspective</emphasis></literal> string. Also, by varying the <literal>path</literal> parameter, you can access a specific asset’s editor in the standalone mode.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>Log in to Business Central.</simpara>
</listitem>
<listitem>
<simpara>In a web browser, enter the appropriate web address as required, for example,</simpara>
<orderedlist numeration="loweralpha">
<listitem>
<simpara>For editing a process:</simpara>
<simpara><literal>http://localhost:8080/business-central/kie-wb.jsp?standalone&amp;path=default://master@MySpace/Shop/src/main/resources/com/purchase.bpmn#StandaloneEditorPerspective</literal></simpara>
<simpara>The <emphasis>Process Designer</emphasis> opens in the standalone mode.</simpara>
</listitem>
<listitem>
<simpara>For editing a form:</simpara>
<simpara><literal>http://localhost:8080/business-central/kie-wb.jsp?standalone&amp;path=default://master@MySpace/Mortgage_Process/src/main/resources/ApplicationMortgage.frm#StandaloneEditorPerspective</literal></simpara>
<simpara>The <emphasis>Form Modeler</emphasis> opens in the standalone mode.</simpara>
</listitem>
</orderedlist>
</listitem>
</orderedlist>
</chapter>
<chapter xml:id="using-standalone-perspectives-content-manager-proc">
<title>Using the standalone content manager perspective</title>
<simpara>By using the standalone content manager perspective in your application, you can create and edit your application’s content and its navigation menus.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>Log in to Business Central.</simpara>
</listitem>
<listitem>
<simpara>In a web browser, enter the following web address in the address bar,</simpara>
<simpara><literal>http://localhost:8080/business-central/kie-wb.jsp?standalone=true&amp;perspective=ContentManagerPerspective</literal></simpara>
<simpara>The standalone content manager perspective opens in the browser.</simpara>
</listitem>
</orderedlist>
</chapter>
<chapter xml:id="using-standalone-perspectives-standalone-custom-pages-proc">
<title>Using standalone custom pages(dashboards)</title>
<simpara>Apart from standalone perspectives, you can also embed custom pages, also known as dashboards, in your application. For accessing the custom pages from your application, provide the name of the custom page as the value of the <literal>perspective</literal> parameter. Note that the <literal>perspective</literal> parameter is case-sensitive.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>Log in to Business Central.</simpara>
</listitem>
<listitem>
<simpara>In a web browser, enter the custom page’s web address in the address bar, for example,</simpara>
<simpara><literal>http://localhost:8080/business-central/kie-wb.jsp?standalone=true&amp;perspective=CustomPageName</literal></simpara>
<simpara>The standalone custom page opens in the browser. Replace the value, <emphasis>CustomPageName</emphasis>, with the name of the custom page you want to use in the standalone mode.</simpara>
</listitem>
</orderedlist>
</chapter>
</part>
<part xml:id="assembly-building-custom-dashboard-widgets">
<title>Building custom dashboard widgets</title>
<partintro>
<simpara>As a business analyst or business rules developer, use the <emphasis role="strong">Page Editor</emphasis> tool to design and define your page and specify the information to be displayed on it. You can decide which components are a part of your page. You can also customize the component properties of a page according to your requirements. Optionally, before creating a page, you can define a data set to feed the reporting components of the page.</simpara>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>You have sufficient permissions for creating pages.</simpara>
</listitem>
</itemizedlist>
</partintro>
<chapter xml:id="data_sets_con_building-custom-dashboard-widgets">
<title>Data sets authoring</title>
<simpara>A data set is a collection of related sets of information. It can be stored in many ways, such as in a database, in a Microsoft Excel file, or in memory. A data set definition instructs Business Central methods to access, read, and parse a data set. Business Central does not store data. It enables you to define access to a data set regardless of where the data is stored.</simpara>
<simpara>For example, if data is stored in a database, a valid data set could contain the entire database or a subset of the database as a result of an SQL query. In both cases, the data is used as input for the reporting components of Business Central which then displays the information.</simpara>
<simpara>To access a data set, you must create and register a data set definition. This data set definition specifies the location of the data set, the ways to access it, read it, and parse it, and the columns that it contains.</simpara>
<note>
<simpara>The <emphasis role="strong">Data Sets</emphasis> page is visible only to users with the <emphasis role="strong">admin</emphasis> role.</simpara>
</note>
<section xml:id="data_sets_add_proc_building-custom-dashboard-widgets">
<title>Adding data sets</title>
<simpara>You can create a data set to fetch data from an external data source and use that data for the reporting components.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, go to <emphasis role="strong">Admin</emphasis> → <emphasis role="strong">Data Sets</emphasis>. The <emphasis role="strong">Data Set Explorer</emphasis> page opens.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">New Data Set</emphasis> and select one of the following provider types:</simpara>
<itemizedlist>
<listitem>
<simpara><emphasis role="strong">Bean:</emphasis> Use to generate a data set from a Java class</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">CSV:</emphasis> Use to generate a data set from a remote or local CSV file</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">SQL:</emphasis> Use to generate a data set from an ANSI-SQL compliant database</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Elastic Search:</emphasis> Use to generate a data set from Elastic Search nodes</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Execution Server:</emphasis> Use to generate a data set using the custom query feature of an Execution Server</simpara>
<note>
<simpara><emphasis role="strong">KIE Server</emphasis> must be configured with this option.</simpara>
</note>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>Complete the <emphasis role="strong">Data Set Creation Wizard</emphasis> and click <emphasis role="strong">Test</emphasis>.</simpara>
<note>
<simpara>The configuration steps differ based on the provider you chose.</simpara>
</note>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="data_sets_edit_proc_building-custom-dashboard-widgets">
<title>Editing data sets</title>
<simpara>You can edit existing data sets to ensure that the data fetched to the reporting components is up-to-date.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, go to <emphasis role="strong">Admin</emphasis> → <emphasis role="strong">Data Sets</emphasis>. The <emphasis role="strong">Data Set Explorer</emphasis> page opens.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">Data Set Explorer</emphasis> pane, search for the data set you want to edit and click <emphasis role="strong">Edit</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">Data Set Editor</emphasis> pane, use the appropriate tab to edit the data as required. The tabs differ based on the data set provider type you chose.</simpara>
<simpara>For example, the following changes are applicable for editing a <emphasis role="strong">CSV</emphasis> data provider:</simpara>
<itemizedlist>
<listitem>
<simpara><emphasis role="strong">CSV Configuration:</emphasis> Enables you to change the name of the data set definition, the source file, the separator, and other properties.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Preview:</emphasis> Enables you to preview the data. After you click <emphasis role="strong">Test</emphasis> in the <emphasis role="strong">CSV Configuration</emphasis> tab, the system executes the data set lookup call and if the data is available, a preview appears. Note that the <emphasis role="strong">Preview</emphasis> tab has two sub-tabs:</simpara>
<itemizedlist>
<listitem>
<simpara><emphasis role="strong">Data columns:</emphasis> Enables you to specify what columns are part of your data set definition.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Filter:</emphasis> Enables you to add a new filter.</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara><emphasis role="strong">Advanced:</emphasis> Enables you to manage the following configurations:</simpara>
<itemizedlist>
<listitem>
<simpara><emphasis role="strong">Caching:</emphasis> See <xref linkend="data_sets_caching_con_building-custom-dashboard-widgets"/> for more information.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Cache life-cycle</emphasis> Enables you to specify an interval of time after which a data set (or data) is refreshed. The <emphasis role="strong">Refresh on stale data</emphasis> feature refreshes the cached data when the back-end data changes.</simpara>
</listitem>
</itemizedlist>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>After making the required changes, click <emphasis role="strong">Validate</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="data_sets_refresh_con_building-custom-dashboard-widgets">
<title>Data refresh</title>
<simpara>The data refresh feature enables you to specify an interval of time after which a data set (or data) is refreshed.
The <emphasis role="strong">Refresh on stale data</emphasis> feature refreshes the cached data when the back-end data changes.</simpara>
</section>
<section xml:id="data_sets_caching_con_building-custom-dashboard-widgets">
<title>Caching</title>
<simpara>Business Central provides caching mechanisms for storing data sets and performing data operations using in-memory data. Caching data reduces network traffic, remote system payload, and processing time. To avoid performance issues, configure the cache settings in Business Central.</simpara>
<simpara>For any data lookup call that results in a data set, the caching method determines where the data lookup call is executed and where the resulting data set is stored. An example of a data lookup call would be all the mortgage applications whose locale parameter is set as "Urban".</simpara>
<simpara>Business Central data set functionality provides two cache levels:</simpara>
<itemizedlist>
<listitem>
<simpara>Client level</simpara>
</listitem>
<listitem>
<simpara>Back-end level</simpara>
</listitem>
</itemizedlist>
<bridgehead xml:id="client_cache_2" renderas="sect3" remap="_client_cache_2">Client cache</bridgehead>
<simpara>When the cache is turned on, the data set is cached in a web browser during the lookup operation and further lookup operations do not perform requests to the back-end. Data set operations like grouping, aggregations, filtering, and sorting are processed in the web browser. Enable client caching only if the data set size is small, for example, for data sets with less than 10 MB of data. For large data sets, browser issues such as slow performance or intermittent freezing can occur. Client caching reduces the number of back-end requests including requests to the storage system.</simpara>
<bridgehead xml:id="back_end_cache_2" renderas="sect3" remap="_back_end_cache_2">Back-end cache</bridgehead>
<simpara>When the cache is enabled, the decision engine caches the data set. This reduces the number of back-end requests to the remote storage system. All data set operations are performed in the decision engine using in-memory data. Enable back-end caching only if the data set size is not updated frequently and it can be stored and processed in memory. Using back-end caching is also useful in cases with low latency connectivity issues with the remote storage.</simpara>
<note>
<simpara>Back-end cache settings are not always visible in the <emphasis role="strong">Advanced</emphasis> tab of the <emphasis role="strong">Data Set Editor</emphasis> because Java and CSV data providers rely on back-end caching (data set must be in the memory) in order to resolve any data lookup operation using the in-memory decision engine.</simpara>
</note>
</section>
</chapter>
<chapter xml:id="building_custom_dashboard_widgets_pages_con" remap="_building_custom_dashboard_widgets_pages_con">
<title>Page authoring</title>
<simpara>Pages, also known as perspectives, are collections of following components:</simpara>
<itemizedlist>
<listitem>
<simpara>Core components</simpara>
</listitem>
<listitem>
<simpara>Navigational components</simpara>
</listitem>
<listitem>
<simpara>Reporting components</simpara>
</listitem>
</itemizedlist>
<simpara>Also, a page can have none or any number of components. The <emphasis role="strong">Page Editor</emphasis> tool is used to edit the pages.</simpara>
<simpara>A page has either the <emphasis role="strong">Fluid</emphasis> style or the <emphasis role="strong">Page</emphasis> style. The <emphasis role="strong">Fluid</emphasis> style is a classical web page with a vertical scroll bar, when the page exceeds the available height. The <emphasis role="strong">Page</emphasis> style is a web page that will always fit to the windows height.</simpara>
<section xml:id="building-custom-dashboard-widgets-creating-pages-proc">
<title>Creating pages</title>
<simpara>You can use the Pages perspective to create a page that consists of different types of components. After a page has been created and all the components in it defined, use the <emphasis role="strong">Page Editor</emphasis> to save, delete, rename, or copy pages as required.</simpara>
<simpara>The following procedure describes how to create a page and add the required components to it:</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, go to <emphasis role="strong">Menu</emphasis> → <emphasis role="strong">Design</emphasis> → <emphasis role="strong">Pages</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">Pages</emphasis> panel, click <emphasis role="strong">New</emphasis>.
Alternatively, click <emphasis role="strong">New Page</emphasis> on the <emphasis role="strong">Page Editor</emphasis> pane.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">New Page</emphasis> dialog box, enter a value in the <emphasis role="strong">Name</emphasis> field and select the required style.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Ok</emphasis>. The new page opens in the <emphasis role="strong">Page Editor</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">Components</emphasis> pane, expand the components and drag the required component types to the editor canvass.</simpara>
</listitem>
<listitem>
<simpara>After placing the components on the page, edit its properties from the <emphasis role="strong">Properties</emphasis> pane.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis> and then click <emphasis role="strong">Save</emphasis> again.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="pages-save-del-rename-copy_proc">
<title>Saving, deleting, renaming, or copying pages</title>
<simpara>After you have created and defined a page, use the <emphasis role="strong">Page Editor</emphasis> to save, delete, rename, or copy pages as required.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, go to <emphasis role="strong">Menu</emphasis> → <emphasis role="strong">Design</emphasis> → <emphasis role="strong">Pages</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Select a page from the <emphasis role="strong">Pages</emphasis> panel. The page opens in the <emphasis role="strong">Page Editor</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Perform the desired operation and select <emphasis role="strong">Save</emphasis>, <emphasis role="strong">Delete</emphasis>, <emphasis role="strong">Rename</emphasis>, or <emphasis role="strong">Copy</emphasis> from the upper right corner of the <emphasis role="strong">Page Editor</emphasis>.</simpara>
</listitem>
</orderedlist>
<figure>
<title>Save, delete, rename, or copy pages</title>
<mediaobject>
<imageobject>
<imagedata fileref="images/_images/pages/pages-save-del-rename-copy.png" contentwidth="delete" contentdepth="rename"/>
</imageobject>
<textobject><phrase>Save</phrase></textobject>
</mediaobject>
</figure>
</section>
<section xml:id="building-custom-dashboard-widgets-workbench-tree-con">
<title>Navigation tree</title>
<simpara>The <emphasis role="strong">Workbench</emphasis> navigation tree contains the entries that are displayed in Business Central’s <emphasis role="strong">Main</emphasis> menu. Changes to this navigation tree structure will be reflected in the <emphasis role="strong">Main</emphasis> menu on the Home page. Such mechanism can be used, for example, to publish new pages.</simpara>
<simpara>Also, additional navigation trees can be created. These custom trees can be used to configure the navigation components within a page. You cannot delete the <emphasis role="strong">Workbench</emphasis> tree from the <emphasis role="strong">Navigation</emphasis> panel but you can edit the <emphasis role="strong">Workbench</emphasis> tree hierarchy to suit your requirements. This feature helps users customize the <emphasis role="strong">Main</emphasis> menu of Business Central with new pages.</simpara>
<note>
<simpara>The <emphasis role="strong">Workbench</emphasis> tree, which appears by default in the <emphasis role="strong">Navigation</emphasis> panel, is the main <emphasis role="strong">Menu</emphasis> of Business Central.</simpara>
</note>
<section xml:id="building-custom-dashboard-widgets-creating-navigation-tree-proc">
<title>Creating a navigation tree</title>
<simpara>You can create as many custom navigation trees as required. A custom navigation tree differs from the default <emphasis role="strong">Workbench</emphasis> navigation tree in one aspect. The custom navigation trees can be deleted but the default tree can not be removed from Business Central. They can contain the default groups and entries from the <emphasis role="strong">Workbench</emphasis> tree as well as user created groups and trees.</simpara>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>You have sufficient user permissions for creating a navigation tree.</simpara>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>Log in to Business Central and go to <emphasis role="strong">Menu</emphasis> → <emphasis role="strong">Design</emphasis> → <emphasis role="strong">Pages</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Select the <emphasis role="strong">Navigation</emphasis> panel and then click <emphasis role="strong">New</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Enter the name of the new navigation tree and click the check mark icon or, press Enter.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="building-custom-dashboard-widgets-editing-navigation-tree-con">
<title>Editing a navigation tree</title>
<simpara>You can use the <emphasis role="strong">Navigation</emphasis> panel from the Pages perspective to edit the custom navigation trees. You can further customize the trees by adding groups, dividers, and page entries, deleting the specific entries of the tree, and reordering, renaming, or deleting them.</simpara>
<itemizedlist>
<title>Prerequisites</title>
<listitem>
<simpara>You have sufficient user permissions for editing a navigation tree.</simpara>
</listitem>
</itemizedlist>
</section>
<section xml:id="building-custom-dashboard-widgets-adding-entries-navigation-tree-proc">
<title>Adding groups, dividers, and page entries to a navigation tree</title>
<simpara>You can add groups, dividers, and page entries to a navigation tree.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, go to <emphasis role="strong">Menu</emphasis> → <emphasis role="strong">Design</emphasis> → <emphasis role="strong">Pages</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click the <emphasis role="strong">Navigation</emphasis> panel and then select the navigation tree you want to add the entries to.</simpara>
</listitem>
<listitem>
<simpara>Click the gear icon of the tree and then select <emphasis role="strong">New Group</emphasis>, <emphasis role="strong">New Divider</emphasis>, or <emphasis role="strong">New Page</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Enter the name of the new group or page and click the check mark icon or press Enter.</simpara>
<note>
<simpara>Divider entries do not have a name property.</simpara>
</note>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="building-custom-dashboard-widgets-reordering-entries-navigation-tree-proc">
<title>Reordering a navigation tree</title>
<simpara>In the <emphasis role="strong">Navigation</emphasis> panel you can reorder the navigation trees as well as its entries.</simpara>
<note>
<simpara>The reordering options of tree entries will differ according to their position in the tree hierarchy.</simpara>
</note>
<bridgehead xml:id="reordering_navigation_trees" renderas="sect4" remap="_reordering_navigation_trees">Reordering navigation trees</bridgehead>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, go to <emphasis role="strong">Menu</emphasis> → <emphasis role="strong">Design</emphasis> → <emphasis role="strong">Pages</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click the <emphasis role="strong">Navigation</emphasis> panel and then select the navigation tree you want to reorder.</simpara>
</listitem>
<listitem>
<simpara>Click the gear icon of the tree and then move up or down as required.</simpara>
<note>
<simpara>First and last entries of a navigation tree have only two reordering options available.</simpara>
</note>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
</orderedlist>
<bridgehead xml:id="reordering_the_entries_of_a_navigation_tree" renderas="sect4" remap="_reordering_the_entries_of_a_navigation_tree">Reordering the entries of a navigation tree</bridgehead>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, go to <emphasis role="strong">Menu</emphasis> → <emphasis role="strong">Design</emphasis> → <emphasis role="strong">Pages</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click the <emphasis role="strong">Navigation</emphasis> panel and then expand the navigation tree.</simpara>
</listitem>
<listitem>
<simpara>Click the gear icon of the entry you want to reorder and then move up or down as required.</simpara>
</listitem>
<listitem>
<simpara>Optional: Click <emphasis role="strong">Goto Page</emphasis> to view the selected page.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="building-custom-dashboard-widgets-renaming-navigation-tree-proc">
<title>Renaming a navigation tree</title>
<simpara>You can rename all navigation trees except the Workbench tree.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, go to <emphasis role="strong">Menu</emphasis> → <emphasis role="strong">Design</emphasis> → <emphasis role="strong">Pages</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click the <emphasis role="strong">Navigation</emphasis> panel and then select the custom navigation tree you want to rename.</simpara>
<note>
<simpara>To rename an entry of a tree, expand the tree and select the entry that you want to rename.</simpara>
</note>
</listitem>
<listitem>
<simpara>Click the edit icon of the tree or the tree entry.</simpara>
</listitem>
<listitem>
<simpara>Enter the new name of the tree and click the check mark icon.</simpara>
<note>
<simpara>You cannot rename divider entries.</simpara>
</note>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="building-custom-dashboard-widgets-deleting-navigation-tree-proc">
<title>Deleting a navigation tree</title>
<simpara>You can delete any navigation tree except the <emphasis role="strong">Workbench</emphasis> tree from the <emphasis role="strong">Navigation</emphasis> panel of the Pages perspective.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, go to <emphasis role="strong">Menu</emphasis> → <emphasis role="strong">Design</emphasis> → <emphasis role="strong">Pages</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">Navigation</emphasis> panel, select the navigation tree that you want to delete, then click the delete icon.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="building-custom-dashboard-widgets-deleting-entries-navigation-tree-proc">
<title>Deleting the entries of a navigation tree</title>
<simpara>You can delete the entries of a navigation tree.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, go to <emphasis role="strong">Menu</emphasis> → <emphasis role="strong">Design</emphasis> → <emphasis role="strong">Pages</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click the <emphasis role="strong">Navigation</emphasis> panel.</simpara>
</listitem>
<listitem>
<simpara>Expand the tree that contains the entries you want delete.</simpara>
</listitem>
<listitem>
<simpara>Click the delete icon of the entry.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
</orderedlist>
</section>
</section>
<section xml:id="building-custom-dashboard-widgets-components-con">
<title>Components</title>
<simpara>A page contains different types of components. You can use the following component types in a page:</simpara>
<itemizedlist>
<listitem>
<simpara><emphasis role="strong">Core</emphasis> components: Used to specify custom HTML information or display existing pages. There are two types of core components.</simpara>
</listitem>
</itemizedlist>
<table frame="all" rowsep="1" colsep="1">
<title>Core component sub-types</title>
<tgroup cols="2">
<colspec colname="col_1" colwidth="50*"/>
<colspec colname="col_2" colwidth="50*"/>
<thead>
<row>
<entry align="left" valign="top">Core component sub-types</entry>
<entry align="left" valign="top">Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><emphasis role="strong">HTML</emphasis></simpara></entry>
<entry align="left" valign="top"><simpara>This component opens an HTML editor widget. This can be used to create HTML pages using text, images, tables, links, colors, and so on. You can customize the page as per your requirements.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><emphasis role="strong">Page</emphasis></simpara></entry>
<entry align="left" valign="top"><simpara>This component allows you to add previously created pages to a new dashboard. You can use this component to nest custom pages you have already created in your dashboard.</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<note>
<simpara>Core components are not mandatory.</simpara>
</note>
<itemizedlist>
<listitem>
<simpara><emphasis role="strong">Navigation</emphasis> components: Used for navigating between pages. There are six types of navigation components.</simpara>
</listitem>
</itemizedlist>
<table frame="all" rowsep="1" colsep="1">
<title>Navigation component sub-types</title>
<tgroup cols="2">
<colspec colname="col_1" colwidth="50*"/>
<colspec colname="col_2" colwidth="50*"/>
<thead>
<row>
<entry align="left" valign="top">Navigation component sub-types</entry>
<entry align="left" valign="top">Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><emphasis role="strong">Target Div</emphasis></simpara></entry>
<entry align="left" valign="top"><simpara>This component is used by the Tab list, Menu bar, and the Tree navigator components to display their entries and keep track of the last item clicked.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><emphasis role="strong">Menu Bar</emphasis></simpara></entry>
<entry align="left" valign="top"><simpara>This component displays the entries of a navigation tree in the form of a menu bar. There is no limit to the number of levels supported by Business Central.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><emphasis role="strong">Tile Navigator</emphasis></simpara></entry>
<entry align="left" valign="top"><simpara>This component displays the navigation group in the form of tiles. Groups are displayed as folders but for single entries, its content is displayed instead when selected.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><emphasis role="strong">Tree</emphasis></simpara></entry>
<entry align="left" valign="top"><simpara>This component displays the entries in a vertical tree structure format.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><emphasis role="strong">Carousel</emphasis></simpara></entry>
<entry align="left" valign="top"><simpara>This component displays or cycles through the selected pages like a carousel or a slide show.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><emphasis role="strong">Tab List</emphasis></simpara></entry>
<entry align="left" valign="top"><simpara>This component displays selected menu pages as tabs at the top of the component.</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<note>
<simpara>The target div setting is <emphasis role="strong">not</emphasis> needed for non-target div components such as Carousel or Tile navigator.</simpara>
</note>
<itemizedlist>
<listitem>
<simpara><emphasis role="strong">Reporting</emphasis> components: Used for displaying data from data sets (see <link linkend="data_sets_con_building-custom-dashboard-widgets">Data sets authoring</link> section) in the form of graphs, tables, maps, and so on. There are ten types of reporting components. The reporting components can be configured using the <emphasis role="strong">New Displayer</emphasis> widget, which has the following three tabs:</simpara>
<itemizedlist>
<listitem>
<simpara><emphasis role="strong">Type</emphasis>: Choose how to display custom data graphically.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Data</emphasis>: Choose a data set from the list of custom data sets that you had created from the <emphasis role="strong">Data Sets</emphasis> section available in the <emphasis role="strong">Settings</emphasis> menu.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Display</emphasis>: Edit and customize how the content is displayed by adding titles, changing colors, size, and so on.</simpara>
</listitem>
</itemizedlist>
</listitem>
</itemizedlist>
<section xml:id="building-custom-dashboard-widgets-placing-components-proc">
<title>Placing components on the page editor to create a page</title>
<simpara>To create pages, you must drag the components to the <emphasis role="strong">Editor</emphasis> canvas of the Pages perspective. After placing all of the required components on the page, click <emphasis role="strong">Save</emphasis>.</simpara>
</section>
<section xml:id="building-custom-dashboard-widgets-previewing-pages-proc">
<title>Using the Preview tab to preview pages</title>
<simpara>While creating or editing pages, click the <emphasis role="strong">Preview</emphasis> tab on the <emphasis role="strong">Page Editor</emphasis> to preview a page before saving it.</simpara>
</section>
<section xml:id="building-custom-dashboard-widgets-components-properties-ref">
<title>Component properties</title>
<simpara>The components used in a page have different properties associated with them. The <emphasis role="strong">Properties</emphasis> panel enables you to customize a component by editing the following properties:</simpara>
<itemizedlist>
<listitem>
<simpara><emphasis role="strong">Panel</emphasis> properties: Used to customize component panel properties such as <emphasis role="strong">Width</emphasis>, <emphasis role="strong">Height</emphasis>, and <emphasis role="strong">Background Color</emphasis>.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Margin</emphasis> properties: Used to customize component margin properties such as <emphasis role="strong">Top</emphasis>, <emphasis role="strong">Bottom</emphasis>, <emphasis role="strong">Left</emphasis>, and <emphasis role="strong">Right</emphasis>.</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">Padding</emphasis> properties: Used to customize component padding properties such as <emphasis role="strong">Top</emphasis>, <emphasis role="strong">Bottom</emphasis>, <emphasis role="strong">Left</emphasis>, and <emphasis role="strong">Right</emphasis>.</simpara>
</listitem>
</itemizedlist>
<note>
<simpara><emphasis role="strong">HTML</emphasis> components also have additional text properties to customize component <emphasis role="strong">Alignment</emphasis>, <emphasis role="strong">Decoration</emphasis>, <emphasis role="strong">Color</emphasis>, <emphasis role="strong">Size</emphasis>, and <emphasis role="strong">Weight</emphasis> properties.</simpara>
</note>
</section>
</section>
<section xml:id="building-custom-dashboard-widgets-external-components-con">
<title>External components</title>
<simpara>In Business Central, you can add external components to a page. The components are disabled by default. To enable the external components, change the value of <literal>dashbuilder.components.enable</literal> system property to <literal>true</literal>.</simpara>
<simpara>The external component location is set and configured with the <literal>dashbuilder.components.dir</literal> system property. The default value of this system property is <literal>/tmp/dashbuilder/components</literal>.
You must set the component under the components directory with a parent directory, which is used as the component ID. For example, if the component ID is <literal>mycomp</literal> and the component directory is <literal>/tmp/dashbuilder/components</literal>, then the component base directory is <literal>/tmp/dashbuilder/components/mycomp</literal>.</simpara>
<simpara>Business Central checks the <literal>manifest.json</literal> file in the components directory. The <literal>manifest.json</literal> must contain at least one <literal>name</literal> text parameter.</simpara>
<table frame="all" rowsep="1" colsep="1">
<title>manifest.json file descriptions</title>
<tgroup cols="2">
<colspec colname="col_1" colwidth="50*"/>
<colspec colname="col_2" colwidth="50*"/>
<thead>
<row>
<entry align="left" valign="top">Parameter</entry>
<entry align="left" valign="top">Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara><literal>name</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Name of the component displayed under <emphasis role="strong">Components</emphasis> section.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>icon</literal></simpara></entry>
<entry align="left" valign="top"><simpara>Icon of the component displayed under <emphasis role="strong">Components</emphasis> section.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>noData</literal></simpara></entry>
<entry align="left" valign="top"><simpara>A flag that indicates that the component does not require a data set.</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara><literal>parameters</literal></simpara></entry>
<entry align="left" valign="top"><simpara>The list of parameters are using <literal>ComponentParameter</literal> type. Supported parameter types include <literal>name</literal>, <literal>type</literal>, <literal>category</literal>, <literal>defaultValue</literal>, <literal>label</literal>, and <literal>comboValues</literal>.</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<formalpara>
<title>Sample <literal>manifest.json</literal> file</title>
<para>
<programlisting language="json" linenumbering="unnumbered">{
    "name": "Heat Map Experiment",
    "icon": "fa fa-bell-o",
    "parameters": [
        {
            "name": "svg",
            "type": "text",
            "defaultValue": "",
            "label": "SVG XML",
            "category": "SVG Content"
        },
        {
            "name": "svgUrl",
            "type": "text",
            "defaultValue": "",
            "label": "SVG URL",
            "category": "SVG URL"
        }
        ,
        {
            "name": "ksProcessId",
            "type": "text",
            "defaultValue": "",
            "label": "Process ID",
            "category": "Kie Server"
        }
    ]
}</programlisting>
</para>
</formalpara>
<section xml:id="building-custom-dashboard-widgets-creating-external-components-proc">
<title>Creating external components</title>
<simpara>The following procedure describes how to create and add the external components to a page:</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>Set the component under components directory with a parent directory.</simpara>
<simpara>For example, if the component ID is <literal>mycomp</literal> and the component directory is <literal>/tmp/dashbuilder/components</literal>, then the component base directory is <literal>/tmp/dashbuilder/components/mycomp</literal>.</simpara>
</listitem>
<listitem>
<simpara>Create the <literal>manifest.json</literal> file in the component directory.</simpara>
</listitem>
<listitem>
<simpara>Create <literal>index.html</literal> file with HTML content.</simpara>
</listitem>
<listitem>
<simpara>In a terminal application, navigate to <literal>EAP_HOME/bin</literal>.</simpara>
</listitem>
<listitem>
<simpara>To enable the external components, set the value of <literal>dashbuilder.components.enable</literal> system property to <literal>true</literal>:</simpara>
<screen>$ ~/EAP_HOME/bin/standalone.sh -c standalone-full.xml
-Ddashbuilder.components.dir={component directory base path} -Ddashbuilder.components.enable=true</screen>
</listitem>
<listitem>
<simpara>Start Business Central, go to <emphasis role="strong">Menu → Design → Pages</emphasis>.</simpara>
<simpara><emphasis role="strong">External Components</emphasis> is available under <emphasis role="strong">Components</emphasis> pane.</simpara>
</listitem>
<listitem>
<simpara>In the <emphasis role="strong">Components</emphasis> pane, expand the <emphasis role="strong">External Components</emphasis> and drag the required component types to the canvas.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
</orderedlist>
</section>
</section>
</chapter>
<chapter xml:id="business-central-settings-security-proc_building-custom-dashboard-widgets">
<title>Security management</title>
<simpara>You can perform security and permission management tasks from the <emphasis role="strong">Security management</emphasis> page. To access the <emphasis role="strong">Security management</emphasis> page, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and click <emphasis role="strong">Roles</emphasis>, <emphasis role="strong">Groups</emphasis>, or <emphasis role="strong">Users</emphasis> on the Business Central <emphasis role="strong">Settings</emphasis> page. Depending on which icon you click, the <emphasis role="strong">Security management</emphasis> page opens for the respective tab. Use roles and groups to manage privileges and settings for users. Any changes apply to all users with the affected role or group.</simpara>
<section xml:id="business-central-settings-creating-new-users-proc_building-custom-dashboard-widgets">
<title>Creating users</title>
<simpara>User privileges and settings are controlled by the roles assigned to a user and the groups that a user belongs to. You can create any number of users in Business Central.</simpara>
<note>
<simpara>Do not create a user called <literal>unknown</literal> in process engine or KIE Server. The <literal>unknown</literal> user account is a reserved system name with superuser access. The <literal>unknown</literal> user account performs tasks related to the SLA violation listener when there are no users logged in.</simpara>
</note>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Users</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">New user</emphasis>, enter a user name, and then click <emphasis role="strong">Next</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>To assign roles to the user, click the <emphasis role="strong">Roles</emphasis> tab, click <emphasis role="strong">Add Roles</emphasis>, select the desired roles, and click <emphasis role="strong">Add to selected roles</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Optional: To assign groups to the user, click the <emphasis role="strong">Groups</emphasis> tab, click <emphasis role="strong">Add to groups</emphasis>, select the desired groups, and click <emphasis role="strong">Add to selected groups</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Create</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Yes</emphasis> to set a password for the user, enter a desired password, and click <emphasis role="strong">Change</emphasis>.</simpara>
</listitem>
</orderedlist>
<note>
<simpara>The user must have at least one role to access Business Central.</simpara>
</note>
</section>
<section xml:id="business-central-settings-creating-new-groups-proc">
<title>Creating groups</title>
<simpara>Groups enable you to control privileges and settings for a collection of users. You can create as many groups as you require.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Groups</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">New group</emphasis>, enter a group name, and then click <emphasis role="strong">Next</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Select the users that you want to add to this group, and then click <emphasis role="strong">Add selected users</emphasis>.</simpara>
<simpara>The newly created group is listed under <emphasis role="strong">All groups</emphasis>.</simpara>
</listitem>
</orderedlist>
</section>
<section xml:id="business-central-settings-changing-permissions-proc_building-custom-dashboard-widgets">
<title>Changing permissions for groups and roles</title>
<simpara>You cannot change permissions for an individual user. However, you can change permissions for groups and roles. The changed permissions apply to users that have the role or belong to the group that you changed.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Roles</emphasis> or <emphasis role="strong">Groups</emphasis> to open the corresponding list.</simpara>
</listitem>
<listitem>
<simpara>From the list, click the role or group you want to edit. All details are displayed in the right pane.</simpara>
</listitem>
<listitem>
<simpara>Set the <emphasis role="strong">Home Page</emphasis> or <emphasis role="strong">Priority</emphasis> under the <emphasis role="strong">Settings</emphasis> section.</simpara>
</listitem>
<listitem>
<simpara>Set the Business Central, page, editor, space, and project permissions under the <emphasis role="strong">Permissions</emphasis> section.</simpara>
<simpara>You can expand the resource type whose permissions you want to change.</simpara>
</listitem>
<listitem>
<simpara>Optional: To add an item not listed, click <emphasis role="strong">Add Exception</emphasis> and then set the permissions as required.</simpara>
<note>
<simpara>You cannot add an exception to the Business Central resource type.</simpara>
</note>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
</orderedlist>
<note>
<simpara>Any changes you make to roles or groups affect all of the users associated with that role or group.</simpara>
</note>
</section>
<section xml:id="business-central-settings-changing-home-proc">
<title>Changing the home page</title>
<simpara>The home page is the page that appears after you log on to Business Central. By default, the home page is set to Home. You can change the home page for roles and groups.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Roles</emphasis> or <emphasis role="strong">Groups</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Select a role or group.</simpara>
</listitem>
<listitem>
<simpara>Select a page from the <emphasis role="strong">Home Page</emphasis> list.</simpara>
</listitem>
<listitem>
<simpara>Click <emphasis role="strong">Save</emphasis>.</simpara>
<note>
<simpara>The role or group must have read access to a page before you can make it the home page.</simpara>
</note>
</listitem>
</orderedlist>
</section>
<section xml:id="business-central-settings-setting-priorities-proc">
<title>Setting priorities</title>
<simpara>A user can have multiple roles and belong to multiple groups. The Priority setting determines the order of precedence of a role or group.</simpara>
<orderedlist numeration="arabic">
<title>Procedure</title>
<listitem>
<simpara>In Business Central, select the <emphasis role="strong">Admin</emphasis> icon in the top-right corner of the screen and select <emphasis role="strong">Roles</emphasis> or <emphasis role="strong">Groups</emphasis>.</simpara>
</listitem>
<listitem>
<simpara>Select a role or group.</simpara>
</listitem>
<listitem>
<simpara>Select a priority from the Priority menu, and then click <emphasis role="strong">Save</emphasis>.</simpara>
</listitem>
</orderedlist>
<note>
<simpara>If a user has a role or belongs to a group that has conflicting settings, the settings of the role or group with the highest priority applies.</simpara>
</note>
</section>
</chapter>
<chapter xml:id="building-custom-dashboard-widgets-creating-dashboard-proc">
<title>Creating a custom dashboard widget</title>
<simpara>In order to create custom dashboards, users must combine some of the features of the Business Central (like data sets, pages, navigation trees, and permissions) together and publish them. Dashboards are pages containing at least one reporting component.</simpara>
<simpara>There are four stages in the creation of a custom dashboard:</simpara>
<itemizedlist>
<listitem>
<simpara>Data set authoring - In this stage, you define a data set for accessing the data and displaying it through the pages. For more information, see <link linkend="data_sets_add_proc_building-custom-dashboard-widgets">Adding data sets</link>.</simpara>
</listitem>
<listitem>
<simpara>Page authoring - In this stage, you create the pages which are used to display the data from the data sets, among other things. For more information, see <link linkend="building-custom-dashboard-widgets-creating-pages-proc">Creating pages</link>.</simpara>
</listitem>
<listitem>
<simpara>Publication - In this stage, navigation between pages are defined when you create the custom navigation trees or modify the existing default one (<emphasis role="strong">Workbench</emphasis> tree). For more information, see <link linkend="building-custom-dashboard-widgets-creating-navigation-tree-proc">Creating a navigation tree</link> or <link linkend="building-custom-dashboard-widgets-editing-navigation-tree-con">Editing a navigation tree</link>.</simpara>
</listitem>
<listitem>
<simpara>Security management - In this stage, role and group permissions are set which defines the privileges a user enjoys when working on Business Central. For more information, see <link linkend="business-central-settings-security-proc_building-custom-dashboard-widgets">Security management</link>.</simpara>
</listitem>
</itemizedlist>
<note>
<simpara>You will have to follow the stages listed above if you plan on migrating your dashboards from previous versions of Business Central to the latest one. Note that there is no automatic migration path or tooling to assist you in that regard. You must recreate all your dashboards from scratch.</simpara>
</note>
</chapter>
</part>
<appendix xml:id="versioning-information">
<title>Versioning information</title>
<simpara>Documentation last updated on Monday, January 18, 2021.</simpara>
</appendix>
<appendix xml:id="author-group">
<title>Contact information</title>
<simpara>Red Hat Process Automation Manager documentation team: <link xlink:href="mailto:brms-docs@redhat.com">brms-docs@redhat.com</link></simpara>
</appendix>
</book>