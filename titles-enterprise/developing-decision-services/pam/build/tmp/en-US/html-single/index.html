<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" class="chrometwo"><head><title>Developing decision services in Red Hat Process Automation Manager</title><link rel="stylesheet" type="text/css" href="Common_Content/css/default.css"/><meta name="generator" content="publican v4.3.6"/><meta name="description" content="This document describes how to develop decision services with Red Hat Process Automation Manager using Decision Model and Notation (DMN) models, Drools Rule Language (DRL) files, guided decision tables, and other decision-authoring assets."/><link rel="next" href="#idm139921829023248" title="Preface"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><script type="text/javascript" src="Common_Content/scripts/jquery-1.7.1.min.js"> </script><script type="text/javascript" src="Common_Content/scripts/utils.js"> </script><script type="text/javascript" src="Common_Content/scripts/highlight.js/highlight.pack.js"> </script></head><body><div id="chrometwo"><div id="main"><div xml:lang="en-US" class="book" id="idm139921848074128"><div class="titlepage"><div><div class="producttitle"><span class="productname">Red Hat Process Automation Manager</span> <span class="productnumber">7.10</span></div><div><h1 class="title">Developing decision services in Red Hat Process Automation Manager</h1></div><div><h2 class="subtitle"/></div><div><a href="#idm139921835421024">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				This document describes how to develop decision services with Red Hat Process Automation Manager using Decision Model and Notation (DMN) models, Drools Rule Language (DRL) files, guided decision tables, and other decision-authoring assets.
			</div></div></div></div><hr/></div><div class="toc"><ul class="toc"><li><span class="preface"><a href="#idm139921829023248">Preface</a></span></li><li><span class="preface"><a href="#snip-conscious-language_developing-decision-services">Making open source more inclusive</a></span></li><li><span class="part"><a href="#assembly-dmn-models">I. Designing a decision service using DMN models</a></span><ul><li><span class="chapter"><a href="#decision-authoring-assets-ref_dmn-models">1. Decision-authoring assets in Red Hat Process Automation Manager</a></span></li><li><span class="chapter"><a href="#con-BPMN-DMN-modelers_dmn-models">2. Red Hat Process Automation Manager BPMN and DMN modelers</a></span><ul><li><span class="section"><a href="#proc-vscode-extension_dmn-models">2.1. Installing the Red Hat Process Automation Manager VSCode extension bundle</a></span></li><li><span class="section"><a href="#proc-standalone-editors_dmn-models">2.2. Configuring the Red Hat Process Automation Manager standalone editors</a></span></li></ul></li><li><span class="chapter"><a href="#dmn-con_dmn-models">3. Decision Model and Notation (DMN)</a></span><ul><li><span class="section"><a href="#dmn-conformance-levels-con_dmn-models">3.1. DMN conformance levels</a></span></li><li><span class="section"><a href="#dmn-drd-components-ref_dmn-models">3.2. DMN decision requirements diagram (DRD) components</a></span></li><li><span class="section"><a href="#dmn-feel-con_dmn-models">3.3. Rule expressions in FEEL</a></span><ul><li><span class="section"><a href="#dmn-feel-data-types-ref_dmn-models">3.3.1. Data types in FEEL</a></span></li><li><span class="section"><a href="#ref-dmn-feel-builtin-functions_dmn-models">3.3.2. Built-in functions in FEEL</a></span></li><li><span class="section"><a href="#dmn-feel-variable-function-names-ref_dmn-models">3.3.3. Variable and function names in FEEL</a></span></li></ul></li><li><span class="section"><a href="#dmn-boxed-expressions-con_dmn-models">3.4. DMN decision logic in boxed expressions</a></span><ul><li><span class="section"><a href="#dmn-decision-tables-con_dmn-models">3.4.1. DMN decision tables</a></span></li><li><span class="section"><a href="#dmn-literal-expressions-con_dmn-models">3.4.2. Boxed literal expressions</a></span></li><li><span class="section"><a href="#dmn-context-expressions-con_dmn-models">3.4.3. Boxed context expressions</a></span></li><li><span class="section"><a href="#dmn-relation-expressions-con_dmn-models">3.4.4. Boxed relation expressions</a></span></li><li><span class="section"><a href="#dmn-function-expressions-con_dmn-models">3.4.5. Boxed function expressions</a></span></li><li><span class="section"><a href="#dmn-invocation-expressions-con_dmn-models">3.4.6. Boxed invocation expressions</a></span></li><li><span class="section"><a href="#dmn-list-expressions-con_dmn-models">3.4.7. Boxed list expressions</a></span></li></ul></li><li><span class="section"><a href="#dmn-model-example-ref_dmn-models">3.5. DMN model example</a></span></li></ul></li><li><span class="chapter"><a href="#dmn-support-con_dmn-models">4. DMN support in Red Hat Process Automation Manager</a></span><ul><li><span class="section"><a href="#dmn-properties-ref_dmn-models">4.1. Configurable DMN properties in Red Hat Process Automation Manager</a></span></li><li><span class="section"><a href="#dmn-validation-con_dmn-models">4.2. Configurable DMN validation in Red Hat Process Automation Manager</a></span></li></ul></li><li><span class="chapter"><a href="#dmn-model-creating-proc_dmn-models">5. Creating and editing DMN models in Business Central</a></span><ul><li><span class="section"><a href="#dmn-logic-defining-proc_dmn-models">5.1. Defining DMN decision logic in boxed expressions in Business Central</a></span></li><li><span class="section"><a href="#dmn-data-types-defining-proc_dmn-models">5.2. Creating custom data types for DMN boxed expressions in Business Central</a></span></li><li><span class="section"><a href="#dmn-included-models-con_dmn-models">5.3. Included models in DMN files in Business Central</a></span><ul><li><span class="section"><a href="#dmn-included-models-dmn-proc_dmn-models">5.3.1. Including other DMN models within a DMN file in Business Central</a></span></li><li><span class="section"><a href="#dmn-included-models-pmml-proc_dmn-models">5.3.2. Including PMML models within a DMN file in Business Central</a></span></li></ul></li><li><span class="section"><a href="#dmn-model-creating-multiples-proc_dmn-models">5.4. Creating DMN models with multiple diagrams in Business Central</a></span></li><li><span class="section"><a href="#dmn-documentation-con_dmn-models">5.5. DMN model documentation in Business Central</a></span></li><li><span class="section"><a href="#dmn-designer-nav-ref_dmn-models">5.6. DMN designer navigation and properties in Business Central</a></span></li></ul></li><li><span class="chapter"><a href="#dmn-execution-con_dmn-models">6. DMN model execution</a></span><ul><li><span class="section"><a href="#dmn-execution-embedded-proc">6.1. Embedding a DMN call directly in a Java application</a></span></li><li><span class="section"><a href="#dmn-execution-remote-java-proc">6.2. Executing a DMN service using the KIE Server Java client API</a></span></li><li><span class="section"><a href="#dmn-execution-rest-proc_dmn-models">6.3. Executing a DMN service using the KIE Server REST API</a></span></li></ul></li><li><span class="chapter"><a href="#additional_resources">7. Additional resources</a></span></li></ul></li><li><span class="part"><a href="#assembly-pmml-models">II. Designing a decision service using PMML models</a></span><ul><li><span class="chapter"><a href="#decision-authoring-assets-ref_pmml-models">8. Decision-authoring assets in Red Hat Process Automation Manager</a></span></li><li><span class="chapter"><a href="#pmml-con_pmml-models">9. Predictive Model Markup Language (PMML)</a></span><ul><li><span class="section"><a href="#pmml-conformance-con_pmml-models">9.1. PMML conformance levels</a></span></li></ul></li><li><span class="chapter"><a href="#pmml-examples-ref_pmml-models">10. PMML model examples</a></span></li><li><span class="chapter"><a href="#pmml-support-con_pmml-models">11. PMML support in Red Hat Process Automation Manager</a></span><ul><li><span class="section"><a href="#pmml-naming-conventions-ref_pmml-models">11.1. PMML naming conventions in Red Hat Process Automation Manager</a></span></li><li><span class="section"><a href="#pmml-extensions-ref_pmml-models">11.2. PMML extensions in Red Hat Process Automation Manager</a></span></li></ul></li><li><span class="chapter"><a href="#pmml-invocation-options-con_pmml-models">12. PMML model execution</a></span><ul><li><span class="section"><a href="#pmml-invocation-embedded-proc_pmml-models">12.1. Embedding a PMML call directly in a Java application</a></span><ul><li><span class="section"><a href="#pmml-invocation-helper-classes-ref_pmml-models">12.1.1. PMML execution helper class</a></span></li></ul></li><li><span class="section"><a href="#pmml-invocation-kie-server-proc_pmml-models">12.2. Executing a PMML model using KIE Server</a></span></li></ul></li><li><span class="chapter"><a href="#additional_resources_2">13. Additional resources</a></span></li></ul></li><li><span class="part"><a href="#assembly-drl-rules">III. Designing a decision service using DRL rules</a></span><ul><li><span class="chapter"><a href="#decision-authoring-assets-ref_drl-rules">14. Decision-authoring assets in Red Hat Process Automation Manager</a></span></li><li><span class="chapter"><a href="#drl-rules-con_drl-rules">15. DRL (Drools Rule Language) rules</a></span><ul><li><span class="section"><a href="#drl-packages-con_drl-rules">15.1. Packages in DRL</a></span></li><li><span class="section"><a href="#drl-imports-con_drl-rules">15.2. Import statements in DRL</a></span></li><li><span class="section"><a href="#drl-functions-con_drl-rules">15.3. Functions in DRL</a></span></li><li><span class="section"><a href="#drl-queries-con_drl-rules">15.4. Queries in DRL</a></span></li><li><span class="section"><a href="#drl-declarations-con_drl-rules">15.5. Type declarations and metadata in DRL</a></span><ul><li><span class="section"><a href="#drl-declarations-without-metadata-con_drl-rules">15.5.1. Type declarations without metadata in DRL</a></span></li><li><span class="section"><a href="#drl-declarations-enumerative-con_drl-rules">15.5.2. Enumerative type declarations in DRL</a></span></li><li><span class="section"><a href="#drl-declarations-extended-con_drl-rules">15.5.3. Extended type declarations in DRL</a></span></li><li><span class="section"><a href="#drl-declarations-with-metadata-con_drl-rules">15.5.4. Type declarations with metadata in DRL</a></span></li><li><span class="section"><a href="#drl-declarations-metadata-tags-ref_drl-rules">15.5.5. Metadata tags for fact type and attribute declarations in DRL</a></span></li><li><span class="section"><a href="#property-change-listeners-con_drl-rules">15.5.6. Property-change settings and listeners for fact types</a></span></li><li><span class="section"><a href="#drl-declarations-access-con_drl-rules">15.5.7. Access to DRL declared types in application code</a></span></li></ul></li><li><span class="section"><a href="#drl-globals-con_drl-rules">15.6. Global variables in DRL</a></span></li><li><span class="section"><a href="#rules-attributes-ref_drl-rules">15.7. Rule attributes in DRL</a></span><ul><li><span class="section"><a href="#drl-timers-calendars-con_drl-rules">15.7.1. Timer and calendar rule attributes in DRL</a></span></li></ul></li><li><span class="section"><a href="#drl-rules-WHEN-con_drl-rules">15.8. Rule conditions in DRL (WHEN)</a></span><ul><li><span class="section"><a href="#patterns_and_constraints">15.8.1. Patterns and constraints</a></span></li><li><span class="section"><a href="#bound_variables_in_patterns_and_constraints">15.8.2. Bound variables in patterns and constraints</a></span></li><li><span class="section"><a href="#nested_constraints_and_inline_casts">15.8.3. Nested constraints and inline casts</a></span></li><li><span class="section"><a href="#date_literal_in_constraints">15.8.4. Date literal in constraints</a></span></li><li><span class="section"><a href="#drl-operators-ref_drl-rules">15.8.5. Supported operators in DRL pattern constraints</a></span></li><li><span class="section"><a href="#drl-operator-precedence-ref_drl-rules">15.8.6. Operator precedence in DRL pattern constraints</a></span></li><li><span class="section"><a href="#drl-rules-WHEN-elements-ref_drl-rules">15.8.7. Supported rule condition elements in DRL (keywords)</a></span></li><li><span class="section"><a href="#drl-rules-oopath-con_drl-rules">15.8.8. OOPath syntax with graphs of objects in DRL rule conditions</a></span></li></ul></li><li><span class="section"><a href="#drl-rules-THEN-con_drl-rules">15.9. Rule actions in DRL (THEN)</a></span><ul><li><span class="section"><a href="#drl-rules-THEN-methods-ref_drl-rules">15.9.1. Supported rule action methods in DRL</a></span></li><li><span class="section"><a href="#drl-rules-THEN-methods-variables-ref_drl-rules">15.9.2. Other rule action methods from <code class="literal">drools</code> and <code class="literal">kcontext</code> variables</a></span></li><li><span class="section"><a href="#drl-rules-THEN-advanced-con_drl-rules">15.9.3. Advanced rule actions with conditional and named consequences</a></span></li></ul></li><li><span class="section"><a href="#drl-rules-comments-con_drl-rules">15.10. Comments in DRL files</a></span></li><li><span class="section"><a href="#drl-rules-errors-ref_drl-rules">15.11. Error messages for DRL troubleshooting</a></span></li><li><span class="section"><a href="#drl-rule-units-con_drl-rules">15.12. Rule units in DRL rule sets</a></span><ul><li><span class="section"><a href="#data_sources_for_rule_units">15.12.1. Data sources for rule units</a></span></li><li><span class="section"><a href="#rule_unit_execution_control">15.12.2. Rule unit execution control</a></span></li><li><span class="section"><a href="#rule_unit_identity_conflicts">15.12.3. Rule unit identity conflicts</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#data-objects-con_drl-rules">16. Data objects</a></span><ul><li><span class="section"><a href="#data-objects-create-proc_drl-rules">16.1. Creating data objects</a></span></li></ul></li><li><span class="chapter"><a href="#drl-rules-central-create-proc">17. Creating DRL rules in Business Central</a></span><ul><li><span class="section"><a href="#drl-rules-WHEN-proc">17.1. Adding WHEN conditions in DRL rules</a></span></li><li><span class="section"><a href="#drl-rules-THEN-proc">17.2. Adding THEN actions in DRL rules</a></span></li></ul></li><li><span class="chapter"><a href="#assets-executing-proc_drl-rules">18. Executing rules</a></span></li><li><span class="chapter"><a href="#drl-rules-other-con">19. Other methods for creating and executing DRL rules</a></span><ul><li><span class="section"><a href="#drl-rules-codeready-studio-create-proc_drl-rules">19.1. Creating and executing DRL rules in Red Hat CodeReady Studio</a></span></li><li><span class="section"><a href="#drl-rules-java-create-proc_drl-rules">19.2. Creating and executing DRL rules using Java</a></span></li><li><span class="section"><a href="#drl-rules-maven-create-proc_drl-rules">19.3. Creating and executing DRL rules using Maven</a></span></li></ul></li><li><span class="chapter"><a href="#decision-examples-IDE-con_drl-rules">20. Example decisions in Red Hat Process Automation Manager for an IDE</a></span><ul><li><span class="section"><a href="#decision-examples-IDE-proc_drl-rules">20.1. Importing and executing Red Hat Process Automation Manager example decisions in an IDE</a></span></li><li><span class="section"><a href="#decision-examples-helloworld-ref_drl-rules">20.2. Hello World example decisions (basic rules and debugging)</a></span></li><li><span class="section"><a href="#decision-examples-state-ref_drl-rules">20.3. State example decisions (forward chaining and conflict resolution)</a></span></li><li><span class="section"><a href="#decision-examples-fibonacci-ref_drl-rules">20.4. Fibonacci example decisions (recursion and conflict resolution)</a></span></li><li><span class="section"><a href="#decision-examples-pricing-ref_drl-rules">20.5. Pricing example decisions (decision tables)</a></span></li><li><span class="section"><a href="#decision-examples-petstore-ref_drl-rules">20.6. Pet Store example decisions (agenda groups, global variables, callbacks, and GUI integration)</a></span></li><li><span class="section"><a href="#decision-examples-politician-ref_drl-rules">20.7. Honest Politician example decisions (truth maintenance and salience)</a></span></li><li><span class="section"><a href="#decision-examples-sudoku-ref_drl-rules">20.8. Sudoku example decisions (complex pattern matching, callbacks, and GUI integration)</a></span></li><li><span class="section"><a href="#decision-examples-conway-ref_drl-rules">20.9. Conway’s Game of Life example decisions (ruleflow groups and GUI integration)</a></span></li><li><span class="section"><a href="#decision-examples-doom-ref_drl-rules">20.10. House of Doom example decisions (backward chaining and recursion)</a></span></li></ul></li><li><span class="chapter"><a href="#performance-tuning-drl-ref_drl-rules">21. Performance tuning considerations with DRL</a></span></li><li><span class="chapter"><a href="#next_steps">22. Next steps</a></span></li></ul></li><li><span class="part"><a href="#assembly-guided-decision-tables">IV. Designing a decision service using guided decision tables</a></span><ul><li><span class="chapter"><a href="#decision-authoring-assets-ref_guided-decision-tables">23. Decision-authoring assets in Red Hat Process Automation Manager</a></span></li><li><span class="chapter"><a href="#guided-decision-tables-con_guided-decision-tables">24. Guided decision tables</a></span></li><li><span class="chapter"><a href="#data-objects-con_guided-decision-tables">25. Data objects</a></span><ul><li><span class="section"><a href="#data-objects-create-proc_guided-decision-tables">25.1. Creating data objects</a></span></li></ul></li><li><span class="chapter"><a href="#guided-decision-tables-create-proc">26. Creating guided decision tables</a></span></li><li><span class="chapter"><a href="#hit-policies-con">27. Hit policies for guided decision tables</a></span><ul><li><span class="section"><a href="#hit-policies-examples-ref">27.1. Hit policy examples: Decision table for discounts on movie tickets</a></span><ul><li><span class="section"><a href="#guided-decision-tables-types-con">27.1.1. Types of guided decision tables</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#guided-decision-tables-columns-create-proc">28. Adding columns to guided decision tables</a></span></li><li><span class="chapter"><a href="#guided-decision-tables-columns-types-con">29. Types of columns in guided decision tables</a></span><ul><li><span class="section"><a href="#guided-decision-tables-columns-condition-con">29.1. "Add a Condition"</a></span><ul><li><span class="section"><a href="#guided-decision-tables-any-other-add-proc">29.1.1. Inserting an <code class="literal">any other</code> value in condition column cells</a></span></li></ul></li><li><span class="section"><a href="#guided-decision-tables-columns-condition-BRL-con">29.2. "Add a Condition BRL fragment"</a></span></li><li><span class="section"><a href="#guided-decision-tables-columns-metadata-con">29.3. "Add a Metadata column"</a></span></li><li><span class="section"><a href="#guided-decision-tables-columns-action-BRL-con">29.4. "Add an Action BRL fragment"</a></span></li><li><span class="section"><a href="#guided-decision-tables-columns-attribute-con">29.5. "Add an Attribute column"</a></span></li><li><span class="section"><a href="#guided-decision-tables-columns-delete-fact-con">29.6. "Delete an existing fact"</a></span></li><li><span class="section"><a href="#guided-decision-tables-columns-work-item-con">29.7. "Execute a Work Item"</a></span></li><li><span class="section"><a href="#guided-decision-tables-columns-field-con">29.8. "Set the value of a field"</a></span></li><li><span class="section"><a href="#guided-decision-tables-columns-field-work-item-con">29.9. "Set the value of a field with a Work Item result"</a></span></li></ul></li><li><span class="chapter"><a href="#guided-decision-tables-rulename-column-view-proc">30. Viewing Rule Name column in guided decision tables</a></span></li><li><span class="chapter"><a href="#guided-decision-tables-columns-edit-proc">31. Editing or deleting columns in guided decision tables</a></span></li><li><span class="chapter"><a href="#guided-decision-tables-rows-create-proc">32. Adding rows and defining rules in guided decision tables</a></span></li><li><span class="chapter"><a href="#enumerations-define-proc_guided-decision-tables">33. Defining enumerations for drop-down lists in rule assets</a></span><ul><li><span class="section"><a href="#enumerations-advanced-ref_guided-decision-tables">33.1. Advanced enumeration options for rule assets</a></span></li></ul></li><li><span class="chapter"><a href="#guided-decision-tables-validation-con">34. Real-time verification and validation of guided decision tables</a></span><ul><li><span class="section"><a href="#guided-decision-tables-errors-ref">34.1. Types of problems in guided decision tables</a></span></li><li><span class="section"><a href="#guided-decision-tables-messages-ref">34.2. Types of notifications</a></span></li><li><span class="section"><a href="#guided-decision-tables-validation-disable-proc">34.3. Disabling verification and validation of guided decision tables</a></span></li></ul></li><li><span class="chapter"><a href="#guided-decision-tables-convert-proc">35. Converting a guided decision table to a spreadsheet decision table</a></span></li><li><span class="chapter"><a href="#assets-executing-proc_guided-decision-tables">36. Executing rules</a></span></li><li><span class="chapter"><a href="#next_steps_2">37. Next steps</a></span></li></ul></li><li><span class="part"><a href="#assembly-decision-tables">V. Designing a decision service using spreadsheet decision tables</a></span><ul><li><span class="chapter"><a href="#decision-authoring-assets-ref_decision-tables">38. Decision-authoring assets in Red Hat Process Automation Manager</a></span></li><li><span class="chapter"><a href="#decision-tables-con_decision-tables">39. Spreadsheet decision tables</a></span></li><li><span class="chapter"><a href="#data-objects-con_decision-tables">40. Data objects</a></span><ul><li><span class="section"><a href="#data-objects-create-proc_decision-tables">40.1. Creating data objects</a></span></li></ul></li><li><span class="chapter"><a href="#decision-tables-use-case-con">41. Decision table use case</a></span></li><li><span class="chapter"><a href="#decision-tables-defining-proc">42. Defining spreadsheet decision tables</a></span><ul><li><span class="section"><a href="#decision-tables-rule-set-entries-ref">42.1. RuleSet definitions</a></span></li><li><span class="section"><a href="#decision-tables-rule-table-entries-ref">42.2. RuleTable definitions</a></span></li><li><span class="section"><a href="#decision-tables-attributes-ref">42.3. Additional rule attributes for RuleSet or RuleTable definitions</a></span></li></ul></li><li><span class="chapter"><a href="#decision-tables-upload-proc">43. Uploading spreadsheet decision tables to Business Central</a></span></li><li><span class="chapter"><a href="#decision-tables-convert-proc">44. Converting an uploaded spreadsheet decision table to a guided decision table in Business Central</a></span></li><li><span class="chapter"><a href="#assets-executing-proc_decision-tables">45. Executing rules</a></span></li><li><span class="chapter"><a href="#next_steps_3">46. Next steps</a></span></li></ul></li><li><span class="part"><a href="#assembly-guided-rules">VI. Designing a decision service using guided rules</a></span><ul><li><span class="chapter"><a href="#decision-authoring-assets-ref_guided-rules">47. Decision-authoring assets in Red Hat Process Automation Manager</a></span></li><li><span class="chapter"><a href="#guided-rules-con_guided-rules">48. Guided rules</a></span></li><li><span class="chapter"><a href="#data-objects-con_guided-rules">49. Data objects</a></span><ul><li><span class="section"><a href="#data-objects-create-proc_guided-rules">49.1. Creating data objects</a></span></li></ul></li><li><span class="chapter"><a href="#guided-rules-create-proc_guided-rules">50. Creating guided rules</a></span><ul><li><span class="section"><a href="#guided-rules-WHEN-proc_guided-rules">50.1. Adding WHEN conditions in guided rules</a></span></li><li><span class="section"><a href="#guided-rules-THEN-proc_guided-rules">50.2. Adding THEN actions in guided rules</a></span></li><li><span class="section"><a href="#enumerations-define-proc_guided-rules">50.3. Defining enumerations for drop-down lists in rule assets</a></span><ul><li><span class="section"><a href="#enumerations-advanced-ref_guided-rules">50.3.1. Advanced enumeration options for rule assets</a></span></li></ul></li><li><span class="section"><a href="#guided-rules-options-proc_guided-rules">50.4. Adding other rule options</a></span><ul><li><span class="section"><a href="#rules-attributes-ref_guided-rules">50.4.1. Rule attributes</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#assets-executing-proc_guided-rules">51. Executing rules</a></span></li><li><span class="chapter"><a href="#next_steps_4">52. Next steps</a></span></li></ul></li><li><span class="part"><a href="#assembly-guided-rule-templates">VII. Designing a decision service using guided rule templates</a></span><ul><li><span class="chapter"><a href="#decision-authoring-assets-ref_guided-rule-templates">53. Decision-authoring assets in Red Hat Process Automation Manager</a></span></li><li><span class="chapter"><a href="#guided-rule-templates-con">54. Guided rule templates</a></span></li><li><span class="chapter"><a href="#data-objects-con_guided-rule-templates">55. Data objects</a></span><ul><li><span class="section"><a href="#data-objects-create-proc_guided-rule-templates">55.1. Creating data objects</a></span></li></ul></li><li><span class="chapter"><a href="#guided-rule-templates-create-proc">56. Creating guided rule templates</a></span><ul><li><span class="section"><a href="#guided-rule-templates-WHEN-proc">56.1. Adding WHEN conditions in guided rule templates</a></span></li><li><span class="section"><a href="#guided-rule-templates-THEN-proc">56.2. Adding THEN actions in guided rule templates</a></span></li><li><span class="section"><a href="#enumerations-define-proc_guided-rule-templates">56.3. Defining enumerations for drop-down lists in rule assets</a></span><ul><li><span class="section"><a href="#enumerations-advanced-ref_guided-rule-templates">56.3.1. Advanced enumeration options for rule assets</a></span></li></ul></li><li><span class="section"><a href="#guided-rules-options-proc_guided-rule-templates">56.4. Adding other rule options</a></span><ul><li><span class="section"><a href="#rules-attributes-ref_guided-rule-templates">56.4.1. Rule attributes</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#guided-rule-templates-tables-proc">57. Defining data tables for guided rule templates</a></span></li><li><span class="chapter"><a href="#assets-executing-proc_guided-rule-templates">58. Executing rules</a></span></li><li><span class="chapter"><a href="#next_steps_5">59. Next steps</a></span></li></ul></li><li><span class="part"><a href="#assembly-test-scenarios">VIII. Testing a decision service using test scenarios</a></span><ul><li><span class="chapter"><a href="#test-scenarios-intro-con_test-scenarios">60. Test scenarios</a></span></li><li><span class="chapter"><a href="#data-objects-con_test-scenarios">61. Data objects</a></span><ul><li><span class="section"><a href="#data-objects-create-proc_test-scenarios">61.1. Creating data objects</a></span></li></ul></li><li><span class="chapter"><a href="#test-designer-con">62. Test scenarios designer in Business Central</a></span><ul><li><span class="section"><a href="#test-designer-data-objects-import-proc">62.1. Importing data objects</a></span></li><li><span class="section"><a href="#test-designer-test-scenario-import-proc">62.2. Importing a test scenario</a></span></li><li><span class="section"><a href="#test-designer-save-test-proc">62.3. Saving a test scenario</a></span></li><li><span class="section"><a href="#test-designer-copy-test-proc">62.4. Copying a test scenario</a></span></li><li><span class="section"><a href="#test-designer-download-test-proc">62.5. Downloading a test scenario</a></span></li><li><span class="section"><a href="#test-designer-latest-version-test-proc">62.6. Switching between versions of a test scenario</a></span></li><li><span class="section"><a href="#test-designer-view-hide-alerts-con">62.7. View or hide the alerts panel</a></span></li><li><span class="section"><a href="#test-designer-contextual-menu-ref">62.8. Contextual menu options</a></span></li><li><span class="section"><a href="#test-designer-global-settings-panel-con">62.9. Global settings for test scenarios</a></span><ul><li><span class="section"><a href="#test-designer-global-settings-panel-rule-based-proc">62.9.1. Configuring global settings for rule-based test scenarios</a></span></li><li><span class="section"><a href="#test-designer-global-settings-panel-dmn-based-proc">62.9.2. Configuring global settings for DMN-based test scenarios</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#test-designer-create-test-scenario-template-con">63. Test scenario template</a></span><ul><li><span class="section"><a href="#test-designer-create-test-template-rule-based-proc">63.1. Creating a test scenario template for rule-based test scenarios</a></span></li><li><span class="section"><a href="#test-designer-alias-proc">63.2. Using aliases in rule-based test scenarios</a></span></li></ul></li><li><span class="chapter"><a href="#test-designer-test-template-dmn-based-con">64. Test template for DMN-based test scenarios</a></span><ul><li><span class="section"><a href="#test-designer-create-test-template-dmn-based-proc">64.1. Creating a test scenario template for DMN-based test scenarios</a></span></li></ul></li><li><span class="chapter"><a href="#test-designer-test-scenario-definition-proc">65. Defining a test scenario</a></span></li><li><span class="chapter"><a href="#test-scenarios-background-instance-con">66. Background instance in test scenarios</a></span><ul><li><span class="section"><a href="#test-scenarios-background-rule-based-proc">66.1. Adding a background data in rule-based test scenarios</a></span></li><li><span class="section"><a href="#test-scenarios-background-dmn-based-proc">66.2. Adding a background data in DMN-based test scenarios</a></span></li></ul></li><li><span class="chapter"><a href="#test-designer-list-map-add-remove-item-proc">67. Using list and map collections in test scenarios</a></span></li><li><span class="chapter"><a href="#test-designer-expressions-syntax-intro-ref">68. Expression syntax in test scenarios</a></span><ul><li><span class="section"><a href="#test-designer-expressions-syntax-rule-based-ref">68.1. Expression syntax in rule-based test scenarios</a></span></li><li><span class="section"><a href="#test-designer-expressions-syntax-dmn-based-ref">68.2. Expression syntax in DMN-based scenarios</a></span></li></ul></li><li><span class="chapter"><a href="#test-designer-run-test-proc">69. Running the test scenarios</a></span></li><li><span class="chapter"><a href="#test-scenarios-running-locally-proc">70. Running a test scenario locally</a></span></li><li><span class="chapter"><a href="#test-designer-test-scenario-export-import-spreadsheet-con">71. Exporting and importing test scenario spreadsheets</a></span><ul><li><span class="section"><a href="#test-designer-test-scenario-export-spreadsheet-proc">71.1. Exporting a test scenario spreadsheet</a></span></li><li><span class="section"><a href="#test-designer-test-scenario-import-spreadsheet-proc">71.2. Importing a test scenario spreadsheet</a></span></li></ul></li><li><span class="chapter"><a href="#test-scenarios-coverage-report-con">72. Coverage reports for test scenarios</a></span><ul><li><span class="section"><a href="#test-scenarios-coverage-report-rule-based-proc">72.1. Generating coverage reports for rule-based test scenarios</a></span></li><li><span class="section"><a href="#test-scenarios-coverage-report-dmn-based-proc">72.2. Generating coverage reports for DMN-based test scenarios</a></span></li></ul></li><li><span class="chapter"><a href="#test-scenarios-execution-rest-api-proc">73. Executing a test scenario using the KIE Server REST API</a></span></li><li><span class="chapter"><a href="#test-designer-create-mortgages-example-proc">74. Creating test scenario using the sample Mortgages project</a></span></li><li><span class="chapter"><a href="#test-scenarios-legacy-designer-con">75. Test scenarios (legacy) designer in Business Central</a></span><ul><li><span class="section"><a href="#test-scenarios-legacy-create-proc">75.1. Creating and running a test scenario (legacy)</a></span><ul><li><span class="section"><a href="#test-scenarios-legacy-GIVEN-proc">75.1.1. Adding GIVEN facts in test scenarios (legacy)</a></span></li><li><span class="section"><a href="#test-scenarios-legacy-EXPECT-proc">75.1.2. Adding EXPECT results in test scenarios (legacy)</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#test-scenarios-comparison-legacy-new-ref">76. Feature comparison of legacy and new test scenario designer</a></span></li><li><span class="chapter"><a href="#next_steps_6">77. Next steps</a></span></li></ul></li><li><span class="part"><a href="#assembly-decision-engine">IX. Decision engine in Red Hat Process Automation Manager</a></span><ul><li><span class="chapter"><a href="#decision-engine-con_decision-engine">78. Decision engine in Red Hat Process Automation Manager</a></span></li><li><span class="chapter"><a href="#kie-sessions-con_decision-engine">79. KIE sessions</a></span><ul><li><span class="section"><a href="#kie-sessions-stateless-con_decision-engine">79.1. Stateless KIE sessions</a></span><ul><li><span class="section"><a href="#kie-sessions-stateless-globals-con_decision-engine">79.1.1. Global variables in stateless KIE sessions</a></span></li></ul></li><li><span class="section"><a href="#kie-sessions-stateful-con_decision-engine">79.2. Stateful KIE sessions</a></span></li><li><span class="section"><a href="#kie-sessions-pools-con_decision-engine">79.3. KIE session pools</a></span></li></ul></li><li><span class="chapter"><a href="#inference-and-truth-maintenance_decision-engine">80. Inference and truth maintenance in the decision engine</a></span><ul><li><span class="section"><a href="#fact-equality-modes-con_decision-engine">80.1. Fact equality modes in the decision engine</a></span></li></ul></li><li><span class="chapter"><a href="#execution-control-con_decision-engine">81. Execution control in the decision engine</a></span><ul><li><span class="section"><a href="#salience_for_rules">81.1. Salience for rules</a></span></li><li><span class="section"><a href="#agenda_groups_for_rules">81.2. Agenda groups for rules</a></span></li><li><span class="section"><a href="#activation_groups_for_rules">81.3. Activation groups for rules</a></span></li><li><span class="section"><a href="#rule-execution-modes-con_decision-engine">81.4. Rule execution modes and thread safety in the decision engine</a></span></li><li><span class="section"><a href="#fact-propagation-modes-con_decision-engine">81.5. Fact propagation modes in the decision engine</a></span></li><li><span class="section"><a href="#agenda-filters-con_decision-engine">81.6. Agenda evaluation filters</a></span></li><li><span class="section"><a href="#drl-rule-units-con_decision-engine">81.7. Rule units in DRL rule sets</a></span><ul><li><span class="section"><a href="#data_sources_for_rule_units_2">81.7.1. Data sources for rule units</a></span></li><li><span class="section"><a href="#rule_unit_execution_control_2">81.7.2. Rule unit execution control</a></span></li><li><span class="section"><a href="#rule_unit_identity_conflicts_2">81.7.3. Rule unit identity conflicts</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#phreak-algorithm-con_decision-engine">82. Phreak rule algorithm in the decision engine</a></span><ul><li><span class="section"><a href="#phreak-rule-evaluation-con_decision-engine">82.1. Rule evaluation in Phreak</a></span><ul><li><span class="section"><a href="#forward-and-backward-chaining-con_decision-engine">82.1.1. Rule evaluation with forward and backward chaining</a></span></li></ul></li><li><span class="section"><a href="#rule-base-configuration-con_decision-engine">82.2. Rule base configuration</a></span></li><li><span class="section"><a href="#phreak-sequential-mode-con_decision-engine">82.3. Sequential mode in Phreak</a></span></li></ul></li><li><span class="chapter"><a href="#cep-con_decision-engine">83. Complex event processing (CEP)</a></span><ul><li><span class="section"><a href="#cep-events-con_decision-engine">83.1. Events in complex event processing</a></span></li><li><span class="section"><a href="#cep-events-proc_decision-engine">83.2. Declaring facts as events</a></span></li><li><span class="section"><a href="#drl-declarations-metadata-tags-ref_decision-engine">83.3. Metadata tags for events</a></span></li><li><span class="section"><a href="#cep-modes-con_decision-engine">83.4. Event processing modes in the decision engine</a></span><ul><li><span class="section"><a href="#cep-negative-patterns_decision-engine">83.4.1. Negative patterns in decision engine stream mode</a></span></li></ul></li><li><span class="section"><a href="#property-change-listeners-con_decision-engine">83.5. Property-change settings and listeners for fact types</a></span></li><li><span class="section"><a href="#cep-temporal-operators_decision-engine">83.6. Temporal operators for events</a></span></li><li><span class="section"><a href="#cep-clock-ref_decision-engine">83.7. Session clock implementations in the decision engine</a></span></li><li><span class="section"><a href="#cep-event-streams-con_decision-engine">83.8. Event streams and entry points</a></span><ul><li><span class="section"><a href="#cep-event-streams-proc_decision-engine">83.8.1. Declaring entry points for rule data</a></span></li></ul></li><li><span class="section"><a href="#cep-sliding-windows-con_decision-engine">83.9. Sliding windows of time or length</a></span><ul><li><span class="section"><a href="#cep-sliding-windows-proc_decision-engine">83.9.1. Declaring sliding windows for rule data</a></span></li></ul></li><li><span class="section"><a href="#cep-memory-management-con_decision-engine">83.10. Memory management for events</a></span></li></ul></li><li><span class="chapter"><a href="#engine-queries-con_decision-engine">84. Decision engine queries and live queries</a></span></li><li><span class="chapter"><a href="#engine-event-listeners-con_decision-engine">85. Decision engine event listeners and debug logging</a></span><ul><li><span class="section"><a href="#logging-proc_decision-engine">85.1. Configuring a logging utility in the decision engine</a></span></li></ul></li><li><span class="chapter"><a href="#decision-examples-IDE-con_decision-engine">86. Example decisions in Red Hat Process Automation Manager for an IDE</a></span><ul><li><span class="section"><a href="#decision-examples-IDE-proc_decision-engine">86.1. Importing and executing Red Hat Process Automation Manager example decisions in an IDE</a></span></li><li><span class="section"><a href="#decision-examples-helloworld-ref_decision-engine">86.2. Hello World example decisions (basic rules and debugging)</a></span></li><li><span class="section"><a href="#decision-examples-state-ref_decision-engine">86.3. State example decisions (forward chaining and conflict resolution)</a></span></li><li><span class="section"><a href="#decision-examples-fibonacci-ref_decision-engine">86.4. Fibonacci example decisions (recursion and conflict resolution)</a></span></li><li><span class="section"><a href="#decision-examples-pricing-ref_decision-engine">86.5. Pricing example decisions (decision tables)</a></span></li><li><span class="section"><a href="#decision-examples-petstore-ref_decision-engine">86.6. Pet Store example decisions (agenda groups, global variables, callbacks, and GUI integration)</a></span></li><li><span class="section"><a href="#decision-examples-politician-ref_decision-engine">86.7. Honest Politician example decisions (truth maintenance and salience)</a></span></li><li><span class="section"><a href="#decision-examples-sudoku-ref_decision-engine">86.8. Sudoku example decisions (complex pattern matching, callbacks, and GUI integration)</a></span></li><li><span class="section"><a href="#decision-examples-conway-ref_decision-engine">86.9. Conway’s Game of Life example decisions (ruleflow groups and GUI integration)</a></span></li><li><span class="section"><a href="#decision-examples-doom-ref_decision-engine">86.10. House of Doom example decisions (backward chaining and recursion)</a></span></li></ul></li><li><span class="chapter"><a href="#performance-tuning-decision-engine-ref_decision-engine">87. Performance tuning considerations with the decision engine</a></span></li><li><span class="chapter"><a href="#additional_resources_3">88. Additional resources</a></span></li></ul></li><li><span class="part"><a href="#assembly-ba-artificial-intelligence">X. Integrating machine learning with Red Hat Process Automation Manager</a></span><ul><li><span class="chapter"><a href="#ai-con_artificial-intelligence">89. Pragmatic AI</a></span></li><li><span class="chapter"><a href="#ai-credit-card-con_artificial-intelligence">90. Credit card fraud dispute use case</a></span><ul><li><span class="section"><a href="#ai-gsg_artificial-intelligence">90.1. Using a PMML model with a DMN model to resolve credit card transaction disputes</a></span></li><li><span class="section"><a href="#ai-pmml-ref_artificial-intelligence">90.2. Credit card transaction dispute exercise PMML file</a></span></li></ul></li><li><span class="chapter"><a href="#additional_resources_4">91. Additional resources</a></span></li></ul></li><li><span class="appendix"><a href="#versioning-information">A. Versioning information</a></span></li><li><span class="appendix"><a href="#author-group">B. Contact information</a></span></li></ul></div><section class="preface" id="idm139921829023248"><div class="titlepage"><div><div><h1 class="title">Preface</h1></div></div></div><p>
			As a developer of business decisions, you can use Red Hat Process Automation Manager to develop decision services using Decision Model and Notation (DMN) models, Drools Rule Language (DRL) rules, guided decision tables, and other rule-authoring assets.
		</p></section><section class="preface" id="snip-conscious-language_developing-decision-services"><div class="titlepage"><div><div><h1 class="title">Making open source more inclusive</h1></div></div></div><p>
			Red Hat is committed to replacing problematic language in our code, documentation, and web properties. We are beginning with these four terms: master, slave, blacklist, and whitelist. Because of the enormity of this endeavor, these changes will be implemented gradually over several upcoming releases. For more details, see <a class="link" href="https://www.redhat.com/en/blog/making-open-source-more-inclusive-eradicating-problematic-language"><span class="emphasis"><em>our CTO Chris Wright’s message</em></span></a>.
		</p></section><div class="part" id="assembly-dmn-models"><div class="titlepage"><div><div><h1 class="title">Part I. Designing a decision service using DMN models</h1></div></div></div><div class="partintro" id="idm139921832841248"><div/><p>
				As a business analyst or business rules developer, you can use Decision Model and Notation (DMN) to model a decision service graphically. The decision requirements of a DMN decision model are determined by a decision requirements graph (DRG) that is depicted in one or more decision requirements diagrams (DRDs). A DRD can represent part or all of the overall DRG for the DMN model. DRDs trace business decisions from start to finish, with each decision node using logic defined in DMN boxed expressions such as decision tables.
			</p><p>
				Red Hat Process Automation Manager provides design and runtime support for DMN 1.2 models at conformance level 3, and runtime-only support for DMN 1.1 and 1.3 models at conformance level 3. You can design your DMN models directly in Business Central or with the Red Hat Process Automation Manager DMN modeler in VSCode, or import existing DMN models into your Red Hat Process Automation Manager projects for deployment and execution. Any DMN 1.1 and 1.3 models (do not contain DMN 1.3 features) that you import into Business Central, open in the DMN designer, and save are converted to DMN 1.2 models.
			</p><p>
				For more information about DMN, see the Object Management Group (OMG) <a class="link" href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.
			</p><p>
				For a step-by-step tutorial with an example DMN decision service, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/getting_started_with_red_hat_process_automation_manager#assembly-getting-started-decision-services"><span class="emphasis"><em>Getting started with decision services</em></span></a>.
			</p><div class="toc"><p><strong>Table of Contents</strong></p><ul class="toc"><li><span class="chapter"><a href="#decision-authoring-assets-ref_dmn-models">1. Decision-authoring assets in Red Hat Process Automation Manager</a></span></li><li><span class="chapter"><a href="#con-BPMN-DMN-modelers_dmn-models">2. Red Hat Process Automation Manager BPMN and DMN modelers</a></span><ul><li><span class="section"><a href="#proc-vscode-extension_dmn-models">2.1. Installing the Red Hat Process Automation Manager VSCode extension bundle</a></span></li><li><span class="section"><a href="#proc-standalone-editors_dmn-models">2.2. Configuring the Red Hat Process Automation Manager standalone editors</a></span></li></ul></li><li><span class="chapter"><a href="#dmn-con_dmn-models">3. Decision Model and Notation (DMN)</a></span><ul><li><span class="section"><a href="#dmn-conformance-levels-con_dmn-models">3.1. DMN conformance levels</a></span></li><li><span class="section"><a href="#dmn-drd-components-ref_dmn-models">3.2. DMN decision requirements diagram (DRD) components</a></span></li><li><span class="section"><a href="#dmn-feel-con_dmn-models">3.3. Rule expressions in FEEL</a></span><ul><li><span class="section"><a href="#dmn-feel-data-types-ref_dmn-models">3.3.1. Data types in FEEL</a></span></li><li><span class="section"><a href="#ref-dmn-feel-builtin-functions_dmn-models">3.3.2. Built-in functions in FEEL</a></span></li><li><span class="section"><a href="#dmn-feel-variable-function-names-ref_dmn-models">3.3.3. Variable and function names in FEEL</a></span></li></ul></li><li><span class="section"><a href="#dmn-boxed-expressions-con_dmn-models">3.4. DMN decision logic in boxed expressions</a></span><ul><li><span class="section"><a href="#dmn-decision-tables-con_dmn-models">3.4.1. DMN decision tables</a></span></li><li><span class="section"><a href="#dmn-literal-expressions-con_dmn-models">3.4.2. Boxed literal expressions</a></span></li><li><span class="section"><a href="#dmn-context-expressions-con_dmn-models">3.4.3. Boxed context expressions</a></span></li><li><span class="section"><a href="#dmn-relation-expressions-con_dmn-models">3.4.4. Boxed relation expressions</a></span></li><li><span class="section"><a href="#dmn-function-expressions-con_dmn-models">3.4.5. Boxed function expressions</a></span></li><li><span class="section"><a href="#dmn-invocation-expressions-con_dmn-models">3.4.6. Boxed invocation expressions</a></span></li><li><span class="section"><a href="#dmn-list-expressions-con_dmn-models">3.4.7. Boxed list expressions</a></span></li></ul></li><li><span class="section"><a href="#dmn-model-example-ref_dmn-models">3.5. DMN model example</a></span></li></ul></li><li><span class="chapter"><a href="#dmn-support-con_dmn-models">4. DMN support in Red Hat Process Automation Manager</a></span><ul><li><span class="section"><a href="#dmn-properties-ref_dmn-models">4.1. Configurable DMN properties in Red Hat Process Automation Manager</a></span></li><li><span class="section"><a href="#dmn-validation-con_dmn-models">4.2. Configurable DMN validation in Red Hat Process Automation Manager</a></span></li></ul></li><li><span class="chapter"><a href="#dmn-model-creating-proc_dmn-models">5. Creating and editing DMN models in Business Central</a></span><ul><li><span class="section"><a href="#dmn-logic-defining-proc_dmn-models">5.1. Defining DMN decision logic in boxed expressions in Business Central</a></span></li><li><span class="section"><a href="#dmn-data-types-defining-proc_dmn-models">5.2. Creating custom data types for DMN boxed expressions in Business Central</a></span></li><li><span class="section"><a href="#dmn-included-models-con_dmn-models">5.3. Included models in DMN files in Business Central</a></span><ul><li><span class="section"><a href="#dmn-included-models-dmn-proc_dmn-models">5.3.1. Including other DMN models within a DMN file in Business Central</a></span></li><li><span class="section"><a href="#dmn-included-models-pmml-proc_dmn-models">5.3.2. Including PMML models within a DMN file in Business Central</a></span></li></ul></li><li><span class="section"><a href="#dmn-model-creating-multiples-proc_dmn-models">5.4. Creating DMN models with multiple diagrams in Business Central</a></span></li><li><span class="section"><a href="#dmn-documentation-con_dmn-models">5.5. DMN model documentation in Business Central</a></span></li><li><span class="section"><a href="#dmn-designer-nav-ref_dmn-models">5.6. DMN designer navigation and properties in Business Central</a></span></li></ul></li><li><span class="chapter"><a href="#dmn-execution-con_dmn-models">6. DMN model execution</a></span><ul><li><span class="section"><a href="#dmn-execution-embedded-proc">6.1. Embedding a DMN call directly in a Java application</a></span></li><li><span class="section"><a href="#dmn-execution-remote-java-proc">6.2. Executing a DMN service using the KIE Server Java client API</a></span></li><li><span class="section"><a href="#dmn-execution-rest-proc_dmn-models">6.3. Executing a DMN service using the KIE Server REST API</a></span></li></ul></li><li><span class="chapter"><a href="#additional_resources">7. Additional resources</a></span></li></ul></div></div><section class="chapter" id="decision-authoring-assets-ref_dmn-models"><div class="titlepage"><div><div><h2 class="title">Chapter 1. Decision-authoring assets in Red Hat Process Automation Manager</h2></div></div></div><p>
				Red Hat Process Automation Manager supports several assets that you can use to define business decisions for your decision service. Each decision-authoring asset has different advantages, and you might prefer to use one or a combination of multiple assets depending on your goals and needs.
			</p><p>
				The following table highlights the main decision-authoring assets supported in Red Hat Process Automation Manager projects to help you decide or confirm the best method for defining decisions in your decision service.
			</p><div class="table" id="idm139921844863664"><p class="title"><strong>Table 1.1. Decision-authoring assets supported in Red Hat Process Automation Manager</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"/><col style="width: 40%; " class="col_2"/><col style="width: 20%; " class="col_3"/><col style="width: 20%; " class="col_4"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921829124944" scope="col">Asset</th><th align="left" valign="top" id="idm139921829123856" scope="col">Highlights</th><th align="left" valign="top" id="idm139921829122768" scope="col">Authoring tools</th><th align="left" valign="top" id="idm139921829121680" scope="col">Documentation</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921829124944">
							<p>
								Decision Model and Notation (DMN) models
							</p>
							</td><td align="left" valign="top" headers="idm139921829123856">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are decision models based on a notation standard defined by the Object Management Group (OMG)
									</li><li class="listitem">
										Use graphical decision requirements diagrams (DRDs) that represent part or all of the overall decision requirements graph (DRG) to trace business decision flows
									</li><li class="listitem">
										Use an XML schema that allows the DMN models to be shared between DMN-compliant platforms
									</li><li class="listitem">
										Support Friendly Enough Expression Language (FEEL) to define decision logic in DMN decision tables and other DMN boxed expressions
									</li><li class="listitem">
										Can be integrated efficiently with Business Process Model and Notation (BPMN) process models
									</li><li class="listitem">
										Are optimal for creating comprehensive, illustrative, and stable decision flows
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921829122768">
							<p>
								Business Central or other DMN-compliant editor
							</p>
							</td><td align="left" valign="top" headers="idm139921829121680">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-dmn-models"><span class="emphasis"><em>Designing a decision service using DMN models</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921829124944">
							<p>
								Guided decision tables
							</p>
							</td><td align="left" valign="top" headers="idm139921829123856">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are tables of rules that you create in a UI-based table designer in Business Central
									</li><li class="listitem">
										Are a wizard-led alternative to spreadsheet decision tables
									</li><li class="listitem">
										Provide fields and options for acceptable input
									</li><li class="listitem">
										Support template keys and values for creating rule templates
									</li><li class="listitem">
										Support hit policies, real-time validation, and other additional features not supported in other assets
									</li><li class="listitem">
										Are optimal for creating rules in a controlled tabular format to minimize compilation errors
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921829122768">
							<p>
								Business Central
							</p>
							</td><td align="left" valign="top" headers="idm139921829121680">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-guided-decision-tables"><span class="emphasis"><em>Designing a decision service using guided decision tables</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921829124944">
							<p>
								Spreadsheet decision tables
							</p>
							</td><td align="left" valign="top" headers="idm139921829123856">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are XLS or XLSX spreadsheet decision tables that you can upload into Business Central
									</li><li class="listitem">
										Support template keys and values for creating rule templates
									</li><li class="listitem">
										Are optimal for creating rules in decision tables already managed outside of Business Central
									</li><li class="listitem">
										Have strict syntax requirements for rules to be compiled properly when uploaded
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921829122768">
							<p>
								Spreadsheet editor
							</p>
							</td><td align="left" valign="top" headers="idm139921829121680">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-decision-tables"><span class="emphasis"><em>Designing a decision service using spreadsheet decision tables</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921829124944">
							<p>
								Guided rules
							</p>
							</td><td align="left" valign="top" headers="idm139921829123856">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are individual rules that you create in a UI-based rule designer in Business Central
									</li><li class="listitem">
										Provide fields and options for acceptable input
									</li><li class="listitem">
										Are optimal for creating single rules in a controlled format to minimize compilation errors
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921829122768">
							<p>
								Business Central
							</p>
							</td><td align="left" valign="top" headers="idm139921829121680">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-guided-rules"><span class="emphasis"><em>Designing a decision service using guided rules</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921829124944">
							<p>
								Guided rule templates
							</p>
							</td><td align="left" valign="top" headers="idm139921829123856">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are reusable rule structures that you create in a UI-based template designer in Business Central
									</li><li class="listitem">
										Provide fields and options for acceptable input
									</li><li class="listitem">
										Support template keys and values for creating rule templates (fundamental to the purpose of this asset)
									</li><li class="listitem">
										Are optimal for creating many rules with the same rule structure but with different defined field values
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921829122768">
							<p>
								Business Central
							</p>
							</td><td align="left" valign="top" headers="idm139921829121680">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-guided-rule-templates"><span class="emphasis"><em>Designing a decision service using guided rule templates</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921829124944">
							<p>
								DRL rules
							</p>
							</td><td align="left" valign="top" headers="idm139921829123856">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are individual rules that you define directly in <code class="literal">.drl</code> text files
									</li><li class="listitem">
										Provide the most flexibility for defining rules and other technicalities of rule behavior
									</li><li class="listitem">
										Can be created in certain standalone environments and integrated with Red Hat Process Automation Manager
									</li><li class="listitem">
										Are optimal for creating rules that require advanced DRL options
									</li><li class="listitem">
										Have strict syntax requirements for rules to be compiled properly
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921829122768">
							<p>
								Business Central or integrated development environment (IDE)
							</p>
							</td><td align="left" valign="top" headers="idm139921829121680">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-drl-rules"><span class="emphasis"><em>Designing a decision service using DRL rules</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921829124944">
							<p>
								Predictive Model Markup Language (PMML) models
							</p>
							</td><td align="left" valign="top" headers="idm139921829123856">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are predictive data-analytic models based on a notation standard defined by the Data Mining Group (DMG)
									</li><li class="listitem">
										Use an XML schema that allows the PMML models to be shared between PMML-compliant platforms
									</li><li class="listitem">
										Support Regression, Scorecard, Tree, Mining, and other model types
									</li><li class="listitem">
										Can be included with a standalone Red Hat Process Automation Manager project or imported into a project in Business Central
									</li><li class="listitem">
										Are optimal for incorporating predictive data into decision services in Red Hat Process Automation Manager
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921829122768">
							<p>
								PMML or XML editor
							</p>
							</td><td align="left" valign="top" headers="idm139921829121680">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-pmml-models"><span class="emphasis"><em>Designing a decision service using PMML models</em></span></a>
							</p>
							</td></tr></tbody></table></div></div></section><section class="chapter" id="con-BPMN-DMN-modelers_dmn-models"><div class="titlepage"><div><div><h2 class="title">Chapter 2. Red Hat Process Automation Manager BPMN and DMN modelers</h2></div></div></div><p>
				Red Hat Process Automation Manager provides the following extensions or applications that you can use to design Business Process Model and Notation (BPMN) process models and Decision Model and Notation (DMN) decision models using graphical modelers.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>Business Central</strong></span>: Enables you to view and design BPMN models, DMN models, and test scenario files in a related embedded designer.
					</p><p class="simpara">
						To use Business Central, you can set up a development environment containing a Business Central to design business rules and processes, and a KIE Server to execute and test the created business rules and processes.
					</p></li><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>Red Hat Process Automation Manager VSCode extension</strong></span>: Enables you to view and design BPMN models, DMN models, and test scenario files in Visual Studio Code (VSCode). The VSCode extension requires VSCode 1.46.0 or later.
					</p><p class="simpara">
						To install the Red Hat Process Automation Manager VSCode extension, select the <span class="strong strong"><strong>Extensions</strong></span> menu option in VSCode and search for and install the <span class="strong strong"><strong>Red Hat Business Automation Bundle</strong></span> extension.
					</p></li><li class="listitem">
						<span class="strong strong"><strong>Standalone BPMN and DMN editors</strong></span>: Enable you to view and design BPMN and DMN models embedded in your web applications. To download the necessary files, you can either use the NPM artifacts from the <a class="link" href="https://npm.registry.redhat.com/">NPM registry</a> or download the JavaScript files directly for the DMN standalone editor library at <code class="literal"><a class="link" href="https://&lt;YOUR_PAGE&gt;/dmn/index.js">https://&lt;YOUR_PAGE&gt;/dmn/index.js</a></code> and for the BPMN standalone editor library at <code class="literal"><a class="link" href="https://&lt;YOUR_PAGE&gt;/bpmn/index.js">https://&lt;YOUR_PAGE&gt;/bpmn/index.js</a></code>.
					</li></ul></div><section class="section" id="proc-vscode-extension_dmn-models"><div class="titlepage"><div><div><h2 class="title">2.1. Installing the Red Hat Process Automation Manager VSCode extension bundle</h2></div></div></div><p>
					Red Hat Process Automation Manager provides a <span class="strong strong"><strong>Red Hat Business Automation Bundle</strong></span> VSCode extension that enables you to design Decision Model and Notation (DMN) decision models, Business Process Model and Notation (BPMN) 2.0 business processes, and test scenarios directly in VSCode. Red Hat Process Automation Manager also provides individual <span class="strong strong"><strong>DMN Editor</strong></span> and <span class="strong strong"><strong>BPMN Editor</strong></span> VSCode extensions for DMN or BPMN support only, if needed.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://code.visualstudio.com/">VSCode</a> 1.46.0 or later is installed.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							In your VSCode IDE, select the <span class="strong strong"><strong>Extensions</strong></span> menu option and search for <span class="strong strong"><strong>Red Hat Business Automation Bundle</strong></span> for DMN, BPMN, and test scenario file support.
						</p><p class="simpara">
							For DMN or BPMN file support only, you can also search for the individual <span class="strong strong"><strong>DMN Editor</strong></span> or <span class="strong strong"><strong>BPMN Editor</strong></span> extensions.
						</p></li><li class="listitem">
							When the <span class="strong strong"><strong>Red Hat Business Automation Bundle</strong></span> extension appears in VSCode, select it and click <span class="strong strong"><strong>Install</strong></span>.
						</li><li class="listitem">
							For optimal VSCode editor behavior, after the extension installation is complete, reload or close and re-launch your instance of VSCode.
						</li></ol></div><p>
					After you install the VSCode extension bundle, any <code class="literal">.dmn</code>, <code class="literal">.bpmn</code>, or <code class="literal">.bpmn2</code> files that you open in VSCode are automatically displayed as graphical models. Additionally, any <code class="literal">.scesim</code> files that you open are automatically displayed as tabular test scenario models for testing the functionality of your business decisions.
				</p><p>
					If the DMN, BPMN, or test scenario modelers open only the XML source of a DMN, BPMN, or test scenario file and displays an error message, review the reported errors and the model file to ensure that all elements are correctly defined.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						For new DMN or BPMN models, you can also enter <code class="literal">dmn.new</code> or <code class="literal">bpmn.new</code> in a web browser to design your DMN or BPMN model in the online modeler. When you finish creating your model, you can click <span class="strong strong"><strong>Download</strong></span> in the online modeler page to import your DMN or BPMN file into your Red Hat Process Automation Manager project in VSCode.
					</p></div></div></section><section class="section" id="proc-standalone-editors_dmn-models"><div class="titlepage"><div><div><h2 class="title">2.2. Configuring the Red Hat Process Automation Manager standalone editors</h2></div></div></div><p>
					Red Hat Process Automation Manager provides standalone editors that are distributed in a self-contained library providing an all-in-one JavaScript file for each editor. The JavaScript file uses a comprehensive API to set and control the editor.
				</p><p>
					You can install the standalone editors in three ways:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Download each JavaScript file manually
						</li><li class="listitem">
							Use the NPM package
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Install the standalone editors using one of the following methods:
						</p><p class="simpara">
							<span class="strong strong"><strong>Download each JavaScript file manually</strong></span>: For this method, follow these steps:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Download the JavaScript files.
								</li><li class="listitem">
									Add the downloaded Javascript files to your hosted application.
								</li><li class="listitem"><p class="simpara">
									Add the following <code class="literal">&lt;script&gt;</code> tag to your HTML page:
								</p><div class="formalpara"><p class="title"><strong>Script tag for your HTML page for the DMN editor</strong></p><p>
										
<pre class="screen">&lt;script src="https://&lt;YOUR_PAGE&gt;/dmn/index.js"&gt;&lt;/script&gt;</pre>
									</p></div><div class="formalpara"><p class="title"><strong>Script tag for your HTML page for the BPMN editor</strong></p><p>
										
<pre class="screen">&lt;script src="https://&lt;YOUR_PAGE&gt;/bpmn/index.js"&gt;&lt;/script&gt;</pre>
									</p></div></li></ol></div><p class="simpara">
							<span class="strong strong"><strong>Use the NPM package</strong></span>: For this method, follow these steps:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Add the NPM package to your <code class="literal">package.json</code> file:
								</p><div class="formalpara"><p class="title"><strong>Adding the NPM package</strong></p><p>
										
<pre class="screen">npm install @redhat/kogito-tooling-kie-editors-standalone</pre>
									</p></div></li><li class="listitem"><p class="simpara">
									Import each editor library to your TypeScript file:
								</p><div class="formalpara"><p class="title"><strong>Importing each editor</strong></p><p>
										
<pre class="screen">import * as DmnEditor from "@redhat/kogito-tooling-kie-editors-standalone/dist/dmn"
import * as BpmnEditor from "@redhat/kogito-tooling-kie-editors-standalone/dist/bpmn"</pre>
									</p></div></li></ol></div></li><li class="listitem"><p class="simpara">
							After you install the standalone editors, open the required editor by using the provided editor API, as shown in the following example for opening a DMN editor. The API is the same for each editor.
						</p><div class="formalpara"><p class="title"><strong>Opening the DMN standalone editor</strong></p><p>
								
<pre class="programlisting language-java">const editor = DmnEditor.open({
  container: document.getElementById("dmn-editor-container"),
  initialContent: Promise.resolve(""),
  readOnly: false,
  origin: "",
  resources: new Map([
    [
      "MyIncludedModel.dmn",
      {
        contentType: "text",
        content: Promise.resolve("")
      }
    ]
  ])
});</pre>
							</p></div><p class="simpara">
							Use the following parameters with the editor API:
						</p><div class="table" id="idm139921851591120"><p class="title"><strong>Table 2.1. Example parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 40%; " class="col_1"/><col style="width: 60%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921849143952" scope="col">Parameter</th><th align="left" valign="top" id="idm139921849142864" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921849143952">
										<p>
											<code class="literal">container</code>
										</p>
										</td><td align="left" valign="top" headers="idm139921849142864">
										<p>
											HTML element in which the editor is appended.
										</p>
										</td></tr><tr><td align="left" valign="top" headers="idm139921849143952">
										<p>
											<code class="literal">initialContent</code>
										</p>
										</td><td align="left" valign="top" headers="idm139921849142864">
										<p>
											Promise to a DMN model content. This parameter can be empty, as shown in the following examples:
										</p>
										<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<code class="literal">Promise.resolve("")</code>
												</li><li class="listitem">
													<code class="literal">Promise.resolve("&lt;DIAGRAM_CONTENT_DIRECTLY_HERE&gt;")</code>
												</li><li class="listitem">
													<code class="literal">fetch("MyDmnModel.dmn").then(content ⇒ content.text())</code>
												</li></ul></div>
										</td></tr><tr><td align="left" valign="top" headers="idm139921849143952">
										<p>
											<code class="literal">readOnly</code> (Optional)
										</p>
										</td><td align="left" valign="top" headers="idm139921849142864">
										<p>
											Enables you to allow changes in the editor. Set to <code class="literal">false</code> (default) to allow content editing and <code class="literal">true</code> for read-only mode in editor.
										</p>
										<div class="admonition note"><div class="admonition_header">Note</div><div><p>
												Only the DMN editor supports read-only mode for now.
											</p></div></div>
										</td></tr><tr><td align="left" valign="top" headers="idm139921849143952">
										<p>
											<code class="literal">origin</code> (Optional)
										</p>
										</td><td align="left" valign="top" headers="idm139921849142864">
										<p>
											Origin of the repository. The default value is <code class="literal">window.location.origin</code>.
										</p>
										</td></tr><tr><td align="left" valign="top" headers="idm139921849143952">
										<p>
											<code class="literal">resources</code> (Optional)
										</p>
										</td><td align="left" valign="top" headers="idm139921849142864">
										<p>
											Map of resources for the editor. For example, this parameter is used to provide included models for the DMN editor or work item definitions for the BPMN editor. Each entry in the map contains a resource name and an object that consists of <code class="literal">content-type</code> (<code class="literal">text</code> or <code class="literal">binary</code>) and <code class="literal">content</code> (similar to the <code class="literal">initialContent</code> parameter).
										</p>
										</td></tr></tbody></table></div></div><p class="simpara">
							The returned object contains the methods that are required to manipulate the editor.
						</p><div class="table" id="idm139921838766912"><p class="title"><strong>Table 2.2. Returned object methods</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 40%; " class="col_1"/><col style="width: 60%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921836192304" scope="col">Method</th><th align="left" valign="top" id="idm139921836191216" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921836192304">
										<p>
											<code class="literal">getContent(): Promise&lt;string&gt;</code>
										</p>
										</td><td align="left" valign="top" headers="idm139921836191216">
										<p>
											Returns a promise containing the editor content.
										</p>
										</td></tr><tr><td align="left" valign="top" headers="idm139921836192304">
										<p>
											<code class="literal">setContent(content: string): void</code>
										</p>
										</td><td align="left" valign="top" headers="idm139921836191216">
										<p>
											Sets the content of the editor.
										</p>
										</td></tr><tr><td align="left" valign="top" headers="idm139921836192304">
										<p>
											<code class="literal">getPreview(): Promise&lt;string&gt;</code>
										</p>
										</td><td align="left" valign="top" headers="idm139921836191216">
										<p>
											Returns a promise containing an SVG string of the current diagram.
										</p>
										</td></tr><tr><td align="left" valign="top" headers="idm139921836192304">
										<p>
											<code class="literal">subscribeToContentChanges(callback: (isDirty: boolean) ⇒ void): (isDirty: boolean) ⇒ void</code>
										</p>
										</td><td align="left" valign="top" headers="idm139921836191216">
										<p>
											Sets a callback to be called when the content changes in the editor and returns the same callback to be used for unsubscription.
										</p>
										</td></tr><tr><td align="left" valign="top" headers="idm139921836192304">
										<p>
											<code class="literal">unsubscribeToContentChanges(callback: (isDirty: boolean) ⇒ void): void</code>
										</p>
										</td><td align="left" valign="top" headers="idm139921836191216">
										<p>
											Unsubscribes the passed callback when the content changes in the editor.
										</p>
										</td></tr><tr><td align="left" valign="top" headers="idm139921836192304">
										<p>
											<code class="literal">markAsSaved(): void</code>
										</p>
										</td><td align="left" valign="top" headers="idm139921836191216">
										<p>
											Resets the editor state that indicates that the content in the editor is saved. Also, it activates the subscribed callbacks related to content change.
										</p>
										</td></tr><tr><td align="left" valign="top" headers="idm139921836192304">
										<p>
											<code class="literal">undo(): void</code>
										</p>
										</td><td align="left" valign="top" headers="idm139921836191216">
										<p>
											Undoes the last change in the editor. Also, it activates the subscribed callbacks related to content change.
										</p>
										</td></tr><tr><td align="left" valign="top" headers="idm139921836192304">
										<p>
											<code class="literal">redo(): void</code>
										</p>
										</td><td align="left" valign="top" headers="idm139921836191216">
										<p>
											Redoes the last undone change in the editor. Also, it activates the subscribed callbacks related to content change.
										</p>
										</td></tr><tr><td align="left" valign="top" headers="idm139921836192304">
										<p>
											<code class="literal">close(): void</code>
										</p>
										</td><td align="left" valign="top" headers="idm139921836191216">
										<p>
											Closes the editor.
										</p>
										</td></tr><tr><td align="left" valign="top" headers="idm139921836192304">
										<p>
											<code class="literal">getElementPosition(selector: string): Promise&lt;Rect&gt;</code>
										</p>
										</td><td align="left" valign="top" headers="idm139921836191216">
										<p>
											Provides an alternative to extend the standard query selector when an element lives inside a canvas or a video component. The <code class="literal">selector</code> parameter must follow the <code class="literal">&lt;PROVIDER&gt;:::&lt;SELECT&gt;</code> format, such as <code class="literal">Canvas:::MySquare</code> or <code class="literal">Video:::PresenterHand</code>. This method returns a <code class="literal">Rect</code> representing the element position.
										</p>
										</td></tr><tr><td align="left" valign="top" headers="idm139921836192304">
										<p>
											<code class="literal">envelopeApi: MessageBusClientApi&lt;KogitoEditorEnvelopeApi&gt;</code>
										</p>
										</td><td align="left" valign="top" headers="idm139921836191216">
										<p>
											This is an advanced editor API. For more information about advanced editor API, see <a class="link" href="https://github.com/kiegroup/kogito-tooling/blob/master/packages/envelope-bus/src/api/index.ts#L43-L56">MessageBusClientApi</a> and <a class="link" href="https://github.com/kiegroup/kogito-tooling/blob/master/packages/editor/src/api/KogitoEditorEnvelopeApi.ts#L34-L41">KogitoEditorEnvelopeApi</a>.
										</p>
										</td></tr></tbody></table></div></div></li></ol></div></section></section><section class="chapter" id="dmn-con_dmn-models"><div class="titlepage"><div><div><h2 class="title">Chapter 3. Decision Model and Notation (DMN)</h2></div></div></div><p>
				Decision Model and Notation (DMN) is a standard established by the Object Management Group (OMG) for describing and modeling operational decisions. DMN defines an XML schema that enables DMN models to be shared between DMN-compliant platforms and across organizations so that business analysts and business rules developers can collaborate in designing and implementing DMN decision services. The DMN standard is similar to and can be used together with the Business Process Model and Notation (BPMN) standard for designing and modeling business processes.
			</p><p>
				For more information about the background and applications of DMN, see the OMG <a class="link" href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.
			</p><section class="section" id="dmn-conformance-levels-con_dmn-models"><div class="titlepage"><div><div><h2 class="title">3.1. DMN conformance levels</h2></div></div></div><p>
					The DMN specification defines three incremental levels of conformance in a software implementation. A product that claims compliance at one level must also be compliant with any preceding levels. For example, a conformance level 3 implementation must also include the supported components in conformance levels 1 and 2. For the formal definitions of each conformance level, see the OMG <a class="link" href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.
				</p><p>
					The following list summarizes the three DMN conformance levels:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Conformance level 1</span></dt><dd>
								A DMN conformance level 1 implementation supports decision requirement diagrams (DRDs), decision logic, and decision tables, but decision models are not executable. Any language can be used to define the expressions, including natural, unstructured languages.
							</dd><dt><span class="term">Conformance level 2</span></dt><dd>
								A DMN conformance level 2 implementation includes the requirements in conformance level 1, and supports Simplified Friendly Enough Expression Language (S-FEEL) expressions and fully executable decision models.
							</dd><dt><span class="term">Conformance level 3</span></dt><dd>
								A DMN conformance level 3 implementation includes the requirements in conformance levels 1 and 2, and supports Friendly Enough Expression Language (FEEL) expressions, the full set of boxed expressions, and fully executable decision models.
							</dd></dl></div><p>
					Red Hat Process Automation Manager provides design and runtime support for DMN 1.2 models at conformance level 3, and runtime-only support for DMN 1.1 and 1.3 models at conformance level 3. You can design your DMN models directly in Business Central or with the Red Hat Process Automation Manager DMN modeler in VSCode, or import existing DMN models into your Red Hat Process Automation Manager projects for deployment and execution. Any DMN 1.1 and 1.3 models (do not contain DMN 1.3 features) that you import into Business Central, open in the DMN designer, and save are converted to DMN 1.2 models.
				</p></section><section class="section" id="dmn-drd-components-ref_dmn-models"><div class="titlepage"><div><div><h2 class="title">3.2. DMN decision requirements diagram (DRD) components</h2></div></div></div><p>
					A decision requirements diagram (DRD) is a visual representation of your DMN model. A DRD can represent part or all of the overall decision requirements graph (DRG) for the DMN model. DRDs trace business decisions using decision nodes, business knowledge models, sources of business knowledge, input data, and decision services.
				</p><p>
					The following table summarizes the components in a DRD:
				</p><div class="table" id="idm139921852539088"><p class="title"><strong>Table 3.1. DRD components</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"/><col style="width: 20%; " class="col_2"/><col style="width: 40%; " class="col_3"/><col style="width: 20%; " class="col_4"/></colgroup><thead><tr><th colspan="2" align="left" valign="top" id="idm139921848987760" scope="col">Component</th><th align="left" valign="top" id="idm139921848986064" scope="col">Description</th><th align="left" valign="top" id="idm139921848575136" scope="col">Notation</th></tr></thead><tbody><tr><td rowspan="5" align="left" valign="top" headers="idm139921848987760">
								<p>
									Elements
								</p>
								</td><td align="left" valign="top" headers="idm139921848987760">
								<p>
									Decision
								</p>
								</td><td align="left" valign="top" headers="idm139921848986064">
								<p>
									Node where one or more input elements determine an output based on defined decision logic.
								</p>
								</td><td align="left" valign="top" headers="idm139921848575136"><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-decision-node.png" alt="dmn decision node"/></div></div></td></tr><tr><td align="left" valign="top" headers="idm139921848987760">
								<p>
									Business knowledge model
								</p>
								</td><td align="left" valign="top" headers="idm139921848986064">
								<p>
									Reusable function with one or more decision elements. Decisions that have the same logic but depend on different sub-input data or sub-decisions use business knowledge models to determine which procedure to follow.
								</p>
								</td><td align="left" valign="top" headers="idm139921848575136"><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-bkm-node.png" alt="dmn bkm node"/></div></div></td></tr><tr><td align="left" valign="top" headers="idm139921848987760">
								<p>
									Knowledge source
								</p>
								</td><td align="left" valign="top" headers="idm139921848986064">
								<p>
									External authorities, documents, committees, or policies that regulate a decision or business knowledge model. Knowledge sources are references to real-world factors rather than executable business rules.
								</p>
								</td><td align="left" valign="top" headers="idm139921848575136"><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-knowledge-source-node.png" alt="dmn knowledge source node"/></div></div></td></tr><tr><td align="left" valign="top" headers="idm139921848987760">
								<p>
									Input data
								</p>
								</td><td align="left" valign="top" headers="idm139921848986064">
								<p>
									Information used in a decision node or a business knowledge model. Input data usually includes business-level concepts or objects relevant to the business, such as loan applicant data used in a lending strategy.
								</p>
								</td><td align="left" valign="top" headers="idm139921848575136"><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-input-data-node.png" alt="dmn input data node"/></div></div></td></tr><tr><td align="left" valign="top" headers="idm139921848987760">
								<p>
									Decision service
								</p>
								</td><td align="left" valign="top" headers="idm139921848986064">
								<p>
									Top-level decision containing a set of reusable decisions published as a service for invocation. A decision service can be invoked from an external application or a BPMN business process.
								</p>
								</td><td align="left" valign="top" headers="idm139921848575136"><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-decision-service-node.png" alt="dmn decision service node"/></div></div></td></tr><tr><td rowspan="3" align="left" valign="top" headers="idm139921848987760">
								<p>
									Requirement connectors
								</p>
								</td><td align="left" valign="top" headers="idm139921848987760">
								<p>
									Information requirement
								</p>
								</td><td align="left" valign="top" headers="idm139921848986064">
								<p>
									Connection from an input data node or decision node to another decision node that requires the information.
								</p>
								</td><td align="left" valign="top" headers="idm139921848575136"><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-info-connector.png" alt="dmn info connector"/></div></div></td></tr><tr><td align="left" valign="top" headers="idm139921848987760">
								<p>
									Knowledge requirement
								</p>
								</td><td align="left" valign="top" headers="idm139921848986064">
								<p>
									Connection from a business knowledge model to a decision node or to another business knowledge model that invokes the decision logic.
								</p>
								</td><td align="left" valign="top" headers="idm139921848575136"><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-knowledge-connector.png" alt="dmn knowledge connector"/></div></div></td></tr><tr><td align="left" valign="top" headers="idm139921848987760">
								<p>
									Authority requirement
								</p>
								</td><td align="left" valign="top" headers="idm139921848986064">
								<p>
									Connection from an input data node or a decision node to a dependent knowledge source or from a knowledge source to a decision node, business knowledge model, or another knowledge source.
								</p>
								</td><td align="left" valign="top" headers="idm139921848575136"><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-authority-connector.png" alt="dmn authority connector"/></div></div></td></tr><tr><td rowspan="2" align="left" valign="top" headers="idm139921848987760">
								<p>
									Artifacts
								</p>
								</td><td align="left" valign="top" headers="idm139921848987760">
								<p>
									Text annotation
								</p>
								</td><td align="left" valign="top" headers="idm139921848986064">
								<p>
									Explanatory note associated with an input data node, decision node, business knowledge model, or knowledge source.
								</p>
								</td><td align="left" valign="top" headers="idm139921848575136"><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-annotation-node.png" alt="dmn annotation node"/></div></div></td></tr><tr><td align="left" valign="top" headers="idm139921848987760">
								<p>
									Association
								</p>
								</td><td align="left" valign="top" headers="idm139921848986064">
								<p>
									Connection from an input data node, decision node, business knowledge model, or knowledge source to a text annotation.
								</p>
								</td><td align="left" valign="top" headers="idm139921848575136"><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-association-connector.png" alt="dmn association connector"/></div></div></td></tr></tbody></table></div></div><p>
					The following table summarizes the permitted connectors between DRD elements:
				</p><div class="table" id="idm139921835977040"><p class="title"><strong>Table 3.2. DRD connector rules</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"/><col style="width: 20%; " class="col_2"/><col style="width: 20%; " class="col_3"/><col style="width: 40%; " class="col_4"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921844886880" scope="col">Starts from</th><th align="left" valign="top" id="idm139921841347312" scope="col">Connects to</th><th align="left" valign="top" id="idm139921841346336" scope="col">Connection type</th><th align="left" valign="top" id="idm139921841345248" scope="col">Example</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921844886880">
								<p>
									Decision
								</p>
								</td><td align="left" valign="top" headers="idm139921841347312">
								<p>
									Decision
								</p>
								</td><td align="left" valign="top" headers="idm139921841346336">
								<p>
									Information requirement
								</p>
								</td><td align="left" valign="top" headers="idm139921841345248"><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-decision-to-decision.png" alt="dmn decision to decision"/></div></div></td></tr><tr><td rowspan="2" align="left" valign="top" headers="idm139921844886880">
								<p>
									Business knowledge model
								</p>
								</td><td align="left" valign="top" headers="idm139921841347312">
								<p>
									Decision
								</p>
								</td><td rowspan="2" align="left" valign="top" headers="idm139921841346336">
								<p>
									Knowledge requirement
								</p>
								</td><td align="left" valign="top" headers="idm139921841345248"><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-bkm-to-decision.png" alt="dmn bkm to decision"/></div></div></td></tr><tr><td align="left" valign="top" headers="idm139921841347312">
								<p>
									Business knowledge model
								</p>
								</td><td align="left" valign="top" headers="idm139921841345248"><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-bkm-to-bkm.png" alt="dmn bkm to bkm"/></div></div></td></tr><tr><td rowspan="2" align="left" valign="top" headers="idm139921844886880">
								<p>
									Decision service
								</p>
								</td><td align="left" valign="top" headers="idm139921841347312">
								<p>
									Decision
								</p>
								</td><td rowspan="2" align="left" valign="top" headers="idm139921841346336">
								<p>
									Knowledge requirement
								</p>
								</td><td align="left" valign="top" headers="idm139921841345248"><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-decision-service-to-decision.png" alt="dmn decision service to decision"/></div></div></td></tr><tr><td align="left" valign="top" headers="idm139921841347312">
								<p>
									Business knowledge model
								</p>
								</td><td align="left" valign="top" headers="idm139921841345248"><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-decision-service-to-bkm.png" alt="dmn decision service to bkm"/></div></div></td></tr><tr><td rowspan="2" align="left" valign="top" headers="idm139921844886880">
								<p>
									Input data
								</p>
								</td><td align="left" valign="top" headers="idm139921841347312">
								<p>
									Decision
								</p>
								</td><td align="left" valign="top" headers="idm139921841346336">
								<p>
									Information requirement
								</p>
								</td><td align="left" valign="top" headers="idm139921841345248"><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-input-to-decision.png" alt="dmn input to decision"/></div></div></td></tr><tr><td align="left" valign="top" headers="idm139921841347312">
								<p>
									Knowledge source
								</p>
								</td><td align="left" valign="top" headers="idm139921841346336">
								<p>
									Authority requirement
								</p>
								</td><td align="left" valign="top" headers="idm139921841345248"><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-input-to-knowledge-source.png" alt="dmn input to knowledge source"/></div></div></td></tr><tr><td rowspan="3" align="left" valign="top" headers="idm139921844886880">
								<p>
									Knowledge source
								</p>
								</td><td align="left" valign="top" headers="idm139921841347312">
								<p>
									Decision
								</p>
								</td><td rowspan="3" align="left" valign="top" headers="idm139921841346336">
								<p>
									Authority requirement
								</p>
								</td><td align="left" valign="top" headers="idm139921841345248"><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-knowledge-source-to-decision.png" alt="dmn knowledge source to decision"/></div></div></td></tr><tr><td align="left" valign="top" headers="idm139921841347312">
								<p>
									Business knowledge model
								</p>
								</td><td align="left" valign="top" headers="idm139921841345248"><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-knowledge-source-to-bkm.png" alt="dmn knowledge source to bkm"/></div></div></td></tr><tr><td align="left" valign="top" headers="idm139921841347312">
								<p>
									Knowledge source
								</p>
								</td><td align="left" valign="top" headers="idm139921841345248"><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-knowledge-source-to-knowledge-source.png" alt="dmn knowledge source to knowledge source"/></div></div></td></tr><tr><td align="left" valign="top" headers="idm139921844886880">
								<p>
									Decision
								</p>
								</td><td rowspan="4" align="left" valign="top" headers="idm139921841347312">
								<p>
									Text annotation
								</p>
								</td><td rowspan="4" align="left" valign="top" headers="idm139921841346336">
								<p>
									Association
								</p>
								</td><td align="left" valign="top" headers="idm139921841345248"><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-decision-to-annotation.png" alt="dmn decision to annotation"/></div></div></td></tr><tr><td align="left" valign="top" headers="idm139921844886880">
								<p>
									Business knowledge model
								</p>
								</td><td align="left" valign="top" headers="idm139921841345248"><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-bkm-to-annotation.png" alt="dmn bkm to annotation"/></div></div></td></tr><tr><td align="left" valign="top" headers="idm139921844886880">
								<p>
									Knowledge source
								</p>
								</td><td align="left" valign="top" headers="idm139921841345248"><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-knowledge-source-to-annotation.png" alt="dmn knowledge source to annotation"/></div></div></td></tr><tr><td align="left" valign="top" headers="idm139921844886880">
								<p>
									Input data
								</p>
								</td><td align="left" valign="top" headers="idm139921841345248"><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-input-to-annotation.png" alt="dmn input to annotation"/></div></div></td></tr></tbody></table></div></div><p>
					The following example DRD illustrates some of these DMN components in practice:
				</p><div class="figure" id="idm139921829880688"><p class="title"><strong>Figure 3.1. Example DRD: Loan prequalification</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-example-drd.png" alt="dmn example drd"/></div></div></div><p>
					The following example DRD illustrates DMN components that are part of a reusable decision service:
				</p><div class="figure" id="idm139921829876272"><p class="title"><strong>Figure 3.2. Example DRD: Phone call handling as a decision service</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-example-drd3.png" width="486" alt="dmn example drd3"/></div></div></div><p>
					In a DMN decision service node, the decision nodes in the bottom segment incorporate input data from outside of the decision service to arrive at a final decision in the top segment of the decision service node. The resulting top-level decisions from the decision service are then implemented in any subsequent decisions or business knowledge requirements of the DMN model. You can reuse DMN decision services in other DMN models to apply the same decision logic with different input data and different outgoing connections.
				</p></section><section class="section" id="dmn-feel-con_dmn-models"><div class="titlepage"><div><div><h2 class="title">3.3. Rule expressions in FEEL</h2></div></div></div><p>
					Friendly Enough Expression Language (FEEL) is an expression language defined by the Object Management Group (OMG) DMN specification. FEEL expressions define the logic of a decision in a DMN model. FEEL is designed to facilitate both decision modeling and execution by assigning semantics to the decision model constructs. FEEL expressions in decision requirements diagrams (DRDs) occupy table cells in boxed expressions for decision nodes and business knowledge models.
				</p><p>
					For more information about FEEL in DMN, see the OMG <a class="link" href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.
				</p><section class="section" id="dmn-feel-data-types-ref_dmn-models"><div class="titlepage"><div><div><h3 class="title">3.3.1. Data types in FEEL</h3></div></div></div><p>
						Friendly Enough Expression Language (FEEL) supports the following data types:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Numbers
							</li><li class="listitem">
								Strings
							</li><li class="listitem">
								Boolean values
							</li><li class="listitem">
								Dates
							</li><li class="listitem">
								Time
							</li><li class="listitem">
								Date and time
							</li><li class="listitem">
								Days and time duration
							</li><li class="listitem">
								Years and months duration
							</li><li class="listitem">
								Functions
							</li><li class="listitem">
								Contexts
							</li><li class="listitem">
								Ranges (or intervals)
							</li><li class="listitem">
								Lists
							</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The DMN specification currently does not provide an explicit way of declaring a variable as a <code class="literal">function</code>, <code class="literal">context</code>, <code class="literal">range</code>, or <code class="literal">list</code>, but Red Hat Process Automation Manager extends the DMN built-in types to support variables of these types.
						</p></div></div><p>
						The following list describes each data type:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Numbers</span></dt><dd><p class="simpara">
									Numbers in FEEL are based on the <a class="link" href="http://ieeexplore.ieee.org/document/4610935/">IEEE 754-2008</a> Decimal 128 format, with 34 digits of precision. Internally, numbers are represented in Java as <a class="link" href="https://docs.oracle.com/javase/8/docs/api/java/math/BigDecimal.html"><code class="literal">BigDecimals</code></a> with <code class="literal">MathContext DECIMAL128</code>. FEEL supports only one number data type, so the same type is used to represent both integers and floating point numbers.
								</p><p class="simpara">
									FEEL numbers use a dot (<code class="literal">.</code>) as a decimal separator. FEEL does not support <code class="literal">-INF</code>, <code class="literal">+INF</code>, or <code class="literal">NaN</code>. FEEL uses <code class="literal">null</code> to represent invalid numbers.
								</p><p class="simpara">
									Red Hat Process Automation Manager extends the DMN specification and supports additional number notations:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											<span class="strong strong"><strong>Scientific:</strong></span> You can use scientific notation with the suffix <code class="literal">e&lt;exp&gt;</code> or <code class="literal">E&lt;exp&gt;</code>. For example, <code class="literal">1.2e3</code> is the same as writing the expression <code class="literal">1.2*10**3</code>, but is a literal instead of an expression.
										</li><li class="listitem">
											<span class="strong strong"><strong>Hexadecimal:</strong></span> You can use hexadecimal numbers with the prefix <code class="literal">0x</code>. For example, <code class="literal">0xff</code> is the same as the decimal number <code class="literal">255</code>. Both uppercase and lowercase letters are supported. For example, <code class="literal">0XFF</code> is the same as <code class="literal">0xff</code>.
										</li><li class="listitem">
											<span class="strong strong"><strong>Type suffixes:</strong></span> You can use the type suffixes <code class="literal">f</code>, <code class="literal">F</code>, <code class="literal">d</code>, <code class="literal">D</code>, <code class="literal">l</code>, and <code class="literal">L</code>. These suffixes are ignored.
										</li></ul></div></dd><dt><span class="term">Strings</span></dt><dd><p class="simpara">
									Strings in FEEL are any sequence of characters delimited by double quotation marks.
								</p><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
										
<pre class="screen">"John Doe"</pre>
									</p></div></dd><dt><span class="term">Boolean values</span></dt><dd>
									FEEL uses three-valued boolean logic, so a boolean logic expression may have values <code class="literal">true</code>, <code class="literal">false</code>, or <code class="literal">null</code>.
								</dd><dt><span class="term">Dates</span></dt><dd><p class="simpara">
									Date literals are not supported in FEEL, but you can use the built-in <code class="literal">date()</code> function to construct date values. Date strings in FEEL follow the format defined in the <a class="link" href="https://www.w3.org/TR/xmlschema-2/#date">XML Schema Part 2: Datatypes</a> document. The format is <code class="literal">"YYYY-MM-DD"</code> where <code class="literal">YYYY</code> is the year with four digits, <code class="literal">MM</code> is the number of the month with two digits, and <code class="literal">DD</code> is the number of the day.
								</p><p class="simpara">
									Example:
								</p><pre class="screen">date( "2017-06-23" )</pre><p class="simpara">
									Date objects have time equal to <code class="literal">"00:00:00"</code>, which is midnight. The dates are considered to be local, without a timezone.
								</p></dd><dt><span class="term">Time</span></dt><dd><p class="simpara">
									Time literals are not supported in FEEL, but you can use the built-in <code class="literal">time()</code> function to construct time values. Time strings in FEEL follow the format defined in the <a class="link" href="https://www.w3.org/TR/xmlschema-2/#time">XML Schema Part 2: Datatypes</a> document. The format is <code class="literal">"hh:mm:ss[.uuu][(+-)hh:mm]"</code> where <code class="literal">hh</code> is the hour of the day (from <code class="literal">00</code> to <code class="literal">23</code>), <code class="literal">mm</code> is the minutes in the hour, and <code class="literal">ss</code> is the number of seconds in the minute. Optionally, the string may define the number of milliseconds (<code class="literal">uuu</code>) within the second and contain a positive (<code class="literal">+</code>) or negative (<code class="literal">-</code>) offset from UTC time to define its timezone. Instead of using an offset, you can use the letter <code class="literal">z</code> to represent the UTC time, which is the same as an offset of <code class="literal">-00:00</code>. If no offset is defined, the time is considered to be local.
								</p><p class="simpara">
									Examples:
								</p><pre class="screen">time( "04:25:12" )
time( "14:10:00+02:00" )
time( "22:35:40.345-05:00" )
time( "15:00:30z" )</pre><p class="simpara">
									Time values that define an offset or a timezone cannot be compared to local times that do not define an offset or a timezone.
								</p></dd><dt><span class="term">Date and time</span></dt><dd><p class="simpara">
									Date and time literals are not supported in FEEL, but you can use the built-in <code class="literal">date and time()</code> function to construct date and time values. Date and time strings in FEEL follow the format defined in the <a class="link" href="https://www.w3.org/TR/xmlschema-2/#dateTime">XML Schema Part 2: Datatypes</a> document. The format is <code class="literal">"&lt;date&gt;T&lt;time&gt;"</code>, where <code class="literal">&lt;date&gt;</code> and <code class="literal">&lt;time&gt;</code> follow the prescribed XML schema formatting, conjoined by <code class="literal">T</code>.
								</p><p class="simpara">
									Examples:
								</p><pre class="screen">date and time( "2017-10-22T23:59:00" )
date and time( "2017-06-13T14:10:00+02:00" )
date and time( "2017-02-05T22:35:40.345-05:00" )
date and time( "2017-06-13T15:00:30z" )</pre><p class="simpara">
									Date and time values that define an offset or a timezone cannot be compared to local date and time values that do not define an offset or a timezone.
								</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
										If your implementation of the DMN specification does not support spaces in the XML schema, use the keyword <code class="literal">dateTime</code> as a synonym of <code class="literal">date and time</code>.
									</p></div></div></dd><dt><span class="term">Days and time duration</span></dt><dd><p class="simpara">
									Days and time duration literals are not supported in FEEL, but you can use the built-in <code class="literal">duration()</code> function to construct days and time duration values. Days and time duration strings in FEEL follow the format defined in the <a class="link" href="https://www.w3.org/TR/xmlschema-2/#duration">XML Schema Part 2: Datatypes</a> document, but are restricted to only days, hours, minutes and seconds. Months and years are not supported.
								</p><p class="simpara">
									Examples:
								</p><pre class="screen">duration( "P1DT23H12M30S" )
duration( "P23D" )
duration( "PT12H" )
duration( "PT35M" )</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
										If your implementation of the DMN specification does not support spaces in the XML schema, use the keyword <code class="literal">dayTimeDuration</code> as a synonym of <code class="literal">days and time duration</code>.
									</p></div></div></dd><dt><span class="term">Years and months duration</span></dt><dd><p class="simpara">
									Years and months duration literals are not supported in FEEL, but you can use the built-in <code class="literal">duration()</code> function to construct days and time duration values. Years and months duration strings in FEEL follow the format defined in the <a class="link" href="https://www.w3.org/TR/xmlschema-2/#duration">XML Schema Part 2: Datatypes</a> document, but are restricted to only years and months. Days, hours, minutes, or seconds are not supported.
								</p><p class="simpara">
									Examples:
								</p><pre class="screen">duration( "P3Y5M" )
duration( "P2Y" )
duration( "P10M" )
duration( "P25M" )</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
										If your implementation of the DMN specification does not support spaces in the XML schema, use the keyword <code class="literal">yearMonthDuration</code> as a synonym of <code class="literal">years and months duration</code>.
									</p></div></div></dd><dt><span class="term">Functions</span></dt><dd><p class="simpara">
									FEEL has <code class="literal">function</code> literals (or anonymous functions) that you can use to create functions. The DMN specification currently does not provide an explicit way of declaring a variable as a <code class="literal">function</code>, but Red Hat Process Automation Manager extends the DMN built-in types to support variables of functions.
								</p><p class="simpara">
									Example:
								</p><pre class="screen">function(a, b) a + b</pre><p class="simpara">
									In this example, the FEEL expression creates a function that adds the parameters <code class="literal">a</code> and <code class="literal">b</code> and returns the result.
								</p></dd><dt><span class="term">Contexts</span></dt><dd><p class="simpara">
									FEEL has <code class="literal">context</code> literals that you can use to create contexts. A <code class="literal">context</code> in FEEL is a list of key and value pairs, similar to maps in languages like Java. The DMN specification currently does not provide an explicit way of declaring a variable as a <code class="literal">context</code>, but Red Hat Process Automation Manager extends the DMN built-in types to support variables of contexts.
								</p><p class="simpara">
									Example:
								</p><pre class="screen">{ x : 5, y : 3 }</pre><p class="simpara">
									In this example, the expression creates a context with two entries, <code class="literal">x</code> and <code class="literal">y</code>, representing a coordinate in a chart.
								</p><p class="simpara">
									In DMN 1.2, another way to create contexts is to create an item definition that contains the list of keys as attributes, and then declare the variable as having that item definition type.
								</p><p class="simpara">
									The Red Hat Process Automation Manager DMN API supports DMN <code class="literal">ItemDefinition</code> structural types in a <code class="literal">DMNContext</code> represented in two ways:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											User-defined Java type: Must be a valid JavaBeans object defining properties and getters for each of the components in the DMN <code class="literal">ItemDefinition</code>. If necessary, you can also use the <code class="literal">@FEELProperty</code> annotation for those getters representing a component name which would result in an invalid Java identifier.
										</li><li class="listitem">
											<code class="literal">java.util.Map</code> interface: The map needs to define the appropriate entries, with the keys corresponding to the component name in the DMN <code class="literal">ItemDefinition</code>.
										</li></ul></div></dd><dt><span class="term">Ranges (or intervals)</span></dt><dd><p class="simpara">
									FEEL has <code class="literal">range</code> literals that you can use to create ranges or intervals. A <code class="literal">range</code> in FEEL is a value that defines a lower and an upper bound, where either can be open or closed. The DMN specification currently does not provide an explicit way of declaring a variable as a <code class="literal">range</code>, but Red Hat Process Automation Manager extends the DMN built-in types to support variables of ranges.
								</p><p class="simpara">
									The syntax of a range is defined in the following formats:
								</p><pre class="screen">range          := interval_start endpoint '..' endpoint interval_end
interval_start := open_start | closed_start
open_start     := '(' | ']'
closed_start   := '['
interval_end   := open_end | closed_end
open_end       := ')' | '['
closed_end     := ']'
endpoint       := expression</pre><p class="simpara">
									The expression for the endpoint must return a comparable value, and the lower bound endpoint must be lower than the upper bound endpoint.
								</p><p class="simpara">
									For example, the following literal expression defines an interval between <code class="literal">1</code> and <code class="literal">10</code>, including the boundaries (a closed interval on both endpoints):
								</p><pre class="screen">[ 1 .. 10 ]</pre><p class="simpara">
									The following literal expression defines an interval between 1 hour and 12 hours, including the lower boundary (a closed interval), but excluding the upper boundary (an open interval):
								</p><pre class="screen">[ duration("PT1H") .. duration("PT12H") )</pre><p class="simpara">
									You can use ranges in decision tables to test for ranges of values, or use ranges in simple literal expressions. For example, the following literal expression returns <code class="literal">true</code> if the value of a variable <code class="literal">x</code> is between <code class="literal">0</code> and <code class="literal">100</code>:
								</p><pre class="screen">x in [ 1 .. 100 ]</pre></dd><dt><span class="term">Lists</span></dt><dd><p class="simpara">
									FEEL has <code class="literal">list</code> literals that you can use to create lists of items. A <code class="literal">list</code> in FEEL is represented by a comma-separated list of values enclosed in square brackets. The DMN specification currently does not provide an explicit way of declaring a variable as a <code class="literal">list</code>, but Red Hat Process Automation Manager extends the DMN built-in types to support variables of lists.
								</p><p class="simpara">
									Example:
								</p><pre class="screen">[ 2, 3, 4, 5 ]</pre><p class="simpara">
									All lists in FEEL contain elements of the same type and are immutable. Elements in a list can be accessed by index, where the first element is <code class="literal">1</code>. Negative indexes can access elements starting from the end of the list so that <code class="literal">-1</code> is the last element.
								</p><p class="simpara">
									For example, the following expression returns the second element of a list <code class="literal">x</code>:
								</p><pre class="screen">x[2]</pre><p class="simpara">
									The following expression returns the second-to-last element of a list <code class="literal">x</code>:
								</p><pre class="screen">x[-2]</pre><p class="simpara">
									Elements in a list can also be counted by the function <code class="literal">count</code>, which uses the list of elements as the parameter.
								</p><p class="simpara">
									For example, the following expression returns <code class="literal">4</code>:
								</p><pre class="screen">count([ 2, 3, 4, 5 ])</pre></dd></dl></div></section><section class="section" id="ref-dmn-feel-builtin-functions_dmn-models"><div class="titlepage"><div><div><h3 class="title">3.3.2. Built-in functions in FEEL</h3></div></div></div><p class="_abstract _abstract">
						To promote interoperability with other platforms and systems, Friendly Enough Expression Language (FEEL) includes a library of built-in functions. The built-in FEEL functions are implemented in the Drools Decision Model and Notation (DMN) engine so that you can use the functions in your DMN decision services.
					</p><p>
						The following sections describe each built-in FEEL function, listed in the format <code class="literal"><span class="emphasis"><em>NAME</em></span>( <span class="emphasis"><em>PARAMETERS</em></span> )</code>. For more information about FEEL functions in DMN, see the OMG <a class="link" href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.
					</p><section class="section" id="conversion_functions"><div class="titlepage"><div><div><h4 class="title">3.3.2.1. Conversion functions</h4></div></div></div><p>
							The following functions support conversion between values of different types. Some of these functions use specific string formats, such as the following examples:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">date string</code>: Follows the format defined in the <a class="link" href="https://www.w3.org/TR/xmlschema-2/#date">XML Schema Part 2: Datatypes</a> document, such as <code class="literal">2020-06-01</code>
								</li><li class="listitem"><p class="simpara">
									<code class="literal">time string</code>: Follows one of the following formats:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											Format defined in the <a class="link" href="https://www.w3.org/TR/xmlschema-2/#time">XML Schema Part 2: Datatypes</a> document, such as <code class="literal">23:59:00z</code>
										</li><li class="listitem">
											Format for a local time defined by ISO 8601 followed by <code class="literal">@</code> and an IANA Timezone, such as <code class="literal">00:01:00@Etc/UTC</code>
										</li></ul></div></li><li class="listitem">
									<code class="literal">date time string</code>: Follows the format of a <code class="literal">date string</code> followed by <code class="literal">T</code> and a <code class="literal">time string</code>, such as <code class="literal">2012-12-25T11:00:00Z</code>
								</li><li class="listitem">
									<code class="literal">duration string</code>: Follows the format of <code class="literal">days and time duration</code> and <code class="literal">years and months duration</code> defined in the <a class="link" href="https://www.w3.org/TR/xpath-datamodel/#types">XQuery 1.0 and XPath 2.0 Data Model</a>, such as <code class="literal">P1Y2M</code>
								</li></ul></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">date( from ) - <span class="emphasis"><em>using date</em></span></span></dt><dd><p class="simpara">
										Converts <code class="literal">from</code> to a <code class="literal">date</code> value.
									</p><div class="table" id="idm139921834919568"><p class="title"><strong>Table 3.3. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 30%; " class="col_2"/><col style="width: 40%; " class="col_3"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921851399376" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921851398288" scope="col">Type</th><th style="text-align: left; vertical-align: top; " id="idm139921850251664" scope="col">Format</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921851399376">
													<p>
														<code class="literal">from</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921851398288">
													<p>
														<code class="literal">string</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921850251664">
													<p>
														<code class="literal">date string</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">date( "2012-12-25" ) - date( "2012-12-24" ) = duration( "P1D" )</pre>
										</p></div></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">date( from ) - <span class="emphasis"><em>using date and time</em></span></span></dt><dd><p class="simpara">
										Converts <code class="literal">from</code> to a <code class="literal">date</code> value and sets time components to null.
									</p><div class="table" id="idm139921848334448"><p class="title"><strong>Table 3.4. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921848199136" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921848198048" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921848199136">
													<p>
														<code class="literal">from</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921848198048">
													<p>
														<code class="literal">date and time</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">date(date and time( "2012-12-25T11:00:00Z" )) = date( "2012-12-25" )</pre>
										</p></div></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">date( year, month, day )</span></dt><dd><p class="simpara">
										Produces a <code class="literal">date</code> from the specified year, month, and day values.
									</p><div class="table" id="idm139921843702768"><p class="title"><strong>Table 3.5. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921842390880" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921842389792" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921842390880">
													<p>
														<code class="literal">year</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921842389792">
													<p>
														<code class="literal">number</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921842390880">
													<p>
														<code class="literal">month</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921842389792">
													<p>
														<code class="literal">number</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921842390880">
													<p>
														<code class="literal">day</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921842389792">
													<p>
														<code class="literal">number</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">date( 2012, 12, 25 ) = date( "2012-12-25" )</pre>
										</p></div></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">date and time( date, time )</span></dt><dd><p class="simpara">
										Produces a <code class="literal">date and time</code> from the specified date and ignores any time components and the specified time.
									</p><div class="table" id="idm139921816789504"><p class="title"><strong>Table 3.6. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921829207248" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921829206160" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921829207248">
													<p>
														<code class="literal">date</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921829206160">
													<p>
														<code class="literal">date</code> or <code class="literal">date and time</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921829207248">
													<p>
														<code class="literal">time</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921829206160">
													<p>
														<code class="literal">time</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">date and time ( "2012-12-24T23:59:00" ) = date and time(date( "2012-12-24" ), time( "23:59:00" ))</pre>
										</p></div></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">date and time( from )</span></dt><dd><p class="simpara">
										Produces a <code class="literal">date and time</code> from the specified string.
									</p><div class="table" id="idm139921850158640"><p class="title"><strong>Table 3.7. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 30%; " class="col_2"/><col style="width: 40%; " class="col_3"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921848675840" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921848674752" scope="col">Type</th><th style="text-align: left; vertical-align: top; " id="idm139921848477088" scope="col">Format</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921848675840">
													<p>
														<code class="literal">from</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921848674752">
													<p>
														<code class="literal">string</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921848477088">
													<p>
														<code class="literal">date time string</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">date and time( "2012-12-24T23:59:00" ) + duration( "PT1M" ) = date and time( "2012-12-25T00:00:00" )</pre>
										</p></div></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">time( from )</span></dt><dd><p class="simpara">
										Produces a <code class="literal">time</code> from the specified string.
									</p><div class="table" id="idm139921841883232"><p class="title"><strong>Table 3.8. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 30%; " class="col_2"/><col style="width: 40%; " class="col_3"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921840443872" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921840442784" scope="col">Type</th><th style="text-align: left; vertical-align: top; " id="idm139921840441696" scope="col">Format</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921840443872">
													<p>
														<code class="literal">from</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921840442784">
													<p>
														<code class="literal">string</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921840441696">
													<p>
														<code class="literal">time string</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">time( "23:59:00z" ) + duration( "PT2M" ) = time( "00:01:00@Etc/UTC" )</pre>
										</p></div></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">time( from )</span></dt><dd><p class="simpara">
										Produces a <code class="literal">time</code> from the specified parameter and ignores any date components.
									</p><div class="table" id="idm139921833403664"><p class="title"><strong>Table 3.9. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921833398832" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921834569520" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921833398832">
													<p>
														<code class="literal">from</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921834569520">
													<p>
														<code class="literal">time</code> or <code class="literal">date and time</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">time(date and time( "2012-12-25T11:00:00Z" )) = time( "11:00:00Z" )</pre>
										</p></div></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">time( hour, minute, second, offset? )</span></dt><dd><p class="simpara">
										Produces a <code class="literal">time</code> from the specified hour, minute, and second component values.
									</p><div class="table" id="idm139921853486208"><p class="title"><strong>Table 3.10. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921853481376" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921852600544" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921853481376">
													<p>
														<code class="literal">hour</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921852600544">
													<p>
														<code class="literal">number</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921853481376">
													<p>
														<code class="literal">minute</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921852600544">
													<p>
														<code class="literal">number</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921853481376">
													<p>
														<code class="literal">second</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921852600544">
													<p>
														<code class="literal">number</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921853481376">
													<p>
														<code class="literal">offset</code> (Optional)
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921852600544">
													<p>
														<code class="literal">days and time duration</code> or null
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">time( "23:59:00z" ) = time(23, 59, 0, duration( "PT0H" ))</pre>
										</p></div></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">number( from, grouping separator, decimal separator )</span></dt><dd><p class="simpara">
										Converts <code class="literal">from</code> to a <code class="literal">number</code> using the specified separators.
									</p><div class="table" id="idm139921854468480"><p class="title"><strong>Table 3.11. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921851798992" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921851797904" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921851798992">
													<p>
														<code class="literal">from</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921851797904">
													<p>
														<code class="literal">string</code> representing a valid number
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921851798992">
													<p>
														<code class="literal">grouping separator</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921851797904">
													<p>
														Space ( ), comma (<code class="literal">,</code>), period (<code class="literal">.</code>), or null
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921851798992">
													<p>
														<code class="literal">decimal separator</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921851797904">
													<p>
														Same types as <code class="literal">grouping separator</code>, but the values cannot match
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">number( "1 000,0", " ", "," ) = number( "1,000.0", ",", "." )</pre>
										</p></div></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">string( from )</span></dt><dd><p class="simpara">
										Provides a string representation of the specified parameter.
									</p><div class="table" id="idm139921844039376"><p class="title"><strong>Table 3.12. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921829534432" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921829533344" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921829534432">
													<p>
														<code class="literal">from</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921829533344">
													<p>
														Non-null value
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">string( 1.1 ) = "1.1"
string( null ) = null</pre>
										</p></div></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">duration( from )</span></dt><dd><p class="simpara">
										Converts <code class="literal">from</code> to a <code class="literal">days and time duration</code> value or <code class="literal">years and months duration</code> value.
									</p><div class="table" id="idm139921813539504"><p class="title"><strong>Table 3.13. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 30%; " class="col_2"/><col style="width: 40%; " class="col_3"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921828376976" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921828375888" scope="col">Type</th><th style="text-align: left; vertical-align: top; " id="idm139921830846960" scope="col">Format</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921828376976">
													<p>
														<code class="literal">from</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921828375888">
													<p>
														<code class="literal">string</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921830846960">
													<p>
														<code class="literal">duration string</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">date and time( "2012-12-24T23:59:00" ) - date and time( "2012-12-22T03:45:00" ) = duration( "P2DT20H14M" )
duration( "P2Y2M" ) = duration( "P26M" )</pre>
										</p></div></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">years and months duration( from, to )</span></dt><dd><p class="simpara">
										Calculates the <code class="literal">years and months duration</code> between the two specified parameters.
									</p><div class="table" id="idm139921850300176"><p class="title"><strong>Table 3.14. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921846847552" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921846846464" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921846847552">
													<p>
														<code class="literal">from</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921846846464">
													<p>
														<code class="literal">date</code> or <code class="literal">date and time</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921846847552">
													<p>
														<code class="literal">to</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921846846464">
													<p>
														<code class="literal">date</code> or <code class="literal">date and time</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">years and months duration( date( "2011-12-22" ), date( "2013-08-24" ) ) = duration( "P1Y8M" )</pre>
										</p></div></dd></dl></div></section><section class="section" id="boolean_functions"><div class="titlepage"><div><div><h4 class="title">3.3.2.2. Boolean functions</h4></div></div></div><p>
							The following functions support Boolean operations.
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">not( negand )</span></dt><dd><p class="simpara">
										Performs the logical negation of the <code class="literal">negand</code> operand.
									</p><div class="table" id="idm139921841016864"><p class="title"><strong>Table 3.15. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921834741552" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921834740464" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921834741552">
													<p>
														<code class="literal">negand</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921834740464">
													<p>
														<code class="literal">boolean</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">not( true ) = false
not( null ) = null</pre>
										</p></div></dd></dl></div></section><section class="section" id="string_functions"><div class="titlepage"><div><div><h4 class="title">3.3.2.3. String functions</h4></div></div></div><p>
							The following functions support string operations.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								In FEEL, Unicode characters are counted based on their code points.
							</p></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">substring( string, start position, length? )</span></dt><dd><p class="simpara">
										Returns the substring from the start position for the specified length. The first character is at position value <code class="literal">1</code>.
									</p><div class="table" id="idm139921843349072"><p class="title"><strong>Table 3.16. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921843344240" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921843343152" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921843344240">
													<p>
														<code class="literal">string</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921843343152">
													<p>
														<code class="literal">string</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921843344240">
													<p>
														<code class="literal">start position</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921843343152">
													<p>
														<code class="literal">number</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921843344240">
													<p>
														<code class="literal">length</code> (Optional)
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921843343152">
													<p>
														<code class="literal">number</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">substring( "testing",3 ) = "sting"
substring( "testing",3,3 ) = "sti"
substring( "testing", -2, 1 ) = "n"
substring( "\U01F40Eab", 2 ) = "ab"</pre>
										</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											In FEEL, the string literal <code class="literal">"\U01F40Eab"</code> is the <code class="literal">🐎ab</code> string (horse symbol followed by <code class="literal">a</code> and <code class="literal">b</code>).
										</p></div></div></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">string length( string )</span></dt><dd><p class="simpara">
										Calculates the length of the specified string.
									</p><div class="table" id="idm139921856844128"><p class="title"><strong>Table 3.17. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921853106704" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921853105616" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921853106704">
													<p>
														<code class="literal">string</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921853105616">
													<p>
														<code class="literal">string</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">string length( "tes" ) = 3
string length( "\U01F40Eab" ) = 3</pre>
										</p></div></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">upper case( string )</span></dt><dd><p class="simpara">
										Produces an uppercase version of the specified string.
									</p><div class="table" id="idm139921833559792"><p class="title"><strong>Table 3.18. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921857174512" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921857173424" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921857174512">
													<p>
														<code class="literal">string</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921857173424">
													<p>
														<code class="literal">string</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">upper case( "aBc4" ) = "ABC4"</pre>
										</p></div></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">lower case( string )</span></dt><dd><p class="simpara">
										Produces a lowercase version of the specified string.
									</p><div class="table" id="idm139921848787840"><p class="title"><strong>Table 3.19. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921847530192" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921847529104" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921847530192">
													<p>
														<code class="literal">string</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921847529104">
													<p>
														<code class="literal">string</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">lower case( "aBc4" ) = "abc4"</pre>
										</p></div></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">substring before( string, match )</span></dt><dd><p class="simpara">
										Calculates the substring before the match.
									</p><div class="table" id="idm139921837484688"><p class="title"><strong>Table 3.20. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921830887200" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921830886112" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921830887200">
													<p>
														<code class="literal">string</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921830886112">
													<p>
														<code class="literal">string</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921830887200">
													<p>
														<code class="literal">match</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921830886112">
													<p>
														<code class="literal">string</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">substring before( "testing", "ing" ) = "test"
substring before( "testing", "xyz" ) = ""</pre>
										</p></div></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">substring after( string, match )</span></dt><dd><p class="simpara">
										Calculates the substring after the match.
									</p><div class="table" id="idm139921856833376"><p class="title"><strong>Table 3.21. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921830178336" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921830177248" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921830178336">
													<p>
														<code class="literal">string</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921830177248">
													<p>
														<code class="literal">string</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921830178336">
													<p>
														<code class="literal">match</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921830177248">
													<p>
														<code class="literal">string</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">substring after( "testing", "test" ) = "ing"
substring after( "", "a" ) = ""</pre>
										</p></div></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">replace( input, pattern, replacement, flags? )</span></dt><dd><p class="simpara">
										Calculates the regular expression replacement.
									</p><div class="table" id="idm139921850987424"><p class="title"><strong>Table 3.22. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921845805024" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921845803936" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921845805024">
													<p>
														<code class="literal">input</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921845803936">
													<p>
														<code class="literal">string</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921845805024">
													<p>
														<code class="literal">pattern</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921845803936">
													<p>
														<code class="literal">string</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921845805024">
													<p>
														<code class="literal">replacement</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921845803936">
													<p>
														<code class="literal">string</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921845805024">
													<p>
														<code class="literal">flags</code> (Optional)
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921845803936">
													<p>
														<code class="literal">string</code>
													</p>
													</td></tr></tbody></table></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											This function uses regular expression parameters as defined in <a class="link" href="https://www.w3.org/TR/xquery-operators/#regex-syntax">XQuery 1.0 and XPath 2.0 Functions and Operators</a>.
										</p></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">replace( "abcd", "(ab)|(a)", "[1=$1][2=$2]" ) = "[1=ab][2=]cd"</pre>
										</p></div></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">contains( string, match )</span></dt><dd><p class="simpara">
										Returns <code class="literal">true</code> if the string contains the match.
									</p><div class="table" id="idm139921842257136"><p class="title"><strong>Table 3.23. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921842128912" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921842127824" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921842128912">
													<p>
														<code class="literal">string</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921842127824">
													<p>
														<code class="literal">string</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921842128912">
													<p>
														<code class="literal">match</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921842127824">
													<p>
														<code class="literal">string</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">contains( "testing", "to" ) = false</pre>
										</p></div></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">starts with( string, match )</span></dt><dd><p class="simpara">
										Returns <code class="literal">true</code> if the string starts with the match
									</p><div class="table" id="idm139921829524464"><p class="title"><strong>Table 3.24. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921855431936" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921855430848" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921855431936">
													<p>
														<code class="literal">string</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921855430848">
													<p>
														<code class="literal">string</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921855431936">
													<p>
														<code class="literal">match</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921855430848">
													<p>
														<code class="literal">string</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">starts with( "testing", "te" ) = true</pre>
										</p></div></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">ends with( string, match )</span></dt><dd><p class="simpara">
										Returns <code class="literal">true</code> if the string ends with the match.
									</p><div class="table" id="idm139921832029088"><p class="title"><strong>Table 3.25. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921832024368" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921832023280" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921832024368">
													<p>
														<code class="literal">string</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921832023280">
													<p>
														<code class="literal">string</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921832024368">
													<p>
														<code class="literal">match</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921832023280">
													<p>
														<code class="literal">string</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">ends with( "testing", "g" ) = true</pre>
										</p></div></dd><dt><span class="term">matches( input, pattern, flags? )</span></dt><dd><p class="simpara">
										Returns <code class="literal">true</code> if the input matches the regular expression.
									</p><div class="table" id="idm139921835885984"><p class="title"><strong>Table 3.26. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921828419632" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921828418544" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921828419632">
													<p>
														<code class="literal">input</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921828418544">
													<p>
														<code class="literal">string</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921828419632">
													<p>
														<code class="literal">pattern</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921828418544">
													<p>
														<code class="literal">string</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921828419632">
													<p>
														<code class="literal">flags</code> (Optional)
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921828418544">
													<p>
														<code class="literal">string</code>
													</p>
													</td></tr></tbody></table></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											This function uses regular expression parameters as defined in <a class="link" href="https://www.w3.org/TR/xquery-operators/#regex-syntax">XQuery 1.0 and XPath 2.0 Functions and Operators</a>.
										</p></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">matches( "teeesting", "^te*sting" ) = true</pre>
										</p></div></dd><dt><span class="term">split( string, delimiter )</span></dt><dd><p class="simpara">
										Returns a list of the original string and splits it at the delimiter regular expression pattern.
									</p><div class="table" id="idm139921840888096"><p class="title"><strong>Table 3.27. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921840883264" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921831794976" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921840883264">
													<p>
														<code class="literal">string</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921831794976">
													<p>
														<code class="literal">string</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921840883264">
													<p>
														<code class="literal">delimiter</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921831794976">
													<p>
														<code class="literal">string</code> for a regular expression pattern
													</p>
													</td></tr></tbody></table></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											This function uses regular expression parameters as defined in <a class="link" href="https://www.w3.org/TR/xquery-operators/#regex-syntax">XQuery 1.0 and XPath 2.0 Functions and Operators</a>.
										</p></div></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">split( "John Doe", "\\s" ) = ["John", "Doe"]
split( "a;b;c;;", ";" ) = ["a","b","c","",""]</pre>
										</p></div></dd></dl></div></section><section class="section" id="list_functions"><div class="titlepage"><div><div><h4 class="title">3.3.2.4. List functions</h4></div></div></div><p>
							The following functions support list operations.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								In FEEL, the index of the first element in a list is <code class="literal">1</code>. The index of the last element in a list can be identified as <code class="literal">-1</code>.
							</p></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">list contains( list, element )</span></dt><dd><p class="simpara">
										Returns <code class="literal">true</code> if the list contains the element.
									</p><div class="table" id="idm139921832041024"><p class="title"><strong>Table 3.28. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921837637920" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921837636832" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921837637920">
													<p>
														<code class="literal">list</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921837636832">
													<p>
														<code class="literal">list</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921837637920">
													<p>
														<code class="literal">element</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921837636832">
													<p>
														Any type, including null
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">list contains( [1,2,3], 2 ) = true</pre>
										</p></div></dd><dt><span class="term">count( list )</span></dt><dd><p class="simpara">
										Counts the elements in the list.
									</p><div class="table" id="idm139921839091136"><p class="title"><strong>Table 3.29. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921838816480" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921838815392" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921838816480">
													<p>
														<code class="literal">list</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921838815392">
													<p>
														<code class="literal">list</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">count( [1,2,3] ) = 3
count( [] ) = 0
count( [1,[2,3]] ) = 2</pre>
										</p></div></dd><dt><span class="term">min( list )</span></dt><dd><p class="simpara">
										Returns the minimum comparable element in the list.
									</p><div class="table" id="idm139921827852416"><p class="title"><strong>Table 3.30. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921830016560" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921830015472" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921830016560">
													<p>
														<code class="literal">list</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921830015472">
													<p>
														<code class="literal">list</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Alternative signature</strong></p><p>
											
<pre class="screen">min( e1, e2, ..., eN )</pre>
										</p></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">min( [1,2,3] ) = 1
min( 1 ) = 1
min( [1] ) = 1</pre>
										</p></div></dd><dt><span class="term">max( list )</span></dt><dd><p class="simpara">
										Returns the maximum comparable element in the list.
									</p><div class="table" id="idm139921852566576"><p class="title"><strong>Table 3.31. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921852417520" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921852416432" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921852417520">
													<p>
														<code class="literal">list</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921852416432">
													<p>
														<code class="literal">list</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Alternative signature</strong></p><p>
											
<pre class="screen">max( e1, e2, ..., eN )</pre>
										</p></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">max( 1,2,3 ) = 3
max( [] ) = null</pre>
										</p></div></dd><dt><span class="term">sum( list )</span></dt><dd><p class="simpara">
										Returns the sum of the numbers in the list.
									</p><div class="table" id="idm139921850936992"><p class="title"><strong>Table 3.32. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921849186256" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921849185168" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921849186256">
													<p>
														<code class="literal">list</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921849185168">
													<p>
														<code class="literal">list</code> of <code class="literal">number</code> elements
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Alternative signature</strong></p><p>
											
<pre class="screen">sum( n1, n2, ..., nN )</pre>
										</p></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">sum( [1,2,3] ) = 6
sum( 1,2,3 ) = 6
sum( 1 ) = 1
sum( [] ) = null</pre>
										</p></div></dd><dt><span class="term">mean( list )</span></dt><dd><p class="simpara">
										Calculates the average (arithmetic mean) of the elements in the list.
									</p><div class="table" id="idm139921837703984"><p class="title"><strong>Table 3.33. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921839327872" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921839326784" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921839327872">
													<p>
														<code class="literal">list</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921839326784">
													<p>
														<code class="literal">list</code> of <code class="literal">number</code> elements
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Alternative signature</strong></p><p>
											
<pre class="screen">mean( n1, n2, ..., nN )</pre>
										</p></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">mean( [1,2,3] ) = 2
mean( 1,2,3 ) = 2
mean( 1 ) = 1
mean( [] ) = null</pre>
										</p></div></dd><dt><span class="term">all( list )</span></dt><dd><p class="simpara">
										Returns <code class="literal">true</code> if all elements in the list are true.
									</p><div class="table" id="idm139921839739104"><p class="title"><strong>Table 3.34. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921836489936" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921836488848" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921836489936">
													<p>
														<code class="literal">list</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921836488848">
													<p>
														<code class="literal">list</code> of <code class="literal">boolean</code> elements
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Alternative signature</strong></p><p>
											
<pre class="screen">all( b1, b2, ..., bN )</pre>
										</p></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">all( [false,null,true] ) = false
all( true ) = true
all( [true] ) = true
all( [] ) = true
all( 0 ) = null</pre>
										</p></div></dd><dt><span class="term">any( list )</span></dt><dd><p class="simpara">
										Returns <code class="literal">true</code> if any element in the list is true.
									</p><div class="table" id="idm139921838115632"><p class="title"><strong>Table 3.35. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921838110800" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921834805424" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921838110800">
													<p>
														<code class="literal">list</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921834805424">
													<p>
														<code class="literal">list</code> of <code class="literal">boolean</code> elements
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Alternative signature</strong></p><p>
											
<pre class="screen">any( b1, b2, ..., bN )</pre>
										</p></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">any( [false,null,true] ) = true
any( false ) = false
any( [] ) = false
any( 0 ) = null</pre>
										</p></div></dd><dt><span class="term">sublist( list, start position, length? )</span></dt><dd><p class="simpara">
										Returns the sublist from the start position, limited to the length elements.
									</p><div class="table" id="idm139921846234656"><p class="title"><strong>Table 3.36. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921854020304" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921854019216" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921854020304">
													<p>
														<code class="literal">list</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921854019216">
													<p>
														<code class="literal">list</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921854020304">
													<p>
														<code class="literal">start position</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921854019216">
													<p>
														<code class="literal">number</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921854020304">
													<p>
														<code class="literal">length</code> (Optional)
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921854019216">
													<p>
														<code class="literal">number</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">sublist( [4,5,6], 1, 2 ) = [4,5]</pre>
										</p></div></dd><dt><span class="term">append( list, item )</span></dt><dd><p class="simpara">
										Creates a list that is appended to the item or items.
									</p><div class="table" id="idm139921854660848"><p class="title"><strong>Table 3.37. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921852467248" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921852466160" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921852467248">
													<p>
														<code class="literal">list</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921852466160">
													<p>
														<code class="literal">list</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921852467248">
													<p>
														<code class="literal">item</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921852466160">
													<p>
														Any type
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">append( [1], 2, 3 ) = [1,2,3]</pre>
										</p></div></dd><dt><span class="term">concatenate( list )</span></dt><dd><p class="simpara">
										Creates a list that is the result of the concatenated lists.
									</p><div class="table" id="idm139921849250640"><p class="title"><strong>Table 3.38. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921837167808" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921837166720" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921837167808">
													<p>
														<code class="literal">list</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921837166720">
													<p>
														<code class="literal">list</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">concatenate( [1,2],[3] ) = [1,2,3]</pre>
										</p></div></dd><dt><span class="term">insert before( list, position, newItem )</span></dt><dd><p class="simpara">
										Creates a list with the <code class="literal">newItem</code> inserted at the specified position.
									</p><div class="table" id="idm139921837112672"><p class="title"><strong>Table 3.39. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921849478768" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921849477680" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921849478768">
													<p>
														<code class="literal">list</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921849477680">
													<p>
														<code class="literal">list</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921849478768">
													<p>
														<code class="literal">position</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921849477680">
													<p>
														<code class="literal">number</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921849478768">
													<p>
														<code class="literal">newItem</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921849477680">
													<p>
														Any type
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">insert before( [1,3],1,2 ) = [2,1,3]</pre>
										</p></div></dd><dt><span class="term">remove( list, position )</span></dt><dd><p class="simpara">
										Creates a list with the removed element excluded from the specified position.
									</p><div class="table" id="idm139921838742368"><p class="title"><strong>Table 3.40. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921832103408" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921832102320" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921832103408">
													<p>
														<code class="literal">list</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921832102320">
													<p>
														<code class="literal">list</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921832103408">
													<p>
														<code class="literal">position</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921832102320">
													<p>
														<code class="literal">number</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">remove( [1,2,3], 2 ) = [1,3]</pre>
										</p></div></dd><dt><span class="term">reverse( list )</span></dt><dd><p class="simpara">
										Returns a reversed list.
									</p><div class="table" id="idm139921847997040"><p class="title"><strong>Table 3.41. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921842630368" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921842629280" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921842630368">
													<p>
														<code class="literal">list</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921842629280">
													<p>
														<code class="literal">list</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">reverse( [1,2,3] ) = [3,2,1]</pre>
										</p></div></dd><dt><span class="term">index of( list, match )</span></dt><dd><p class="simpara">
										Returns indexes matching the element.
									</p><div class="itemizedlist"><p class="title"><strong>Parameters</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
												<code class="literal">list</code> of type <code class="literal">list</code>
											</li><li class="listitem">
												<code class="literal">match</code> of any type
											</li></ul></div><div class="table" id="idm139921817042800"><p class="title"><strong>Table 3.42. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921830073056" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921830071968" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921830073056">
													<p>
														<code class="literal">list</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921830071968">
													<p>
														<code class="literal">list</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921830073056">
													<p>
														<code class="literal">match</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921830071968">
													<p>
														Any type
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">index of( [1,2,3,2],2 ) = [2,4]</pre>
										</p></div></dd><dt><span class="term">union( list )</span></dt><dd><p class="simpara">
										Returns a list of all the elements from multiple lists and excludes duplicates.
									</p><div class="table" id="idm139921853352832"><p class="title"><strong>Table 3.43. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921850239984" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921850238896" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921850239984">
													<p>
														<code class="literal">list</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921850238896">
													<p>
														<code class="literal">list</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">union( [1,2],[2,3] ) = [1,2,3]</pre>
										</p></div></dd><dt><span class="term">distinct values( list )</span></dt><dd><p class="simpara">
										Returns a list of elements from a single list and excludes duplicates.
									</p><div class="table" id="idm139921830670256"><p class="title"><strong>Table 3.44. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921839135232" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921839134144" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921839135232">
													<p>
														<code class="literal">list</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921839134144">
													<p>
														<code class="literal">list</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">distinct values( [1,2,3,2,1] ) = [1,2,3]</pre>
										</p></div></dd><dt><span class="term">flatten( list )</span></dt><dd><p class="simpara">
										Returns a flattened list.
									</p><div class="table" id="idm139921857288688"><p class="title"><strong>Table 3.45. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921852140944" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921852139856" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921852140944">
													<p>
														<code class="literal">list</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921852139856">
													<p>
														<code class="literal">list</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">flatten( [[1,2],[[3]], 4] ) = [1,2,3,4]</pre>
										</p></div></dd><dt><span class="term">product( list )</span></dt><dd><p class="simpara">
										Returns the product of the numbers in the list.
									</p><div class="table" id="idm139921850431744"><p class="title"><strong>Table 3.46. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921834490096" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921834489008" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921834490096">
													<p>
														<code class="literal">list</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921834489008">
													<p>
														<code class="literal">list</code> of <code class="literal">number</code> elements
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Alternative signature</strong></p><p>
											
<pre class="screen">product( n1, n2, ..., nN )</pre>
										</p></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">product( [2, 3, 4] ) = 24
product( 2, 3, 4 ) = 24</pre>
										</p></div></dd><dt><span class="term">median( list )</span></dt><dd><p class="simpara">
										Returns the median of the numbers in the list. If the number of elements is odd, the result is the middle element. If the number of elements is even, the result is the average of the two middle elements.
									</p><div class="table" id="idm139921831074816"><p class="title"><strong>Table 3.47. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921854981904" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921854980816" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921854981904">
													<p>
														<code class="literal">list</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921854980816">
													<p>
														<code class="literal">list</code> of <code class="literal">number</code> elements
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Alternative signature</strong></p><p>
											
<pre class="screen">median( n1, n2, ..., nN )</pre>
										</p></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">median( 8, 2, 5, 3, 4 ) = 4
median( [6, 1, 2, 3] ) = 2.5
median( [ ] ) = null</pre>
										</p></div></dd><dt><span class="term">stddev( list )</span></dt><dd><p class="simpara">
										Returns the standard deviation of the numbers in the list.
									</p><div class="table" id="idm139921849925120"><p class="title"><strong>Table 3.48. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921848741984" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921848740896" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921848741984">
													<p>
														<code class="literal">list</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921848740896">
													<p>
														<code class="literal">list</code> of <code class="literal">number</code> elements
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Alternative signature</strong></p><p>
											
<pre class="screen">stddev( n1, n2, ..., nN )</pre>
										</p></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">stddev( 2, 4, 7, 5 ) = 2.081665999466132735282297706979931
stddev( [47] ) = null
stddev( 47 ) = null
stddev( [ ] ) = null</pre>
										</p></div></dd><dt><span class="term">mode( list )</span></dt><dd><p class="simpara">
										Returns the mode of the numbers in the list. If multiple elements are returned, the numbers are sorted in ascending order.
									</p><div class="table" id="idm139921837424112"><p class="title"><strong>Table 3.49. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921838263600" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921838262512" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921838263600">
													<p>
														<code class="literal">list</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921838262512">
													<p>
														<code class="literal">list</code> of <code class="literal">number</code> elements
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Alternative signature</strong></p><p>
											
<pre class="screen">mode( n1, n2, ..., nN )</pre>
										</p></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">mode( 6, 3, 9, 6, 6 ) = [6]
mode( [6, 1, 9, 6, 1] ) = [1, 6]
mode( [ ] ) = [ ]</pre>
										</p></div></dd></dl></div></section><section class="section" id="numeric_functions"><div class="titlepage"><div><div><h4 class="title">3.3.2.5. Numeric functions</h4></div></div></div><p>
							The following functions support number operations.
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">decimal( n, scale )</span></dt><dd><p class="simpara">
										Returns a number with the specified scale.
									</p><div class="table" id="idm139921830751440"><p class="title"><strong>Table 3.50. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921830746608" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921850780032" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921830746608">
													<p>
														<code class="literal">n</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921850780032">
													<p>
														<code class="literal">number</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921830746608">
													<p>
														<code class="literal">scale</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921850780032">
													<p>
														<code class="literal">number</code> in the range <code class="literal">[−6111..6176]</code>
													</p>
													</td></tr></tbody></table></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											This function is implemented to be consistent with the <code class="literal">FEEL:number</code> definition for rounding decimal numbers to the nearest even decimal number.
										</p></div></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">decimal( 1/3, 2 ) = .33
decimal( 1.5, 0 ) = 2
decimal( 2.5, 0 ) = 2
decimal( 1.035, 2 ) = 1.04
decimal( 1.045, 2 ) = 1.04
decimal( 1.055, 2 ) = 1.06
decimal( 1.065, 2 ) = 1.06</pre>
										</p></div></dd><dt><span class="term">floor( n )</span></dt><dd><p class="simpara">
										Returns the greatest integer that is less than or equal to the specified number.
									</p><div class="table" id="idm139921834436064"><p class="title"><strong>Table 3.51. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921832064464" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921832063376" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921832064464">
													<p>
														<code class="literal">n</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921832063376">
													<p>
														<code class="literal">number</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">floor( 1.5 ) = 1
floor( -1.5 ) = -2</pre>
										</p></div></dd><dt><span class="term">ceiling( n )</span></dt><dd><p class="simpara">
										Returns the smallest integer that is greater than or equal to the specified number.
									</p><div class="table" id="idm139921828166288"><p class="title"><strong>Table 3.52. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921837769776" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921837768688" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921837769776">
													<p>
														<code class="literal">n</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921837768688">
													<p>
														<code class="literal">number</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">ceiling( 1.5 ) = 2
ceiling( -1.5 ) = -1</pre>
										</p></div></dd><dt><span class="term">abs( n )</span></dt><dd><p class="simpara">
										Returns the absolute value.
									</p><div class="table" id="idm139921854166352"><p class="title"><strong>Table 3.53. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921854161520" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921853977600" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921854161520">
													<p>
														<code class="literal">n</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921853977600">
													<p>
														<code class="literal">number</code>, <code class="literal">days and time duration</code>, or <code class="literal">years and months duration</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">abs( 10 ) = 10
abs( -10 ) = 10
abs( @"PT5H" ) = @"PT5H"
abs( @"-PT5H" ) = @"PT5H"</pre>
										</p></div></dd><dt><span class="term">modulo( dividend, divisor )</span></dt><dd><p class="simpara">
										Returns the remainder of the division of the dividend by the divisor. If either the dividend or divisor is negative, the result is of the same sign as the divisor.
									</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											This function is also expressed as <code class="literal">modulo(dividend, divisor) = dividend - divisor*floor(dividen d/divisor)</code>.
										</p></div></div><div class="table" id="idm139921830303600"><p class="title"><strong>Table 3.54. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921830298768" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921829344816" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921830298768">
													<p>
														<code class="literal">dividend</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921829344816">
													<p>
														<code class="literal">number</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921830298768">
													<p>
														<code class="literal">divisor</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921829344816">
													<p>
														<code class="literal">number</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">modulo( 12, 5 ) = 2
modulo( -12,5 )= 3
modulo( 12,-5 )= -3
modulo( -12,-5 )= -2
modulo( 10.1, 4.5 )= 1.1
modulo( -10.1, 4.5 )= 3.4
modulo( 10.1, -4.5 )= -3.4
modulo( -10.1, -4.5 )= -1.1</pre>
										</p></div></dd><dt><span class="term">sqrt( number )</span></dt><dd><p class="simpara">
										Returns the square root of the specified number.
									</p><div class="table" id="idm139921838873072"><p class="title"><strong>Table 3.55. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921816982272" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921816981184" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921816982272">
													<p>
														<code class="literal">n</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921816981184">
													<p>
														<code class="literal">number</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">sqrt( 16 ) = 4</pre>
										</p></div></dd><dt><span class="term">log( number )</span></dt><dd><p class="simpara">
										Returns the logarithm of the specified number.
									</p><div class="table" id="idm139921831092224"><p class="title"><strong>Table 3.56. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921831087392" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921851952816" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921831087392">
													<p>
														<code class="literal">n</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921851952816">
													<p>
														<code class="literal">number</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">decimal( log( 10 ), 2 ) = 2.30</pre>
										</p></div></dd><dt><span class="term">exp( number )</span></dt><dd><p class="simpara">
										Returns Euler’s number <code class="literal">e</code> raised to the power of the specified number.
									</p><div class="table" id="idm139921849660960"><p class="title"><strong>Table 3.57. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921836227536" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921836226448" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921836227536">
													<p>
														<code class="literal">n</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921836226448">
													<p>
														<code class="literal">number</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">decimal( exp( 5 ), 2 ) = 148.41</pre>
										</p></div></dd><dt><span class="term">odd( number )</span></dt><dd><p class="simpara">
										Returns <code class="literal">true</code> if the specified number is odd.
									</p><div class="table" id="idm139921829330864"><p class="title"><strong>Table 3.58. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921835829936" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921835828848" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921835829936">
													<p>
														<code class="literal">n</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921835828848">
													<p>
														<code class="literal">number</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">odd( 5 ) = true
odd( 2 ) = false</pre>
										</p></div></dd><dt><span class="term">even( number )</span></dt><dd><p class="simpara">
										Returns <code class="literal">true</code> if the specified number is even.
									</p><div class="table" id="idm139921848278704"><p class="title"><strong>Table 3.59. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921830560064" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921830558976" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921830560064">
													<p>
														<code class="literal">n</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921830558976">
													<p>
														<code class="literal">number</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">even( 5 ) = false
even ( 2 ) = true</pre>
										</p></div></dd></dl></div></section><section class="section" id="date_and_time_functions"><div class="titlepage"><div><div><h4 class="title">3.3.2.6. Date and time functions</h4></div></div></div><p>
							The following functions support date and time operations.
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">is( value1, value2 )</span></dt><dd><p class="simpara">
										Returns <code class="literal">true</code> if both values are the same element in the FEEL semantic domain.
									</p><div class="table" id="idm139921831904208"><p class="title"><strong>Table 3.60. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921836691008" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921836689920" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921836691008">
													<p>
														<code class="literal">value1</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921836689920">
													<p>
														Any type
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921836691008">
													<p>
														<code class="literal">value2</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921836689920">
													<p>
														Any type
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">is( date( "2012-12-25" ), time( "23:00:50" ) ) = false
is( date( "2012-12-25" ), date( "2012-12-25" ) ) = true
is( time( "23:00:50z" ), time( "23:00:50" ) ) = false</pre>
										</p></div></dd></dl></div></section><section class="section" id="range_functions"><div class="titlepage"><div><div><h4 class="title">3.3.2.7. Range functions</h4></div></div></div><p>
							The following functions support temporal ordering operations to establish relationships between single scalar values and ranges of such values. These functions are similar to the components in the Health Level Seven (HL7) International <a class="link" href="https://cql.hl7.org/08-a-cqlsyntax.html">Clinical Quality Language (CQL) 1.4 syntax</a>.
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">before( )</span></dt><dd><p class="simpara">
										Returns <code class="literal">true</code> when an element <code class="literal">A</code> is before an element <code class="literal">B</code> and when the relevant requirements for evaluating to <code class="literal">true</code> are also met.
									</p><div class="orderedlist"><p class="title"><strong>Signatures</strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">before( point1 point2 )</code>
											</li><li class="listitem">
												<code class="literal">before( point range )</code>
											</li><li class="listitem">
												<code class="literal">before( range point )</code>
											</li><li class="listitem">
												<code class="literal">before( range1,range2 )</code>
											</li></ol></div><div class="orderedlist"><p class="title"><strong>Requirements for evaluating to <code class="literal">true</code></strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">point1 &lt; point2</code>
											</li><li class="listitem">
												<code class="literal">point &lt; range.start or ( point = range.start and not(range.start included) )</code>
											</li><li class="listitem">
												<code class="literal">range.end &lt; point or ( range.end = point and not(range.end included) )</code>
											</li><li class="listitem">
												<code class="literal">range1.end &lt; range2.start or (( not(range1.end included) or not(range2.start included) ) and range1.end = range2.start )</code>
											</li></ol></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">before( 1, 10 ) = true
before( 10, 1 ) = false
before( 1, [1..10] ) = false
before( 1, (1..10] ) = true
before( 1, [5..10] ) = true
before( [1..10], 10 ) = false
before( [1..10), 10 ) = true
before( [1..10], 15 ) = true
before( [1..10], [15..20] ) = true
before( [1..10], [10..20] ) = false
before( [1..10), [10..20] ) = true
before( [1..10], (10..20] ) = true</pre>
										</p></div></dd><dt><span class="term">after( )</span></dt><dd><p class="simpara">
										Returns <code class="literal">true</code> when an element <code class="literal">A</code> is after an element <code class="literal">B</code> and when the relevant requirements for evaluating to <code class="literal">true</code> are also met.
									</p><div class="orderedlist"><p class="title"><strong>Signatures</strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">after( point1 point2 )</code>
											</li><li class="listitem">
												<code class="literal">after( point range )</code>
											</li><li class="listitem">
												<code class="literal">after( range, point )</code>
											</li><li class="listitem">
												<code class="literal">after( range1 range2 )</code>
											</li></ol></div><div class="orderedlist"><p class="title"><strong>Requirements for evaluating to <code class="literal">true</code></strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">point1 &gt; point2</code>
											</li><li class="listitem">
												<code class="literal">point &gt; range.end or ( point = range.end and not(range.end included) )</code>
											</li><li class="listitem">
												<code class="literal">range.start &gt; point or ( range.start = point and not(range.start included) )</code>
											</li><li class="listitem">
												<code class="literal">range1.start &gt; range2.end or (( not(range1.start included) or not(range2.end included) ) and range1.start = range2.end )</code>
											</li></ol></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">after( 10, 5 ) = true
after( 5, 10 ) = false
after( 12, [1..10] ) = true
after( 10, [1..10) ) = true
after( 10, [1..10] ) = false
after( [11..20], 12 ) = false
after( [11..20], 10 ) = true
after( (11..20], 11 ) = true
after( [11..20], 11 ) = false
after( [11..20], [1..10] ) = true
after( [1..10], [11..20] ) = false
after( [11..20], [1..11) ) = true
after( (11..20], [1..11] ) = true</pre>
										</p></div></dd><dt><span class="term">meets( )</span></dt><dd><p class="simpara">
										Returns <code class="literal">true</code> when an element <code class="literal">A</code> meets an element <code class="literal">B</code> and when the relevant requirements for evaluating to <code class="literal">true</code> are also met.
									</p><div class="orderedlist"><p class="title"><strong>Signatures</strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">meets( range1, range2 )</code>
											</li></ol></div><div class="orderedlist"><p class="title"><strong>Requirements for evaluating to <code class="literal">true</code></strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">range1.end included and range2.start included and range1.end = range2.start</code>
											</li></ol></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">meets( [1..5], [5..10] ) = true
meets( [1..5), [5..10] ) = false
meets( [1..5], (5..10] ) = false
meets( [1..5], [6..10] ) = false</pre>
										</p></div></dd><dt><span class="term">met by( )</span></dt><dd><p class="simpara">
										Returns <code class="literal">true</code> when an element <code class="literal">A</code> is met by an element <code class="literal">B</code> and when the relevant requirements for evaluating to <code class="literal">true</code> are also met.
									</p><div class="orderedlist"><p class="title"><strong>Signatures</strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">met by( range1, range2 )</code>
											</li></ol></div><div class="orderedlist"><p class="title"><strong>Requirements for evaluating to <code class="literal">true</code></strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">range1.start included and range2.end included and range1.start = range2.end</code>
											</li></ol></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">met by( [5..10], [1..5] ) = true
met by( [5..10], [1..5) ) = false
met by( (5..10], [1..5] ) = false
met by( [6..10], [1..5] ) = false</pre>
										</p></div></dd><dt><span class="term">overlaps( )</span></dt><dd><p class="simpara">
										Returns <code class="literal">true</code> when an element <code class="literal">A</code> overlaps an element <code class="literal">B</code> and when the relevant requirements for evaluating to <code class="literal">true</code> are also met.
									</p><div class="orderedlist"><p class="title"><strong>Signatures</strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">overlaps( range1, range2 )</code>
											</li></ol></div><div class="orderedlist"><p class="title"><strong>Requirements for evaluating to <code class="literal">true</code></strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">( range1.end &gt; range2.start or (range1.end = range2.start and (range1.end included or range2.end included)) ) and ( range1.start &lt; range2.end or (range1.start = range2.end and range1.start included and range2.end included) )</code>
											</li></ol></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">overlaps( [1..5], [3..8] ) = true
overlaps( [3..8], [1..5] ) = true
overlaps( [1..8], [3..5] ) = true
overlaps( [3..5], [1..8] ) = true
overlaps( [1..5], [6..8] ) = false
overlaps( [6..8], [1..5] ) = false
overlaps( [1..5], [5..8] ) = true
overlaps( [1..5], (5..8] ) = false
overlaps( [1..5), [5..8] ) = false
overlaps( [1..5), (5..8] ) = false
overlaps( [5..8], [1..5] ) = true
overlaps( (5..8], [1..5] ) = false
overlaps( [5..8], [1..5) ) = false
overlaps( (5..8], [1..5) ) = false</pre>
										</p></div></dd><dt><span class="term">overlaps before( )</span></dt><dd><p class="simpara">
										Returns <code class="literal">true</code> when an element <code class="literal">A</code> overlaps before an element <code class="literal">B</code> and when the relevant requirements for evaluating to <code class="literal">true</code> are also met.
									</p><div class="orderedlist"><p class="title"><strong>Signatures</strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">overlaps before( range1 range2 )</code>
											</li></ol></div><div class="orderedlist"><p class="title"><strong>Requirements for evaluating to <code class="literal">true</code></strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">( range1.start &lt; range2.start or (range1.start = range2.start and range1.start included and range2.start included) ) and ( range1.end &gt; range2.start or (range1.end = range2.start and range1.end included and range2.start included) ) and ( range1.end &lt; range2.end or (range1.end = range2.end and (not(range1.end included) or range2.end included )) )</code>
											</li></ol></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">overlaps before( [1..5], [3..8] ) = true
overlaps before( [1..5], [6..8] ) = false
overlaps before( [1..5], [5..8] ) = true
overlaps before( [1..5], (5..8] ) = false
overlaps before( [1..5), [5..8] ) = false
overlaps before( [1..5), (1..5] ) = true
overlaps before( [1..5], (1..5] ) = true
overlaps before( [1..5), [1..5] ) = false
overlaps before( [1..5], [1..5] ) = false</pre>
										</p></div></dd><dt><span class="term">overlaps after( )</span></dt><dd><p class="simpara">
										Returns <code class="literal">true</code> when an element <code class="literal">A</code> overlaps after an element <code class="literal">B</code> and when the relevant requirements for evaluating to <code class="literal">true</code> are also met.
									</p><div class="orderedlist"><p class="title"><strong>Signatures</strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">overlaps after( range1 range2 )</code>
											</li></ol></div><div class="orderedlist"><p class="title"><strong>Requirements for evaluating to <code class="literal">true</code></strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">( range2.start &lt; range1.start or (range2.start = range1.start and range2.start included and not( range1.start included)) ) and ( range2.end &gt; range1.start or (range2.end = range1.start and range2.end included and range1.start included) ) and ( range2.end &lt; range1.end or (range2.end = range1.end and (not(range2.end included) or range1.end included)) )</code>
											</li></ol></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">overlaps after( [3..8], [1..5] )= true
overlaps after( [6..8], [1..5] )= false
overlaps after( [5..8], [1..5] )= true
overlaps after( (5..8], [1..5] )= false
overlaps after( [5..8], [1..5) )= false
overlaps after( (1..5], [1..5) )= true
overlaps after( (1..5], [1..5] )= true
overlaps after( [1..5], [1..5) )= false
overlaps after( [1..5], [1..5] )= false
overlaps after( (1..5), [1..5] )= false
overlaps after( (1..5], [1..6] )= false
overlaps after( (1..5], (1..5] )= false
overlaps after( (1..5], [2..5] )= false</pre>
										</p></div></dd><dt><span class="term">finishes( )</span></dt><dd><p class="simpara">
										Returns <code class="literal">true</code> when an element <code class="literal">A</code> finishes an element <code class="literal">B</code> and when the relevant requirements for evaluating to <code class="literal">true</code> are also met.
									</p><div class="orderedlist"><p class="title"><strong>Signatures</strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">finishes( point, range )</code>
											</li><li class="listitem">
												<code class="literal">finishes( range1, range2 )</code>
											</li></ol></div><div class="orderedlist"><p class="title"><strong>Requirements for evaluating to <code class="literal">true</code></strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">range.end included and range.end = point</code>
											</li><li class="listitem">
												<code class="literal">range1.end included = range2.end included and range1.end = range2.end and ( range1.start &gt; range2.start or (range1.start = range2.start and (not(range1.start included) or range2.start included)) )</code>
											</li></ol></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">finishes( 10, [1..10] ) = true
finishes( 10, [1..10) ) = false
finishes( [5..10], [1..10] ) = true
finishes( [5..10), [1..10] ) = false
finishes( [5..10), [1..10) ) = true
finishes( [1..10], [1..10] ) = true
finishes( (1..10], [1..10] ) = true</pre>
										</p></div></dd><dt><span class="term">finished by( )</span></dt><dd><p class="simpara">
										Returns <code class="literal">true</code> when an element <code class="literal">A</code> is finished by an element <code class="literal">B</code> and when the relevant requirements for evaluating to <code class="literal">true</code> are also met.
									</p><div class="orderedlist"><p class="title"><strong>Signatures</strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">finished by( range, point )</code>
											</li><li class="listitem">
												<code class="literal">finished by( range1 range2 )</code>
											</li></ol></div><div class="orderedlist"><p class="title"><strong>Requirements for evaluating to <code class="literal">true</code></strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">range.end included and range.end = point</code>
											</li><li class="listitem">
												<code class="literal">range1.end included = range2.end included and range1.end = range2.end and ( range1.start &lt; range2.start or (range1.start = range2.start and (range1.start included or not(range2.start included))) )</code>
											</li></ol></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">finished by( [1..10], 10 ) = true
finished by( [1..10), 10 ) = false
finished by( [1..10], [5..10] ) = true
finished by( [1..10], [5..10) ) = false
finished by( [1..10), [5..10) ) = true
finished by( [1..10], [1..10] ) = true
finished by( [1..10], (1..10] ) = true</pre>
										</p></div></dd><dt><span class="term">includes( )</span></dt><dd><p class="simpara">
										Returns <code class="literal">true</code> when an element <code class="literal">A</code> includes an element <code class="literal">B</code> and when the relevant requirements for evaluating to <code class="literal">true</code> are also met.
									</p><div class="orderedlist"><p class="title"><strong>Signatures</strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">includes( range, point )</code>
											</li><li class="listitem">
												<code class="literal">includes( range1, range2 )</code>
											</li></ol></div><div class="orderedlist"><p class="title"><strong>Requirements for evaluating to <code class="literal">true</code></strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">(range.start &lt; point and range.end &gt; point) or (range.start = point and range.start included) or (range.end = point and range.end included)</code>
											</li><li class="listitem">
												<code class="literal">( range1.start &lt; range2.start or (range1.start = range2.start and (range1.start included or not(range2.start included))) ) and ( range1.end &gt; range2.end or (range1.end = range2.end and (range1.end included or not(range2.end included))) )</code>
											</li></ol></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">includes( [1..10], 5 ) = true
includes( [1..10], 12 ) = false
includes( [1..10], 1 ) = true
includes( [1..10], 10 ) = true
includes( (1..10], 1 ) = false
includes( [1..10), 10 ) = false
includes( [1..10], [4..6] ) = true
includes( [1..10], [1..5] ) = true
includes( (1..10], (1..5] ) = true
includes( [1..10], (1..10) ) = true
includes( [1..10), [5..10) ) = true
includes( [1..10], [1..10) ) = true
includes( [1..10], (1..10] ) = true
includes( [1..10], [1..10] ) = true</pre>
										</p></div></dd><dt><span class="term">during( )</span></dt><dd><p class="simpara">
										Returns <code class="literal">true</code> when an element <code class="literal">A</code> is during an element <code class="literal">B</code> and when the relevant requirements for evaluating to <code class="literal">true</code> are also met.
									</p><div class="orderedlist"><p class="title"><strong>Signatures</strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">during( point, range )</code>
											</li><li class="listitem">
												<code class="literal">during( range1 range2 )</code>
											</li></ol></div><div class="orderedlist"><p class="title"><strong>Requirements for evaluating to <code class="literal">true</code></strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">(range.start &lt; point and range.end &gt; point) or (range.start = point and range.start included) or (range.end = point and range.end included)</code>
											</li><li class="listitem">
												<code class="literal">( range2.start &lt; range1.start or (range2.start = range1.start and (range2.start included or not(range1.start included))) ) and ( range2.end &gt; range1.end or (range2.end = range1.end and (range2.end included or not(range1.end included))) )</code>
											</li></ol></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">during( 5, [1..10] ) = true
during( 12, [1..10] ) = false
during( 1, [1..10] ) = true
during( 10, [1..10] ) = true
during( 1, (1..10] ) = false
during( 10, [1..10) ) = false
during( [4..6], [1..10] ) = true
during( [1..5], [1..10] ) = true
during( (1..5], (1..10] ) = true
during( (1..10), [1..10] ) = true
during( [5..10), [1..10) ) = true
during( [1..10), [1..10] ) = true
during( (1..10], [1..10] ) = true
during( [1..10], [1..10] ) = true</pre>
										</p></div></dd><dt><span class="term">starts( )</span></dt><dd><p class="simpara">
										Returns <code class="literal">true</code> when an element <code class="literal">A</code> starts an element <code class="literal">B</code> and when the relevant requirements for evaluating to <code class="literal">true</code> are also met.
									</p><div class="orderedlist"><p class="title"><strong>Signatures</strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">starts( point, range )</code>
											</li><li class="listitem">
												<code class="literal">starts( range1, range2 )</code>
											</li></ol></div><div class="orderedlist"><p class="title"><strong>Requirements for evaluating to <code class="literal">true</code></strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">range.start = point and range.start included</code>
											</li><li class="listitem">
												<code class="literal">range1.start = range2.start and range1.start included = range2.start included and ( range1.end &lt; range2.end or (range1.end = range2.end and (not(range1.end included) or range2.end included)) )</code>
											</li></ol></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">starts( 1, [1..10] ) = true
starts( 1, (1..10] ) = false
starts( 2, [1..10] ) = false
starts( [1..5], [1..10] ) = true
starts( (1..5], (1..10] ) = true
starts( (1..5], [1..10] ) = false
starts( [1..5], (1..10] ) = false
starts( [1..10], [1..10] ) = true
starts( [1..10), [1..10] ) = true
starts( (1..10), (1..10) ) = true</pre>
										</p></div></dd><dt><span class="term">started by( )</span></dt><dd><p class="simpara">
										Returns <code class="literal">true</code> when an element <code class="literal">A</code> is started by an element <code class="literal">B</code> and when the relevant requirements for evaluating to <code class="literal">true</code> are also met.
									</p><div class="orderedlist"><p class="title"><strong>Signatures</strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">started by( range, point )</code>
											</li><li class="listitem">
												<code class="literal">started by( range1, range2 )</code>
											</li></ol></div><div class="orderedlist"><p class="title"><strong>Requirements for evaluating to <code class="literal">true</code></strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">range.start = point and range.start included</code>
											</li><li class="listitem">
												<code class="literal">range1.start = range2.start and range1.start included = range2.start included and ( range2.end &lt; range1.end or (range2.end = range1.end and (not(range2.end included) or range1.end included)) )</code>
											</li></ol></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">started by( [1..10], 1 ) = true
started by( (1..10], 1 ) = false
started by( [1..10], 2 ) = false
started by( [1..10], [1..5] ) = true
started by( (1..10], (1..5] ) = true
started by( [1..10], (1..5] ) = false
started by( (1..10], [1..5] ) = false
started by( [1..10], [1..10] ) = true
started by( [1..10], [1..10) ) = true
started by( (1..10), (1..10) ) = true</pre>
										</p></div></dd><dt><span class="term">coincides( )</span></dt><dd><p class="simpara">
										Returns <code class="literal">true</code> when an element <code class="literal">A</code> coincides with an element <code class="literal">B</code> and when the relevant requirements for evaluating to <code class="literal">true</code> are also met.
									</p><div class="orderedlist"><p class="title"><strong>Signatures</strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">coincides( point1, point2 )</code>
											</li><li class="listitem">
												<code class="literal">coincides( range1, range2 )</code>
											</li></ol></div><div class="orderedlist"><p class="title"><strong>Requirements for evaluating to <code class="literal">true</code></strong></p><ol class="orderedlist" type="a"><li class="listitem">
												<code class="literal">point1 = point2</code>
											</li><li class="listitem">
												<code class="literal">range1.start = range2.start and range1.start included = range2.start included and range1.end = range2.end and range1.end included = range2.end included</code>
											</li></ol></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">coincides( 5, 5 ) = true
coincides( 3, 4 ) = false
coincides( [1..5], [1..5] ) = true
coincides( (1..5), [1..5] ) = false
coincides( [1..5], [2..6] ) = false</pre>
										</p></div></dd></dl></div></section><section class="section" id="temporal_functions"><div class="titlepage"><div><div><h4 class="title">3.3.2.8. Temporal functions</h4></div></div></div><p>
							The following functions support general temporal operations.
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">day of year( date )</span></dt><dd><p class="simpara">
										Returns the Gregorian number of the day of the year.
									</p><div class="table" id="idm139921850481424"><p class="title"><strong>Table 3.61. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921846502928" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921846501840" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921846502928">
													<p>
														<code class="literal">date</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921846501840">
													<p>
														<code class="literal">date</code> or <code class="literal">date and time</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">day of year( date(2019, 9, 17) ) = 260</pre>
										</p></div></dd><dt><span class="term">day of week( date )</span></dt><dd><p class="simpara">
										Returns the Gregorian day of the week: <code class="literal">"Monday"</code>, <code class="literal">"Tuesday"</code>, <code class="literal">"Wednesday"</code>, <code class="literal">"Thursday"</code>, <code class="literal">"Friday"</code>, <code class="literal">"Saturday"</code>, or <code class="literal">"Sunday"</code>.
									</p><div class="table" id="idm139921843201200"><p class="title"><strong>Table 3.62. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921843091216" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921843090128" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921843091216">
													<p>
														<code class="literal">date</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921843090128">
													<p>
														<code class="literal">date</code> or <code class="literal">date and time</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">day of week( date(2019, 9, 17) ) = "Tuesday"</pre>
										</p></div></dd><dt><span class="term">month of year( date )</span></dt><dd><p class="simpara">
										Returns the Gregorian month of the year: <code class="literal">"January"</code>, <code class="literal">"February"</code>, <code class="literal">"March"</code>, <code class="literal">"April"</code>, <code class="literal">"May"</code>, <code class="literal">"June"</code>, <code class="literal">"July"</code>, <code class="literal">"August"</code>, <code class="literal">"September"</code>, <code class="literal">"October"</code>, <code class="literal">"November"</code>, or <code class="literal">"December"</code>.
									</p><div class="table" id="idm139921840875568"><p class="title"><strong>Table 3.63. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921829839872" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921829838784" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921829839872">
													<p>
														<code class="literal">date</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921829838784">
													<p>
														<code class="literal">date</code> or <code class="literal">date and time</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">month of year( date(2019, 9, 17) ) = "September"</pre>
										</p></div></dd><dt><span class="term">month of year( date )</span></dt><dd><p class="simpara">
										Returns the Gregorian week of the year as defined by ISO 8601.
									</p><div class="table" id="idm139921831010128"><p class="title"><strong>Table 3.64. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921831005296" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921831004208" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921831005296">
													<p>
														<code class="literal">date</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921831004208">
													<p>
														<code class="literal">date</code> or <code class="literal">date and time</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">week of year( date(2019, 9, 17) ) = 38
week of year( date(2003, 12, 29) ) = 1
week of year( date(2004, 1, 4) ) = 1
week of year( date(2005, 1, 1) ) = 53
week of year( date(2005, 1, 3) ) = 1
week of year( date(2005, 1, 9) ) = 1</pre>
										</p></div></dd></dl></div></section><section class="section" id="sort_functions"><div class="titlepage"><div><div><h4 class="title">3.3.2.9. Sort functions</h4></div></div></div><p>
							The following functions support sorting operations.
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">sort( list, precedes )</span></dt><dd><p class="simpara">
										Returns a list of the same elements but ordered according to the sorting function.
									</p><div class="table" id="idm139921843016912"><p class="title"><strong>Table 3.65. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921843012080" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921843010992" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921843012080">
													<p>
														<code class="literal">list</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921843010992">
													<p>
														<code class="literal">list</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921843012080">
													<p>
														<code class="literal">precedes</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921843010992">
													<p>
														<code class="literal">function</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">sort( list: [3,1,4,5,2], precedes: function(x,y) x &lt; y ) = [1,2,3,4,5]</pre>
										</p></div></dd></dl></div></section><section class="section" id="context_functions"><div class="titlepage"><div><div><h4 class="title">3.3.2.10. Context functions</h4></div></div></div><p>
							The following functions support context operations.
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">get value( m, key )</span></dt><dd><p class="simpara">
										Returns the value from the context for the specified entry key.
									</p><div class="table" id="idm139921852067696"><p class="title"><strong>Table 3.66. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921828197504" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921828196416" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921828197504">
													<p>
														<code class="literal">m</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921828196416">
													<p>
														<code class="literal">context</code>
													</p>
													</td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139921828197504">
													<p>
														<code class="literal">key</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921828196416">
													<p>
														<code class="literal">string</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
											
<pre class="programlisting language-feel">get value( {key1 : "value1"}, "key1" ) = "value1"
get value( {key1 : "value1"}, "unexistent-key" ) = null</pre>
										</p></div></dd><dt><span class="term">get entries( m )</span></dt><dd><p class="simpara">
										Returns a list of key-value pairs for the specified context.
									</p><div class="table" id="idm139921841870976"><p class="title"><strong>Table 3.67. Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139921841866144" scope="col">Parameter</th><th style="text-align: left; vertical-align: top; " id="idm139921841865056" scope="col">Type</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139921841866144">
													<p>
														<code class="literal">m</code>
													</p>
													</td><td style="text-align: left; vertical-align: top; " headers="idm139921841865056">
													<p>
														<code class="literal">context</code>
													</p>
													</td></tr></tbody></table></div></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
											
<pre class="programlisting language-feel">get entries( {key1 : "value1", key2 : "value2"} ) = [ { key : "key1", value : "value1" }, {key : "key2", value : "value2"} ]</pre>
										</p></div></dd></dl></div></section></section><section class="section" id="dmn-feel-variable-function-names-ref_dmn-models"><div class="titlepage"><div><div><h3 class="title">3.3.3. Variable and function names in FEEL</h3></div></div></div><p>
						Unlike many traditional expression languages, Friendly Enough Expression Language (FEEL) supports spaces and a few special characters as part of variable and function names. A FEEL name must start with a <code class="literal">letter</code>, <code class="literal">?</code>, or <code class="literal">_</code> element. The unicode letter characters are also allowed. Variable names cannot start with a language keyword, such as <code class="literal">and</code>, <code class="literal">true</code>, or <code class="literal">every</code>. The remaining characters in a variable name can be any of the starting characters, as well as <code class="literal">digits</code>, white spaces, and special characters such as <code class="literal">+</code>, <code class="literal">-</code>, <code class="literal">/</code>, <code class="literal">*</code>, <code class="literal">'</code>, and <code class="literal">.</code>.
					</p><p>
						For example, the following names are all valid FEEL names:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Age
							</li><li class="listitem">
								Birth Date
							</li><li class="listitem">
								Flight 234 pre-check procedure
							</li></ul></div><p>
						Several limitations apply to variable and function names in FEEL:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Ambiguity</span></dt><dd>
									The use of spaces, keywords, and other special characters as part of names can make FEEL ambiguous. The ambiguities are resolved in the context of the expression, matching names from left to right. The parser resolves the variable name as the longest name matched in scope. You can use <code class="literal">( )</code> to disambiguate names if necessary.
								</dd><dt><span class="term">Spaces in names</span></dt><dd><p class="simpara">
									The DMN specification limits the use of spaces in FEEL names. According to the DMN specification, names can contain multiple spaces but not two consecutive spaces.
								</p><p class="simpara">
									In order to make the language easier to use and avoid common errors due to spaces, Red Hat Process Automation Manager removes the limitation on the use of consecutive spaces. Red Hat Process Automation Manager supports variable names with any number of consecutive spaces, but normalizes them into a single space. For example, the variable references <code class="literal">First Name</code> with one space and <code class="literal">First Name</code> with two spaces are both acceptable in Red Hat Process Automation Manager.
								</p><p class="simpara">
									Red Hat Process Automation Manager also normalizes the use of other white spaces, like the non-breakable white space that is common in web pages, tabs, and line breaks. From a Red Hat Process Automation Manager FEEL engine perspective, all of these characters are normalized into a single white space before processing.
								</p></dd><dt><span class="term">The keyword <code class="literal">in</code></span></dt><dd>
									The keyword <code class="literal">in</code> is the only keyword in the language that cannot be used as part of a variable name. Although the specifications allow the use of keywords in the middle of variable names, the use of <code class="literal">in</code> in variable names conflicts with the grammar definition of <code class="literal">for</code>, <code class="literal">every</code> and <code class="literal">some</code> expression constructs.
								</dd></dl></div></section></section><section class="section" id="dmn-boxed-expressions-con_dmn-models"><div class="titlepage"><div><div><h2 class="title">3.4. DMN decision logic in boxed expressions</h2></div></div></div><p>
					Boxed expressions in DMN are tables that you use to define the underlying logic of decision nodes and business knowledge models in a decision requirements diagram (DRD). Some boxed expressions can contain other boxed expressions, but the top-level boxed expression corresponds to the decision logic of a single DRD artifact. While DRDs represent the flow of a DMN decision model, boxed expressions define the actual decision logic of individual nodes. DRDs and boxed expressions together form a complete and functional DMN decision model.
				</p><p>
					The following are the types of DMN boxed expressions:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Decision tables
						</li><li class="listitem">
							Literal expressions
						</li><li class="listitem">
							Contexts
						</li><li class="listitem">
							Relations
						</li><li class="listitem">
							Functions
						</li><li class="listitem">
							Invocations
						</li><li class="listitem">
							Lists
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Red Hat Process Automation Manager does not provide boxed list expressions in Business Central, but supports a FEEL <code class="literal">list</code> data type that you can use in boxed literal expressions. For more information about the <code class="literal">list</code> data type and other FEEL data types in Red Hat Process Automation Manager, see <a class="xref" href="#dmn-feel-data-types-ref_dmn-models" title="3.3.1. Data types in FEEL">Section 3.3.1, “Data types in FEEL”</a>.
					</p></div></div><p>
					All Friendly Enough Expression Language (FEEL) expressions that you use in your boxed expressions must conform to the FEEL syntax requirements in the OMG <a class="link" href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.
				</p><section class="section" id="dmn-decision-tables-con_dmn-models"><div class="titlepage"><div><div><h3 class="title">3.4.1. DMN decision tables</h3></div></div></div><p>
						A decision table in DMN is a visual representation of one or more business rules in a tabular format. You use decision tables to define rules for a decision node that applies those rules at a given point in the decision model. Each rule consists of a single row in the table, and includes columns that define the conditions (input) and outcome (output) for that particular row. The definition of each row is precise enough to derive the outcome using the values of the conditions. Input and output values can be FEEL expressions or defined data type values.
					</p><p>
						For example, the following decision table determines credit score ratings based on a defined range of a loan applicant’s credit score:
					</p><div class="figure" id="idm139921839158144"><p class="title"><strong>Figure 3.3. Decision table for credit score rating</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-decision-table-example.png" alt="dmn decision table example"/></div></div></div><p>
						The following decision table determines the next step in a lending strategy for applicants depending on applicant loan eligibility and the bureau call type:
					</p><div class="figure" id="idm139921832229776"><p class="title"><strong>Figure 3.4. Decision table for lending strategy</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-decision-table-example2.png" alt="dmn decision table example2"/></div></div></div><p>
						The following decision table determines applicant qualification for a loan as the concluding decision node in a loan prequalification decision model:
					</p><div class="figure" id="idm139921835527792"><p class="title"><strong>Figure 3.5. Decision table for loan prequalification</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-decision-table-example3.png" alt="dmn decision table example3"/></div></div></div><p>
						Decision tables are a popular way of modeling rules and decision logic, and are used in many methodologies (such as DMN) and implementation frameworks (such as Drools).
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							Red Hat Process Automation Manager supports both DMN decision tables and Drools-native decision tables, but they are different types of assets with different syntax requirements and are not interchangeable. For more information about Drools-native decision tables in Red Hat Process Automation Manager, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-decision-tables"><span class="emphasis"><em>Designing a decision service using spreadsheet decision tables</em></span></a>.
						</p></div></div><section class="section" id="dmn-decision-tables-hit-policies-con_dmn-models"><div class="titlepage"><div><div><h4 class="title">3.4.1.1. Hit policies in DMN decision tables</h4></div></div></div><p>
							Hit policies determine how to reach an outcome when multiple rules in a decision table match the provided input values. For example, if one rule in a decision table applies a sales discount to military personnel and another rule applies a discount to students, then when a customer is both a student and in the military, the decision table hit policy must indicate whether to apply one discount or the other (<span class="strong strong"><strong>Unique</strong></span>, <span class="strong strong"><strong>First</strong></span>) or both discounts (<span class="strong strong"><strong>Collect Sum</strong></span>). You specify the single character of the hit policy (<span class="strong strong"><strong>U</strong></span>, <span class="strong strong"><strong>F</strong></span>, <span class="strong strong"><strong>C+</strong></span>) in the upper-left corner of the decision table.
						</p><p>
							The following decision table hit policies are supported in DMN:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="strong strong"><strong>Unique (U):</strong></span> Permits only one rule to match. Any overlap raises an error.
								</li><li class="listitem">
									<span class="strong strong"><strong>Any (A):</strong></span> Permits multiple rules to match, but they must all have the same output. If multiple matching rules do not have the same output, an error is raised.
								</li><li class="listitem">
									<span class="strong strong"><strong>Priority (P):</strong></span> Permits multiple rules to match, with different outputs. The output that comes first in the output values list is selected.
								</li><li class="listitem">
									<span class="strong strong"><strong>First (F):</strong></span> Uses the first match in rule order.
								</li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>Collect (C+, C&gt;, C&lt;, C#):</strong></span> Aggregates output from multiple rules based on an aggregation function.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<span class="strong strong"><strong>Collect ( C ):</strong></span> Aggregates values in an arbitrary list.
										</li><li class="listitem">
											<span class="strong strong"><strong>Collect Sum (C+):</strong></span> Outputs the sum of all collected values. Values must be numeric.
										</li><li class="listitem">
											<span class="strong strong"><strong>Collect Min (C&lt;):</strong></span> Outputs the minimum value among the matches. The resulting values must be comparable, such as numbers, dates, or text (lexicographic order).
										</li><li class="listitem">
											<span class="strong strong"><strong>Collect Max (C&gt;):</strong></span> Outputs the maximum value among the matches. The resulting values must be comparable, such as numbers, dates or text (lexicographic order).
										</li><li class="listitem">
											<span class="strong strong"><strong>Collect Count (C#):</strong></span> Outputs the number of matching rules.
										</li></ul></div></li></ul></div></section></section><section class="section" id="dmn-literal-expressions-con_dmn-models"><div class="titlepage"><div><div><h3 class="title">3.4.2. Boxed literal expressions</h3></div></div></div><p>
						A boxed literal expression in DMN is a literal FEEL expression as text in a table cell, typically with a labeled column and an assigned data type. You use boxed literal expressions to define simple or complex node logic or decision data directly in FEEL for a particular node in a decision. Literal FEEL expressions must conform to FEEL syntax requirements in the OMG <a class="link" href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.
					</p><p>
						For example, the following boxed literal expression defines the minimum acceptable PITI calculation (principal, interest, taxes, and insurance) in a lending decision, where <code class="literal">acceptable rate</code> is a variable defined in the DMN model:
					</p><div class="figure" id="idm139921832285888"><p class="title"><strong>Figure 3.6. Boxed literal expression for minimum PITI value</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-literal-expression-example2.png" alt="dmn literal expression example2"/></div></div></div><p>
						The following boxed literal expression sorts a list of possible dating candidates (soul mates) in an online dating application based on their score on criteria such as age, location, and interests:
					</p><div class="figure" id="idm139921839056512"><p class="title"><strong>Figure 3.7. Boxed literal expression for matching online dating candidates</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-literal-expression-example3b.png" alt="dmn literal expression example3b"/></div></div></div></section><section class="section" id="dmn-context-expressions-con_dmn-models"><div class="titlepage"><div><div><h3 class="title">3.4.3. Boxed context expressions</h3></div></div></div><p>
						A boxed context expression in DMN is a set of variable names and values with a result value. Each name-value pair is a context entry. You use context expressions to represent data definitions in decision logic and set a value for a desired decision element within the DMN decision model. A value in a boxed context expression can be a data type value or FEEL expression, or can contain a nested sub-expression of any type, such as a decision table, a literal expression, or another context expression.
					</p><p>
						For example, the following boxed context expression defines the factors for sorting delayed passengers in a flight-rebooking decision model, based on defined data types (<code class="literal">tPassengerTable</code>, <code class="literal">tFlightNumberList</code>):
					</p><div class="figure" id="idm139921828564384"><p class="title"><strong>Figure 3.8. Boxed context expression for flight passenger waiting list</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-context-expression-example.png" alt="dmn context expression example"/></div></div></div><p>
						The following boxed context expression defines the factors that determine whether a loan applicant can meet minimum mortgage payments based on principal, interest, taxes, and insurance (PITI), represented as a front-end ratio calculation with a sub-context expression:
					</p><div class="figure" id="idm139921857244640"><p class="title"><strong>Figure 3.9. Boxed context expression for front-end client PITI ratio</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-context-expression-example2.png" alt="dmn context expression example2"/></div></div></div></section><section class="section" id="dmn-relation-expressions-con_dmn-models"><div class="titlepage"><div><div><h3 class="title">3.4.4. Boxed relation expressions</h3></div></div></div><p>
						A boxed relation expression in DMN is a traditional data table with information about given entities, listed as rows. You use boxed relation tables to define decision data for relevant entities in a decision at a particular node. Boxed relation expressions are similar to context expressions in that they set variable names and values, but relation expressions contain no result value and list all variable values based on a single defined variable in each column.
					</p><p>
						For example, the following boxed relation expression provides information about employees in an employee rostering decision:
					</p><div class="figure" id="idm139921854700064"><p class="title"><strong>Figure 3.10. Boxed relation expression with employee information</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-relation-expression-example.png" alt="dmn relation expression example"/></div></div></div></section><section class="section" id="dmn-function-expressions-con_dmn-models"><div class="titlepage"><div><div><h3 class="title">3.4.5. Boxed function expressions</h3></div></div></div><p>
						A boxed function expression in DMN is a parameterized boxed expression containing a literal FEEL expression, a nested context expression of an external JAVA or PMML function, or a nested boxed expression of any type. By default, all business knowledge models are defined as boxed function expressions. You use boxed function expressions to call functions on your decision logic and to define all business knowledge models.
					</p><p>
						For example, the following boxed function expression determines airline flight capacity in a flight-rebooking decision model:
					</p><div class="figure" id="idm139921851559360"><p class="title"><strong>Figure 3.11. Boxed function expression for flight capacity</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-function-expression-example.png" alt="dmn function expression example"/></div></div></div><p>
						The following boxed function expression contains a basic Java function as a context expression for determining absolute value in a decision model calculation:
					</p><div class="figure" id="idm139921851554832"><p class="title"><strong>Figure 3.12. Boxed function expression for absolute value</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-function-expression-example2.png" alt="dmn function expression example2"/></div></div></div><p>
						The following boxed function expression determines a monthly mortgage installment as a business knowledge model in a lending decision, with the function value defined as a nested context expression:
					</p><div class="figure" id="idm139921837915680"><p class="title"><strong>Figure 3.13. Boxed function expression for installment calculation in business knowledge model</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-function-expression-example3.png" alt="dmn function expression example3"/></div></div></div><p>
						The following boxed function expression uses a PMML model included in the DMN file to define the minimum acceptable PITI calculation (principal, interest, taxes, and insurance) in a lending decision:
					</p><div class="figure" id="idm139921854843008"><p class="title"><strong>Figure 3.14. Boxed function expression with an included PMML model in business knowledge model</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-function-expression-example5.png" alt="dmn function expression example5"/></div></div></div></section><section class="section" id="dmn-invocation-expressions-con_dmn-models"><div class="titlepage"><div><div><h3 class="title">3.4.6. Boxed invocation expressions</h3></div></div></div><p>
						A boxed invocation expression in DMN is a boxed expression that invokes a business knowledge model. A boxed invocation expression contains the name of the business knowledge model to be invoked and a list of parameter bindings. Each binding is represented by two boxed expressions on a row: The box on the left contains the name of a parameter and the box on the right contains the binding expression whose value is assigned to the parameter to evaluate the invoked business knowledge model. You use boxed invocations to invoke at a particular decision node a business knowledge model defined in the decision model.
					</p><p>
						For example, the following boxed invocation expression invokes a <code class="literal">Reassign Next Passenger</code> business knowledge model as the concluding decision node in a flight-rebooking decision model:
					</p><div class="figure" id="idm139921834199712"><p class="title"><strong>Figure 3.15. Boxed invocation expression to reassign flight passengers</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-invocation-example.png" alt="dmn invocation example"/></div></div></div><p>
						The following boxed invocation expression invokes an <code class="literal">InstallmentCalculation</code> business knowledge model to calculate a monthly installment amount for a loan before proceeding to affordability decisions:
					</p><div class="figure" id="idm139921837960240"><p class="title"><strong>Figure 3.16. Boxed invocation expression for required monthly installment</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-invocation-example2.png" alt="dmn invocation example2"/></div></div></div></section><section class="section" id="dmn-list-expressions-con_dmn-models"><div class="titlepage"><div><div><h3 class="title">3.4.7. Boxed list expressions</h3></div></div></div><p>
						A boxed list expression in DMN represents a FEEL list of items. You use boxed lists to define lists of relevant items for a particular node in a decision. You can also use literal FEEL expressions for list items in cells to create more complex lists.
					</p><p>
						For example, the following boxed list expression identifies approved credit score agencies in a loan application decision service:
					</p><div class="figure" id="idm139921850696096"><p class="title"><strong>Figure 3.17. Boxed list expression for approved credit score agencies</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-list-expression-example.png" alt="dmn list expression example"/></div></div></div><p>
						The following boxed list expression also identifies approved credit score agencies but uses FEEL logic to define the agency status (Inc., LLC, SA, GA) based on a DMN input node:
					</p><div class="figure" id="idm139921850691584"><p class="title"><strong>Figure 3.18. Boxed list expression using FEEL logic for approved credit score agency status</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-list-expression-example2.png" alt="dmn list expression example2"/></div></div></div><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-list-expression-example2a.png" alt="dmn list expression example2a"/></div></div></section></section><section class="section" id="dmn-model-example-ref_dmn-models"><div class="titlepage"><div><div><h2 class="title">3.5. DMN model example</h2></div></div></div><p>
					The following is a real-world DMN model example that demonstrates how you can use decision modeling to reach a decision based on input data, circumstances, and company guidelines. In this scenario, a flight from San Diego to New York is canceled, requiring the affected airline to find alternate arrangements for its inconvenienced passengers.
				</p><p>
					First, the airline collects the information necessary to determine how best to get the travelers to their destinations:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Input data</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										List of flights
									</li><li class="listitem">
										List of passengers
									</li></ul></div></dd><dt><span class="term">Decisions</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Prioritize the passengers who will get seats on a new flight
									</li><li class="listitem">
										Determine which flights those passengers will be offered
									</li></ul></div></dd><dt><span class="term">Business knowledge models</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										The company process for determining passenger priority
									</li><li class="listitem">
										Any flights that have space available
									</li><li class="listitem">
										Company rules for determining how best to reassign inconvenienced passengers
									</li></ul></div></dd></dl></div><p>
					The airline then uses the DMN standard to model its decision process in the following decision requirements diagram (DRD) for determining the best rebooking solution:
				</p><div class="figure" id="idm139921831724704"><p class="title"><strong>Figure 3.19. DRD for flight rebooking</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-passenger-rebooking-drd.png" alt="dmn passenger rebooking drd"/></div></div></div><p>
					Similar to flowcharts, DRDs use shapes to represent the different elements in a process. Ovals contain the two necessary input data, rectangles contain the decision points in the model, and rectangles with clipped corners (business knowledge models) contain reusable logic that can be repeatedly invoked.
				</p><p>
					The DRD draws logic for each element from boxed expressions that provide variable definitions using FEEL expressions or data type values.
				</p><p>
					Some boxed expressions are basic, such as the following decision for establishing a prioritized waiting list:
				</p><div class="figure" id="idm139921839344944"><p class="title"><strong>Figure 3.20. Boxed context expression example for prioritized wait list</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-context-expression-example.png" alt="dmn context expression example"/></div></div></div><p>
					Some boxed expressions are more complex with greater detail and calculation, such as the following business knowledge model for reassigning the next delayed passenger:
				</p><div class="figure" id="idm139921839340400"><p class="title"><strong>Figure 3.21. Boxed function expression for passenger reassignment</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-reassign-passenger.png" alt="dmn reassign passenger"/></div></div></div><p>
					The following is the DMN source file for this decision model:
				</p><pre class="programlisting language-xml">&lt;dmn:definitions xmlns="https://www.drools.org/kie-dmn/Flight-rebooking" xmlns:dmn="http://www.omg.org/spec/DMN/20151101/dmn.xsd" xmlns:feel="http://www.omg.org/spec/FEEL/20140401" id="_0019_flight_rebooking" name="0019-flight-rebooking" namespace="https://www.drools.org/kie-dmn/Flight-rebooking"&gt;
  &lt;dmn:itemDefinition id="_tFlight" name="tFlight"&gt;
    &lt;dmn:itemComponent id="_tFlight_Flight" name="Flight Number"&gt;
      &lt;dmn:typeRef&gt;feel:string&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tFlight_From" name="From"&gt;
      &lt;dmn:typeRef&gt;feel:string&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tFlight_To" name="To"&gt;
      &lt;dmn:typeRef&gt;feel:string&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tFlight_Dep" name="Departure"&gt;
      &lt;dmn:typeRef&gt;feel:dateTime&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tFlight_Arr" name="Arrival"&gt;
      &lt;dmn:typeRef&gt;feel:dateTime&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tFlight_Capacity" name="Capacity"&gt;
      &lt;dmn:typeRef&gt;feel:number&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tFlight_Status" name="Status"&gt;
      &lt;dmn:typeRef&gt;feel:string&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
  &lt;/dmn:itemDefinition&gt;
  &lt;dmn:itemDefinition id="_tFlightTable" isCollection="true" name="tFlightTable"&gt;
    &lt;dmn:typeRef&gt;tFlight&lt;/dmn:typeRef&gt;
  &lt;/dmn:itemDefinition&gt;
  &lt;dmn:itemDefinition id="_tPassenger" name="tPassenger"&gt;
    &lt;dmn:itemComponent id="_tPassenger_Name" name="Name"&gt;
      &lt;dmn:typeRef&gt;feel:string&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tPassenger_Status" name="Status"&gt;
      &lt;dmn:typeRef&gt;feel:string&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tPassenger_Miles" name="Miles"&gt;
      &lt;dmn:typeRef&gt;feel:number&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tPassenger_Flight" name="Flight Number"&gt;
      &lt;dmn:typeRef&gt;feel:string&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
  &lt;/dmn:itemDefinition&gt;
  &lt;dmn:itemDefinition id="_tPassengerTable" isCollection="true" name="tPassengerTable"&gt;
    &lt;dmn:typeRef&gt;tPassenger&lt;/dmn:typeRef&gt;
  &lt;/dmn:itemDefinition&gt;
  &lt;dmn:itemDefinition id="_tFlightNumberList" isCollection="true" name="tFlightNumberList"&gt;
    &lt;dmn:typeRef&gt;feel:string&lt;/dmn:typeRef&gt;
  &lt;/dmn:itemDefinition&gt;
  &lt;dmn:inputData id="i_Flight_List" name="Flight List"&gt;
    &lt;dmn:variable name="Flight List" typeRef="tFlightTable"/&gt;
  &lt;/dmn:inputData&gt;
  &lt;dmn:inputData id="i_Passenger_List" name="Passenger List"&gt;
    &lt;dmn:variable name="Passenger List" typeRef="tPassengerTable"/&gt;
  &lt;/dmn:inputData&gt;
  &lt;dmn:decision name="Prioritized Waiting List" id="d_PrioritizedWaitingList"&gt;
    &lt;dmn:variable name="Prioritized Waiting List" typeRef="tPassengerTable"/&gt;
    &lt;dmn:informationRequirement&gt;
      &lt;dmn:requiredInput href="#i_Passenger_List"/&gt;
    &lt;/dmn:informationRequirement&gt;
    &lt;dmn:informationRequirement&gt;
      &lt;dmn:requiredInput href="#i_Flight_List"/&gt;
    &lt;/dmn:informationRequirement&gt;
    &lt;dmn:knowledgeRequirement&gt;
      &lt;dmn:requiredKnowledge href="#b_PassengerPriority"/&gt;
    &lt;/dmn:knowledgeRequirement&gt;
    &lt;dmn:context&gt;
      &lt;dmn:contextEntry&gt;
        &lt;dmn:variable name="Cancelled Flights" typeRef="tFlightNumberList"/&gt;
        &lt;dmn:literalExpression&gt;
          &lt;dmn:text&gt;Flight List[ Status = "cancelled" ].Flight Number&lt;/dmn:text&gt;
        &lt;/dmn:literalExpression&gt;
      &lt;/dmn:contextEntry&gt;
      &lt;dmn:contextEntry&gt;
        &lt;dmn:variable name="Waiting List" typeRef="tPassengerTable"/&gt;
        &lt;dmn:literalExpression&gt;
          &lt;dmn:text&gt;Passenger List[ list contains( Cancelled Flights, Flight Number ) ]&lt;/dmn:text&gt;
        &lt;/dmn:literalExpression&gt;
      &lt;/dmn:contextEntry&gt;
      &lt;dmn:contextEntry&gt;
        &lt;dmn:literalExpression&gt;
          &lt;dmn:text&gt;sort( Waiting List, passenger priority )&lt;/dmn:text&gt;
        &lt;/dmn:literalExpression&gt;
      &lt;/dmn:contextEntry&gt;
    &lt;/dmn:context&gt;
  &lt;/dmn:decision&gt;
  &lt;dmn:decision name="Rebooked Passengers" id="d_RebookedPassengers"&gt;
    &lt;dmn:variable name="Rebooked Passengers" typeRef="tPassengerTable"/&gt;
    &lt;dmn:informationRequirement&gt;
      &lt;dmn:requiredDecision href="#d_PrioritizedWaitingList"/&gt;
    &lt;/dmn:informationRequirement&gt;
    &lt;dmn:informationRequirement&gt;
      &lt;dmn:requiredInput href="#i_Flight_List"/&gt;
    &lt;/dmn:informationRequirement&gt;
    &lt;dmn:knowledgeRequirement&gt;
      &lt;dmn:requiredKnowledge href="#b_ReassignNextPassenger"/&gt;
    &lt;/dmn:knowledgeRequirement&gt;
    &lt;dmn:invocation&gt;
      &lt;dmn:literalExpression&gt;
        &lt;dmn:text&gt;reassign next passenger&lt;/dmn:text&gt;
      &lt;/dmn:literalExpression&gt;
      &lt;dmn:binding&gt;
        &lt;dmn:parameter name="Waiting List"/&gt;
        &lt;dmn:literalExpression&gt;
          &lt;dmn:text&gt;Prioritized Waiting List&lt;/dmn:text&gt;
        &lt;/dmn:literalExpression&gt;
      &lt;/dmn:binding&gt;
      &lt;dmn:binding&gt;
        &lt;dmn:parameter name="Reassigned Passengers List"/&gt;
        &lt;dmn:literalExpression&gt;
          &lt;dmn:text&gt;[]&lt;/dmn:text&gt;
        &lt;/dmn:literalExpression&gt;
      &lt;/dmn:binding&gt;
      &lt;dmn:binding&gt;
        &lt;dmn:parameter name="Flights"/&gt;
        &lt;dmn:literalExpression&gt;
          &lt;dmn:text&gt;Flight List&lt;/dmn:text&gt;
        &lt;/dmn:literalExpression&gt;
      &lt;/dmn:binding&gt;
    &lt;/dmn:invocation&gt;
  &lt;/dmn:decision&gt;
  &lt;dmn:businessKnowledgeModel id="b_PassengerPriority" name="passenger priority"&gt;
    &lt;dmn:encapsulatedLogic&gt;
      &lt;dmn:formalParameter name="Passenger1" typeRef="tPassenger"/&gt;
      &lt;dmn:formalParameter name="Passenger2" typeRef="tPassenger"/&gt;
      &lt;dmn:decisionTable hitPolicy="UNIQUE"&gt;
        &lt;dmn:input id="b_Passenger_Priority_dt_i_P1_Status" label="Passenger1.Status"&gt;
          &lt;dmn:inputExpression typeRef="feel:string"&gt;
            &lt;dmn:text&gt;Passenger1.Status&lt;/dmn:text&gt;
          &lt;/dmn:inputExpression&gt;
          &lt;dmn:inputValues&gt;
            &lt;dmn:text&gt;"gold", "silver", "bronze"&lt;/dmn:text&gt;
          &lt;/dmn:inputValues&gt;
        &lt;/dmn:input&gt;
        &lt;dmn:input id="b_Passenger_Priority_dt_i_P2_Status" label="Passenger2.Status"&gt;
          &lt;dmn:inputExpression typeRef="feel:string"&gt;
            &lt;dmn:text&gt;Passenger2.Status&lt;/dmn:text&gt;
          &lt;/dmn:inputExpression&gt;
          &lt;dmn:inputValues&gt;
            &lt;dmn:text&gt;"gold", "silver", "bronze"&lt;/dmn:text&gt;
          &lt;/dmn:inputValues&gt;
        &lt;/dmn:input&gt;
        &lt;dmn:input id="b_Passenger_Priority_dt_i_P1_Miles" label="Passenger1.Miles"&gt;
          &lt;dmn:inputExpression typeRef="feel:string"&gt;
            &lt;dmn:text&gt;Passenger1.Miles&lt;/dmn:text&gt;
          &lt;/dmn:inputExpression&gt;
        &lt;/dmn:input&gt;
        &lt;dmn:output id="b_Status_Priority_dt_o" label="Passenger1 has priority"&gt;
          &lt;dmn:outputValues&gt;
            &lt;dmn:text&gt;true, false&lt;/dmn:text&gt;
          &lt;/dmn:outputValues&gt;
          &lt;dmn:defaultOutputEntry&gt;
            &lt;dmn:text&gt;false&lt;/dmn:text&gt;
          &lt;/dmn:defaultOutputEntry&gt;
        &lt;/dmn:output&gt;
        &lt;dmn:rule id="b_Passenger_Priority_dt_r1"&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r1_i1"&gt;
            &lt;dmn:text&gt;"gold"&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r1_i2"&gt;
            &lt;dmn:text&gt;"gold"&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r1_i3"&gt;
            &lt;dmn:text&gt;&gt;= Passenger2.Miles&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:outputEntry id="b_Passenger_Priority_dt_r1_o1"&gt;
            &lt;dmn:text&gt;true&lt;/dmn:text&gt;
          &lt;/dmn:outputEntry&gt;
        &lt;/dmn:rule&gt;
        &lt;dmn:rule id="b_Passenger_Priority_dt_r2"&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r2_i1"&gt;
            &lt;dmn:text&gt;"gold"&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r2_i2"&gt;
            &lt;dmn:text&gt;"silver","bronze"&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r2_i3"&gt;
            &lt;dmn:text&gt;-&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:outputEntry id="b_Passenger_Priority_dt_r2_o1"&gt;
            &lt;dmn:text&gt;true&lt;/dmn:text&gt;
          &lt;/dmn:outputEntry&gt;
        &lt;/dmn:rule&gt;
        &lt;dmn:rule id="b_Passenger_Priority_dt_r3"&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r3_i1"&gt;
            &lt;dmn:text&gt;"silver"&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r3_i2"&gt;
            &lt;dmn:text&gt;"silver"&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r3_i3"&gt;
            &lt;dmn:text&gt;&gt;= Passenger2.Miles&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:outputEntry id="b_Passenger_Priority_dt_r3_o1"&gt;
            &lt;dmn:text&gt;true&lt;/dmn:text&gt;
          &lt;/dmn:outputEntry&gt;
        &lt;/dmn:rule&gt;
        &lt;dmn:rule id="b_Passenger_Priority_dt_r4"&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r4_i1"&gt;
            &lt;dmn:text&gt;"silver"&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r4_i2"&gt;
            &lt;dmn:text&gt;"bronze"&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r4_i3"&gt;
            &lt;dmn:text&gt;-&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:outputEntry id="b_Passenger_Priority_dt_r4_o1"&gt;
            &lt;dmn:text&gt;true&lt;/dmn:text&gt;
          &lt;/dmn:outputEntry&gt;
        &lt;/dmn:rule&gt;
        &lt;dmn:rule id="b_Passenger_Priority_dt_r5"&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r5_i1"&gt;
            &lt;dmn:text&gt;"bronze"&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r5_i2"&gt;
            &lt;dmn:text&gt;"bronze"&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r5_i3"&gt;
            &lt;dmn:text&gt;&gt;= Passenger2.Miles&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:outputEntry id="b_Passenger_Priority_dt_r5_o1"&gt;
            &lt;dmn:text&gt;true&lt;/dmn:text&gt;
          &lt;/dmn:outputEntry&gt;
        &lt;/dmn:rule&gt;
      &lt;/dmn:decisionTable&gt;
    &lt;/dmn:encapsulatedLogic&gt;
    &lt;dmn:variable name="passenger priority" typeRef="feel:boolean"/&gt;
  &lt;/dmn:businessKnowledgeModel&gt;
  &lt;dmn:businessKnowledgeModel id="b_ReassignNextPassenger" name="reassign next passenger"&gt;
    &lt;dmn:encapsulatedLogic&gt;
      &lt;dmn:formalParameter name="Waiting List" typeRef="tPassengerTable"/&gt;
      &lt;dmn:formalParameter name="Reassigned Passengers List" typeRef="tPassengerTable"/&gt;
      &lt;dmn:formalParameter name="Flights" typeRef="tFlightTable"/&gt;
      &lt;dmn:context&gt;
        &lt;dmn:contextEntry&gt;
          &lt;dmn:variable name="Next Passenger" typeRef="tPassenger"/&gt;
          &lt;dmn:literalExpression&gt;
            &lt;dmn:text&gt;Waiting List[1]&lt;/dmn:text&gt;
          &lt;/dmn:literalExpression&gt;
        &lt;/dmn:contextEntry&gt;
        &lt;dmn:contextEntry&gt;
          &lt;dmn:variable name="Original Flight" typeRef="tFlight"/&gt;
          &lt;dmn:literalExpression&gt;
            &lt;dmn:text&gt;Flights[ Flight Number = Next Passenger.Flight Number ][1]&lt;/dmn:text&gt;
          &lt;/dmn:literalExpression&gt;
        &lt;/dmn:contextEntry&gt;
        &lt;dmn:contextEntry&gt;
          &lt;dmn:variable name="Best Alternate Flight" typeRef="tFlight"/&gt;
          &lt;dmn:literalExpression&gt;
            &lt;dmn:text&gt;Flights[ From = Original Flight.From and To = Original Flight.To and Departure &gt; Original Flight.Departure and Status = "scheduled" and has capacity( item, Reassigned Passengers List ) ][1]&lt;/dmn:text&gt;
          &lt;/dmn:literalExpression&gt;
        &lt;/dmn:contextEntry&gt;
        &lt;dmn:contextEntry&gt;
          &lt;dmn:variable name="Reassigned Passenger" typeRef="tPassenger"/&gt;
          &lt;dmn:context&gt;
            &lt;dmn:contextEntry&gt;
              &lt;dmn:variable name="Name" typeRef="feel:string"/&gt;
              &lt;dmn:literalExpression&gt;
                &lt;dmn:text&gt;Next Passenger.Name&lt;/dmn:text&gt;
              &lt;/dmn:literalExpression&gt;
            &lt;/dmn:contextEntry&gt;
            &lt;dmn:contextEntry&gt;
              &lt;dmn:variable name="Status" typeRef="feel:string"/&gt;
              &lt;dmn:literalExpression&gt;
                &lt;dmn:text&gt;Next Passenger.Status&lt;/dmn:text&gt;
              &lt;/dmn:literalExpression&gt;
            &lt;/dmn:contextEntry&gt;
            &lt;dmn:contextEntry&gt;
              &lt;dmn:variable name="Miles" typeRef="feel:number"/&gt;
              &lt;dmn:literalExpression&gt;
                &lt;dmn:text&gt;Next Passenger.Miles&lt;/dmn:text&gt;
              &lt;/dmn:literalExpression&gt;
            &lt;/dmn:contextEntry&gt;
            &lt;dmn:contextEntry&gt;
              &lt;dmn:variable name="Flight Number" typeRef="feel:string"/&gt;
              &lt;dmn:literalExpression&gt;
                &lt;dmn:text&gt;Best Alternate Flight.Flight Number&lt;/dmn:text&gt;
              &lt;/dmn:literalExpression&gt;
            &lt;/dmn:contextEntry&gt;
          &lt;/dmn:context&gt;
        &lt;/dmn:contextEntry&gt;
        &lt;dmn:contextEntry&gt;
          &lt;dmn:variable name="Remaining Waiting List" typeRef="tPassengerTable"/&gt;
          &lt;dmn:literalExpression&gt;
            &lt;dmn:text&gt;remove( Waiting List, 1 )&lt;/dmn:text&gt;
          &lt;/dmn:literalExpression&gt;
        &lt;/dmn:contextEntry&gt;
        &lt;dmn:contextEntry&gt;
          &lt;dmn:variable name="Updated Reassigned Passengers List" typeRef="tPassengerTable"/&gt;
          &lt;dmn:literalExpression&gt;
            &lt;dmn:text&gt;append( Reassigned Passengers List, Reassigned Passenger )&lt;/dmn:text&gt;
          &lt;/dmn:literalExpression&gt;
        &lt;/dmn:contextEntry&gt;
        &lt;dmn:contextEntry&gt;
          &lt;dmn:literalExpression&gt;
            &lt;dmn:text&gt;if count( Remaining Waiting List ) &gt; 0 then reassign next passenger( Remaining Waiting List, Updated Reassigned Passengers List, Flights ) else Updated Reassigned Passengers List&lt;/dmn:text&gt;
          &lt;/dmn:literalExpression&gt;
        &lt;/dmn:contextEntry&gt;
      &lt;/dmn:context&gt;
    &lt;/dmn:encapsulatedLogic&gt;
    &lt;dmn:variable name="reassign next passenger" typeRef="tPassengerTable"/&gt;
    &lt;dmn:knowledgeRequirement&gt;
      &lt;dmn:requiredKnowledge href="#b_HasCapacity"/&gt;
    &lt;/dmn:knowledgeRequirement&gt;
  &lt;/dmn:businessKnowledgeModel&gt;
  &lt;dmn:businessKnowledgeModel id="b_HasCapacity" name="has capacity"&gt;
    &lt;dmn:encapsulatedLogic&gt;
      &lt;dmn:formalParameter name="flight" typeRef="tFlight"/&gt;
      &lt;dmn:formalParameter name="rebooked list" typeRef="tPassengerTable"/&gt;
      &lt;dmn:literalExpression&gt;
        &lt;dmn:text&gt;flight.Capacity &gt; count( rebooked list[ Flight Number = flight.Flight Number ] )&lt;/dmn:text&gt;
      &lt;/dmn:literalExpression&gt;
    &lt;/dmn:encapsulatedLogic&gt;
    &lt;dmn:variable name="has capacity" typeRef="feel:boolean"/&gt;
  &lt;/dmn:businessKnowledgeModel&gt;
&lt;/dmn:definitions&gt;</pre></section></section><section class="chapter" id="dmn-support-con_dmn-models"><div class="titlepage"><div><div><h2 class="title">Chapter 4. DMN support in Red Hat Process Automation Manager</h2></div></div></div><p>
				Red Hat Process Automation Manager provides design and runtime support for DMN 1.2 models at conformance level 3, and runtime-only support for DMN 1.1 and 1.3 models at conformance level 3. You can integrate DMN models with your Red Hat Process Automation Manager decision services in several ways:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Design your DMN models directly in Business Central using the DMN designer.
					</li><li class="listitem">
						Import DMN files into your project in Business Central (<span class="strong strong"><strong>Menu → Design → Projects → Import Asset</strong></span>). Any DMN 1.1 and 1.3 models (do not contain DMN 1.3 features) that you import into Business Central, open in the DMN designer, and save are converted to DMN 1.2 models.
					</li><li class="listitem">
						Package DMN files as part of your project knowledge JAR (KJAR) file without Business Central.
					</li></ul></div><p>
				In addition to all DMN conformance level 3 requirements, Red Hat Process Automation Manager also includes enhancements and fixes to FEEL and DMN model components to optimize the experience of implementing DMN decision services with Red Hat Process Automation Manager. From a platform perspective, DMN models are like any other business asset in Red Hat Process Automation Manager, such as DRL files or spreadsheet decision tables, that you can include in your Red Hat Process Automation Manager project and deploy to KIE Server in order to start your DMN decision services.
			</p><p>
				For more information about including external DMN files with your Red Hat Process Automation Manager project packaging and deployment method, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>.
			</p><section class="section" id="dmn-properties-ref_dmn-models"><div class="titlepage"><div><div><h2 class="title">4.1. Configurable DMN properties in Red Hat Process Automation Manager</h2></div></div></div><p>
					Red Hat Process Automation Manager provides the following DMN properties that you can configure when you execute your DMN models on KIE Server or on your client application. You can configure some of these properties using the <code class="literal">kmodule.xml</code> file in your Red Hat Process Automation Manager project when you deploy your project on KIE Server.
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">org.kie.dmn.strictConformance</span></dt><dd><p class="simpara">
								When enabled, this property disables by default any extensions or profiles provided beyond the DMN standard, such as some helper functions or enhanced features of DMN 1.2 backported into DMN 1.1. You can use this property to configure the decision engine to support only pure DMN features, such as when running the <a class="link" href="https://dmn-tck.github.io/tck/">DMN Technology Compatibility Kit</a> (TCK).
							</p><p class="simpara">
								Default value: <code class="literal">false</code>
							</p><pre class="screen">-Dorg.kie.dmn.strictConformance=true</pre></dd><dt><span class="term">org.kie.dmn.runtime.typecheck</span></dt><dd><p class="simpara">
								When enabled, this property enables verification of actual values conforming to their declared types in the DMN model, as input or output of DRD elements. You can use this property to verify whether data supplied to the DMN model or produced by the DMN model is compliant with what is specified in the model.
							</p><p class="simpara">
								Default value: <code class="literal">false</code>
							</p><pre class="screen">-Dorg.kie.dmn.runtime.typecheck=true</pre></dd><dt><span class="term">org.kie.dmn.decisionservice.coercesingleton</span></dt><dd><p class="simpara">
								By default, this property makes the result of a decision service defining a single output decision be the single value of the output decision value. When disabled, this property makes the result of a decision service defining a single output decision be a <code class="literal">context</code> with the single entry for that decision. You can use this property to adjust your decision service outputs according to your project requirements.
							</p><p class="simpara">
								Default value: <code class="literal">true</code>
							</p><pre class="screen">-Dorg.kie.dmn.decisionservice.coercesingleton=false</pre></dd><dt><span class="term">org.kie.dmn.profiles.$PROFILE_NAME</span></dt><dd><p class="simpara">
								When valorized with a Java fully qualified name, this property loads a DMN profile onto the decision engine at start time. You can use this property to implement a predefined DMN profile with supported features different from or beyond the DMN standard. For example, if you are creating DMN models using the Signavio DMN modeller, use this property to implement features from the Signavio DMN profile into your DMN decision service.
							</p><pre class="screen">-Dorg.kie.dmn.profiles.signavio=org.kie.dmn.signavio.KieDMNSignavioProfile</pre></dd><dt><span class="term">org.kie.dmn.runtime.listeners.$LISTENER_NAME</span></dt><dd><p class="simpara">
								When valorized with a Java fully qualified name, this property loads and registers a DMN Runtime Listener onto the decision engine at start time. You can use this property to register a DMN listener in order to be notified of several events during DMN model evaluations.
							</p><p class="simpara">
								To configure this property when deploying your project on KIE Server, modify this property in the <code class="literal">kmodule.xml</code> file of your project. This approach is helpful when the listener is specific to your project and when the configuration must be applied in KIE Server only to your deployed project.
							</p><pre class="programlisting language-xml">&lt;kmodule xmlns="http://www.drools.org/xsd/kmodule"&gt;
  &lt;configuration&gt;
    &lt;property key="org.kie.dmn.runtime.listeners.mylistener" value="org.acme.MyDMNListener"/&gt;
  &lt;/configuration&gt;
&lt;/kmodule&gt;</pre><p class="simpara">
								To configure this property globally for your Red Hat Process Automation Manager environment, modify this property using a command terminal or any other global application configuration mechanism. This approach is helpful when the decision engine is embedded as part of your Java application.
							</p><pre class="screen">-Dorg.kie.dmn.runtime.listeners.mylistener=org.acme.MyDMNListener</pre></dd><dt><span class="term">org.kie.dmn.compiler.execmodel</span></dt><dd><p class="simpara">
								When enabled, this property enables DMN decision table logic to be compiled into executable rule models during run time. You can use this property to evaluate DMN decision table logic more efficiently. This property is helpful when the executable model compilation was not originally performed during project compile time. Enabling this property may result in added compile time during the first evaluation by the decision engine, but subsequent compilations are more efficient.
							</p><p class="simpara">
								Default value: <code class="literal">false</code>
							</p><pre class="screen">-Dorg.kie.dmn.compiler.execmodel=true</pre></dd></dl></div></section><section class="section" id="dmn-validation-con_dmn-models"><div class="titlepage"><div><div><h2 class="title">4.2. Configurable DMN validation in Red Hat Process Automation Manager</h2></div></div></div><p>
					By default, the <code class="literal">kie-maven-plugin</code> component in the <code class="literal">pom.xml</code> file of your Red Hat Process Automation Manager project uses the following <code class="literal">&lt;validateDMN&gt;</code> configurations to perform pre-compilation validation of DMN model assets and to perform DMN decision table static analysis:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">VALIDATE_SCHEMA</code>: DMN model files are verified against the DMN specification XSD schema to ensure that the files are valid XML and compliant with the specification.
						</li><li class="listitem">
							<code class="literal">VALIDATE_MODEL</code>: The pre-compilation analysis is performed for the DMN model to ensure that the basic semantic is aligned with the DMN specification.
						</li><li class="listitem">
							<code class="literal">ANALYZE_DECISION_TABLE</code>: DMN decision tables are statically analyzed for gaps or overlaps and to ensure that the semantic of the decision table follows best practices.
						</li></ul></div><p>
					You can modify the default DMN validation and DMN decision table analysis behavior to perform only a specified validation during the project build, or you can disable this default behavior completely, as shown in the following examples:
				</p><div class="formalpara"><p class="title"><strong>Default configuration for DMN validation and decision table analysis</strong></p><p>
						
<pre class="programlisting language-xml">&lt;plugin&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-maven-plugin&lt;/artifactId&gt;
  &lt;extensions&gt;true&lt;/extensions&gt;
  &lt;configuration&gt;
    &lt;validateDMN&gt;VALIDATE_SCHEMA,VALIDATE_MODEL,ANALYZE_DECISION_TABLE&lt;/validateDMN&gt;
  &lt;/configuration&gt;
&lt;/plugin&gt;</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Configuration to perform only the DMN decision table static analysis</strong></p><p>
						
<pre class="programlisting language-xml">&lt;plugin&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-maven-plugin&lt;/artifactId&gt;
  &lt;extensions&gt;true&lt;/extensions&gt;
  &lt;configuration&gt;
    &lt;validateDMN&gt;ANALYZE_DECISION_TABLE&lt;/validateDMN&gt;
  &lt;/configuration&gt;
&lt;/plugin&gt;</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Configuration to perform only the XSD schema validation</strong></p><p>
						
<pre class="programlisting language-xml">&lt;plugin&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-maven-plugin&lt;/artifactId&gt;
  &lt;extensions&gt;true&lt;/extensions&gt;
  &lt;configuration&gt;
    &lt;validateDMN&gt;VALIDATE_SCHEMA&lt;/validateDMN&gt;
  &lt;/configuration&gt;
&lt;/plugin&gt;</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Configuration to perform only the DMN model validation</strong></p><p>
						
<pre class="programlisting language-xml">&lt;plugin&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-maven-plugin&lt;/artifactId&gt;
  &lt;extensions&gt;true&lt;/extensions&gt;
  &lt;configuration&gt;
    &lt;validateDMN&gt;VALIDATE_MODEL&lt;/validateDMN&gt;
  &lt;/configuration&gt;
&lt;/plugin&gt;</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Configuration to disable all DMN validation</strong></p><p>
						
<pre class="programlisting language-xml">&lt;plugin&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-maven-plugin&lt;/artifactId&gt;
  &lt;extensions&gt;true&lt;/extensions&gt;
  &lt;configuration&gt;
    &lt;validateDMN&gt;disable&lt;/validateDMN&gt;
  &lt;/configuration&gt;
&lt;/plugin&gt;</pre>
					</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you enter an unrecognized <code class="literal">&lt;validateDMN&gt;</code> configuration flag, all pre-compilation validation is disabled and the Maven plugin emits related log messages.
					</p></div></div></section></section><section class="chapter" id="dmn-model-creating-proc_dmn-models"><div class="titlepage"><div><div><h2 class="title">Chapter 5. Creating and editing DMN models in Business Central</h2></div></div></div><p>
				You can use the DMN designer in Business Central to design DMN decision requirements diagrams (DRDs) and define decision logic for a complete and functional DMN decision model. Red Hat Process Automation Manager provides design and runtime support for DMN 1.2 models at conformance level 3, and includes enhancements and fixes to FEEL and DMN model components to optimize the experience of implementing DMN decision services with Red Hat Process Automation Manager. Red Hat Process Automation Manager also provides runtime-only support for DMN 1.1 and 1.3 models at conformance level 3, but any DMN 1.1 and 1.3 models (do not contain DMN 1.3 features) that you import into Business Central, open in the DMN designer, and save are converted to DMN 1.2 models.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
					</li><li class="listitem"><p class="simpara">
						Create or import a DMN file in your Business Central project.
					</p><p class="simpara">
						To create a DMN file, click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>DMN</strong></span>, enter an informative DMN model name, select the appropriate <span class="strong strong"><strong>Package</strong></span>, and click <span class="strong strong"><strong>Ok</strong></span>.
					</p><p class="simpara">
						To import an existing DMN file, click <span class="strong strong"><strong>Import Asset</strong></span>, enter the DMN model name, select the appropriate <span class="strong strong"><strong>Package</strong></span>, select the DMN file to upload, and click <span class="strong strong"><strong>Ok</strong></span>.
					</p><p class="simpara">
						The new DMN file is now listed in the <span class="strong strong"><strong>DMN</strong></span> panel of the <span class="strong strong"><strong>Project Explorer</strong></span>, and the DMN decision requirements diagram (DRD) canvas appears.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							If you imported a DMN file that does not contain layout information, the imported decision requirements diagram (DRD) is formatted automatically in the DMN designer. Click <span class="strong strong"><strong>Save</strong></span> in the DMN designer to save the DRD layout.
						</p><p>
							If an imported DRD is not automatically formatted, you can select the <span class="strong strong"><strong>Perform automatic layout</strong></span> icon in the upper-right toolbar in the DMN designer to format the DRD.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Begin adding components to your new or imported DMN decision requirements diagram (DRD) by clicking and dragging one of the DMN nodes from the left toolbar:
					</p><div class="figure" id="idm139921833665072"><p class="title"><strong>Figure 5.1. Adding DRD components</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-drag-decision-node.png" alt="dmn drag decision node"/></div></div></div><p class="simpara">
						The following DRD components are available:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>Decision</strong></span>: Use this node for a DMN decision, where one or more input elements determine an output based on defined decision logic.
							</li><li class="listitem">
								<span class="strong strong"><strong>Business knowledge model</strong></span>: Use this node for reusable functions with one or more decision elements. Decisions that have the same logic but depend on different sub-input data or sub-decisions use business knowledge models to determine which procedure to follow.
							</li><li class="listitem">
								<span class="strong strong"><strong>Knowledge source</strong></span>: Use this node for external authorities, documents, committees, or policies that regulate a decision or business knowledge model. Knowledge sources are references to real-world factors rather than executable business rules.
							</li><li class="listitem">
								<span class="strong strong"><strong>Input data</strong></span>: Use this node for information used in a decision node or a business knowledge model. Input data usually includes business-level concepts or objects relevant to the business, such as loan applicant data used in a lending strategy.
							</li><li class="listitem">
								<span class="strong strong"><strong>Text annotation</strong></span>: Use this node for explanatory notes associated with an input data node, decision node, business knowledge model, or knowledge source.
							</li><li class="listitem">
								<span class="strong strong"><strong>Decision service</strong></span>: Use this node to enclose a set of reusable decisions implemented as a decision service for invocation. A decision service can be used in other DMN models and can be invoked from an external application or a BPMN business process.
							</li></ul></div></li><li class="listitem">
						In the DMN designer canvas, double-click the new DRD node to enter an informative node name.
					</li><li class="listitem"><p class="simpara">
						If the node is a decision or business knowledge model, select the node to display the node options and click the <span class="strong strong"><strong>Edit</strong></span> icon to open the DMN boxed expression designer to define the decision logic for the node:
					</p><div class="figure" id="idm139921829109920"><p class="title"><strong>Figure 5.2. Opening a new decision node boxed expression</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-decision-edit.png" alt="dmn decision edit"/></div></div></div><div class="figure" id="idm139921851190832"><p class="title"><strong>Figure 5.3. Opening a new business knowledge model boxed expression</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-bkm-edit.png" alt="dmn bkm edit"/></div></div></div><p class="simpara">
						By default, all business knowledge models are defined as boxed function expressions containing a literal FEEL expression, a nested context expression of an external JAVA or PMML function, or a nested boxed expression of any type.
					</p><p class="simpara">
						For decision nodes, you click the undefined table to select the type of boxed expression you want to use, such as a boxed literal expression, boxed context expression, decision table, or other DMN boxed expression.
					</p><div class="figure" id="idm139921828940944"><p class="title"><strong>Figure 5.4. Selecting the logic type for a decision node</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-decision-boxed-expression-options.png" alt="dmn decision boxed expression options"/></div></div></div><p class="simpara">
						For business knowledge models, you click the top-left function cell to select the function type, or right-click the function value cell, select <span class="strong strong"><strong>Clear</strong></span>, and select a boxed expression of another type.
					</p><div class="figure" id="idm139921836611328"><p class="title"><strong>Figure 5.5. Selecting the function or other logic type for a business knowledge model</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-bkm-define.png" alt="dmn bkm define"/></div></div></div></li><li class="listitem"><p class="simpara">
						In the selected boxed expression designer for either a decision node (any expression type) or business knowledge model (function expression), click the applicable table cells to define the table name, variable data types, variable names and values, function parameters and bindings, or FEEL expressions to include in the decision logic.
					</p><p class="simpara">
						You can right-click cells for additional actions where applicable, such as inserting or removing table rows and columns or clearing table contents.
					</p><p class="simpara">
						The following is an example decision table for a decision node that determines credit score ratings based on a defined range of a loan applicant’s credit score:
					</p><div class="figure" id="idm139921836604752"><p class="title"><strong>Figure 5.6. Decision node decision table for credit score rating</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-decision-table-example1a.png" alt="dmn decision table example1a"/></div></div></div><p class="simpara">
						The following is an example boxed function expression for a business knowledge model that calculates mortgage payments based on principal, interest, taxes, and insurance (PITI) as a literal expression:
					</p><div class="figure" id="idm139921836702192"><p class="title"><strong>Figure 5.7. Business knowledge model function for PITI calculation</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-function-expression-example4.png" alt="dmn function expression example4"/></div></div></div></li><li class="listitem">
						After you define the decision logic for the selected node, click <span class="strong strong"><strong>Back to "&lt;MODEL_NAME&gt;"</strong></span> to return to the DRD view.
					</li><li class="listitem"><p class="simpara">
						For the selected DRD node, use the available connection options to create and connect to the next node in the DRD, or click and drag a new node onto the DRD canvas from the left toolbar.
					</p><p class="simpara">
						The node type determines which connection options are supported. For example, an <span class="strong strong"><strong>Input data</strong></span> node can connect to a decision node, knowledge source, or text annotation using the applicable connection type, whereas a <span class="strong strong"><strong>Knowledge source</strong></span> node can connect to any DRD element. A <span class="strong strong"><strong>Decision</strong></span> node can connect only to another decision or a text annotation.
					</p><p class="simpara">
						The following connection types are available, depending on the node type:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>Information requirement</strong></span>: Use this connection from an input data node or decision node to another decision node that requires the information.
							</li><li class="listitem">
								<span class="strong strong"><strong>Knowledge requirement</strong></span>: Use this connection from a business knowledge model to a decision node or to another business knowledge model that invokes the decision logic.
							</li><li class="listitem">
								<span class="strong strong"><strong>Authority requirement</strong></span>: Use this connection from an input data node or a decision node to a dependent knowledge source or from a knowledge source to a decision node, business knowledge model, or another knowledge source.
							</li><li class="listitem">
								<span class="strong strong"><strong>Association</strong></span>: Use this connection from an input data node, decision node, business knowledge model, or knowledge source to a text annotation.
							</li></ul></div><div class="figure" id="idm139921829242752"><p class="title"><strong>Figure 5.8. Connecting credit score input to the credit score rating decision</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-input-connection-example.png" alt="dmn input connection example"/></div></div></div><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-input-connection-example2.png" alt="dmn input connection example2"/></div></div></li><li class="listitem"><p class="simpara">
						Continue adding and defining the remaining DRD components of your decision model. Periodically click <span class="strong strong"><strong>Save</strong></span> in the DMN designer to save your work.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							As you periodically save a DRD, the DMN designer performs a static validation of the DMN model and might produce error messages until the model is defined completely. After you finish defining the DMN model completely, if any errors remain, troubleshoot the specified problems accordingly.
						</p></div></div></li><li class="listitem"><p class="simpara">
						After you add and define all components of the DRD, click <span class="strong strong"><strong>Save</strong></span> to save and validate the completed DRD.
					</p><p class="simpara">
						To adjust the DRD layout, you can select the <span class="strong strong"><strong>Perform automatic layout</strong></span> icon in the upper-right toolbar of the DMN designer.
					</p><p class="simpara">
						The following is an example DRD for a loan prequalification decision model:
					</p><div class="figure" id="idm139921853260448"><p class="title"><strong>Figure 5.9. Completed DRD for loan prequalification</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-example-drd.png" alt="dmn example drd"/></div></div></div><p class="simpara">
						The following is an example DRD for a phone call handling decision model using a reusable decision service:
					</p><div class="figure" id="idm139921851470608"><p class="title"><strong>Figure 5.10. Completed DRD for phone call handling with a decision service</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-example-drd3.png" width="486" alt="dmn example drd3"/></div></div></div><p class="simpara">
						In a DMN decision service node, the decision nodes in the bottom segment incorporate input data from outside of the decision service to arrive at a final decision in the top segment of the decision service node. The resulting top-level decisions from the decision service are then implemented in any subsequent decisions or business knowledge requirements of the DMN model. You can reuse DMN decision services in other DMN models to apply the same decision logic with different input data and different outgoing connections.
					</p></li></ol></div><section class="section" id="dmn-logic-defining-proc_dmn-models"><div class="titlepage"><div><div><h2 class="title">5.1. Defining DMN decision logic in boxed expressions in Business Central</h2></div></div></div><p>
					Boxed expressions in DMN are tables that you use to define the underlying logic of decision nodes and business knowledge models in a decision requirements diagram (DRD). Some boxed expressions can contain other boxed expressions, but the top-level boxed expression corresponds to the decision logic of a single DRD artifact. While DRDs represent the flow of a DMN decision model, boxed expressions define the actual decision logic of individual nodes. DRDs and boxed expressions together form a complete and functional DMN decision model.
				</p><p>
					You can use the DMN designer in Business Central to define decision logic for your DRD components using built-in boxed expressions.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							A DMN file is created or imported in Business Central.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span>, click the project name, and select the DMN file you want to modify.
						</li><li class="listitem"><p class="simpara">
							In the DMN designer canvas, select a decision node or business knowledge model node that you want to define and click the <span class="strong strong"><strong>Edit</strong></span> icon to open the DMN boxed expression designer:
						</p><div class="figure" id="idm139921828680720"><p class="title"><strong>Figure 5.11. Opening a new decision node boxed expression</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-decision-edit.png" alt="dmn decision edit"/></div></div></div><div class="figure" id="idm139921838536192"><p class="title"><strong>Figure 5.12. Opening a new business knowledge model boxed expression</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-bkm-edit.png" alt="dmn bkm edit"/></div></div></div><p class="simpara">
							By default, all business knowledge models are defined as boxed function expressions containing a literal FEEL expression, a nested context expression of an external JAVA or PMML function, or a nested boxed expression of any type.
						</p><p class="simpara">
							For decision nodes, you click the undefined table to select the type of boxed expression you want to use, such as a boxed literal expression, boxed context expression, decision table, or other DMN boxed expression.
						</p><div class="figure" id="idm139921838530944"><p class="title"><strong>Figure 5.13. Selecting the logic type for a decision node</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-decision-boxed-expression-options.png" alt="dmn decision boxed expression options"/></div></div></div><p class="simpara">
							For business knowledge model nodes, you click the top-left function cell to select the function type, or right-click the function value cell, select <span class="strong strong"><strong>Clear</strong></span>, and select a boxed expression of another type.
						</p><div class="figure" id="idm139921831850752"><p class="title"><strong>Figure 5.14. Selecting the function or other logic type for a business knowledge model</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-bkm-define.png" alt="dmn bkm define"/></div></div></div></li><li class="listitem"><p class="simpara">
							For this example, use a decision node and select <span class="strong strong"><strong>Decision Table</strong></span> as the boxed expression type.
						</p><p class="simpara">
							A decision table in DMN is a visual representation of one or more rules in a tabular format. Each rule consists of a single row in the table, and includes columns that define the conditions (input) and outcome (output) for that particular row.
						</p></li><li class="listitem">
							Click the input column header to define the name and data type for the input condition. For example, name the input column <span class="strong strong"><strong>Credit Score.FICO</strong></span> with a <code class="literal">number</code> data type. This column specifies numeric credit score values or ranges of loan applicants.
						</li><li class="listitem"><p class="simpara">
							Click the output column header to define the name and data type for the output values. For example, name the output column <span class="strong strong"><strong>Credit Score Rating</strong></span> and next to the <span class="strong strong"><strong>Data Type</strong></span> option, click <span class="strong strong"><strong>Manage</strong></span> to go to the <span class="strong strong"><strong>Data Types</strong></span> page where you can create a custom data type with score ratings as constraints.
						</p><div class="figure" id="idm139921840974048"><p class="title"><strong>Figure 5.15. Managing data types for a column header value</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-manage-data-types.png" alt="dmn manage data types"/></div></div></div></li><li class="listitem"><p class="simpara">
							On the <span class="strong strong"><strong>Data Types</strong></span> page, click <span class="strong strong"><strong>New Data Type</strong></span> to add a new data type or click <span class="strong strong"><strong>Import Data Object</strong></span> to import an existing data object from your project that you want to use as a DMN data type.
						</p><p class="simpara">
							If you import a data object from your project as a DMN data type and then that object is updated, you must re-import the data object as a DMN data type to apply the changes in your DMN model.
						</p><p class="simpara">
							For this example, click <span class="strong strong"><strong>New Data Type</strong></span> and create a <span class="strong strong"><strong>Credit_Score_Rating</strong></span> data type as a <code class="literal">string</code>:
						</p><div class="figure" id="idm139921834637168"><p class="title"><strong>Figure 5.16. Adding a new data type</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-custom-data-type-add.png" alt="dmn custom data type add"/></div></div></div></li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Add Constraints</strong></span>, select <span class="strong strong"><strong>Enumeration</strong></span> from the drop-down options, and add the following constraints:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">"Excellent"</code>
								</li><li class="listitem">
									<code class="literal">"Good"</code>
								</li><li class="listitem">
									<code class="literal">"Fair"</code>
								</li><li class="listitem">
									<code class="literal">"Poor"</code>
								</li><li class="listitem">
									<code class="literal">"Bad"</code>
								</li></ul></div><div class="figure" id="idm139921834302352"><p class="title"><strong>Figure 5.17. Adding constraints to the new data type</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-custom-data-type-constraints.png" alt="dmn custom data type constraints"/></div></div></div><p class="simpara">
							To change the order of data type constraints, you can click the left end of the constraint row and drag the row as needed:
						</p><div class="figure" id="idm139921834297872"><p class="title"><strong>Figure 5.18. Dragging constraints to change constraint order</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-custom-data-type-constraints-drag.png" alt="dmn custom data type constraints drag"/></div></div></div><p class="simpara">
							For information about constraint types and syntax requirements for the specified data type, see the <a class="link" href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.
						</p></li><li class="listitem">
							Click <span class="strong strong"><strong>OK</strong></span> to save the constraints and click the check mark to the right of the data type to save the data type.
						</li><li class="listitem">
							Return to the <span class="strong strong"><strong>Credit Score Rating</strong></span> decision table, click the <span class="strong strong"><strong>Credit Score Rating</strong></span> column header, and set the data type to this new custom data type.
						</li><li class="listitem"><p class="simpara">
							Use the <span class="strong strong"><strong>Credit Score.FICO</strong></span> input column to define credit score values or ranges of values, and use the <span class="strong strong"><strong>Credit Score Rating</strong></span> column to specify one of the corresponding ratings you defined in the <span class="strong strong"><strong>Credit_Score_Rating</strong></span> data type.
						</p><p class="simpara">
							Right-click any value cell to insert or delete rows (rules) or columns (clauses).
						</p><div class="figure" id="idm139921832657312"><p class="title"><strong>Figure 5.19. Decision node decision table for credit score rating</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-decision-table-example1a.png" alt="dmn decision table example1a"/></div></div></div></li><li class="listitem"><p class="simpara">
							After you define all rules, click the top-left corner of the decision table to define the rule <span class="strong strong"><strong>Hit Policy</strong></span> and <span class="strong strong"><strong>Builtin Aggregator</strong></span> (for <span class="strong strong"><strong>COLLECT</strong></span> hit policy only).
						</p><p class="simpara">
							The hit policy determines how to reach an outcome when multiple rules in a decision table match the provided input values. The built-in aggregator determines how to aggregate rule values when you use the <span class="strong strong"><strong>COLLECT</strong></span> hit policy.
						</p><div class="figure" id="idm139921847079344"><p class="title"><strong>Figure 5.20. Defining the decision table hit policy</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-hit-policies.png" alt="dmn hit policies"/></div></div></div><p class="simpara">
							The following example is a more complex decision table that determines applicant qualification for a loan as the concluding decision node in the same loan prequalification decision model:
						</p><div class="figure" id="idm139921828125712"><p class="title"><strong>Figure 5.21. Decision table for loan prequalification</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-decision-table-example3.png" alt="dmn decision table example3"/></div></div></div></li></ol></div><p>
					For boxed expression types other than decision tables, you follow these guidelines similarly to navigate the boxed expression tables and define variables and parameters for decision logic, but according to the requirements of the boxed expression type. Some boxed expressions, such as boxed literal expressions, can be single-column tables, while other boxed expressions, such as function, context, and invocation expressions, can be multi-column tables with nested boxed expressions of other types.
				</p><p>
					For example, the following boxed context expression defines the parameters that determine whether a loan applicant can meet minimum mortgage payments based on principal, interest, taxes, and insurance (PITI), represented as a front-end ratio calculation with a sub-context expression:
				</p><div class="figure" id="idm139921834389584"><p class="title"><strong>Figure 5.22. Boxed context expression for front-end client PITI ratio</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-context-expression-example2.png" alt="dmn context expression example2"/></div></div></div><p>
					The following boxed function expression determines a monthly mortgage installment as a business knowledge model in a lending decision, with the function value defined as a nested context expression:
				</p><div class="figure" id="idm139921835849920"><p class="title"><strong>Figure 5.23. Boxed function expression for installment calculation in business knowledge model</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-function-expression-example3.png" alt="dmn function expression example3"/></div></div></div><p>
					For more information and examples of each boxed expression type, see <a class="xref" href="#dmn-boxed-expressions-con_dmn-models" title="3.4. DMN decision logic in boxed expressions">Section 3.4, “DMN decision logic in boxed expressions”</a>.
				</p></section><section class="section" id="dmn-data-types-defining-proc_dmn-models"><div class="titlepage"><div><div><h2 class="title">5.2. Creating custom data types for DMN boxed expressions in Business Central</h2></div></div></div><p>
					In DMN boxed expressions in Business Central, data types determine the structure of the data that you use within an associated table, column, or field in the boxed expression. You can use default DMN data types (such as String, Number, Boolean) or you can create custom data types to specify additional fields and constraints that you want to implement for the boxed expression values.
				</p><p>
					Custom data types that you create for a boxed expression can be simple or structured:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Simple</strong></span> data types have only a name and a type assignment. Example: <code class="literal">Age (number)</code>.
						</li><li class="listitem">
							<span class="strong strong"><strong>Structured</strong></span> data types contain multiple fields associated with a parent data type. Example: A single type <code class="literal">Person</code> containing the fields <code class="literal">Name (string)</code>, <code class="literal">Age (number)</code>, <code class="literal">Email (string)</code>.
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							A DMN file is created or imported in Business Central.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span>, click the project name, and select the DMN file you want to modify.
						</li><li class="listitem">
							In the DMN designer canvas, select a decision node or business knowledge model for which you want to define the data types and click the <span class="strong strong"><strong>Edit</strong></span> icon to open the DMN boxed expression designer.
						</li><li class="listitem"><p class="simpara">
							If the boxed expression is for a decision node that is not yet defined, click the undefined table to select the type of boxed expression you want to use, such as a boxed literal expression, boxed context expression, decision table, or other DMN boxed expression.
						</p><div class="figure" id="idm139921841943104"><p class="title"><strong>Figure 5.24. Selecting the logic type for a decision node</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-decision-boxed-expression-options.png" alt="dmn decision boxed expression options"/></div></div></div></li><li class="listitem"><p class="simpara">
							Click the cell for the table header, column header, or parameter field (depending on the boxed expression type) for which you want to define the data type and click <span class="strong strong"><strong>Manage</strong></span> to go to the <span class="strong strong"><strong>Data Types</strong></span> page where you can create a custom data type.
						</p><div class="figure" id="idm139921831699296"><p class="title"><strong>Figure 5.25. Managing data types for a column header value</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-manage-data-types.png" alt="dmn manage data types"/></div></div></div><p class="simpara">
							You can also set and manage custom data types for a specified decision node or business knowledge model node by selecting the <span class="strong strong"><strong>Properties</strong></span> icon in the upper-right corner of the DMN designer:
						</p><div class="figure" id="idm139921830440848"><p class="title"><strong>Figure 5.26. Managing data types in decision requirements diagram (DRD) properties</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-manage-data-types1a.png" alt="dmn manage data types1a"/></div></div></div><p class="simpara">
							The data type that you define for a specified cell in a boxed expression determines the structure of the data that you use within that associated table, column, or field in the boxed expression.
						</p><p class="simpara">
							In this example, an output column <span class="strong strong"><strong>Credit Score Rating</strong></span> for a DMN decision table defines a set of custom credit score ratings based on an applicant’s credit score.
						</p></li><li class="listitem"><p class="simpara">
							On the <span class="strong strong"><strong>Data Types</strong></span> page, click <span class="strong strong"><strong>New Data Type</strong></span> to add a new data type or click <span class="strong strong"><strong>Import Data Object</strong></span> to import an existing data object from your project that you want to use as a DMN data type.
						</p><p class="simpara">
							If you import a data object from your project as a DMN data type and then that object is updated, you must re-import the data object as a DMN data type to apply the changes in your DMN model.
						</p><p class="simpara">
							For this example, click <span class="strong strong"><strong>New Data Type</strong></span> and create a <span class="strong strong"><strong>Credit_Score_Rating</strong></span> data type as a <code class="literal">string</code>:
						</p><div class="figure" id="idm139921838599296"><p class="title"><strong>Figure 5.27. Adding a new data type</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-custom-data-type-add.png" alt="dmn custom data type add"/></div></div></div><p class="simpara">
							If the data type requires a list of items, enable the <span class="strong strong"><strong>List</strong></span> setting.
						</p></li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Add Constraints</strong></span>, select <span class="strong strong"><strong>Enumeration</strong></span> from the drop-down options, and add the following constraints:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">"Excellent"</code>
								</li><li class="listitem">
									<code class="literal">"Good"</code>
								</li><li class="listitem">
									<code class="literal">"Fair"</code>
								</li><li class="listitem">
									<code class="literal">"Poor"</code>
								</li><li class="listitem">
									<code class="literal">"Bad"</code>
								</li></ul></div><div class="figure" id="idm139921854090048"><p class="title"><strong>Figure 5.28. Adding constraints to the new data type</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-custom-data-type-constraints.png" alt="dmn custom data type constraints"/></div></div></div><p class="simpara">
							To change the order of data type constraints, you can click the left end of the constraint row and drag the row as needed:
						</p><div class="figure" id="idm139921854085568"><p class="title"><strong>Figure 5.29. Dragging constraints to change constraint order</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-custom-data-type-constraints-drag.png" alt="dmn custom data type constraints drag"/></div></div></div><p class="simpara">
							For information about constraint types and syntax requirements for the specified data type, see the <a class="link" href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.
						</p></li><li class="listitem">
							Click <span class="strong strong"><strong>OK</strong></span> to save the constraints and click the check mark to the right of the data type to save the data type.
						</li><li class="listitem"><p class="simpara">
							Return to the <span class="strong strong"><strong>Credit Score Rating</strong></span> decision table, click the <span class="strong strong"><strong>Credit Score Rating</strong></span> column header, set the data type to this new custom data type, and define the rule values for that column with the rating constraints that you specified.
						</p><div class="figure" id="idm139921811776992"><p class="title"><strong>Figure 5.30. Decision table for credit score rating</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-decision-table-example1a.png" alt="dmn decision table example1a"/></div></div></div><p class="simpara">
							In the DMN decision model for this scenario, the <span class="strong strong"><strong>Credit Score Rating</strong></span> decision flows into the following <span class="strong strong"><strong>Loan Prequalification</strong></span> decision that also requires custom data types:
						</p><div class="figure" id="idm139921849450784"><p class="title"><strong>Figure 5.31. Decision table for loan prequalification</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-manage-data-types-blank.png" alt="dmn manage data types blank"/></div></div></div></li><li class="listitem"><p class="simpara">
							Continuing with this example, return to the <span class="strong strong"><strong>Data Types</strong></span> window, click <span class="strong strong"><strong>New Data Type</strong></span>, and create a <span class="strong strong"><strong>Loan_Qualification</strong></span> data type as a <code class="literal">Structure</code> with no constraints.
						</p><p class="simpara">
							When you save the new structured data type, the first sub-field appears so that you can begin defining nested data fields in this parent data type. You can use these sub-fields in association with the parent structured data type in boxed expressions, such as nested column headers in decision tables or nested table parameters in context or function expressions.
						</p><p class="simpara">
							For additional sub-fields, select the addition icon next to the <span class="strong strong"><strong>Loan_Qualification</strong></span> data type:
						</p><div class="figure" id="idm139921846314640"><p class="title"><strong>Figure 5.32. Adding a new structured data type with nested fields</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-manage-data-types-structured.png" alt="dmn manage data types structured"/></div></div></div></li><li class="listitem"><p class="simpara">
							For this example, under the structured <span class="strong strong"><strong>Loan_Qualification</strong></span> data type, add a <span class="strong strong"><strong>Qualification</strong></span> field with <code class="literal">"Qualified"</code> and <code class="literal">"Not Qualified"</code> enumeration constraints, and a <span class="strong strong"><strong>Reason</strong></span> field with no constraints. Add also a simple <span class="strong strong"><strong>Back_End_Ratio</strong></span> and a <span class="strong strong"><strong>Front_End_Ratio</strong></span> data type, both with <code class="literal">"Sufficient"</code> and <code class="literal">"Insufficient"</code> enumeration constraints.
						</p><p class="simpara">
							Click the check mark to the right of each data type that you create to save your changes.
						</p><div class="figure" id="idm139921834048688"><p class="title"><strong>Figure 5.33. Adding nested data types with constraints</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-manage-data-types-structured2.png" alt="dmn manage data types structured2"/></div></div></div><p class="simpara">
							To change the order or nesting of data types, you can click the left end of the data type row and drag the row as needed:
						</p><div class="figure" id="idm139921834044176"><p class="title"><strong>Figure 5.34. Dragging data types to change data type order or nesting</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-manage-data-types-structured2-drag.png" alt="dmn manage data types structured2 drag"/></div></div></div></li><li class="listitem"><p class="simpara">
							Return to the decision table and, for each column, click the column header cell, set the data type to the new corresponding custom data type, and define the rule values as needed for the column with the constraints that you specified, if applicable.
						</p><div class="figure" id="idm139921830229872"><p class="title"><strong>Figure 5.35. Decision table for loan prequalification</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-decision-table-example3.png" alt="dmn decision table example3"/></div></div></div></li></ol></div><p>
					For boxed expression types other than decision tables, you follow these guidelines similarly to navigate the boxed expression tables and define custom data types as needed.
				</p><p>
					For example, the following boxed function expression uses custom <code class="literal">tCandidate</code> and <code class="literal">tProfile</code> structured data types to associate data for online dating compatibility:
				</p><div class="figure" id="idm139921829051440"><p class="title"><strong>Figure 5.36. Boxed function expression for online dating compatibility</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-manage-data-types-structured3.png" alt="dmn manage data types structured3"/></div></div></div><div class="figure" id="idm139921831999488"><p class="title"><strong>Figure 5.37. Custom data type definitions for online dating compatibility</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-manage-data-types-structured3a.png" alt="dmn manage data types structured3a"/></div></div></div><div class="figure" id="idm139921831995568"><p class="title"><strong>Figure 5.38. Parameter definitions with custom data types for online dating compatibility</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-manage-data-types-structured3b.png" alt="dmn manage data types structured3b"/></div></div></div></section><section class="section" id="dmn-included-models-con_dmn-models"><div class="titlepage"><div><div><h2 class="title">5.3. Included models in DMN files in Business Central</h2></div></div></div><p>
					In the DMN designer in Business Central, you can use the <span class="strong strong"><strong>Included Models</strong></span> tab to include other DMN models and Predictive Model Markup Language (PMML) models from your project in a specified DMN file. When you include a DMN model within another DMN file, you can use all of the nodes and logic from both models in the same decision requirements diagram (DRD). When you include a PMML model within a DMN file, you can invoke that PMML model as a boxed function expression for a DMN decision node or business knowledge model node.
				</p><p>
					You cannot include DMN or PMML models from other projects in Business Central.
				</p><section class="section" id="dmn-included-models-dmn-proc_dmn-models"><div class="titlepage"><div><div><h3 class="title">5.3.1. Including other DMN models within a DMN file in Business Central</h3></div></div></div><p>
						In Business Central, you can include other DMN models from your project in a specified DMN file. When you include a DMN model within another DMN file, you can use all of the nodes and logic from both models in the same decision requirements diagram (DRD), but you cannot edit the nodes from the included model. To edit nodes from included models, you must update the source file for the included model directly. If you update the source file for an included DMN model, open the DMN file where the DMN model is included (or close an re-open) to verify the changes.
					</p><p>
						You cannot include DMN models from other projects in Business Central.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								The DMN models are created or imported (as <code class="literal">.dmn</code> files) in the same project in Business Central as the DMN file in which you want to include the models.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span>, click the project name, and select the DMN file you want to modify.
							</li><li class="listitem">
								In the DMN designer, click the <span class="strong strong"><strong>Included Models</strong></span> tab.
							</li><li class="listitem"><p class="simpara">
								Click <span class="strong strong"><strong>Include Model</strong></span>, select a DMN model from your project in the <span class="strong strong"><strong>Models</strong></span> list, enter a unique name for the included model, and click <span class="strong strong"><strong>Include</strong></span>:
							</p><div class="figure" id="idm139921849314192"><p class="title"><strong>Figure 5.39. Including a DMN model</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-include-model.png" alt="dmn include model"/></div></div></div><p class="simpara">
								The DMN model is added to this DMN file, and all DRD nodes from the included model are listed under <span class="strong strong"><strong>Decision Components</strong></span> in the <span class="strong strong"><strong>Decision Navigator</strong></span> view:
							</p><div class="figure" id="idm139921836907792"><p class="title"><strong>Figure 5.40. DMN file with decision components from the included DMN model</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-include-model-list.png" alt="dmn include model list"/></div></div></div><p class="simpara">
								All data types from the included model are also listed in read-only mode in the <span class="strong strong"><strong>Data Types</strong></span> tab for the DMN file:
							</p><div class="figure" id="idm139921846107888"><p class="title"><strong>Figure 5.41. DMN file with data types from the included DMN model</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-include-model-data-types.png" alt="dmn include model data types"/></div></div></div></li><li class="listitem"><p class="simpara">
								In the <span class="strong strong"><strong>Model</strong></span> tab of the DMN designer, click and drag the included DRD components onto the canvas to begin implementing them in your DRD:
							</p><div class="figure" id="idm139921830870208"><p class="title"><strong>Figure 5.42. Adding DRD components from the included DMN model</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-include-model-drd.png" alt="dmn include model drd"/></div></div></div><p class="simpara">
								To edit DRD nodes or data types from included models, you must update the source file for the included model directly. If you update the source file for an included DMN model, open the DMN file where the DMN model is included (or close an re-open) to verify the changes.
							</p><p class="simpara">
								To edit the included model name or to remove the included model from the DMN file, use the <span class="strong strong"><strong>Included Models</strong></span> tab in the DMN designer.
							</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
									When you remove an included model, any nodes from that included model that are currently used in the DRD are also removed.
								</p></div></div></li></ol></div></section><section class="section" id="dmn-included-models-pmml-proc_dmn-models"><div class="titlepage"><div><div><h3 class="title">5.3.2. Including PMML models within a DMN file in Business Central</h3></div></div></div><p>
						In Business Central, you can include Predictive Model Markup Language (PMML) models from your project in a specified DMN file. When you include a PMML model within a DMN file, you can invoke that PMML model as a boxed function expression for a DMN decision node or business knowledge model node. If you update the source file for an included PMML model, you must remove and re-include the PMML model in the DMN file to apply the source changes.
					</p><p>
						You cannot include PMML models from other projects in Business Central.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								The PMML models are imported (as <code class="literal">.pmml</code> files) in the same project in Business Central as the DMN file in which you want to include the models.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								In your DMN project, add the following dependencies to the project <code class="literal">pom.xml</code> file to enable PMML evaluation:
							</p><pre class="programlisting language-xml">&lt;!-- Required for the PMML compiler --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.drools&lt;/groupId&gt;
  &lt;artifactId&gt;kie-pmml&lt;/artifactId&gt;
  &lt;version&gt;${rhpam.version}&lt;/version&gt;
  &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;

&lt;!-- Alternative dependencies for JPMML Evaluator, override `kie-pmml` dependency --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-dmn-jpmml&lt;/artifactId&gt;
  &lt;version&gt;${rhpam.version}&lt;/version&gt;
  &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.jpmml&lt;/groupId&gt;
  &lt;artifactId&gt;pmml-evaluator&lt;/artifactId&gt;
  &lt;version&gt;1.5.1&lt;/version&gt;
  &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.jpmml&lt;/groupId&gt;
  &lt;artifactId&gt;pmml-evaluator-extension&lt;/artifactId&gt;
  &lt;version&gt;1.5.1&lt;/version&gt;
  &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;</pre><p class="simpara">
								To access the project <code class="literal">pom.xml</code> file in Business Central, you can select any existing asset in the project and then in the <span class="strong strong"><strong>Project Explorer</strong></span> menu on the left side of the screen, click the <span class="strong strong"><strong>Customize View</strong></span> gear icon and select <span class="strong strong"><strong>Repository View</strong></span> → <span class="strong strong"><strong>pom.xml</strong></span>.
							</p><p class="simpara">
								If you want to use the full PMML specification implementation with the Java Evaluator API for PMML (JPMML), use the alternative set of JPMML dependencies in your DMN project. If the JPMML dependencies and the standard <code class="literal">kie-pmml</code> dependency are both present, the <code class="literal">kie-pmml</code> dependency is disabled. For information about JPMML licensing terms, see <a class="link" href="https://openscoring.io/">Openscoring.io</a>.
							</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
									The legacy <code class="literal">kie-pmml</code> dependency is deprecated with Red Hat Process Automation Manager 7.10.0 and will be replaced by <code class="literal">kie-pmml-trusty</code> dependency in a future Red Hat Process Automation Manager release.
								</p></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Instead of specifying a Red Hat Process Automation Manager <code class="literal">&lt;version&gt;</code> for individual dependencies, consider adding the Red Hat Business Automation bill of materials (BOM) dependency to your project <code class="literal">pom.xml</code> file. The Red Hat Business Automation BOM applies to both Red Hat Decision Manager and Red Hat Process Automation Manager. When you add the BOM files, the correct versions of transitive dependencies from the provided Maven repositories are included in the project.
								</p><p>
									Example BOM dependency:
								</p><pre class="programlisting language-xml">&lt;dependency&gt;
  &lt;groupId&gt;com.redhat.ba&lt;/groupId&gt;
  &lt;artifactId&gt;ba-platform-bom&lt;/artifactId&gt;
  &lt;version&gt;7.10.0.redhat-00002&lt;/version&gt;
  &lt;scope&gt;import&lt;/scope&gt;
  &lt;type&gt;pom&lt;/type&gt;
&lt;/dependency&gt;</pre><p>
									For more information about the Red Hat Business Automation BOM, see <a class="link" href="https://access.redhat.com/solutions/3405361">What is the mapping between RHPAM product and maven library version?</a>.
								</p></div></div></li><li class="listitem"><p class="simpara">
								If you added the JPMML dependencies in your DMN project to use the JPMML Evaluator, download the following JAR files and add them to the <code class="literal">~/kie-server.war/WEB-INF/lib</code> and <code class="literal">~/business-central.war/WEB-INF/lib</code> directories in your Red Hat Process Automation Manager distribution:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal">kie-dmn-jpmml</code> JAR file in the <span class="strong strong"><strong>Red Hat Process Automation Manager 7.10.0 Maven Repository</strong></span> distribution (<code class="literal">rhpam-7.10.0-maven-repository/maven-repository/org/kie/kie-dmn-jpmml/7.48.0.Final-redhat-00002/kie-dmn-jpmml-7.48.0.Final-redhat-00002.jar</code>) from the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html?downloadType=distributions&amp;product=rhpam&amp;version=7.10.0">Red Hat Customer Portal</a>
									</li><li class="listitem">
										<a class="link" href="https://mvnrepository.com/artifact/org.jpmml/pmml-evaluator/1.5.1">JPMML Evaluator 1.5.1</a> JAR file from the online Maven repository
									</li><li class="listitem">
										<a class="link" href="https://mvnrepository.com/artifact/org.jpmml/pmml-evaluator-extension/1.5.1">JPMML Evaluator Extensions 1.5.1</a> JAR file from the online Maven repository
									</li></ul></div><p class="simpara">
								These artifacts are required to enable JPMML evaluation in KIE Server and Business Central.
							</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
									Red Hat supports integration with the Java Evaluator API for PMML (JPMML) for PMML execution in Red Hat Process Automation Manager. However, Red Hat does not support the JPMML libraries directly. If you include JPMML libraries in your Red Hat Process Automation Manager distribution, see the <a class="link" href="https://openscoring.io/">Openscoring.io</a> licensing terms for JPMML.
								</p></div></div></li><li class="listitem">
								In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span>, click the project name, and select the DMN file you want to modify.
							</li><li class="listitem">
								In the DMN designer, click the <span class="strong strong"><strong>Included Models</strong></span> tab.
							</li><li class="listitem"><p class="simpara">
								Click <span class="strong strong"><strong>Include Model</strong></span>, select a PMML model from your project in the <span class="strong strong"><strong>Models</strong></span> list, enter a unique name for the included model, and click <span class="strong strong"><strong>Include</strong></span>:
							</p><div class="figure" id="idm139921832350944"><p class="title"><strong>Figure 5.43. Including a PMML model</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-include-model-pmml.png" alt="dmn include model pmml"/></div></div></div><p class="simpara">
								The PMML model is added to this DMN file:
							</p><div class="figure" id="idm139921834257920"><p class="title"><strong>Figure 5.44. DMN file with included PMML model</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-include-model-list-pmml.png" alt="dmn include model list pmml"/></div></div></div></li><li class="listitem"><p class="simpara">
								In the <span class="strong strong"><strong>Model</strong></span> tab of the DMN designer, select or create the decision node or business knowledge model node in which you want to invoke the PMML model and click the <span class="strong strong"><strong>Edit</strong></span> icon to open the DMN boxed expression designer:
							</p><div class="figure" id="idm139921837984240"><p class="title"><strong>Figure 5.45. Opening a new decision node boxed expression</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-decision-edit.png" alt="dmn decision edit"/></div></div></div><div class="figure" id="idm139921837980368"><p class="title"><strong>Figure 5.46. Opening a new business knowledge model boxed expression</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-bkm-edit.png" alt="dmn bkm edit"/></div></div></div></li><li class="listitem">
								Set the expression type to <span class="strong strong"><strong>Function</strong></span> (default for business knowledge model nodes), click the top-left function cell, and select <span class="strong strong"><strong>PMML</strong></span>.
							</li><li class="listitem"><p class="simpara">
								In the <span class="strong strong"><strong>document</strong></span> and <span class="strong strong"><strong>model</strong></span> rows in the table, double-click the undefined cells to specify the included PMML document and the relevant PMML model within that document:
							</p><div class="figure" id="idm139921834112496"><p class="title"><strong>Figure 5.47. Adding a PMML model in a DMN business knowledge model</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-include-model-expression-pmml.png" alt="dmn include model expression pmml"/></div></div></div><div class="figure" id="idm139921834108592"><p class="title"><strong>Figure 5.48. Example PMML definition in a DMN business knowledge model</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-function-expression-example5.png" alt="dmn function expression example5"/></div></div></div><p class="simpara">
								If you update the source file for an included PMML model, you must remove and re-include the PMML model in the DMN file to apply the source changes.
							</p><p class="simpara">
								To edit the included model name or to remove the included model from the DMN file, use the <span class="strong strong"><strong>Included Models</strong></span> tab in the DMN designer.
							</p></li></ol></div></section></section><section class="section" id="dmn-model-creating-multiples-proc_dmn-models"><div class="titlepage"><div><div><h2 class="title">5.4. Creating DMN models with multiple diagrams in Business Central</h2></div></div></div><p>
					For complex DMN models, you can use the DMN designer in Business Central to design multiple DMN decision requirements diagrams (DRDs) that represent parts of the overall decision requirements graph (DRG) for the DMN decision model. In simple cases, you can use a single DRD to represent all of the overall DRG for the decision model, but in complex cases, a single DRD can become large and difficult to follow. Therefore, to better organize DMN decision models with many decision requirements, you can divide the model into smaller nested DRDs that constitute the larger central DRD representation of the overall DRG.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You understand how to design DRDs in Business Central. For information about creating DRDs, see <a class="xref" href="#dmn-model-creating-proc_dmn-models" title="Chapter 5. Creating and editing DMN models in Business Central">Chapter 5, <em>Creating and editing DMN models in Business Central</em></a>.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In Business Central, navigate to your DMN project and create or import a DMN file in the project.
						</li><li class="listitem">
							Open the new or imported DMN file to view the DRD in the DMN designer, and begin designing or modifying the DRD using the DMN nodes in the left toolbar.
						</li><li class="listitem"><p class="simpara">
							For any DMN nodes that you want to define in a separate nested DRD, select the node, click the <span class="strong strong"><strong>DRD Actions</strong></span> icon, and select from the available options.
						</p><div class="figure" id="idm139921831207216"><p class="title"><strong>Figure 5.49. DRD actions icon for subdividing a DRD</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-drd-actions.png" alt="dmn drd actions"/></div></div></div><p class="simpara">
							The following options are available:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="strong strong"><strong>Create</strong></span>: Use this option to create a nested DRD where you can separately define the DMN components and diagram for the selected node.
								</li><li class="listitem">
									<span class="strong strong"><strong>Add to</strong></span>: If you already created a nested DRD, use this option to add the selected node to an existing DRD.
								</li><li class="listitem">
									<span class="strong strong"><strong>Remove</strong></span>: If the node that you selected is already within a nested DRD, use this option to remove the node from that nested DRD.
								</li></ul></div><p class="simpara">
							After you create a nested DRD within your DMN decision model, the new DRD opens in a separate DRD canvas and the available DRD and components are listed in the <span class="strong strong"><strong>Decision Navigator</strong></span> left menu. You can use the <span class="strong strong"><strong>Decision Navigator</strong></span> menu to rename or remove a nested DRD.
						</p><div class="figure" id="idm139921834825728"><p class="title"><strong>Figure 5.50. Rename new nested DRD in the Decision Navigator menu</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-drd-actions-rename.png" alt="dmn drd actions rename"/></div></div></div></li><li class="listitem">
							In the separate canvas for the new nested DRD, design the flow and logic for all required components in this portion of the DMN model, as usual.
						</li><li class="listitem"><p class="simpara">
							Continue adding and defining any other nested DRDs for your decision model and save the completed DMN file.
						</p><p class="simpara">
							For example, the following DRD for a loan prequalification decision model contains all DMN components for the model without any nested DRDs. This example relies on the single DRD for all components and logic, resulting in a large and complex diagram.
						</p><div class="figure" id="idm139921843418784"><p class="title"><strong>Figure 5.51. Single DRD for loan prequalification</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-example-drd.png" alt="dmn example drd"/></div></div></div><p class="simpara">
							Alternatively, by following the steps in this procedure, you can divide this example DRD into multiple nested DRDs to better organize the decision requirements, as shown in the following example:
						</p><div class="figure" id="idm139921835968160"><p class="title"><strong>Figure 5.52. Multiple nested DRDs for loan prequalification</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-drd-multiple.png" alt="dmn drd multiple"/></div></div></div><div class="figure" id="idm139921835964304"><p class="title"><strong>Figure 5.53. Overview of front end ratio DRD</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-drd-multiple-front-end.png" alt="dmn drd multiple front end"/></div></div></div><div class="figure" id="idm139921854947984"><p class="title"><strong>Figure 5.54. DRD for front end ratio</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-drd-multiple-front-end-details.png" alt="dmn drd multiple front end details"/></div></div></div><div class="figure" id="idm139921847052112"><p class="title"><strong>Figure 5.55. Overview of credit score rating DRD</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-drd-multiple-credit-score.png" alt="dmn drd multiple credit score"/></div></div></div><div class="figure" id="idm139921847048240"><p class="title"><strong>Figure 5.56. DRD for credit score rating</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-drd-multiple-credit-score-details.png" alt="dmn drd multiple credit score details"/></div></div></div><div class="figure" id="idm139921843742192"><p class="title"><strong>Figure 5.57. Overview of back end ratio DRD</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-drd-multiple-back-end.png" alt="dmn drd multiple back end"/></div></div></div><div class="figure" id="idm139921843738320"><p class="title"><strong>Figure 5.58. DRD for back end ratio</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-drd-multiple-back-end-details.png" alt="dmn drd multiple back end details"/></div></div></div></li></ol></div></section><section class="section" id="dmn-documentation-con_dmn-models"><div class="titlepage"><div><div><h2 class="title">5.5. DMN model documentation in Business Central</h2></div></div></div><p>
					In the DMN designer in Business Central, you can use the <span class="strong strong"><strong>Documentation</strong></span> tab to generate a report of your DMN model that you can print or download as an HTML file for offline use. The DMN model report contains all decision requirements diagrams (DRDs), data types, and boxed expressions in your DMN model. You can use this report to share your DMN model details or as part of your internal reporting workflow.
				</p><div class="figure" id="idm139921840380064"><p class="title"><strong>Figure 5.59. Example DMN model report</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-documentation.png" alt="dmn documentation"/></div></div></div></section><section class="section" id="dmn-designer-nav-ref_dmn-models"><div class="titlepage"><div><div><h2 class="title">5.6. DMN designer navigation and properties in Business Central</h2></div></div></div><p>
					The DMN designer in Business Central provides the following additional features to help you navigate through the components and properties of decision requirements diagrams (DRDs).
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">DMN file and diagram views</span></dt><dd><p class="simpara">
								In the upper-left corner of the DMN designer, select the <span class="strong strong"><strong>Project Explorer</strong></span> view to navigate between all DMN and other files or select the <span class="strong strong"><strong>Decision Navigator</strong></span> view to navigate between the decision components, graphs, and boxed expressions of a selected DRD:
							</p><div class="figure" id="idm139921828396288"><p class="title"><strong>Figure 5.60. Project Explorer view</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-designer-project-view.png" alt="dmn designer project view"/></div></div></div><div class="figure" id="idm139921828392432"><p class="title"><strong>Figure 5.61. Decision Navigator view</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-designer-nav-view.png" alt="dmn designer nav view"/></div></div></div><div class="informalfigure"><div class="mediaobject"><img src="images/_images/dmn/dmn-designer-nav-view2.png" alt="dmn designer nav view2"/></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									The DRD components from any DMN models included in the DMN file (in the <span class="strong strong"><strong>Included Models</strong></span> tab) are also listed in the <span class="strong strong"><strong>Decision Components</strong></span> panel for the DMN file.
								</p></div></div><p class="simpara">
								In the upper-right corner of the DMN designer, select the <span class="strong strong"><strong>Explore diagram</strong></span> icon to view an elevated preview of the selected DRD and to navigate between the nodes of the selected DRD:
							</p><div class="figure" id="idm139921813799008"><p class="title"><strong>Figure 5.62. Explore diagram view</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-designer-preview.png" alt="dmn designer preview"/></div></div></div></dd><dt><span class="term">DRD properties and design</span></dt><dd><p class="simpara">
								In the upper-right corner of the DMN designer, select the <span class="strong strong"><strong>Properties</strong></span> icon to modify the identifying information, data types, and appearance of a selected DRD, DRD node, or boxed expression cell:
							</p><div class="figure" id="idm139921852482496"><p class="title"><strong>Figure 5.63. DRD node properties</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-designer-properties.png" alt="dmn designer properties"/></div></div></div><p class="simpara">
								To view the properties of the entire DRD, click the DRD canvas background instead of a specific node.
							</p></dd><dt><span class="term">DRD search</span></dt><dd><p class="simpara">
								In the upper-right corner of the DMN designer, use the search bar to search for text that appears in your DRD. The search feature is especially helpful in complex DRDs with many nodes:
							</p><div class="figure" id="idm139921832745536"><p class="title"><strong>Figure 5.64. DRD search</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/dmn/dmn-designer-search.png" alt="dmn designer search"/></div></div></div></dd></dl></div></section></section><section class="chapter" id="dmn-execution-con_dmn-models"><div class="titlepage"><div><div><h2 class="title">Chapter 6. DMN model execution</h2></div></div></div><p>
				You can create or import DMN files in your Red Hat Process Automation Manager project using Business Central or package the DMN files as part of your project knowledge JAR (KJAR) file without Business Central. After you implement your DMN files in your Red Hat Process Automation Manager project, you can execute the DMN decision service by deploying the KIE container that contains it to KIE Server for remote access or by manipulating the KIE container directly as a dependency of the calling application. Other options for creating and deploying DMN knowledge packages are also available, and most are similar for all types of knowledge assets, such as DRL files or process definitions.
			</p><p>
				For information about including external DMN assets with your project packaging and deployment method, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>.
			</p><section class="section" id="dmn-execution-embedded-proc"><div class="titlepage"><div><div><h2 class="title">6.1. Embedding a DMN call directly in a Java application</h2></div></div></div><p>
					A KIE container is local when the knowledge assets are either embedded directly into the calling program or are physically pulled in using Maven dependencies for the KJAR. You typically embed knowledge assets directly into a project if there is a tight relationship between the version of the code and the version of the DMN definition. Any changes to the decision take effect after you have intentionally updated and redeployed the application. A benefit of this approach is that proper operation does not rely on any external dependencies to the run time, which can be a limitation of locked-down environments.
				</p><p>
					Using Maven dependencies enables further flexibility because the specific version of the decision can dynamically change, (for example, by using a system property), and it can be periodically scanned for updates and automatically updated. This introduces an external dependency on the deploy time of the service, but executes the decision locally, reducing reliance on an external service being available during run time.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							You have built the DMN project as a KJAR artifact and deployed it to a Maven repository, or you have included your DMN assets as part of your project classpath. Ideally, you have built the DMN project as an executable model for more efficient execution:
						</p><pre class="screen">mvn clean install -DgenerateDMNModel=yes</pre><p class="simpara">
							For more information about project packaging and deployment and executable models, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>.
						</p></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							In your client application, add the following dependencies to the relevant classpath of your Java project:
						</p><pre class="programlisting language-xml">&lt;!-- Required for the DMN runtime API --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-dmn-core&lt;/artifactId&gt;
  &lt;version&gt;${rhpam.version}&lt;/version&gt;
&lt;/dependency&gt;

&lt;!-- Required if not using classpath KIE container --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-ci&lt;/artifactId&gt;
  &lt;version&gt;${rhpam.version}&lt;/version&gt;
&lt;/dependency&gt;</pre><p class="simpara">
							The <code class="literal">&lt;version&gt;</code> is the Maven artifact version for Red Hat Process Automation Manager currently used in your project (for example, 7.48.0.Final-redhat-00002).
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Instead of specifying a Red Hat Process Automation Manager <code class="literal">&lt;version&gt;</code> for individual dependencies, consider adding the Red Hat Business Automation bill of materials (BOM) dependency to your project <code class="literal">pom.xml</code> file. The Red Hat Business Automation BOM applies to both Red Hat Decision Manager and Red Hat Process Automation Manager. When you add the BOM files, the correct versions of transitive dependencies from the provided Maven repositories are included in the project.
							</p><p>
								Example BOM dependency:
							</p><pre class="programlisting language-xml">&lt;dependency&gt;
  &lt;groupId&gt;com.redhat.ba&lt;/groupId&gt;
  &lt;artifactId&gt;ba-platform-bom&lt;/artifactId&gt;
  &lt;version&gt;7.10.0.redhat-00002&lt;/version&gt;
  &lt;scope&gt;import&lt;/scope&gt;
  &lt;type&gt;pom&lt;/type&gt;
&lt;/dependency&gt;</pre><p>
								For more information about the Red Hat Business Automation BOM, see <a class="link" href="https://access.redhat.com/solutions/3405361">What is the mapping between RHPAM product and maven library version?</a>.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Create a KIE container from <code class="literal">classpath</code> or <code class="literal">ReleaseId</code>:
						</p><pre class="programlisting language-java">KieServices kieServices = KieServices.Factory.get();

ReleaseId releaseId = kieServices.newReleaseId( "org.acme", "my-kjar", "1.0.0" );
KieContainer kieContainer = kieServices.newKieContainer( releaseId );</pre><p class="simpara">
							Alternative option:
						</p><pre class="programlisting language-java">KieServices kieServices = KieServices.Factory.get();

KieContainer kieContainer = kieServices.getKieClasspathContainer();</pre></li><li class="listitem"><p class="simpara">
							Obtain <code class="literal">DMNRuntime</code> from the KIE container and a reference to the DMN model to be evaluated, by using the model <code class="literal">namespace</code> and <code class="literal">modelName</code>:
						</p><pre class="programlisting language-java">DMNRuntime dmnRuntime = KieRuntimeFactory.of(kieContainer.getKieBase()).get(DMNRuntime.class);

String namespace = "http://www.redhat.com/_c7328033-c355-43cd-b616-0aceef80e52a";
String modelName = "dmn-movieticket-ageclassification";

DMNModel dmnModel = dmnRuntime.getModel(namespace, modelName);</pre></li><li class="listitem"><p class="simpara">
							Execute the decision services for the desired model:
						</p><pre class="programlisting language-java">DMNContext dmnContext = dmnRuntime.newContext();  <span id="CO1-1"/><span class="callout">1</span>

for (Integer age : Arrays.asList(1,12,13,64,65,66)) {
    dmnContext.set("Age", age);  <span id="CO1-2"/><span class="callout">2</span>
    DMNResult dmnResult =
        dmnRuntime.evaluateAll(dmnModel, dmnContext);  <span id="CO1-3"/><span class="callout">3</span>

    for (DMNDecisionResult dr : dmnResult.getDecisionResults()) {  <span id="CO1-4"/><span class="callout">4</span>
        log.info("Age: " + age + ", " +
                 "Decision: '" + dr.getDecisionName() + "', " +
                 "Result: " + dr.getResult());
  }
}</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO1-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Instantiate a new DMN Context to be the input for the model evaluation. Note that this example is looping through the Age Classification decision multiple times.
								</div></dd><dt><a href="#CO1-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Assign input variables for the input DMN context.
								</div></dd><dt><a href="#CO1-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									Evaluate all DMN decisions defined in the DMN model.
								</div></dd><dt><a href="#CO1-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									Each evaluation may result in one or more results, creating the loop.
								</div></dd></dl></div><p class="simpara">
							This example prints the following output:
						</p><pre class="screen">Age 1 Decision 'AgeClassification' : Child
Age 12 Decision 'AgeClassification' : Child
Age 13 Decision 'AgeClassification' : Adult
Age 64 Decision 'AgeClassification' : Adult
Age 65 Decision 'AgeClassification' : Senior
Age 66 Decision 'AgeClassification' : Senior</pre><p class="simpara">
							If the DMN model was not previously compiled as an executable model for more efficient execution, you can enable the following property when you execute your DMN models:
						</p><pre class="screen">-Dorg.kie.dmn.compiler.execmodel=true</pre></li></ol></div></section><section class="section" id="dmn-execution-remote-java-proc"><div class="titlepage"><div><div><h2 class="title">6.2. Executing a DMN service using the KIE Server Java client API</h2></div></div></div><p>
					The KIE Server Java client API provides a lightweight approach to invoking a remote DMN service either through the REST or JMS interfaces of KIE Server. This approach reduces the number of runtime dependencies necessary to interact with a KIE base. Decoupling the calling code from the decision definition also increases flexibility by enabling them to iterate independently at the appropriate pace.
				</p><p>
					For more information about the KIE Server Java client API, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-kie-apis"><span class="emphasis"><em>Interacting with Red Hat Process Automation Manager using KIE APIs</em></span></a>.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							KIE Server is installed and configured, including a known user name and credentials for a user with the <code class="literal">kie-server</code> role. For installation options, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/installing_and_configuring_red_hat_process_automation_manager#assembly-planning"><span class="emphasis"><em>Planning a Red Hat Process Automation Manager installation</em></span></a>.
						</li><li class="listitem"><p class="simpara">
							You have built the DMN project as a KJAR artifact and deployed it to KIE Server. Ideally, you have built the DMN project as an executable model for more efficient execution:
						</p><pre class="screen">mvn clean install -DgenerateDMNModel=yes</pre><p class="simpara">
							For more information about project packaging and deployment and executable models, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>.
						</p></li><li class="listitem">
							You have the ID of the KIE container containing the DMN model. If more than one model is present, you must also know the model namespace and model name of the relevant model.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							In your client application, add the following dependency to the relevant classpath of your Java project:
						</p><pre class="programlisting language-xml">&lt;!-- Required for the KIE Server Java client API --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie.server&lt;/groupId&gt;
  &lt;artifactId&gt;kie-server-client&lt;/artifactId&gt;
  &lt;version&gt;${rhpam.version}&lt;/version&gt;
&lt;/dependency&gt;</pre><p class="simpara">
							The <code class="literal">&lt;version&gt;</code> is the Maven artifact version for Red Hat Process Automation Manager currently used in your project (for example, 7.48.0.Final-redhat-00002).
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Instead of specifying a Red Hat Process Automation Manager <code class="literal">&lt;version&gt;</code> for individual dependencies, consider adding the Red Hat Business Automation bill of materials (BOM) dependency to your project <code class="literal">pom.xml</code> file. The Red Hat Business Automation BOM applies to both Red Hat Decision Manager and Red Hat Process Automation Manager. When you add the BOM files, the correct versions of transitive dependencies from the provided Maven repositories are included in the project.
							</p><p>
								Example BOM dependency:
							</p><pre class="programlisting language-xml">&lt;dependency&gt;
  &lt;groupId&gt;com.redhat.ba&lt;/groupId&gt;
  &lt;artifactId&gt;ba-platform-bom&lt;/artifactId&gt;
  &lt;version&gt;7.10.0.redhat-00002&lt;/version&gt;
  &lt;scope&gt;import&lt;/scope&gt;
  &lt;type&gt;pom&lt;/type&gt;
&lt;/dependency&gt;</pre><p>
								For more information about the Red Hat Business Automation BOM, see <a class="link" href="https://access.redhat.com/solutions/3405361">What is the mapping between RHPAM product and maven library version?</a>.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Instantiate a <code class="literal">KieServicesClient</code> instance with the appropriate connection information.
						</p><p class="simpara">
							Example:
						</p><pre class="programlisting language-java">KieServicesConfiguration conf =
    KieServicesFactory.newRestConfiguration(URL, USER, PASSWORD); <span id="CO2-1"/><span class="callout">1</span>

conf.setMarshallingFormat(MarshallingFormat.JSON);  <span id="CO2-2"/><span class="callout">2</span>

KieServicesClient kieServicesClient = KieServicesFactory.newKieServicesClient(conf);</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO2-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									The connection information:
								</div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Example URL: <code class="literal">http://localhost:8080/kie-server/services/rest/server</code>
										</li><li class="listitem">
											The credentials should reference a user with the <code class="literal">kie-server</code> role.
										</li></ul></div></dd><dt><a href="#CO2-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									The Marshalling format is an instance of <code class="literal">org.kie.server.api.marshalling.MarshallingFormat</code>. It controls whether the messages will be JSON or XML. Options for Marshalling format are JSON, JAXB, or XSTREAM.
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Obtain a <code class="literal">DMNServicesClient</code> from the KIE server Java client connected to the related KIE Server by invoking the method <code class="literal">getServicesClient()</code> on the KIE server Java client instance:
						</p><pre class="programlisting language-java">DMNServicesClient dmnClient = kieServicesClient.getServicesClient(DMNServicesClient.class );</pre><p class="simpara">
							The <code class="literal">dmnClient</code> can now execute decision services on KIE Server.
						</p></li><li class="listitem"><p class="simpara">
							Execute the decision services for the desired model.
						</p><p class="simpara">
							Example:
						</p><pre class="programlisting language-java">for (Integer age : Arrays.asList(1,12,13,64,65,66)) {
    DMNContext dmnContext = dmnClient.newContext(); <span id="CO3-1"/><span class="callout">1</span>
    dmnContext.set("Age", age);  <span id="CO3-2"/><span class="callout">2</span>
    ServiceResponse&lt;DMNResult&gt; serverResp =   <span id="CO3-3"/><span class="callout">3</span>
        dmnClient.evaluateAll($kieContainerId,
                              $modelNamespace,
                              $modelName,
                              dmnContext);

    DMNResult dmnResult = serverResp.getResult();  <span id="CO3-4"/><span class="callout">4</span>
    for (DMNDecisionResult dr : dmnResult.getDecisionResults()) {
        log.info("Age: " + age + ", " +
                 "Decision: '" + dr.getDecisionName() + "', " +
                 "Result: " + dr.getResult());
    }
}</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO3-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Instantiate a new DMN Context to be the input for the model evaluation. Note that this example is looping through the Age Classification decision multiple times.
								</div></dd><dt><a href="#CO3-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Assign input variables for the input DMN Context.
								</div></dd><dt><a href="#CO3-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									Evaluate all the DMN Decisions defined in the DMN model:
								</div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											<code class="literal">$kieContainerId</code> is the ID of the container where the KJAR containing the DMN model is deployed
										</li><li class="listitem">
											<code class="literal">$modelNamespace</code> is the namespace for the model.
										</li><li class="listitem">
											<code class="literal">$modelName</code> is the name for the model.
										</li></ul></div></dd><dt><a href="#CO3-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									The DMN Result object is available from the server response.
								</div></dd></dl></div><p class="simpara">
							At this point, the <code class="literal">dmnResult</code> contains all the decision results from the evaluated DMN model.
						</p><p class="simpara">
							You can also execute only a specific DMN decision in the model by using alternative methods of the <code class="literal">DMNServicesClient</code>.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								If the KIE container only contains one DMN model, you can omit <code class="literal">$modelNamespace</code> and <code class="literal">$modelName</code> because the KIE Server API selects it by default.
							</p></div></div></li></ol></div></section><section class="section" id="dmn-execution-rest-proc_dmn-models"><div class="titlepage"><div><div><h2 class="title">6.3. Executing a DMN service using the KIE Server REST API</h2></div></div></div><p>
					Directly interacting with the REST endpoints of KIE Server provides the most separation between the calling code and the decision logic definition. The calling code is completely free of direct dependencies, and you can implement it in an entirely different development platform such as <code class="literal">Node.js</code> or <code class="literal">.NET</code>. The examples in this section demonstrate Nix-style curl commands but provide relevant information to adapt to any REST client.
				</p><p>
					For more information about the KIE Server REST API, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-kie-apis"><span class="emphasis"><em>Interacting with Red Hat Process Automation Manager using KIE APIs</em></span></a>.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							KIE Server is installed and configured, including a known user name and credentials for a user with the <code class="literal">kie-server</code> role. For installation options, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/installing_and_configuring_red_hat_process_automation_manager#assembly-planning"><span class="emphasis"><em>Planning a Red Hat Process Automation Manager installation</em></span></a>.
						</li><li class="listitem"><p class="simpara">
							You have built the DMN project as a KJAR artifact and deployed it to KIE Server. Ideally, you have built the DMN project as an executable model for more efficient execution:
						</p><pre class="screen">mvn clean install -DgenerateDMNModel=yes</pre><p class="simpara">
							For more information about project packaging and deployment and executable models, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>.
						</p></li><li class="listitem">
							You have the ID of the KIE container containing the DMN model. If more than one model is present, you must also know the model namespace and model name of the relevant model.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Determine the base URL for accessing the KIE Server REST API endpoints. This requires knowing the following values (with the default local deployment values as an example):
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Host (<code class="literal">localhost</code>)
								</li><li class="listitem">
									Port (<code class="literal">8080</code>)
								</li><li class="listitem">
									Root context (<code class="literal">kie-server</code>)
								</li><li class="listitem">
									Base REST path (<code class="literal">services/rest/</code>)
								</li></ul></div><p class="simpara">
							Example base URL in local deployment:
						</p><p class="simpara">
							<code class="literal">http://localhost:8080/kie-server/services/rest/</code>
						</p></li><li class="listitem"><p class="simpara">
							Determine user authentication requirements.
						</p><p class="simpara">
							When users are defined directly in the KIE Server configuration, HTTP Basic authentication is used and requires the user name and password. Successful requests require that the user have the <code class="literal">kie-server</code> role.
						</p><p class="simpara">
							The following example demonstrates how to add credentials to a curl request:
						</p><pre class="screen">curl -u username:password &lt;request&gt;</pre><p class="simpara">
							If KIE Server is configured with Red Hat Single Sign-On, the request must include a bearer token:
						</p><pre class="programlisting language-java">curl -H "Authorization: bearer $TOKEN" &lt;request&gt;</pre></li><li class="listitem"><p class="simpara">
							Specify the format of the request and response. The REST API endpoints work with both JSON and XML formats and are set using request headers:
						</p><div class="formalpara"><p class="title"><strong>JSON</strong></p><p>
								
<pre class="screen">curl -H "accept: application/json" -H "content-type: application/json"</pre>
							</p></div><div class="formalpara"><p class="title"><strong>XML</strong></p><p>
								
<pre class="screen">curl -H "accept: application/xml" -H "content-type: application/xml"</pre>
							</p></div></li><li class="listitem"><p class="simpara">
							Optional: Query the container for a list of deployed decision models:
						</p><p class="simpara">
							<span class="strong strong"><strong>[GET]</strong></span> <code class="literal">server/containers/{containerId}/dmn</code>
						</p><p class="simpara">
							Example curl request:
						</p><pre class="screen">curl -u krisv:krisv -H "accept: application/xml" -X GET "http://localhost:8080/kie-server/services/rest/server/containers/MovieDMNContainer/dmn"</pre><p class="simpara">
							Sample XML output:
						</p><pre class="programlisting language-xml">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;
&lt;response type="SUCCESS" msg="OK models successfully retrieved from container 'MovieDMNContainer'"&gt;
    &lt;dmn-model-info-list&gt;
        &lt;model&gt;
            &lt;model-namespace&gt;http://www.redhat.com/_c7328033-c355-43cd-b616-0aceef80e52a&lt;/model-namespace&gt;
            &lt;model-name&gt;dmn-movieticket-ageclassification&lt;/model-name&gt;
            &lt;model-id&gt;_99&lt;/model-id&gt;
            &lt;decisions&gt;
                &lt;dmn-decision-info&gt;
                    &lt;decision-id&gt;_3&lt;/decision-id&gt;
                    &lt;decision-name&gt;AgeClassification&lt;/decision-name&gt;
                &lt;/dmn-decision-info&gt;
            &lt;/decisions&gt;
        &lt;/model&gt;
    &lt;/dmn-model-info-list&gt;
&lt;/response&gt;</pre><p class="simpara">
							Sample JSON output:
						</p><pre class="programlisting language-json">{
  "type" : "SUCCESS",
  "msg" : "OK models successfully retrieved from container 'MovieDMNContainer'",
  "result" : {
    "dmn-model-info-list" : {
      "models" : [ {
        "model-namespace" : "http://www.redhat.com/_c7328033-c355-43cd-b616-0aceef80e52a",
        "model-name" : "dmn-movieticket-ageclassification",
        "model-id" : "_99",
        "decisions" : [ {
          "decision-id" : "_3",
          "decision-name" : "AgeClassification"
        } ]
      } ]
    }
  }
}</pre></li><li class="listitem"><p class="simpara">
							Execute the model:
						</p><p class="simpara">
							<span class="strong strong"><strong>[POST]</strong></span> <code class="literal">server/containers/{containerId}/dmn</code>
						</p><p class="simpara">
							Example curl request:
						</p><pre class="screen">curl -u krisv:krisv -H "accept: application/json" -H "content-type: application/json" -X POST "http://localhost:8080/kie-server/services/rest/server/containers/MovieDMNContainer/dmn" -d "{ \"model-namespace\" : \"http://www.redhat.com/_c7328033-c355-43cd-b616-0aceef80e52a\", \"model-name\" : \"dmn-movieticket-ageclassification\", \"decision-name\" : [ ], \"decision-id\" : [ ], \"dmn-context\" : {\"Age\" : 66}}"</pre><p class="simpara">
							Example JSON request:
						</p><pre class="programlisting language-json">{
  "model-namespace" : "http://www.redhat.com/_c7328033-c355-43cd-b616-0aceef80e52a",
  "model-name" : "dmn-movieticket-ageclassification",
  "decision-name" : [ ],
  "decision-id" : [ ],
  "dmn-context" : {"Age" : 66}
}</pre><p class="simpara">
							Example XML request (JAXB format):
						</p><pre class="programlisting language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;dmn-evaluation-context&gt;
    &lt;model-namespace&gt;http://www.redhat.com/_c7328033-c355-43cd-b616-0aceef80e52a&lt;/model-namespace&gt;
    &lt;model-name&gt;dmn-movieticket-ageclassification&lt;/model-name&gt;
    &lt;dmn-context xsi:type="jaxbListWrapper" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
        &lt;type&gt;MAP&lt;/type&gt;
        &lt;element xsi:type="jaxbStringObjectPair" key="Age"&gt;
            &lt;value xsi:type="xs:int" xmlns:xs="http://www.w3.org/2001/XMLSchema"&gt;66&lt;/value&gt;
        &lt;/element&gt;
    &lt;/dmn-context&gt;
&lt;/dmn-evaluation-context&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Regardless of the request format, the request requires the following elements:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Model namespace
									</li><li class="listitem">
										Model name
									</li><li class="listitem">
										Context object containing input values
									</li></ul></div></div></div><p class="simpara">
							Example JSON response:
						</p><pre class="programlisting language-json">{
  "type" : "SUCCESS",
  "msg" : "OK from container 'MovieDMNContainer'",
  "result" : {
    "dmn-evaluation-result" : {
      "messages" : [ ],
      "model-namespace" : "http://www.redhat.com/_c7328033-c355-43cd-b616-0aceef80e52a",
      "model-name" : "dmn-movieticket-ageclassification",
      "decision-name" : [ ],
      "dmn-context" : {
        "Age" : 66,
        "AgeClassification" : "Senior"
      },
      "decision-results" : {
        "_3" : {
          "messages" : [ ],
          "decision-id" : "_3",
          "decision-name" : "AgeClassification",
          "result" : "Senior",
          "status" : "SUCCEEDED"
        }
      }
    }
  }
}</pre><p class="simpara">
							Example XML (JAXB format) response:
						</p><pre class="programlisting language-xml">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;
&lt;response type="SUCCESS" msg="OK from container 'MovieDMNContainer'"&gt;
      &lt;dmn-evaluation-result&gt;
            &lt;model-namespace&gt;http://www.redhat.com/_c7328033-c355-43cd-b616-0aceef80e52a&lt;/model-namespace&gt;
            &lt;model-name&gt;dmn-movieticket-ageclassification&lt;/model-name&gt;
            &lt;dmn-context xsi:type="jaxbListWrapper" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
                  &lt;type&gt;MAP&lt;/type&gt;
                  &lt;element xsi:type="jaxbStringObjectPair" key="Age"&gt;
                        &lt;value xsi:type="xs:int" xmlns:xs="http://www.w3.org/2001/XMLSchema"&gt;66&lt;/value&gt;
                  &lt;/element&gt;
                  &lt;element xsi:type="jaxbStringObjectPair" key="AgeClassification"&gt;
                        &lt;value xsi:type="xs:string" xmlns:xs="http://www.w3.org/2001/XMLSchema"&gt;Senior&lt;/value&gt;
                  &lt;/element&gt;
            &lt;/dmn-context&gt;
            &lt;messages/&gt;
            &lt;decisionResults&gt;
                  &lt;entry&gt;
                        &lt;key&gt;_3&lt;/key&gt;
                        &lt;value&gt;
                              &lt;decision-id&gt;_3&lt;/decision-id&gt;
                              &lt;decision-name&gt;AgeClassification&lt;/decision-name&gt;
                              &lt;result xsi:type="xs:string" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;Senior&lt;/result&gt;
                              &lt;messages/&gt;
                              &lt;status&gt;SUCCEEDED&lt;/status&gt;
                        &lt;/value&gt;
                  &lt;/entry&gt;
            &lt;/decisionResults&gt;
      &lt;/dmn-evaluation-result&gt;
&lt;/response&gt;</pre></li></ol></div></section></section><section class="chapter" id="additional_resources"><div class="titlepage"><div><div><h2 class="title">Chapter 7. Additional resources</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>
					</li><li class="listitem">
						<a class="link" href="https://dmn-tck.github.io/tck/">DMN Technology Compatibility Kit</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-kie-apis"><span class="emphasis"><em>Interacting with Red Hat Process Automation Manager using KIE APIs</em></span></a>
					</li></ul></div></section></div><div class="part" id="assembly-pmml-models"><div class="titlepage"><div><div><h1 class="title">Part II. Designing a decision service using PMML models</h1></div></div></div><div class="partintro" id="idm139921830264560"><div/><p>
				As a business rules developer, you can use Predictive Model Markup Language (PMML) to define statistical or data-mining models that you can integrate with your decision services in Red Hat Process Automation Manager. Red Hat Process Automation Manager includes consumer conformance support of PMML 4.2.1 for Regression, Scorecard, Tree, and Mining models. Red Hat Process Automation Manager does not include a built-in PMML model editor, but you can use an XML or PMML-specific authoring tool to create PMML models and then integrate them with your Red Hat Process Automation Manager projects.
			</p><p>
				For more information about PMML, see the DMG <a class="link" href="http://dmg.org/pmml/pmml-v4-2-1.html">PMML specification</a>.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					You can also design your decision service using Decision Model and Notation (DMN) models and include your PMML models as part of your DMN service. For information about DMN support in Red Hat Process Automation Manager 7.10, see the following resources:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/getting_started_with_red_hat_process_automation_manager#assembly-getting-started-decision-services"><span class="emphasis"><em>Getting started with decision services</em></span></a> (step-by-step tutorial with a DMN decision service example)
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#dmn-included-models-pmml-proc_dmn-models"><span class="emphasis"><em>Designing a decision service using DMN models</em></span></a> (overview of DMN support and capabilities in Red Hat Process Automation Manager)
						</li></ul></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><ul class="toc"><li><span class="chapter"><a href="#decision-authoring-assets-ref_pmml-models">8. Decision-authoring assets in Red Hat Process Automation Manager</a></span></li><li><span class="chapter"><a href="#pmml-con_pmml-models">9. Predictive Model Markup Language (PMML)</a></span><ul><li><span class="section"><a href="#pmml-conformance-con_pmml-models">9.1. PMML conformance levels</a></span></li></ul></li><li><span class="chapter"><a href="#pmml-examples-ref_pmml-models">10. PMML model examples</a></span></li><li><span class="chapter"><a href="#pmml-support-con_pmml-models">11. PMML support in Red Hat Process Automation Manager</a></span><ul><li><span class="section"><a href="#pmml-naming-conventions-ref_pmml-models">11.1. PMML naming conventions in Red Hat Process Automation Manager</a></span></li><li><span class="section"><a href="#pmml-extensions-ref_pmml-models">11.2. PMML extensions in Red Hat Process Automation Manager</a></span></li></ul></li><li><span class="chapter"><a href="#pmml-invocation-options-con_pmml-models">12. PMML model execution</a></span><ul><li><span class="section"><a href="#pmml-invocation-embedded-proc_pmml-models">12.1. Embedding a PMML call directly in a Java application</a></span><ul><li><span class="section"><a href="#pmml-invocation-helper-classes-ref_pmml-models">12.1.1. PMML execution helper class</a></span></li></ul></li><li><span class="section"><a href="#pmml-invocation-kie-server-proc_pmml-models">12.2. Executing a PMML model using KIE Server</a></span></li></ul></li><li><span class="chapter"><a href="#additional_resources_2">13. Additional resources</a></span></li></ul></div></div><section class="chapter" id="decision-authoring-assets-ref_pmml-models"><div class="titlepage"><div><div><h2 class="title">Chapter 8. Decision-authoring assets in Red Hat Process Automation Manager</h2></div></div></div><p>
				Red Hat Process Automation Manager supports several assets that you can use to define business decisions for your decision service. Each decision-authoring asset has different advantages, and you might prefer to use one or a combination of multiple assets depending on your goals and needs.
			</p><p>
				The following table highlights the main decision-authoring assets supported in Red Hat Process Automation Manager projects to help you decide or confirm the best method for defining decisions in your decision service.
			</p><div class="table" id="idm139921835082048"><p class="title"><strong>Table 8.1. Decision-authoring assets supported in Red Hat Process Automation Manager</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"/><col style="width: 40%; " class="col_2"/><col style="width: 20%; " class="col_3"/><col style="width: 20%; " class="col_4"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921829746976" scope="col">Asset</th><th align="left" valign="top" id="idm139921829745888" scope="col">Highlights</th><th align="left" valign="top" id="idm139921853345504" scope="col">Authoring tools</th><th align="left" valign="top" id="idm139921853344416" scope="col">Documentation</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921829746976">
							<p>
								Decision Model and Notation (DMN) models
							</p>
							</td><td align="left" valign="top" headers="idm139921829745888">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are decision models based on a notation standard defined by the Object Management Group (OMG)
									</li><li class="listitem">
										Use graphical decision requirements diagrams (DRDs) that represent part or all of the overall decision requirements graph (DRG) to trace business decision flows
									</li><li class="listitem">
										Use an XML schema that allows the DMN models to be shared between DMN-compliant platforms
									</li><li class="listitem">
										Support Friendly Enough Expression Language (FEEL) to define decision logic in DMN decision tables and other DMN boxed expressions
									</li><li class="listitem">
										Can be integrated efficiently with Business Process Model and Notation (BPMN) process models
									</li><li class="listitem">
										Are optimal for creating comprehensive, illustrative, and stable decision flows
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921853345504">
							<p>
								Business Central or other DMN-compliant editor
							</p>
							</td><td align="left" valign="top" headers="idm139921853344416">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-dmn-models"><span class="emphasis"><em>Designing a decision service using DMN models</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921829746976">
							<p>
								Guided decision tables
							</p>
							</td><td align="left" valign="top" headers="idm139921829745888">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are tables of rules that you create in a UI-based table designer in Business Central
									</li><li class="listitem">
										Are a wizard-led alternative to spreadsheet decision tables
									</li><li class="listitem">
										Provide fields and options for acceptable input
									</li><li class="listitem">
										Support template keys and values for creating rule templates
									</li><li class="listitem">
										Support hit policies, real-time validation, and other additional features not supported in other assets
									</li><li class="listitem">
										Are optimal for creating rules in a controlled tabular format to minimize compilation errors
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921853345504">
							<p>
								Business Central
							</p>
							</td><td align="left" valign="top" headers="idm139921853344416">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-guided-decision-tables"><span class="emphasis"><em>Designing a decision service using guided decision tables</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921829746976">
							<p>
								Spreadsheet decision tables
							</p>
							</td><td align="left" valign="top" headers="idm139921829745888">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are XLS or XLSX spreadsheet decision tables that you can upload into Business Central
									</li><li class="listitem">
										Support template keys and values for creating rule templates
									</li><li class="listitem">
										Are optimal for creating rules in decision tables already managed outside of Business Central
									</li><li class="listitem">
										Have strict syntax requirements for rules to be compiled properly when uploaded
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921853345504">
							<p>
								Spreadsheet editor
							</p>
							</td><td align="left" valign="top" headers="idm139921853344416">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-decision-tables"><span class="emphasis"><em>Designing a decision service using spreadsheet decision tables</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921829746976">
							<p>
								Guided rules
							</p>
							</td><td align="left" valign="top" headers="idm139921829745888">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are individual rules that you create in a UI-based rule designer in Business Central
									</li><li class="listitem">
										Provide fields and options for acceptable input
									</li><li class="listitem">
										Are optimal for creating single rules in a controlled format to minimize compilation errors
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921853345504">
							<p>
								Business Central
							</p>
							</td><td align="left" valign="top" headers="idm139921853344416">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-guided-rules"><span class="emphasis"><em>Designing a decision service using guided rules</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921829746976">
							<p>
								Guided rule templates
							</p>
							</td><td align="left" valign="top" headers="idm139921829745888">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are reusable rule structures that you create in a UI-based template designer in Business Central
									</li><li class="listitem">
										Provide fields and options for acceptable input
									</li><li class="listitem">
										Support template keys and values for creating rule templates (fundamental to the purpose of this asset)
									</li><li class="listitem">
										Are optimal for creating many rules with the same rule structure but with different defined field values
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921853345504">
							<p>
								Business Central
							</p>
							</td><td align="left" valign="top" headers="idm139921853344416">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-guided-rule-templates"><span class="emphasis"><em>Designing a decision service using guided rule templates</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921829746976">
							<p>
								DRL rules
							</p>
							</td><td align="left" valign="top" headers="idm139921829745888">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are individual rules that you define directly in <code class="literal">.drl</code> text files
									</li><li class="listitem">
										Provide the most flexibility for defining rules and other technicalities of rule behavior
									</li><li class="listitem">
										Can be created in certain standalone environments and integrated with Red Hat Process Automation Manager
									</li><li class="listitem">
										Are optimal for creating rules that require advanced DRL options
									</li><li class="listitem">
										Have strict syntax requirements for rules to be compiled properly
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921853345504">
							<p>
								Business Central or integrated development environment (IDE)
							</p>
							</td><td align="left" valign="top" headers="idm139921853344416">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-drl-rules"><span class="emphasis"><em>Designing a decision service using DRL rules</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921829746976">
							<p>
								Predictive Model Markup Language (PMML) models
							</p>
							</td><td align="left" valign="top" headers="idm139921829745888">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are predictive data-analytic models based on a notation standard defined by the Data Mining Group (DMG)
									</li><li class="listitem">
										Use an XML schema that allows the PMML models to be shared between PMML-compliant platforms
									</li><li class="listitem">
										Support Regression, Scorecard, Tree, Mining, and other model types
									</li><li class="listitem">
										Can be included with a standalone Red Hat Process Automation Manager project or imported into a project in Business Central
									</li><li class="listitem">
										Are optimal for incorporating predictive data into decision services in Red Hat Process Automation Manager
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921853345504">
							<p>
								PMML or XML editor
							</p>
							</td><td align="left" valign="top" headers="idm139921853344416">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-pmml-models"><span class="emphasis"><em>Designing a decision service using PMML models</em></span></a>
							</p>
							</td></tr></tbody></table></div></div></section><section class="chapter" id="pmml-con_pmml-models"><div class="titlepage"><div><div><h2 class="title">Chapter 9. Predictive Model Markup Language (PMML)</h2></div></div></div><p>
				Predictive Model Markup Language (PMML) is an XML-based standard established by the Data Mining Group (DMG) for defining statistical and data-mining models. PMML models can be shared between PMML-compliant platforms and across organizations so that business analysts and developers are unified in designing, analyzing, and implementing PMML-based assets and services.
			</p><p>
				For more information about the background and applications of PMML, see the DMG <a class="link" href="http://dmg.org/pmml/pmml-v4-2-1.html">PMML specification</a>.
			</p><section class="section" id="pmml-conformance-con_pmml-models"><div class="titlepage"><div><div><h2 class="title">9.1. PMML conformance levels</h2></div></div></div><p>
					The PMML specification defines producer and consumer conformance levels in a software implementation to ensure that PMML models are created and integrated reliably. For the formal definitions of each conformance level, see the DMG <a class="link" href="http://dmg.org/pmml/v4-2-1/Conformance.html">PMML conformance</a> page.
				</p><p>
					The following list summarizes the PMML conformance levels:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Producer conformance</span></dt><dd>
								A tool or application is producer conforming if it generates valid PMML documents for at least one type of model. Satisfying PMML producer conformance requirements ensures that a model definition document is syntactically correct and defines a model instance that is consistent with semantic criteria that are defined in model specifications.
							</dd><dt><span class="term">Consumer conformance</span></dt><dd>
								An application is consumer conforming if it accepts valid PMML documents for at least one type of model. Satisfying consumer conformance requirements ensures that a PMML model created according to producer conformance can be integrated and used as defined. For example, if an application is consumer conforming for Regression model types, then valid PMML documents defining models of this type produced by different conforming producers would be interchangeable in the application.
							</dd></dl></div><p>
					Red Hat Process Automation Manager includes consumer conformance support for the following PMML 4.2.1 model types:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="http://dmg.org/pmml/v4-2-1/Regression.html">Regression models</a>
						</li><li class="listitem">
							<a class="link" href="http://dmg.org/pmml/v4-2-1/Scorecard.html">Scorecard models</a>
						</li><li class="listitem">
							<a class="link" href="http://dmg.org/pmml/v4-2-1/TreeModel.html">Tree models</a>
						</li><li class="listitem">
							<a class="link" href="http://dmg.org/pmml/v4-2-1/MultipleModels.html#xsdElement_MiningModel">Mining models</a> (with sub-types <code class="literal">modelChain</code>, <code class="literal">selectAll</code>, and <code class="literal">selectFirst</code>)
						</li></ul></div><p>
					For a list of all PMML model types, including those not supported in Red Hat Process Automation Manager, see the DMG <a class="link" href="http://dmg.org/pmml/v4-2-1/GeneralStructure.html">PMML specification</a>.
				</p></section></section><section class="chapter" id="pmml-examples-ref_pmml-models"><div class="titlepage"><div><div><h2 class="title">Chapter 10. PMML model examples</h2></div></div></div><p>
				PMML defines an <a class="link" href="http://dmg.org/pmml/v4-2-1/pmml-4-2.xsd">XML schema</a> that enables PMML models to be used between different PMML-compliant platforms. The PMML specification enables multiple software platforms to work with the same file for authoring, testing, and production execution, assuming producer and consumer conformance are met.
			</p><p>
				The following are examples of PMML Regression, Scorecard, Tree, and Mining models. These examples illustrate the supported types of models that you can integrate with your decision services in Red Hat Process Automation Manager.
			</p><p>
				For more PMML examples, see the DMG <a class="link" href="http://dmg.org/pmml/pmml_examples/index.html">PMML Sample Files</a> page.
			</p><div class="formalpara"><p class="title"><strong>Example PMML Regression model</strong></p><p>
					
<pre class="programlisting language-xml">&lt;PMML version="4.2" xsi:schemaLocation="http://www.dmg.org/PMML-4_2 http://www.dmg.org/v4-2-1/pmml-4-2.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.dmg.org/PMML-4_2"&gt;
  &lt;Header copyright="JBoss"/&gt;
  &lt;DataDictionary numberOfFields="5"&gt;
    &lt;DataField dataType="double" name="fld1" optype="continuous"/&gt;
    &lt;DataField dataType="double" name="fld2" optype="continuous"/&gt;
    &lt;DataField dataType="string" name="fld3" optype="categorical"&gt;
      &lt;Value value="x"/&gt;
      &lt;Value value="y"/&gt;
    &lt;/DataField&gt;
    &lt;DataField dataType="double" name="fld4" optype="continuous"/&gt;
    &lt;DataField dataType="double" name="fld5" optype="continuous"/&gt;
  &lt;/DataDictionary&gt;
  &lt;RegressionModel algorithmName="linearRegression" functionName="regression" modelName="LinReg" normalizationMethod="logit" targetFieldName="fld4"&gt;
    &lt;MiningSchema&gt;
      &lt;MiningField name="fld1"/&gt;
      &lt;MiningField name="fld2"/&gt;
      &lt;MiningField name="fld3"/&gt;
      &lt;MiningField name="fld4" usageType="predicted"/&gt;
      &lt;MiningField name="fld5" usageType="target"/&gt;
    &lt;/MiningSchema&gt;
    &lt;RegressionTable intercept="0.5"&gt;
      &lt;NumericPredictor coefficient="5" exponent="2" name="fld1"/&gt;
      &lt;NumericPredictor coefficient="2" exponent="1" name="fld2"/&gt;
      &lt;CategoricalPredictor coefficient="-3" name="fld3" value="x"/&gt;
      &lt;CategoricalPredictor coefficient="3" name="fld3" value="y"/&gt;
      &lt;PredictorTerm coefficient="0.4"&gt;
        &lt;FieldRef field="fld1"/&gt;
        &lt;FieldRef field="fld2"/&gt;
      &lt;/PredictorTerm&gt;
    &lt;/RegressionTable&gt;
  &lt;/RegressionModel&gt;
&lt;/PMML&gt;</pre>
				</p></div><div class="formalpara"><p class="title"><strong>Example PMML Scorecard model</strong></p><p>
					
<pre class="programlisting language-xml">&lt;PMML version="4.2" xsi:schemaLocation="http://www.dmg.org/PMML-4_2 http://www.dmg.org/v4-2-1/pmml-4-2.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.dmg.org/PMML-4_2"&gt;
  &lt;Header copyright="JBoss"/&gt;
  &lt;DataDictionary numberOfFields="4"&gt;
    &lt;DataField name="param1" optype="continuous" dataType="double"/&gt;
    &lt;DataField name="param2" optype="continuous" dataType="double"/&gt;
    &lt;DataField name="overallScore" optype="continuous" dataType="double" /&gt;
    &lt;DataField name="finalscore" optype="continuous" dataType="double" /&gt;
  &lt;/DataDictionary&gt;
  &lt;Scorecard modelName="ScorecardCompoundPredicate" useReasonCodes="true" isScorable="true" functionName="regression"    baselineScore="15" initialScore="0.8" reasonCodeAlgorithm="pointsAbove"&gt;
    &lt;MiningSchema&gt;
      &lt;MiningField name="param1" usageType="active" invalidValueTreatment="asMissing"&gt;
      &lt;/MiningField&gt;
      &lt;MiningField name="param2" usageType="active" invalidValueTreatment="asMissing"&gt;
      &lt;/MiningField&gt;
      &lt;MiningField name="overallScore" usageType="target"/&gt;
      &lt;MiningField name="finalscore" usageType="predicted"/&gt;
    &lt;/MiningSchema&gt;
    &lt;Characteristics&gt;
      &lt;Characteristic name="ch1" baselineScore="50" reasonCode="reasonCh1"&gt;
        &lt;Attribute partialScore="20"&gt;
          &lt;SimplePredicate field="param1" operator="lessThan" value="20"/&gt;
        &lt;/Attribute&gt;
        &lt;Attribute partialScore="100"&gt;
          &lt;CompoundPredicate booleanOperator="and"&gt;
            &lt;SimplePredicate field="param1" operator="greaterOrEqual" value="20"/&gt;
            &lt;SimplePredicate field="param2" operator="lessOrEqual" value="25"/&gt;
          &lt;/CompoundPredicate&gt;
        &lt;/Attribute&gt;
        &lt;Attribute partialScore="200"&gt;
          &lt;CompoundPredicate booleanOperator="and"&gt;
            &lt;SimplePredicate field="param1" operator="greaterOrEqual" value="20"/&gt;
            &lt;SimplePredicate field="param2" operator="greaterThan" value="25"/&gt;
          &lt;/CompoundPredicate&gt;
        &lt;/Attribute&gt;
      &lt;/Characteristic&gt;
      &lt;Characteristic name="ch2" reasonCode="reasonCh2"&gt;
        &lt;Attribute partialScore="10"&gt;
          &lt;CompoundPredicate booleanOperator="or"&gt;
            &lt;SimplePredicate field="param2" operator="lessOrEqual" value="-5"/&gt;
            &lt;SimplePredicate field="param2" operator="greaterOrEqual" value="50"/&gt;
          &lt;/CompoundPredicate&gt;
        &lt;/Attribute&gt;
        &lt;Attribute partialScore="20"&gt;
          &lt;CompoundPredicate booleanOperator="and"&gt;
            &lt;SimplePredicate field="param2" operator="greaterThan" value="-5"/&gt;
            &lt;SimplePredicate field="param2" operator="lessThan" value="50"/&gt;
          &lt;/CompoundPredicate&gt;
        &lt;/Attribute&gt;
      &lt;/Characteristic&gt;
    &lt;/Characteristics&gt;
  &lt;/Scorecard&gt;
&lt;/PMML&gt;</pre>
				</p></div><div class="formalpara"><p class="title"><strong>Example PMML Tree model</strong></p><p>
					
<pre class="programlisting language-xml">&lt;PMML version="4.2" xsi:schemaLocation="http://www.dmg.org/PMML-4_2 http://www.dmg.org/v4-2-1/pmml-4-2.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.dmg.org/PMML-4_2"&gt;
  &lt;Header copyright="JBOSS"/&gt;
  &lt;DataDictionary numberOfFields="5"&gt;
    &lt;DataField dataType="double" name="fld1" optype="continuous"/&gt;
    &lt;DataField dataType="double" name="fld2" optype="continuous"/&gt;
    &lt;DataField dataType="string" name="fld3" optype="categorical"&gt;
      &lt;Value value="true"/&gt;
      &lt;Value value="false"/&gt;
    &lt;/DataField&gt;
    &lt;DataField dataType="string" name="fld4" optype="categorical"&gt;
      &lt;Value value="optA"/&gt;
      &lt;Value value="optB"/&gt;
      &lt;Value value="optC"/&gt;
    &lt;/DataField&gt;
    &lt;DataField dataType="string" name="fld5" optype="categorical"&gt;
      &lt;Value value="tgtX"/&gt;
      &lt;Value value="tgtY"/&gt;
      &lt;Value value="tgtZ"/&gt;
    &lt;/DataField&gt;
  &lt;/DataDictionary&gt;
  &lt;TreeModel functionName="classification" modelName="TreeTest"&gt;
    &lt;MiningSchema&gt;
      &lt;MiningField name="fld1"/&gt;
      &lt;MiningField name="fld2"/&gt;
      &lt;MiningField name="fld3"/&gt;
      &lt;MiningField name="fld4"/&gt;
      &lt;MiningField name="fld5" usageType="predicted"/&gt;
    &lt;/MiningSchema&gt;
    &lt;Node score="tgtX"&gt;
      &lt;True/&gt;
      &lt;Node score="tgtX"&gt;
        &lt;SimplePredicate field="fld4" operator="equal" value="optA"/&gt;
        &lt;Node score="tgtX"&gt;
          &lt;CompoundPredicate booleanOperator="surrogate"&gt;
            &lt;SimplePredicate field="fld1" operator="lessThan" value="30.0"/&gt;
            &lt;SimplePredicate field="fld2" operator="greaterThan" value="20.0"/&gt;
          &lt;/CompoundPredicate&gt;
          &lt;Node score="tgtX"&gt;
            &lt;SimplePredicate field="fld2" operator="lessThan" value="40.0"/&gt;
          &lt;/Node&gt;
          &lt;Node score="tgtZ"&gt;
            &lt;SimplePredicate field="fld2" operator="greaterOrEqual" value="10.0"/&gt;
          &lt;/Node&gt;
        &lt;/Node&gt;
        &lt;Node score="tgtZ"&gt;
          &lt;CompoundPredicate booleanOperator="or"&gt;
            &lt;SimplePredicate field="fld1" operator="greaterOrEqual" value="60.0"/&gt;
            &lt;SimplePredicate field="fld1" operator="lessOrEqual" value="70.0"/&gt;
          &lt;/CompoundPredicate&gt;
          &lt;Node score="tgtZ"&gt;
            &lt;SimpleSetPredicate booleanOperator="isNotIn" field="fld4"&gt;
              &lt;Array type="string"&gt;optA optB&lt;/Array&gt;
            &lt;/SimpleSetPredicate&gt;
          &lt;/Node&gt;
        &lt;/Node&gt;
      &lt;/Node&gt;
      &lt;Node score="tgtY"&gt;
        &lt;CompoundPredicate booleanOperator="or"&gt;
          &lt;SimplePredicate field="fld4" operator="equal" value="optA"/&gt;
          &lt;SimplePredicate field="fld4" operator="equal" value="optC"/&gt;
        &lt;/CompoundPredicate&gt;
        &lt;Node score="tgtY"&gt;
          &lt;CompoundPredicate booleanOperator="and"&gt;
            &lt;SimplePredicate field="fld1" operator="greaterThan" value="10.0"/&gt;
            &lt;SimplePredicate field="fld1" operator="lessThan" value="50.0"/&gt;
            &lt;SimplePredicate field="fld4" operator="equal" value="optA"/&gt;
            &lt;SimplePredicate field="fld2" operator="lessThan" value="100.0"/&gt;
            &lt;SimplePredicate field="fld3" operator="equal" value="false"/&gt;
          &lt;/CompoundPredicate&gt;
        &lt;/Node&gt;
        &lt;Node score="tgtZ"&gt;
          &lt;CompoundPredicate booleanOperator="and"&gt;
            &lt;SimplePredicate field="fld4" operator="equal" value="optC"/&gt;
            &lt;SimplePredicate field="fld2" operator="lessThan" value="30.0"/&gt;
          &lt;/CompoundPredicate&gt;
        &lt;/Node&gt;
      &lt;/Node&gt;
    &lt;/Node&gt;
  &lt;/TreeModel&gt;
&lt;/PMML&gt;</pre>
				</p></div><div class="formalpara"><p class="title"><strong>Example PMML Mining model (modelChain)</strong></p><p>
					
<pre class="programlisting language-xml">&lt;PMML version="4.2" xsi:schemaLocation="http://www.dmg.org/PMML-4_2 http://www.dmg.org/v4-2-1/pmml-4-2.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"   xmlns="http://www.dmg.org/PMML-4_2"&gt;
  &lt;Header&gt;
    &lt;Application name="Drools-PMML" version="7.0.0-SNAPSHOT" /&gt;
  &lt;/Header&gt;
  &lt;DataDictionary numberOfFields="7"&gt;
    &lt;DataField name="age" optype="continuous" dataType="double" /&gt;
    &lt;DataField name="occupation" optype="categorical" dataType="string"&gt;
      &lt;Value value="SKYDIVER" /&gt;
      &lt;Value value="ASTRONAUT" /&gt;
      &lt;Value value="PROGRAMMER" /&gt;
      &lt;Value value="TEACHER" /&gt;
      &lt;Value value="INSTRUCTOR" /&gt;
    &lt;/DataField&gt;
    &lt;DataField name="residenceState" optype="categorical" dataType="string"&gt;
      &lt;Value value="AP" /&gt;
      &lt;Value value="KN" /&gt;
      &lt;Value value="TN" /&gt;
    &lt;/DataField&gt;
    &lt;DataField name="validLicense" optype="categorical" dataType="boolean" /&gt;
    &lt;DataField name="overallScore" optype="continuous" dataType="double" /&gt;
    &lt;DataField name="grade" optype="categorical" dataType="string"&gt;
      &lt;Value value="A" /&gt;
      &lt;Value value="B" /&gt;
      &lt;Value value="C" /&gt;
      &lt;Value value="D" /&gt;
      &lt;Value value="F" /&gt;
    &lt;/DataField&gt;
    &lt;DataField name="qualificationLevel" optype="categorical" dataType="string"&gt;
      &lt;Value value="Unqualified" /&gt;
      &lt;Value value="Barely" /&gt;
      &lt;Value value="Well" /&gt;
      &lt;Value value="Over" /&gt;
    &lt;/DataField&gt;
  &lt;/DataDictionary&gt;
  &lt;MiningModel modelName="SampleModelChainMine" functionName="classification"&gt;
    &lt;MiningSchema&gt;
      &lt;MiningField name="age" /&gt;
      &lt;MiningField name="occupation" /&gt;
      &lt;MiningField name="residenceState" /&gt;
      &lt;MiningField name="validLicense" /&gt;
      &lt;MiningField name="overallScore" /&gt;
      &lt;MiningField name="qualificationLevel" usageType="target"/&gt;
    &lt;/MiningSchema&gt;
    &lt;Segmentation multipleModelMethod="modelChain"&gt;
      &lt;Segment id="1"&gt;
        &lt;True /&gt;
        &lt;Scorecard modelName="Sample Score 1" useReasonCodes="true" isScorable="true" functionName="regression"               baselineScore="0.0" initialScore="0.345"&gt;
          &lt;MiningSchema&gt;
            &lt;MiningField name="age" usageType="active" invalidValueTreatment="asMissing" /&gt;
            &lt;MiningField name="occupation" usageType="active" invalidValueTreatment="asMissing" /&gt;
            &lt;MiningField name="residenceState" usageType="active" invalidValueTreatment="asMissing" /&gt;
            &lt;MiningField name="validLicense" usageType="active" invalidValueTreatment="asMissing" /&gt;
            &lt;MiningField name="overallScore" usageType="predicted" /&gt;
          &lt;/MiningSchema&gt;
          &lt;Output&gt;
            &lt;OutputField name="calculatedScore" displayName="Final Score" dataType="double" feature="predictedValue"                     targetField="overallScore" /&gt;
          &lt;/Output&gt;
          &lt;Characteristics&gt;
            &lt;Characteristic name="AgeScore" baselineScore="0.0" reasonCode="ABZ"&gt;
              &lt;Extension name="cellRef" value="$B$8" /&gt;
              &lt;Attribute partialScore="10.0"&gt;
                &lt;Extension name="cellRef" value="$C$10" /&gt;
                &lt;SimplePredicate field="age" operator="lessOrEqual" value="5" /&gt;
              &lt;/Attribute&gt;
              &lt;Attribute partialScore="30.0" reasonCode="CX1"&gt;
                &lt;Extension name="cellRef" value="$C$11" /&gt;
                &lt;CompoundPredicate booleanOperator="and"&gt;
                  &lt;SimplePredicate field="age" operator="greaterOrEqual" value="5" /&gt;
                  &lt;SimplePredicate field="age" operator="lessThan" value="12" /&gt;
                &lt;/CompoundPredicate&gt;
              &lt;/Attribute&gt;
              &lt;Attribute partialScore="40.0" reasonCode="CX2"&gt;
                &lt;Extension name="cellRef" value="$C$12" /&gt;
                &lt;CompoundPredicate booleanOperator="and"&gt;
                  &lt;SimplePredicate field="age" operator="greaterOrEqual" value="13" /&gt;
                  &lt;SimplePredicate field="age" operator="lessThan" value="44" /&gt;
                &lt;/CompoundPredicate&gt;
              &lt;/Attribute&gt;
              &lt;Attribute partialScore="25.0"&gt;
                &lt;Extension name="cellRef" value="$C$13" /&gt;
                &lt;SimplePredicate field="age" operator="greaterOrEqual" value="45" /&gt;
              &lt;/Attribute&gt;
            &lt;/Characteristic&gt;
            &lt;Characteristic name="OccupationScore" baselineScore="0.0"&gt;
              &lt;Extension name="cellRef" value="$B$16" /&gt;
              &lt;Attribute partialScore="-10.0" reasonCode="CX2"&gt;
                &lt;Extension name="description" value="skydiving is a risky occupation" /&gt;
                &lt;Extension name="cellRef" value="$C$18" /&gt;
                &lt;SimpleSetPredicate field="occupation" booleanOperator="isIn"&gt;
                  &lt;Array n="2" type="string"&gt;SKYDIVER ASTRONAUT&lt;/Array&gt;
                &lt;/SimpleSetPredicate&gt;
              &lt;/Attribute&gt;
              &lt;Attribute partialScore="10.0"&gt;
                &lt;Extension name="cellRef" value="$C$19" /&gt;
                &lt;SimpleSetPredicate field="occupation" booleanOperator="isIn"&gt;
                  &lt;Array n="2" type="string"&gt;TEACHER INSTRUCTOR&lt;/Array&gt;
                &lt;/SimpleSetPredicate&gt;
              &lt;/Attribute&gt;
              &lt;Attribute partialScore="5.0"&gt;
                &lt;Extension name="cellRef" value="$C$20" /&gt;
                &lt;SimplePredicate field="occupation" operator="equal" value="PROGRAMMER" /&gt;
              &lt;/Attribute&gt;
            &lt;/Characteristic&gt;
            &lt;Characteristic name="ResidenceStateScore" baselineScore="0.0" reasonCode="RES"&gt;
              &lt;Extension name="cellRef" value="$B$22" /&gt;
              &lt;Attribute partialScore="-10.0"&gt;
                &lt;Extension name="cellRef" value="$C$24" /&gt;
                &lt;SimplePredicate field="residenceState" operator="equal" value="AP" /&gt;
              &lt;/Attribute&gt;
              &lt;Attribute partialScore="10.0"&gt;
                &lt;Extension name="cellRef" value="$C$25" /&gt;
                &lt;SimplePredicate field="residenceState" operator="equal" value="KN" /&gt;
              &lt;/Attribute&gt;
              &lt;Attribute partialScore="5.0"&gt;
                &lt;Extension name="cellRef" value="$C$26" /&gt;
                &lt;SimplePredicate field="residenceState" operator="equal" value="TN" /&gt;
              &lt;/Attribute&gt;
            &lt;/Characteristic&gt;
            &lt;Characteristic name="ValidLicenseScore" baselineScore="0.0"&gt;
              &lt;Extension name="cellRef" value="$B$28" /&gt;
              &lt;Attribute partialScore="1.0" reasonCode="LX00"&gt;
                &lt;Extension name="cellRef" value="$C$30" /&gt;
                &lt;SimplePredicate field="validLicense" operator="equal" value="true" /&gt;
              &lt;/Attribute&gt;
              &lt;Attribute partialScore="-1.0" reasonCode="LX00"&gt;
                &lt;Extension name="cellRef" value="$C$31" /&gt;
                &lt;SimplePredicate field="validLicense" operator="equal" value="false" /&gt;
              &lt;/Attribute&gt;
            &lt;/Characteristic&gt;
          &lt;/Characteristics&gt;
        &lt;/Scorecard&gt;
      &lt;/Segment&gt;
      &lt;Segment id="2"&gt;
        &lt;True /&gt;
        &lt;TreeModel modelName="SampleTree" functionName="classification" missingValueStrategy="lastPrediction" noTrueChildStrategy="returnLastPrediction"&gt;
          &lt;MiningSchema&gt;
            &lt;MiningField name="age" usageType="active" /&gt;
            &lt;MiningField name="validLicense" usageType="active" /&gt;
            &lt;MiningField name="calculatedScore" usageType="active" /&gt;
            &lt;MiningField name="qualificationLevel" usageType="predicted" /&gt;
          &lt;/MiningSchema&gt;
          &lt;Output&gt;
            &lt;OutputField name="qualification" displayName="Qualification Level" dataType="string" feature="predictedValue"                     targetField="qualificationLevel" /&gt;
          &lt;/Output&gt;
          &lt;Node score="Well" id="1"&gt;
            &lt;True/&gt;
            &lt;Node score="Barely" id="2"&gt;
              &lt;CompoundPredicate booleanOperator="and"&gt;
                &lt;SimplePredicate field="age" operator="greaterOrEqual" value="16" /&gt;
                &lt;SimplePredicate field="validLicense" operator="equal" value="true" /&gt;
              &lt;/CompoundPredicate&gt;
              &lt;Node score="Barely" id="3"&gt;
                &lt;SimplePredicate field="calculatedScore" operator="lessOrEqual" value="50.0" /&gt;
              &lt;/Node&gt;
              &lt;Node score="Well" id="4"&gt;
                &lt;CompoundPredicate booleanOperator="and"&gt;
                  &lt;SimplePredicate field="calculatedScore" operator="greaterThan" value="50.0" /&gt;
                  &lt;SimplePredicate field="calculatedScore" operator="lessOrEqual" value="60.0" /&gt;
                &lt;/CompoundPredicate&gt;
              &lt;/Node&gt;
              &lt;Node score="Over" id="5"&gt;
                &lt;SimplePredicate field="calculatedScore" operator="greaterThan" value="60.0" /&gt;
              &lt;/Node&gt;
            &lt;/Node&gt;
            &lt;Node score="Unqualified" id="6"&gt;
              &lt;CompoundPredicate booleanOperator="surrogate"&gt;
                &lt;SimplePredicate field="age" operator="lessThan" value="16" /&gt;
                &lt;SimplePredicate field="calculatedScore" operator="lessOrEqual" value="40.0" /&gt;
                &lt;True /&gt;
              &lt;/CompoundPredicate&gt;
            &lt;/Node&gt;
          &lt;/Node&gt;
        &lt;/TreeModel&gt;
      &lt;/Segment&gt;
    &lt;/Segmentation&gt;
  &lt;/MiningModel&gt;
&lt;/PMML&gt;</pre>
				</p></div></section><section class="chapter" id="pmml-support-con_pmml-models"><div class="titlepage"><div><div><h2 class="title">Chapter 11. PMML support in Red Hat Process Automation Manager</h2></div></div></div><p>
				Red Hat Process Automation Manager includes consumer conformance support for the following PMML 4.2.1 model types:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="http://dmg.org/pmml/v4-2-1/Regression.html">Regression models</a>
					</li><li class="listitem">
						<a class="link" href="http://dmg.org/pmml/v4-2-1/Scorecard.html">Scorecard models</a>
					</li><li class="listitem">
						<a class="link" href="http://dmg.org/pmml/v4-2-1/TreeModel.html">Tree models</a>
					</li><li class="listitem">
						<a class="link" href="http://dmg.org/pmml/v4-2-1/MultipleModels.html#xsdElement_MiningModel">Mining models</a> (with sub-types <code class="literal">modelChain</code>, <code class="literal">selectAll</code>, and <code class="literal">selectFirst</code>)
					</li></ul></div><p>
				For a list of all PMML model types, including those not supported in Red Hat Process Automation Manager, see the DMG <a class="link" href="http://dmg.org/pmml/v4-2-1/GeneralStructure.html">PMML specification</a>.
			</p><p>
				Red Hat Process Automation Manager does not include a built-in PMML model editor, but you can use an XML or PMML-specific authoring tool to create PMML models and then integrate the PMML models in your decision services in Red Hat Process Automation Manager. You can import PMML files into your project in Business Central (<span class="strong strong"><strong>Menu → Design → Projects → Import Asset</strong></span>) or package the PMML files as part of your project knowledge JAR (KJAR) file without Business Central.
			</p><p>
				When you add a PMML file to a project in Red Hat Process Automation Manager, multiple assets are generated. Each type of PMML model generates a different set of assets, but all PMML model types generate at least the following set of assets:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						A DRL file that contains all of the rules associated with your PMML model
					</li><li class="listitem"><p class="simpara">
						At least two Java classes:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								A data class that is used as the default object type for the model type
							</li><li class="listitem">
								A <code class="literal">RuleUnit</code> class that is used to manage data sources and rule execution
							</li></ul></div></li></ul></div><p>
				If a PMML file has <code class="literal">MiningModel</code> as the root model, multiple instances of each of these files are generated.
			</p><p>
				For more information about including assets such as PMML files with your project packaging and deployment method, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>.
			</p><section class="section" id="pmml-naming-conventions-ref_pmml-models"><div class="titlepage"><div><div><h2 class="title">11.1. PMML naming conventions in Red Hat Process Automation Manager</h2></div></div></div><p>
					The following are naming conventions for generated PMML packages, classes, and rules:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							If no package name is given in a PMML model file, then the default package name <code class="literal">org.kie.pmml.pmml_4_2</code> is prefixed to the model name for the generated rules in the format <code class="literal">"org.kie.pmml.pmml_4_2"+modelName</code>.
						</li><li class="listitem">
							The package name for the generated <code class="literal">RuleUnit</code> Java class is the same as the package name for the generated rules.
						</li><li class="listitem">
							The name of the generated <code class="literal">RuleUnit</code> Java class is the model name with <code class="literal">RuleUnit</code> added to it in the format <code class="literal">modelName+"RuleUnit"</code>.
						</li><li class="listitem">
							Each PMML model has at least one data class that is generated. The package name for these classes is <code class="literal">org.kie.pmml.pmml_4_2.model</code>.
						</li><li class="listitem"><p class="simpara">
							The names of generated data classes are determined by the model type, prefixed with the model name:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Regression models: One data class named <code class="literal">modelName+"RegressionData"</code>
								</li><li class="listitem">
									Scorecard models: One data class named <code class="literal">modelName+"ScoreCardData"</code>
								</li><li class="listitem">
									Tree models: Two data classes, the first named <code class="literal">modelName+"TreeNode"</code> and the second named <code class="literal">modelName+"TreeToken"</code>
								</li><li class="listitem">
									Mining models: One data class named <code class="literal">modelName+"MiningModelData"</code>
								</li></ul></div></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The mining model also generates all of the rules and classes that are within each of its segments.
					</p></div></div></section><section class="section" id="pmml-extensions-ref_pmml-models"><div class="titlepage"><div><div><h2 class="title">11.2. PMML extensions in Red Hat Process Automation Manager</h2></div></div></div><p>
					The PMML specification supports <code class="literal">Extension</code> elements that extend the content of a PMML model. You can use extensions at almost every level of a PMML model definition, and as the first and last child in the main element of a model for maximum flexibility. For more information about PMML extensions, see the DMG PMML <a class="link" href="http://dmg.org/pmml/v4-2-1/GeneralStructure.html#xsdElement_Extension">Extension Mechanism</a>.
				</p><p>
					To optimize PMML integration, Red Hat Process Automation Manager supports the following additional PMML extensions:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">modelPackage</code>: Designates a package name for the generated rules and Java classes. Include this extension in the <code class="literal">Header</code> section of the PMML model file.
						</li><li class="listitem">
							<code class="literal">adapter</code>: Designates the type of construct (<code class="literal">bean</code> or <code class="literal">trait</code>) that is used to contain input and output data for rules. Insert this extension in the <code class="literal">MiningSchema</code> or <code class="literal">Output</code> section (or both) of the PMML model file.
						</li><li class="listitem">
							<code class="literal">externalClass</code>: Used in conjunction with the <code class="literal">adapter</code> extension in defining a <code class="literal">MiningField</code> or <code class="literal">OutputField</code>. This extension contains a class with an attribute name that matches the name of the <code class="literal">MiningField</code> or <code class="literal">OutputField</code> element.
						</li></ul></div></section></section><section class="chapter" id="pmml-invocation-options-con_pmml-models"><div class="titlepage"><div><div><h2 class="title">Chapter 12. PMML model execution</h2></div></div></div><p>
				You can import PMML files into your Red Hat Process Automation Manager project using Business Central (<span class="strong strong"><strong>Menu → Design → Projects → Import Asset</strong></span>) or package the PMML files as part of your project knowledge JAR (KJAR) file without Business Central. After you implement your PMML files in your Red Hat Process Automation Manager project, you can execute the PMML-based decision service by embedding PMML calls directly in your Java application or by sending an <code class="literal">ApplyPmmlModelCommand</code> command to a configured KIE Server.
			</p><p>
				For more information about including PMML assets with your project packaging and deployment method, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					You can also include a PMML model as part of a Decision Model and Notation (DMN) service in Business Central. When you include a PMML model within a DMN file, you can invoke that PMML model as a boxed function expression for a DMN decision node or business knowledge model node. For more information about including PMML models in a DMN service, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#dmn-included-models-pmml-proc_dmn-models"><span class="emphasis"><em>Designing a decision service using DMN models</em></span></a>.
				</p></div></div><section class="section" id="pmml-invocation-embedded-proc_pmml-models"><div class="titlepage"><div><div><h2 class="title">12.1. Embedding a PMML call directly in a Java application</h2></div></div></div><p>
					A KIE container is local when the knowledge assets are either embedded directly into the calling program or are physically pulled in using Maven dependencies for the KJAR. You typically embed knowledge assets directly into a project if there is a tight relationship between the version of the code and the version of the PMML definition. Any changes to the decision take effect after you have intentionally updated and redeployed the application. A benefit of this approach is that proper operation does not rely on any external dependencies to the run time, which can be a limitation of locked-down environments.
				</p><p>
					Using Maven dependencies enables further flexibility because the specific version of the decision can dynamically change (for example, by using a system property), and it can be periodically scanned for updates and automatically updated. This introduces an external dependency on the deploy time of the service, but executes the decision locally, reducing reliance on an external service being available during run time.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							A KJAR containing the PMML model to execute has been created. For more information about project packaging, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							In your client application, add the following dependencies to the relevant classpath of your Java project:
						</p><pre class="programlisting language-xml">&lt;!-- Required for the PMML compiler --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.drools&lt;/groupId&gt;
  &lt;artifactId&gt;kie-pmml&lt;/artifactId&gt;
  &lt;version&gt;${rhpam.version}&lt;/version&gt;
&lt;/dependency&gt;

&lt;!-- Required for the KIE public API --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-api&lt;/artifactId&gt;
  &lt;version&gt;${rhpam.version}&lt;/version&gt;
&lt;/dependencies&gt;

&lt;!-- Required if not using classpath KIE container --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-ci&lt;/artifactId&gt;
  &lt;version&gt;${rhpam.version}&lt;/version&gt;
&lt;/dependency&gt;</pre><p class="simpara">
							The <code class="literal">&lt;version&gt;</code> is the Maven artifact version for Red Hat Process Automation Manager currently used in your project (for example, 7.48.0.Final-redhat-00002).
						</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								The legacy <code class="literal">kie-pmml</code> dependency is deprecated with Red Hat Process Automation Manager 7.10.0 and will be replaced by <code class="literal">kie-pmml-trusty</code> dependency in a future Red Hat Process Automation Manager release.
							</p></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Instead of specifying a Red Hat Process Automation Manager <code class="literal">&lt;version&gt;</code> for individual dependencies, consider adding the Red Hat Business Automation bill of materials (BOM) dependency to your project <code class="literal">pom.xml</code> file. The Red Hat Business Automation BOM applies to both Red Hat Decision Manager and Red Hat Process Automation Manager. When you add the BOM files, the correct versions of transitive dependencies from the provided Maven repositories are included in the project.
							</p><p>
								Example BOM dependency:
							</p><pre class="programlisting language-xml">&lt;dependency&gt;
  &lt;groupId&gt;com.redhat.ba&lt;/groupId&gt;
  &lt;artifactId&gt;ba-platform-bom&lt;/artifactId&gt;
  &lt;version&gt;7.10.0.redhat-00002&lt;/version&gt;
  &lt;scope&gt;import&lt;/scope&gt;
  &lt;type&gt;pom&lt;/type&gt;
&lt;/dependency&gt;</pre><p>
								For more information about the Red Hat Business Automation BOM, see <a class="link" href="https://access.redhat.com/solutions/3405361">What is the mapping between RHPAM product and maven library version?</a>.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Create a KIE container from <code class="literal">classpath</code> or <code class="literal">ReleaseId</code>:
						</p><pre class="programlisting language-java">KieServices kieServices = KieServices.Factory.get();

ReleaseId releaseId = kieServices.newReleaseId( "org.acme", "my-kjar", "1.0.0" );
KieContainer kieContainer = kieServices.newKieContainer( releaseId );</pre><p class="simpara">
							Alternative option:
						</p><pre class="programlisting language-java">KieServices kieServices = KieServices.Factory.get();

KieContainer kieContainer = kieServices.getKieClasspathContainer();</pre></li><li class="listitem"><p class="simpara">
							Create an instance of the <code class="literal">PMMLRequestData</code> class, which applies your PMML model to a set of data:
						</p><pre class="programlisting language-java">public class PMMLRequestData {
    private String correlationId; <span id="CO4-1"/><span class="callout">1</span>
    private String modelName; <span id="CO4-2"/><span class="callout">2</span>
    private String source; <span id="CO4-3"/><span class="callout">3</span>
    private List&lt;ParameterInfo&lt;?&gt;&gt; requestParams; <span id="CO4-4"/><span class="callout">4</span>
    ...
}</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO4-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Identifies data that is associated with a particular request or result
								</div></dd><dt><a href="#CO4-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									The name of the model that should be applied to the request data
								</div></dd><dt><a href="#CO4-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									Used by internally generated <code class="literal">PMMLRequestData</code> objects to identify the segment that generated the request
								</div></dd><dt><a href="#CO4-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									The default mechanism for sending input data points
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Create an instance of the <code class="literal">PMML4Result</code> class, which holds the output information that is the result of applying the PMML-based rules to the input data:
						</p><pre class="programlisting language-java">public class PMML4Result {
    private String correlationId;
    private String segmentationId; <span id="CO5-1"/><span class="callout">1</span>
    private String segmentId; <span id="CO5-2"/><span class="callout">2</span>
    private int segmentIndex; <span id="CO5-3"/><span class="callout">3</span>
    private String resultCode; <span id="CO5-4"/><span class="callout">4</span>
    private Map&lt;String, Object&gt; resultVariables; <span id="CO5-5"/><span class="callout">5</span>
    ...
}</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO5-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Used when the model type is <code class="literal">MiningModel</code>. The <code class="literal">segmentationId</code> is used to differentiate between multiple segmentations.
								</div></dd><dt><a href="#CO5-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Used in conjunction with the <code class="literal">segmentationId</code> to identify which segment generated the results.
								</div></dd><dt><a href="#CO5-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									Used to maintain the order of segments.
								</div></dd><dt><a href="#CO5-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									Used to determine whether the model was successfully applied, where <code class="literal">OK</code> indicates success.
								</div></dd><dt><a href="#CO5-5"><span class="callout">5</span></a> </dt><dd><div class="para">
									Contains the name of a resultant variable and its associated value.
								</div></dd></dl></div><p class="simpara">
							In addition to the normal getter methods, the <code class="literal">PMML4Result</code> class also supports the following methods for directly retrieving the values for result variables:
						</p><pre class="programlisting language-java">public &lt;T&gt; Optional&lt;T&gt; getResultValue(String objName, String objField, Class&lt;T&gt; clazz, Object...params)

public Object getResultValue(String objName, String objField, Object...params)</pre></li><li class="listitem"><p class="simpara">
							Create an instance of the <code class="literal">ParameterInfo</code> class, which serves as a wrapper for basic data type objects used as part of the <code class="literal">PMMLRequestData</code> class:
						</p><pre class="programlisting language-java">public class ParameterInfo&lt;T&gt; { <span id="CO6-1"/><span class="callout">1</span>
    private String correlationId;
    private String name; <span id="CO6-2"/><span class="callout">2</span>
    private String capitalizedName;
    private Class&lt;T&gt; type; <span id="CO6-3"/><span class="callout">3</span>
    private T value; <span id="CO6-4"/><span class="callout">4</span>
    ...
}</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO6-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									The parameterized class to handle many different types
								</div></dd><dt><a href="#CO6-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									The name of the variable that is expected as input for the model
								</div></dd><dt><a href="#CO6-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									The class that is the actual type of the variable
								</div></dd><dt><a href="#CO6-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									The actual value of the variable
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Execute the PMML model based on the required PMML class instances that you have created:
						</p><pre class="programlisting language-java">public void executeModel(KieBase kbase,
                         Map&lt;String,Object&gt; variables,
                         String modelName,
                         String correlationId,
                         String modelPkgName) {
    RuleUnitExecutor executor = RuleUnitExecutor.create().bind(kbase);
    PMMLRequestData request = new PMMLRequestData(correlationId, modelName);
    PMML4Result resultHolder = new PMML4Result(correlationId);
    variables.entrySet().forEach( es -&gt; {
        request.addRequestParam(es.getKey(), es.getValue());
    });

    DataSource&lt;PMMLRequestData&gt; requestData = executor.newDataSource("request");
    DataSource&lt;PMML4Result&gt; resultData = executor.newDataSource("results");
    DataSource&lt;PMMLData&gt; internalData = executor.newDataSource("pmmlData");

    requestData.insert(request);
    resultData.insert(resultHolder);

    List&lt;String&gt; possiblePackageNames = calculatePossiblePackageNames(modelName,
                                                                    modelPkgName);
    Class&lt;? extends RuleUnit&gt; ruleUnitClass = getStartingRuleUnit("RuleUnitIndicator",
                                                                (InternalKnowledgeBase)kbase,
                                                                possiblePackageNames);

    if (ruleUnitClass != null) {
        executor.run(ruleUnitClass);
        if ( "OK".equals(resultHolder.getResultCode()) ) {
          // extract result variables here
        }
    }
}

protected Class&lt;? extends RuleUnit&gt; getStartingRuleUnit(String startingRule, InternalKnowledgeBase ikb, List&lt;String&gt; possiblePackages) {
    RuleUnitRegistry unitRegistry = ikb.getRuleUnitRegistry();
    Map&lt;String,InternalKnowledgePackage&gt; pkgs = ikb.getPackagesMap();
    RuleImpl ruleImpl = null;
    for (String pkgName: possiblePackages) {
      if (pkgs.containsKey(pkgName)) {
          InternalKnowledgePackage pkg = pkgs.get(pkgName);
          ruleImpl = pkg.getRule(startingRule);
          if (ruleImpl != null) {
              RuleUnitDescr descr = unitRegistry.getRuleUnitFor(ruleImpl).orElse(null);
              if (descr != null) {
                  return descr.getRuleUnitClass();
              }
          }
      }
    }
    return null;
}

protected List&lt;String&gt; calculatePossiblePackageNames(String modelId, String...knownPackageNames) {
    List&lt;String&gt; packageNames = new ArrayList&lt;&gt;();
    String javaModelId = modelId.replaceAll("\\s","");
    if (knownPackageNames != null &amp;&amp; knownPackageNames.length &gt; 0) {
        for (String knownPkgName: knownPackageNames) {
            packageNames.add(knownPkgName + "." + javaModelId);
        }
    }
    String basePkgName = PMML4UnitImpl.DEFAULT_ROOT_PACKAGE+"."+javaModelId;
    packageNames.add(basePkgName);
    return packageNames;
}</pre><p class="simpara">
							Rules are executed by the <code class="literal">RuleUnitExecutor</code> class. The <code class="literal">RuleUnitExecutor</code> class creates KIE sessions and adds the required <code class="literal">DataSource</code> objects to those sessions, and then executes the rules based on the <code class="literal">RuleUnit</code> that is passed as a parameter to the <code class="literal">run()</code> method. The <code class="literal">calculatePossiblePackageNames</code> and the <code class="literal">getStartingRuleUnit</code> methods determine the fully qualified name of the <code class="literal">RuleUnit</code> class that is passed to the <code class="literal">run()</code> method.
						</p></li></ol></div><p>
					To facilitate your PMML model execution, you can also use a <code class="literal">PMML4ExecutionHelper</code> class supported in Red Hat Process Automation Manager. For more information about the PMML helper class, see <a class="xref" href="#pmml-invocation-helper-classes-ref_pmml-models" title="12.1.1. PMML execution helper class">Section 12.1.1, “PMML execution helper class”</a>.
				</p><section class="section" id="pmml-invocation-helper-classes-ref_pmml-models"><div class="titlepage"><div><div><h3 class="title">12.1.1. PMML execution helper class</h3></div></div></div><p>
						Red Hat Process Automation Manager provides a <code class="literal">PMML4ExecutionHelper</code> class that helps create the <code class="literal">PMMLRequestData</code> class required for PMML model execution and that helps execute rules using the <code class="literal">RuleUnitExecutor</code> class.
					</p><p>
						The following are examples of a PMML model execution without and with the <code class="literal">PMML4ExecutionHelper</code> class, as a comparison:
					</p><div class="formalpara"><p class="title"><strong>Example PMML model execution without using <code class="literal">PMML4ExecutionHelper</code></strong></p><p>
							
<pre class="programlisting language-java">public void executeModel(KieBase kbase,
                         Map&lt;String,Object&gt; variables,
                         String modelName,
                         String correlationId,
                         String modelPkgName) {
    RuleUnitExecutor executor = RuleUnitExecutor.create().bind(kbase);
    PMMLRequestData request = new PMMLRequestData(correlationId, modelName);
    PMML4Result resultHolder = new PMML4Result(correlationId);
    variables.entrySet().forEach( es -&gt; {
        request.addRequestParam(es.getKey(), es.getValue());
    });

    DataSource&lt;PMMLRequestData&gt; requestData = executor.newDataSource("request");
    DataSource&lt;PMML4Result&gt; resultData = executor.newDataSource("results");
    DataSource&lt;PMMLData&gt; internalData = executor.newDataSource("pmmlData");

    requestData.insert(request);
    resultData.insert(resultHolder);

    List&lt;String&gt; possiblePackageNames = calculatePossiblePackageNames(modelName,
                                                                    modelPkgName);
    Class&lt;? extends RuleUnit&gt; ruleUnitClass = getStartingRuleUnit("RuleUnitIndicator",
                                                                (InternalKnowledgeBase)kbase,
                                                                possiblePackageNames);

    if (ruleUnitClass != null) {
        executor.run(ruleUnitClass);
        if ( "OK".equals(resultHolder.getResultCode()) ) {
          // extract result variables here
        }
    }
}

protected Class&lt;? extends RuleUnit&gt; getStartingRuleUnit(String startingRule, InternalKnowledgeBase ikb, List&lt;String&gt; possiblePackages) {
    RuleUnitRegistry unitRegistry = ikb.getRuleUnitRegistry();
    Map&lt;String,InternalKnowledgePackage&gt; pkgs = ikb.getPackagesMap();
    RuleImpl ruleImpl = null;
    for (String pkgName: possiblePackages) {
      if (pkgs.containsKey(pkgName)) {
          InternalKnowledgePackage pkg = pkgs.get(pkgName);
          ruleImpl = pkg.getRule(startingRule);
          if (ruleImpl != null) {
              RuleUnitDescr descr = unitRegistry.getRuleUnitFor(ruleImpl).orElse(null);
              if (descr != null) {
                  return descr.getRuleUnitClass();
              }
          }
      }
    }
    return null;
}

protected List&lt;String&gt; calculatePossiblePackageNames(String modelId, String...knownPackageNames) {
    List&lt;String&gt; packageNames = new ArrayList&lt;&gt;();
    String javaModelId = modelId.replaceAll("\\s","");
    if (knownPackageNames != null &amp;&amp; knownPackageNames.length &gt; 0) {
        for (String knownPkgName: knownPackageNames) {
            packageNames.add(knownPkgName + "." + javaModelId);
        }
    }
    String basePkgName = PMML4UnitImpl.DEFAULT_ROOT_PACKAGE+"."+javaModelId;
    packageNames.add(basePkgName);
    return packageNames;
}</pre>
						</p></div><div class="formalpara"><p class="title"><strong>Example PMML model execution using <code class="literal">PMML4ExecutionHelper</code></strong></p><p>
							
<pre class="programlisting language-java">public void executeModel(KieBase kbase,
                         Map&lt;String,Object&gt; variables,
                         String modelName,
                         String modelPkgName,
                         String correlationId) {
   PMML4ExecutionHelper helper = PMML4ExecutionHelperFactory.getExecutionHelper(modelName, kbase);
   helper.addPossiblePackageName(modelPkgName);

   PMMLRequestData request = new PMMLRequestData(correlationId, modelName);
   variables.entrySet().forEach(entry -&gt; {
     request.addRequestParam(entry.getKey(), entry.getValue);
   });

   PMML4Result resultHolder = helper.submitRequest(request);
   if ("OK".equals(resultHolder.getResultCode)) {
     // extract result variables here
   }
}</pre>
						</p></div><p>
						When you use the <code class="literal">PMML4ExecutionHelper</code>, you do not need to specify the possible package names nor the <code class="literal">RuleUnit</code> class as you would in a typical PMML model execution.
					</p><p>
						To construct a <code class="literal">PMML4ExecutionHelper</code> class, you use the <code class="literal">PMML4ExecutionHelperFactory</code> class to determine how instances of <code class="literal">PMML4ExecutionHelper</code> are retrieved.
					</p><p>
						The following are the available <code class="literal">PMML4ExecutionHelperFactory</code> class methods for constructing a <code class="literal">PMML4ExecutionHelper</code> class:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">PMML4ExecutionHelperFactory methods for PMML assets in a KIE base</span></dt><dd><p class="simpara">
									Use these methods when PMML assets have already been compiled and are being used from an existing KIE base:
								</p><pre class="programlisting language-java">public static PMML4ExecutionHelper getExecutionHelper(String modelName, KieBase kbase)

public static PMML4ExecutionHelper getExecutionHelper(String modelName, KieBase kbase, boolean includeMiningDataSources)</pre></dd><dt><span class="term">PMML4ExecutionHelperFactory methods for PMML assets on the project classpath</span></dt><dd><p class="simpara">
									Use these methods when PMML assets are on the project classpath. The <code class="literal">classPath</code> argument is the project classpath location of the PMML file:
								</p><pre class="programlisting language-java">public static PMML4ExecutionHelper getExecutionHelper(String modelName,  String classPath, KieBaseConfiguration kieBaseConf)

public static PMML4ExecutionHelper getExecutionHelper(String modelName,String classPath, KieBaseConfiguration kieBaseConf, boolean includeMiningDataSources)</pre></dd><dt><span class="term">PMML4ExecutionHelperFactory methods for PMML assets in a byte array</span></dt><dd><p class="simpara">
									Use these methods when PMML assets are in the form of a byte array:
								</p><pre class="programlisting language-java">public static PMML4ExecutionHelper getExecutionHelper(String modelName, byte[] content, KieBaseConfiguration kieBaseConf)

public static PMML4ExecutionHelper getExecutionHelper(String modelName, byte[] content, KieBaseConfiguration kieBaseConf, boolean includeMiningDataSources)</pre></dd><dt><span class="term">PMML4ExecutionHelperFactory methods for PMML assets in a <code class="literal">Resource</code></span></dt><dd><p class="simpara">
									Use these methods when PMML assets are in the form of an <code class="literal">org.kie.api.io.Resource</code> object:
								</p><pre class="programlisting language-java">public static PMML4ExecutionHelper getExecutionHelper(String modelName, Resource resource, KieBaseConfiguration kieBaseConf)

public static PMML4ExecutionHelper getExecutionHelper(String modelName, Resource resource, KieBaseConfiguration kieBaseConf, boolean includeMiningDataSources)</pre></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The classpath, byte array, and resource <code class="literal">PMML4ExecutionHelperFactory</code> methods create a KIE container for the generated rules and Java classes. The container is used as the source of the KIE base that the <code class="literal">RuleUnitExecutor</code> uses. The container is not persisted. The <code class="literal">PMML4ExecutionHelperFactory</code> method for PMML assets that are already in a KIE base does not create a KIE container in this way.
						</p></div></div></section></section><section class="section" id="pmml-invocation-kie-server-proc_pmml-models"><div class="titlepage"><div><div><h2 class="title">12.2. Executing a PMML model using KIE Server</h2></div></div></div><p>
					You can execute PMML models that have been deployed to KIE Server by sending the <code class="literal">ApplyPmmlModelCommand</code> command to the configured KIE Server. When you use this command, a <code class="literal">PMMLRequestData</code> object is sent to the KIE Server and a <code class="literal">PMML4Result</code> result object is received as a reply. You can send PMML requests to KIE Server through the KIE Server REST API from a configured Java class or directly from a REST client.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							KIE Server is installed and configured, including a known user name and credentials for a user with the <code class="literal">kie-server</code> role. For installation options, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/installing_and_configuring_red_hat_process_automation_manager#assembly-planning"><span class="emphasis"><em>Planning a Red Hat Process Automation Manager installation</em></span></a>.
						</li><li class="listitem">
							A KIE container is deployed in KIE Server in the form of a KJAR that includes the PMML model. For more information about project packaging, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>.
						</li><li class="listitem">
							You have the container ID of the KIE container containing the PMML model.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							In your client application, add the following dependencies to the relevant classpath of your Java project:
						</p><pre class="programlisting language-xml">&lt;!-- Required for the PMML compiler --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.drools&lt;/groupId&gt;
  &lt;artifactId&gt;kie-pmml&lt;/artifactId&gt;
  &lt;version&gt;${rhpam.version}&lt;/version&gt;
&lt;/dependency&gt;

&lt;!-- Required for the KIE public API --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-api&lt;/artifactId&gt;
  &lt;version&gt;${rhpam.version}&lt;/version&gt;
&lt;/dependencies&gt;

&lt;!-- Required for the KIE Server Java client API --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie.server&lt;/groupId&gt;
  &lt;artifactId&gt;kie-server-client&lt;/artifactId&gt;
  &lt;version&gt;${rhpam.version}&lt;/version&gt;
&lt;/dependency&gt;

&lt;!-- Required if not using classpath KIE container --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-ci&lt;/artifactId&gt;
  &lt;version&gt;${rhpam.version}&lt;/version&gt;
&lt;/dependency&gt;</pre><p class="simpara">
							The <code class="literal">&lt;version&gt;</code> is the Maven artifact version for Red Hat Process Automation Manager currently used in your project (for example, 7.48.0.Final-redhat-00002).
						</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								The legacy <code class="literal">kie-pmml</code> dependency is deprecated with Red Hat Process Automation Manager 7.10.0 and will be replaced by <code class="literal">kie-pmml-trusty</code> dependency in a future Red Hat Process Automation Manager release.
							</p></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Instead of specifying a Red Hat Process Automation Manager <code class="literal">&lt;version&gt;</code> for individual dependencies, consider adding the Red Hat Business Automation bill of materials (BOM) dependency to your project <code class="literal">pom.xml</code> file. The Red Hat Business Automation BOM applies to both Red Hat Decision Manager and Red Hat Process Automation Manager. When you add the BOM files, the correct versions of transitive dependencies from the provided Maven repositories are included in the project.
							</p><p>
								Example BOM dependency:
							</p><pre class="programlisting language-xml">&lt;dependency&gt;
  &lt;groupId&gt;com.redhat.ba&lt;/groupId&gt;
  &lt;artifactId&gt;ba-platform-bom&lt;/artifactId&gt;
  &lt;version&gt;7.10.0.redhat-00002&lt;/version&gt;
  &lt;scope&gt;import&lt;/scope&gt;
  &lt;type&gt;pom&lt;/type&gt;
&lt;/dependency&gt;</pre><p>
								For more information about the Red Hat Business Automation BOM, see <a class="link" href="https://access.redhat.com/solutions/3405361">What is the mapping between RHPAM product and maven library version?</a>.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Create a KIE container from <code class="literal">classpath</code> or <code class="literal">ReleaseId</code>:
						</p><pre class="programlisting language-java">KieServices kieServices = KieServices.Factory.get();

ReleaseId releaseId = kieServices.newReleaseId( "org.acme", "my-kjar", "1.0.0" );
KieContainer kieContainer = kieServices.newKieContainer( releaseId );</pre><p class="simpara">
							Alternative option:
						</p><pre class="programlisting language-java">KieServices kieServices = KieServices.Factory.get();

KieContainer kieContainer = kieServices.getKieClasspathContainer();</pre></li><li class="listitem"><p class="simpara">
							Create a class for sending requests to KIE Server and receiving responses:
						</p><pre class="programlisting language-java">public class ApplyScorecardModel {
  private static final ReleaseId releaseId =
          new ReleaseId("org.acme","my-kjar","1.0.0");
  private static final String containerId = "SampleModelContainer";
  private static KieCommands commandFactory;
  private static ClassLoader kjarClassLoader; <span id="CO7-1"/><span class="callout">1</span>
  private RuleServicesClient serviceClient; <span id="CO7-2"/><span class="callout">2</span>

  // Attributes specific to your class instance
  private String rankedFirstCode;
  private Double score;

  // Initialization of non-final static attributes
  static {
    commandFactory = KieServices.Factory.get().getCommands();

    // Specifications for kjarClassLoader, if used
    KieMavenRepository kmp = KieMavenRepository.getMavenRepository();
    File artifactFile = kmp.resolveArtifact(releaseId).getFile();
    if (artifactFile != null) {
      URL urls[] = new URL[1];
      try {
        urls[0] = artifactFile.toURI().toURL();
        classLoader = new KieURLClassLoader(urls,PMML4Result.class.getClassLoader());
      } catch (MalformedURLException e) {
        logger.error("Error getting classLoader for "+containerId);
        logger.error(e.getMessage());
      }
    } else {
      logger.warn("Did not find the artifact file for "+releaseId.toString());
    }
  }

  public ApplyScorecardModel(KieServicesConfiguration kieConfig) {
    KieServicesClient clientFactory = KieServicesFactory.newKieServicesClient(kieConfig);
    serviceClient = clientFactory.getServicesClient(RuleServicesClient.class);
  }
  ...
  // Getters and setters
  ...

  // Method for executing the PMML model on KIE Server
  public void applyModel(String occupation, int age) {
    PMMLRequestData input = new PMMLRequestData("1234","SampleModelName"); <span id="CO7-3"/><span class="callout">3</span>
    input.addRequestParam(new ParameterInfo("1234","occupation",String.class,occupation));
    input.addRequestParam(new ParameterInfo("1234","age",Integer.class,age));

    CommandFactoryServiceImpl cf = (CommandFactoryServiceImpl)commandFactory;
    ApplyPmmlModelCommand command = (ApplyPmmlModelCommand) cf.newApplyPmmlModel(request); <span id="CO7-4"/><span class="callout">4</span>

    ServiceResponse&lt;ExecutionResults&gt; results =
        ruleClient.executeCommandsWithResults(CONTAINER_ID, command); <span id="CO7-5"/><span class="callout">5</span>

    if (results != null) {  <span id="CO7-6"/><span class="callout">6</span>
      PMML4Result resultHolder = (PMML4Result)results.getResult().getValue("results");
      if (resultHolder != null &amp;&amp; "OK".equals(resultHolder.getResultCode())) {
        this.score = resultHolder.getResultValue("ScoreCard","score",Double.class).get();
        Map&lt;String,Object&gt; rankingMap =
             (Map&lt;String,Object&gt;)resultHolder.getResultValue("ScoreCard","ranking");
        if (rankingMap != null &amp;&amp; !rankingMap.isEmpty()) {
          this.rankedFirstCode = rankingMap.keySet().iterator().next();
        }
      }
    }
  }
}</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO7-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									Defines the class loader if you did not include the KJAR in your client project dependencies
								</div></dd><dt><a href="#CO7-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Identifies the service client as defined in the configuration settings, including KIE Server REST API access credentials
								</div></dd><dt><a href="#CO7-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									Initializes a <code class="literal">PMMLRequestData</code> object
								</div></dd><dt><a href="#CO7-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									Creates an instance of the <code class="literal">ApplyPmmlModelCommand</code>
								</div></dd><dt><a href="#CO7-5"><span class="callout">5</span></a> </dt><dd><div class="para">
									Sends the command using the service client
								</div></dd><dt><a href="#CO7-6"><span class="callout">6</span></a> </dt><dd><div class="para">
									Retrieves the results of the executed PMML model
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Execute the class instance to send the PMML invocation request to KIE Server.
						</p><p class="simpara">
							Alternatively, you can use JMS and REST interfaces to send the <code class="literal">ApplyPmmlModelCommand</code> command to KIE Server. For REST requests, you use the <code class="literal">ApplyPmmlModelCommand</code> command as a <code class="literal">POST</code> request to <code class="literal">http://SERVER:PORT/kie-server/services/rest/server/containers/instances/{containerId}</code> in JSON, JAXB, or XStream request format.
						</p><div class="formalpara"><p class="title"><strong>Example POST endpoint</strong></p><p>
								
<pre class="screen">http://localhost:8080/kie-server/services/rest/server/containers/instances/SampleModelContainer</pre>
							</p></div><div class="formalpara"><p class="title"><strong>Example JSON request body</strong></p><p>
								
<pre class="programlisting language-json">{
  "commands": [ {
      "apply-pmml-model-command": {
        "outIdentifier": null,
        "packageName": null,
        "hasMining": false,
        "requestData": {
          "correlationId": "123",
          "modelName": "SimpleScorecard",
          "source": null,
          "requestParams": [
            {
              "correlationId": "123",
              "name": "param1",
              "type": "java.lang.Double",
              "value": "10.0"
            },
            {
              "correlationId": "123",
              "name": "param2",
              "type": "java.lang.Double",
              "value": "15.0"
            }
          ]
        }
      }
    }
  ]
}</pre>
							</p></div><div class="formalpara"><p class="title"><strong>Example curl request with endpoint and body</strong></p><p>
								
<pre class="screen">curl -X POST "http://localhost:8080/kie-server/services/rest/server/containers/instances/SampleModelContainer" -H "accept: application/json" -H "content-type: application/json" -d "{ \"commands\": [ { \"apply-pmml-model-command\": { \"outIdentifier\": null, \"packageName\": null, \"hasMining\": false, \"requestData\": { \"correlationId\": \"123\", \"modelName\": \"SimpleScorecard\", \"source\": null, \"requestParams\": [ { \"correlationId\": \"123\", \"name\": \"param1\", \"type\": \"java.lang.Double\", \"value\": \"10.0\" }, { \"correlationId\": \"123\", \"name\": \"param2\", \"type\": \"java.lang.Double\", \"value\": \"15.0\" } ] } } } ]}"</pre>
							</p></div><div class="formalpara"><p class="title"><strong>Example JSON response</strong></p><p>
								
<pre class="programlisting language-json">{
  "results" : [ {
    "value" : {"org.kie.api.pmml.DoubleFieldOutput":{
  "value" : 40.8,
  "correlationId" : "123",
  "segmentationId" : null,
  "segmentId" : null,
  "name" : "OverallScore",
  "displayValue" : "OverallScore",
  "weight" : 1.0
}},
    "key" : "OverallScore"
  }, {
    "value" : {"org.kie.api.pmml.PMML4Result":{
  "resultVariables" : {
    "OverallScore" : {
      "value" : 40.8,
      "correlationId" : "123",
      "segmentationId" : null,
      "segmentId" : null,
      "name" : "OverallScore",
      "displayValue" : "OverallScore",
      "weight" : 1.0
    },
    "ScoreCard" : {
      "modelName" : "SimpleScorecard",
      "score" : 40.8,
      "holder" : {
        "modelName" : "SimpleScorecard",
        "correlationId" : "123",
        "voverallScore" : null,
        "moverallScore" : true,
        "vparam1" : 10.0,
        "mparam1" : false,
        "vparam2" : 15.0,
        "mparam2" : false
      },
      "enableRC" : true,
      "pointsBelow" : true,
      "ranking" : {
        "reasonCh1" : 5.0,
        "reasonCh2" : -6.0
      }
    }
  },
  "correlationId" : "123",
  "segmentationId" : null,
  "segmentId" : null,
  "segmentIndex" : 0,
  "resultCode" : "OK",
  "resultObjectName" : null
}},
    "key" : "results"
  } ],
  "facts" : [ ]
}</pre>
							</p></div></li></ol></div></section></section><section class="chapter" id="additional_resources_2"><div class="titlepage"><div><div><h2 class="title">Chapter 13. Additional resources</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="http://dmg.org/pmml/pmml-v4-2-1.html">PMML specification</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-kie-apis"><span class="emphasis"><em>Interacting with Red Hat Process Automation Manager using KIE APIs</em></span></a>
					</li></ul></div></section></div><div class="part" id="assembly-drl-rules"><div class="titlepage"><div><div><h1 class="title">Part III. Designing a decision service using DRL rules</h1></div></div></div><div class="partintro" id="idm139921839577216"><div/><p>
				As a business rules developer, you can define business rules using the DRL (Drools Rule Language) designer in Business Central. DRL rules are defined directly in free-form <code class="literal">.drl</code> text files instead of in a guided or tabular format like other types of rule assets in Business Central. These DRL files form the core of the decision service for your project.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					You can also design your decision service using Decision Model and Notation (DMN) models instead of rule-based or table-based assets. For information about DMN support in Red Hat Process Automation Manager 7.10, see the following resources:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/getting_started_with_red_hat_process_automation_manager#assembly-getting-started-decision-services"><span class="emphasis"><em>Getting started with decision services</em></span></a> (step-by-step tutorial with a DMN decision service example)
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-dmn-models"><span class="emphasis"><em>Designing a decision service using DMN models</em></span></a> (overview of DMN support and capabilities in Red Hat Process Automation Manager)
						</li></ul></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The space and project for the DRL rules have been created in Business Central. Each asset is associated with a project assigned to a space. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/getting_started_with_red_hat_process_automation_manager#assembly-getting-started-decision-services"><span class="emphasis"><em>Getting started with decision services</em></span></a>.
					</li></ul></div><div class="toc"><p><strong>Table of Contents</strong></p><ul class="toc"><li><span class="chapter"><a href="#decision-authoring-assets-ref_drl-rules">14. Decision-authoring assets in Red Hat Process Automation Manager</a></span></li><li><span class="chapter"><a href="#drl-rules-con_drl-rules">15. DRL (Drools Rule Language) rules</a></span><ul><li><span class="section"><a href="#drl-packages-con_drl-rules">15.1. Packages in DRL</a></span></li><li><span class="section"><a href="#drl-imports-con_drl-rules">15.2. Import statements in DRL</a></span></li><li><span class="section"><a href="#drl-functions-con_drl-rules">15.3. Functions in DRL</a></span></li><li><span class="section"><a href="#drl-queries-con_drl-rules">15.4. Queries in DRL</a></span></li><li><span class="section"><a href="#drl-declarations-con_drl-rules">15.5. Type declarations and metadata in DRL</a></span><ul><li><span class="section"><a href="#drl-declarations-without-metadata-con_drl-rules">15.5.1. Type declarations without metadata in DRL</a></span></li><li><span class="section"><a href="#drl-declarations-enumerative-con_drl-rules">15.5.2. Enumerative type declarations in DRL</a></span></li><li><span class="section"><a href="#drl-declarations-extended-con_drl-rules">15.5.3. Extended type declarations in DRL</a></span></li><li><span class="section"><a href="#drl-declarations-with-metadata-con_drl-rules">15.5.4. Type declarations with metadata in DRL</a></span></li><li><span class="section"><a href="#drl-declarations-metadata-tags-ref_drl-rules">15.5.5. Metadata tags for fact type and attribute declarations in DRL</a></span></li><li><span class="section"><a href="#property-change-listeners-con_drl-rules">15.5.6. Property-change settings and listeners for fact types</a></span></li><li><span class="section"><a href="#drl-declarations-access-con_drl-rules">15.5.7. Access to DRL declared types in application code</a></span></li></ul></li><li><span class="section"><a href="#drl-globals-con_drl-rules">15.6. Global variables in DRL</a></span></li><li><span class="section"><a href="#rules-attributes-ref_drl-rules">15.7. Rule attributes in DRL</a></span><ul><li><span class="section"><a href="#drl-timers-calendars-con_drl-rules">15.7.1. Timer and calendar rule attributes in DRL</a></span></li></ul></li><li><span class="section"><a href="#drl-rules-WHEN-con_drl-rules">15.8. Rule conditions in DRL (WHEN)</a></span><ul><li><span class="section"><a href="#patterns_and_constraints">15.8.1. Patterns and constraints</a></span></li><li><span class="section"><a href="#bound_variables_in_patterns_and_constraints">15.8.2. Bound variables in patterns and constraints</a></span></li><li><span class="section"><a href="#nested_constraints_and_inline_casts">15.8.3. Nested constraints and inline casts</a></span></li><li><span class="section"><a href="#date_literal_in_constraints">15.8.4. Date literal in constraints</a></span></li><li><span class="section"><a href="#drl-operators-ref_drl-rules">15.8.5. Supported operators in DRL pattern constraints</a></span></li><li><span class="section"><a href="#drl-operator-precedence-ref_drl-rules">15.8.6. Operator precedence in DRL pattern constraints</a></span></li><li><span class="section"><a href="#drl-rules-WHEN-elements-ref_drl-rules">15.8.7. Supported rule condition elements in DRL (keywords)</a></span></li><li><span class="section"><a href="#drl-rules-oopath-con_drl-rules">15.8.8. OOPath syntax with graphs of objects in DRL rule conditions</a></span></li></ul></li><li><span class="section"><a href="#drl-rules-THEN-con_drl-rules">15.9. Rule actions in DRL (THEN)</a></span><ul><li><span class="section"><a href="#drl-rules-THEN-methods-ref_drl-rules">15.9.1. Supported rule action methods in DRL</a></span></li><li><span class="section"><a href="#drl-rules-THEN-methods-variables-ref_drl-rules">15.9.2. Other rule action methods from <code class="literal">drools</code> and <code class="literal">kcontext</code> variables</a></span></li><li><span class="section"><a href="#drl-rules-THEN-advanced-con_drl-rules">15.9.3. Advanced rule actions with conditional and named consequences</a></span></li></ul></li><li><span class="section"><a href="#drl-rules-comments-con_drl-rules">15.10. Comments in DRL files</a></span></li><li><span class="section"><a href="#drl-rules-errors-ref_drl-rules">15.11. Error messages for DRL troubleshooting</a></span></li><li><span class="section"><a href="#drl-rule-units-con_drl-rules">15.12. Rule units in DRL rule sets</a></span><ul><li><span class="section"><a href="#data_sources_for_rule_units">15.12.1. Data sources for rule units</a></span></li><li><span class="section"><a href="#rule_unit_execution_control">15.12.2. Rule unit execution control</a></span></li><li><span class="section"><a href="#rule_unit_identity_conflicts">15.12.3. Rule unit identity conflicts</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#data-objects-con_drl-rules">16. Data objects</a></span><ul><li><span class="section"><a href="#data-objects-create-proc_drl-rules">16.1. Creating data objects</a></span></li></ul></li><li><span class="chapter"><a href="#drl-rules-central-create-proc">17. Creating DRL rules in Business Central</a></span><ul><li><span class="section"><a href="#drl-rules-WHEN-proc">17.1. Adding WHEN conditions in DRL rules</a></span></li><li><span class="section"><a href="#drl-rules-THEN-proc">17.2. Adding THEN actions in DRL rules</a></span></li></ul></li><li><span class="chapter"><a href="#assets-executing-proc_drl-rules">18. Executing rules</a></span></li><li><span class="chapter"><a href="#drl-rules-other-con">19. Other methods for creating and executing DRL rules</a></span><ul><li><span class="section"><a href="#drl-rules-codeready-studio-create-proc_drl-rules">19.1. Creating and executing DRL rules in Red Hat CodeReady Studio</a></span></li><li><span class="section"><a href="#drl-rules-java-create-proc_drl-rules">19.2. Creating and executing DRL rules using Java</a></span></li><li><span class="section"><a href="#drl-rules-maven-create-proc_drl-rules">19.3. Creating and executing DRL rules using Maven</a></span></li></ul></li><li><span class="chapter"><a href="#decision-examples-IDE-con_drl-rules">20. Example decisions in Red Hat Process Automation Manager for an IDE</a></span><ul><li><span class="section"><a href="#decision-examples-IDE-proc_drl-rules">20.1. Importing and executing Red Hat Process Automation Manager example decisions in an IDE</a></span></li><li><span class="section"><a href="#decision-examples-helloworld-ref_drl-rules">20.2. Hello World example decisions (basic rules and debugging)</a></span></li><li><span class="section"><a href="#decision-examples-state-ref_drl-rules">20.3. State example decisions (forward chaining and conflict resolution)</a></span></li><li><span class="section"><a href="#decision-examples-fibonacci-ref_drl-rules">20.4. Fibonacci example decisions (recursion and conflict resolution)</a></span></li><li><span class="section"><a href="#decision-examples-pricing-ref_drl-rules">20.5. Pricing example decisions (decision tables)</a></span></li><li><span class="section"><a href="#decision-examples-petstore-ref_drl-rules">20.6. Pet Store example decisions (agenda groups, global variables, callbacks, and GUI integration)</a></span></li><li><span class="section"><a href="#decision-examples-politician-ref_drl-rules">20.7. Honest Politician example decisions (truth maintenance and salience)</a></span></li><li><span class="section"><a href="#decision-examples-sudoku-ref_drl-rules">20.8. Sudoku example decisions (complex pattern matching, callbacks, and GUI integration)</a></span></li><li><span class="section"><a href="#decision-examples-conway-ref_drl-rules">20.9. Conway’s Game of Life example decisions (ruleflow groups and GUI integration)</a></span></li><li><span class="section"><a href="#decision-examples-doom-ref_drl-rules">20.10. House of Doom example decisions (backward chaining and recursion)</a></span></li></ul></li><li><span class="chapter"><a href="#performance-tuning-drl-ref_drl-rules">21. Performance tuning considerations with DRL</a></span></li><li><span class="chapter"><a href="#next_steps">22. Next steps</a></span></li></ul></div></div><section class="chapter" id="decision-authoring-assets-ref_drl-rules"><div class="titlepage"><div><div><h2 class="title">Chapter 14. Decision-authoring assets in Red Hat Process Automation Manager</h2></div></div></div><p>
				Red Hat Process Automation Manager supports several assets that you can use to define business decisions for your decision service. Each decision-authoring asset has different advantages, and you might prefer to use one or a combination of multiple assets depending on your goals and needs.
			</p><p>
				The following table highlights the main decision-authoring assets supported in Red Hat Process Automation Manager projects to help you decide or confirm the best method for defining decisions in your decision service.
			</p><div class="table" id="idm139921828494816"><p class="title"><strong>Table 14.1. Decision-authoring assets supported in Red Hat Process Automation Manager</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"/><col style="width: 40%; " class="col_2"/><col style="width: 20%; " class="col_3"/><col style="width: 20%; " class="col_4"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921837795104" scope="col">Asset</th><th align="left" valign="top" id="idm139921837794016" scope="col">Highlights</th><th align="left" valign="top" id="idm139921837792928" scope="col">Authoring tools</th><th align="left" valign="top" id="idm139921837791840" scope="col">Documentation</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921837795104">
							<p>
								Decision Model and Notation (DMN) models
							</p>
							</td><td align="left" valign="top" headers="idm139921837794016">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are decision models based on a notation standard defined by the Object Management Group (OMG)
									</li><li class="listitem">
										Use graphical decision requirements diagrams (DRDs) that represent part or all of the overall decision requirements graph (DRG) to trace business decision flows
									</li><li class="listitem">
										Use an XML schema that allows the DMN models to be shared between DMN-compliant platforms
									</li><li class="listitem">
										Support Friendly Enough Expression Language (FEEL) to define decision logic in DMN decision tables and other DMN boxed expressions
									</li><li class="listitem">
										Can be integrated efficiently with Business Process Model and Notation (BPMN) process models
									</li><li class="listitem">
										Are optimal for creating comprehensive, illustrative, and stable decision flows
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921837792928">
							<p>
								Business Central or other DMN-compliant editor
							</p>
							</td><td align="left" valign="top" headers="idm139921837791840">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-dmn-models"><span class="emphasis"><em>Designing a decision service using DMN models</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921837795104">
							<p>
								Guided decision tables
							</p>
							</td><td align="left" valign="top" headers="idm139921837794016">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are tables of rules that you create in a UI-based table designer in Business Central
									</li><li class="listitem">
										Are a wizard-led alternative to spreadsheet decision tables
									</li><li class="listitem">
										Provide fields and options for acceptable input
									</li><li class="listitem">
										Support template keys and values for creating rule templates
									</li><li class="listitem">
										Support hit policies, real-time validation, and other additional features not supported in other assets
									</li><li class="listitem">
										Are optimal for creating rules in a controlled tabular format to minimize compilation errors
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921837792928">
							<p>
								Business Central
							</p>
							</td><td align="left" valign="top" headers="idm139921837791840">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-guided-decision-tables"><span class="emphasis"><em>Designing a decision service using guided decision tables</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921837795104">
							<p>
								Spreadsheet decision tables
							</p>
							</td><td align="left" valign="top" headers="idm139921837794016">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are XLS or XLSX spreadsheet decision tables that you can upload into Business Central
									</li><li class="listitem">
										Support template keys and values for creating rule templates
									</li><li class="listitem">
										Are optimal for creating rules in decision tables already managed outside of Business Central
									</li><li class="listitem">
										Have strict syntax requirements for rules to be compiled properly when uploaded
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921837792928">
							<p>
								Spreadsheet editor
							</p>
							</td><td align="left" valign="top" headers="idm139921837791840">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-decision-tables"><span class="emphasis"><em>Designing a decision service using spreadsheet decision tables</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921837795104">
							<p>
								Guided rules
							</p>
							</td><td align="left" valign="top" headers="idm139921837794016">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are individual rules that you create in a UI-based rule designer in Business Central
									</li><li class="listitem">
										Provide fields and options for acceptable input
									</li><li class="listitem">
										Are optimal for creating single rules in a controlled format to minimize compilation errors
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921837792928">
							<p>
								Business Central
							</p>
							</td><td align="left" valign="top" headers="idm139921837791840">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-guided-rules"><span class="emphasis"><em>Designing a decision service using guided rules</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921837795104">
							<p>
								Guided rule templates
							</p>
							</td><td align="left" valign="top" headers="idm139921837794016">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are reusable rule structures that you create in a UI-based template designer in Business Central
									</li><li class="listitem">
										Provide fields and options for acceptable input
									</li><li class="listitem">
										Support template keys and values for creating rule templates (fundamental to the purpose of this asset)
									</li><li class="listitem">
										Are optimal for creating many rules with the same rule structure but with different defined field values
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921837792928">
							<p>
								Business Central
							</p>
							</td><td align="left" valign="top" headers="idm139921837791840">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-guided-rule-templates"><span class="emphasis"><em>Designing a decision service using guided rule templates</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921837795104">
							<p>
								DRL rules
							</p>
							</td><td align="left" valign="top" headers="idm139921837794016">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are individual rules that you define directly in <code class="literal">.drl</code> text files
									</li><li class="listitem">
										Provide the most flexibility for defining rules and other technicalities of rule behavior
									</li><li class="listitem">
										Can be created in certain standalone environments and integrated with Red Hat Process Automation Manager
									</li><li class="listitem">
										Are optimal for creating rules that require advanced DRL options
									</li><li class="listitem">
										Have strict syntax requirements for rules to be compiled properly
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921837792928">
							<p>
								Business Central or integrated development environment (IDE)
							</p>
							</td><td align="left" valign="top" headers="idm139921837791840">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-drl-rules"><span class="emphasis"><em>Designing a decision service using DRL rules</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921837795104">
							<p>
								Predictive Model Markup Language (PMML) models
							</p>
							</td><td align="left" valign="top" headers="idm139921837794016">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are predictive data-analytic models based on a notation standard defined by the Data Mining Group (DMG)
									</li><li class="listitem">
										Use an XML schema that allows the PMML models to be shared between PMML-compliant platforms
									</li><li class="listitem">
										Support Regression, Scorecard, Tree, Mining, and other model types
									</li><li class="listitem">
										Can be included with a standalone Red Hat Process Automation Manager project or imported into a project in Business Central
									</li><li class="listitem">
										Are optimal for incorporating predictive data into decision services in Red Hat Process Automation Manager
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921837792928">
							<p>
								PMML or XML editor
							</p>
							</td><td align="left" valign="top" headers="idm139921837791840">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-pmml-models"><span class="emphasis"><em>Designing a decision service using PMML models</em></span></a>
							</p>
							</td></tr></tbody></table></div></div></section><section class="chapter" id="drl-rules-con_drl-rules"><div class="titlepage"><div><div><h2 class="title">Chapter 15. DRL (Drools Rule Language) rules</h2></div></div></div><p>
				DRL (Drools Rule Language) rules are business rules that you define directly in <code class="literal">.drl</code> text files. These DRL files are the source in which all other rule assets in Business Central are ultimately rendered. You can create and manage DRL files within the Business Central interface, or create them externally as part of a Maven or Java project using Red Hat CodeReady Studio or another integrated development environment (IDE). A DRL file can contain one or more rules that define at a minimum the rule conditions (<code class="literal">when</code>) and actions (<code class="literal">then</code>). The DRL designer in Business Central provides syntax highlighting for Java, DRL, and XML.
			</p><p>
				DRL files consist of the following components:
			</p><div class="formalpara"><p class="title"><strong>Components in a DRL file</strong></p><p>
					
<pre class="screen">package

import

function  // Optional

query  // Optional

declare   // Optional

global   // Optional

rule "rule name"
    // Attributes
    when
        // Conditions
    then
        // Actions
end

rule "rule2 name"

...</pre>
				</p></div><p>
				The following example DRL rule determines the age limit in a loan application decision service:
			</p><div class="formalpara"><p class="title"><strong>Example rule for loan application age limit</strong></p><p>
					
<pre class="screen">rule "Underage"
  salience 15
  agenda-group "applicationGroup"
  when
    $application : LoanApplication()
    Applicant( age &lt; 21 )
  then
    $application.setApproved( false );
    $application.setExplanation( "Underage" );
end</pre>
				</p></div><p>
				A DRL file can contain single or multiple rules, queries, and functions, and can define resource declarations such as imports, globals, and attributes that are assigned and used by your rules and queries. The DRL package must be listed at the top of a DRL file and the rules are typically listed last. All other DRL components can follow any order.
			</p><p>
				Each rule must have a unique name within the rule package. If you use the same rule name more than once in any DRL file in the package, the rules fail to compile. Always enclose rule names with double quotation marks (<code class="literal">rule "rule name"</code>) to prevent possible compilation errors, especially if you use spaces in rule names.
			</p><p>
				All data objects related to a DRL rule must be in the same project package as the DRL file in Business Central. Assets in the same package are imported by default. Existing assets in other packages can be imported with the DRL rule.
			</p><section class="section" id="drl-packages-con_drl-rules"><div class="titlepage"><div><div><h2 class="title">15.1. Packages in DRL</h2></div></div></div><p>
					A package is a folder of related assets in Red Hat Process Automation Manager, such as data objects, DRL files, decision tables, and other asset types. A package also serves as a unique namespace for each group of rules. A single rule base can contain multiple packages. You typically store all the rules for a package in the same file as the package declaration so that the package is self-contained. However, you can import objects from other packages that you want to use in the rules.
				</p><p>
					The following example is a package name and namespace for a DRL file in a mortgage application decision service:
				</p><div class="formalpara"><p class="title"><strong>Example package definition in a DRL file</strong></p><p>
						
<pre class="screen">package org.mortgages;</pre>
					</p></div></section><section class="section" id="drl-imports-con_drl-rules"><div class="titlepage"><div><div><h2 class="title">15.2. Import statements in DRL</h2></div></div></div><p>
					Similar to import statements in Java, imports in DRL files identify the fully qualified paths and type names for any objects that you want to use in the rules. You specify the package and data object in the format <code class="literal">packageName.objectName</code>, with multiple imports on separate lines. The decision engine automatically imports classes from the Java package with the same name as the DRL package and from the package <code class="literal">java.lang</code>.
				</p><p>
					The following example is an import statement for a loan application object in a mortgage application decision service:
				</p><div class="formalpara"><p class="title"><strong>Example import statement in a DRL file</strong></p><p>
						
<pre class="screen">import org.mortgages.LoanApplication;</pre>
					</p></div></section><section class="section" id="drl-functions-con_drl-rules"><div class="titlepage"><div><div><h2 class="title">15.3. Functions in DRL</h2></div></div></div><p>
					Functions in DRL files put semantic code in your rule source file instead of in Java classes. Functions are especially useful if an action (<code class="literal">then</code>) part of a rule is used repeatedly and only the parameters differ for each rule. Above the rules in the DRL file, you can declare the function or import a static method from a helper class as a function, and then use the function by name in an action (<code class="literal">then</code>) part of the rule.
				</p><p>
					The following examples illustrate a function that is either declared or imported in a DRL file:
				</p><div class="formalpara"><p class="title"><strong>Example function declaration with a rule (option 1)</strong></p><p>
						
<pre class="screen">function String hello(String applicantName) {
    return "Hello " + applicantName + "!";
}

rule "Using a function"
  when
    // Empty
  then
    System.out.println( hello( "James" ) );
end</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Example function import with a rule (option 2)</strong></p><p>
						
<pre class="screen">import function my.package.applicant.hello;

rule "Using a function"
  when
    // Empty
  then
    System.out.println( hello( "James" ) );
end</pre>
					</p></div></section><section class="section" id="drl-queries-con_drl-rules"><div class="titlepage"><div><div><h2 class="title">15.4. Queries in DRL</h2></div></div></div><p>
					Queries in DRL files search the working memory of the decision engine for facts related to the rules in the DRL file. You add the query definitions in DRL files and then obtain the matching results in your application code. Queries search for a set of defined conditions and do not require <code class="literal">when</code> or <code class="literal">then</code> specifications. Query names are global to the KIE base and therefore must be unique among all other rule queries in the project. To return the results of a query, you construct a <code class="literal">QueryResults</code> definition using <code class="literal">ksession.getQueryResults("name")</code>, where <code class="literal">"name"</code> is the query name. This returns a list of query results, which enable you to retrieve the objects that matched the query. You define the query and query results parameters above the rules in the DRL file.
				</p><p>
					The following example is a query definition in a DRL file for underage applicants in a mortgage application decision service, with the accompanying application code:
				</p><div class="formalpara"><p class="title"><strong>Example query definition in a DRL file</strong></p><p>
						
<pre class="screen">query "people under the age of 21"
    $person : Person( age &lt; 21 )
end</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Example application code to obtain query results</strong></p><p>
						
<pre class="programlisting language-java">QueryResults results = ksession.getQueryResults( "people under the age of 21" );
System.out.println( "we have " + results.size() + " people under the age  of 21" );</pre>
					</p></div><p>
					You can also iterate over the returned <code class="literal">QueryResults</code> using a standard <code class="literal">for</code> loop. Each element is a <code class="literal">QueryResultsRow</code> that you can use to access each of the columns in the tuple.
				</p><div class="formalpara"><p class="title"><strong>Example application code to obtain and iterate over query results</strong></p><p>
						
<pre class="programlisting language-java">QueryResults results = ksession.getQueryResults( "people under the age of 21" );
System.out.println( "we have " + results.size() + " people under the age of 21" );

System.out.println( "These people are under the age of 21:" );

for ( QueryResultsRow row : results ) {
    Person person = ( Person ) row.get( "person" );
    System.out.println( person.getName() + "\n" );
}</pre>
					</p></div></section><section class="section" id="drl-declarations-con_drl-rules"><div class="titlepage"><div><div><h2 class="title">15.5. Type declarations and metadata in DRL</h2></div></div></div><p>
					Declarations in DRL files define new fact types or metadata for fact types to be used by rules in the DRL file:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>New fact types:</strong></span> The default fact type in the <code class="literal">java.lang</code> package of Red Hat Process Automation Manager is <code class="literal">Object</code>, but you can declare other types in DRL files as needed. Declaring fact types in DRL files enables you to define a new fact model directly in the decision engine, without creating models in a lower-level language like Java. You can also declare a new type when a domain model is already built and you want to complement this model with additional entities that are used mainly during the reasoning process.
						</li><li class="listitem">
							<span class="strong strong"><strong>Metadata for fact types:</strong></span> You can associate metadata in the format <code class="literal">@key(value)</code> with new or existing facts. Metadata can be any kind of data that is not represented by the fact attributes and is consistent among all instances of that fact type. The metadata can be queried at run time by the decision engine and used in the reasoning process.
						</li></ul></div><section class="section" id="drl-declarations-without-metadata-con_drl-rules"><div class="titlepage"><div><div><h3 class="title">15.5.1. Type declarations without metadata in DRL</h3></div></div></div><p>
						A declaration of a new fact does not require any metadata, but must include a list of attributes or fields. If a type declaration does not include identifying attributes, the decision engine searches for an existing fact class in the classpath and raises an error if the class is missing.
					</p><p>
						The following example is a declaration of a new fact type <code class="literal">Person</code> with no metadata in a DRL file:
					</p><div class="formalpara"><p class="title"><strong>Example declaration of a new fact type with a rule</strong></p><p>
							
<pre class="screen">declare Person
  name : String
  dateOfBirth : java.util.Date
  address : Address
end

rule "Using a declared type"
  when
    $p : Person( name == "James" )
  then   // Insert Mark, who is a customer of James.
    Person mark = new Person();
    mark.setName( "Mark" );
    insert( mark );
end</pre>
						</p></div><p>
						In this example, the new fact type <code class="literal">Person</code> has the three attributes <code class="literal">name</code>, <code class="literal">dateOfBirth</code>, and <code class="literal">address</code>. Each attribute has a type that can be any valid Java type, including another class that you create or a fact type that you previously declared. The <code class="literal">dateOfBirth</code> attribute has the type <code class="literal">java.util.Date</code>, from the Java API, and the <code class="literal">address</code> attribute has the previously defined fact type <code class="literal">Address</code>.
					</p><p>
						To avoid writing the fully qualified name of a class every time you declare it, you can define the full class name as part of the <code class="literal">import</code> clause:
					</p><div class="formalpara"><p class="title"><strong>Example type declaration with the fully qualified class name in the import</strong></p><p>
							
<pre class="screen">import java.util.Date

declare Person
    name : String
    dateOfBirth : Date
    address : Address
end</pre>
						</p></div><p>
						When you declare a new fact type, the decision engine generates at compile time a Java class representing the fact type. The generated Java class is a one-to-one JavaBeans mapping of the type definition.
					</p><p>
						For example, the following Java class is generated from the example <code class="literal">Person</code> type declaration:
					</p><div class="formalpara"><p class="title"><strong>Generated Java class for the Person fact type declaration</strong></p><p>
							
<pre class="programlisting language-java">public class Person implements Serializable {
    private String name;
    private java.util.Date dateOfBirth;
    private Address address;

    // Empty constructor
    public Person() {...}

    // Constructor with all fields
    public Person( String name, Date dateOfBirth, Address address ) {...}

    // If keys are defined, constructor with keys
    public Person( ...keys... ) {...}

    // Getters and setters
    // `equals` and `hashCode`
    // `toString`
}</pre>
						</p></div><p>
						You can then use the generated class in your rules like any other fact, as illustrated in the previous rule example with the <code class="literal">Person</code> type declaration:
					</p><div class="formalpara"><p class="title"><strong>Example rule that uses the declared Person fact type</strong></p><p>
							
<pre class="screen">rule "Using a declared type"
  when
    $p : Person( name == "James" )
  then   // Insert Mark, who is a customer of James.
    Person mark = new Person();
    mark.setName( "Mark" );
    insert( mark );
end</pre>
						</p></div></section><section class="section" id="drl-declarations-enumerative-con_drl-rules"><div class="titlepage"><div><div><h3 class="title">15.5.2. Enumerative type declarations in DRL</h3></div></div></div><p>
						DRL supports the declaration of enumerative types in the format <code class="literal">declare enum &lt;factType&gt;</code>, followed by a comma-separated list of values ending with a semicolon. You can then use the enumerative list in the rules in the DRL file.
					</p><p>
						For example, the following enumerative type declaration defines days of the week for an employee scheduling rule:
					</p><div class="formalpara"><p class="title"><strong>Example enumerative type declaration with a scheduling rule</strong></p><p>
							
<pre class="screen">declare enum DaysOfWeek
   SUN("Sunday"),MON("Monday"),TUE("Tuesday"),WED("Wednesday"),THU("Thursday"),FRI("Friday"),SAT("Saturday");

   fullName : String
end

rule "Using a declared Enum"
when
   $emp : Employee( dayOff == DaysOfWeek.MONDAY )
then
   ...
end</pre>
						</p></div></section><section class="section" id="drl-declarations-extended-con_drl-rules"><div class="titlepage"><div><div><h3 class="title">15.5.3. Extended type declarations in DRL</h3></div></div></div><p>
						DRL supports type declaration inheritance in the format <code class="literal">declare &lt;factType1&gt; extends &lt;factType2&gt;</code>. To extend a type declared in Java by a subtype declared in DRL, you repeat the parent type in a declaration statement without any fields.
					</p><p>
						For example, the following type declarations extend a <code class="literal">Student</code> type from a top-level <code class="literal">Person</code> type, and a <code class="literal">LongTermStudent</code> type from the <code class="literal">Student</code> subtype:
					</p><div class="formalpara"><p class="title"><strong>Example extended type declarations</strong></p><p>
							
<pre class="screen">import org.people.Person

declare Person end

declare Student extends Person
    school : String
end

declare LongTermStudent extends Student
    years : int
    course : String
end</pre>
						</p></div></section><section class="section" id="drl-declarations-with-metadata-con_drl-rules"><div class="titlepage"><div><div><h3 class="title">15.5.4. Type declarations with metadata in DRL</h3></div></div></div><p>
						You can associate metadata in the format <code class="literal">@key(value)</code> (the value is optional) with fact types or fact attributes. Metadata can be any kind of data that is not represented by the fact attributes and is consistent among all instances of that fact type. The metadata can be queried at run time by the decision engine and used in the reasoning process. Any metadata that you declare before the attributes of a fact type are assigned to the fact type, while metadata that you declare after an attribute are assigned to that particular attribute.
					</p><p>
						In the following example, the two metadata attributes <code class="literal">@author</code> and <code class="literal">@dateOfCreation</code> are declared for the <code class="literal">Person</code> fact type, and the two metadata items <code class="literal">@key</code> and <code class="literal">@maxLength</code> are declared for the <code class="literal">name</code> attribute. The <code class="literal">@key</code> metadata attribute has no required value, so the parentheses and the value are omitted.
					</p><div class="formalpara"><p class="title"><strong>Example metadata declaration for fact types and attributes</strong></p><p>
							
<pre class="screen">import java.util.Date

declare Person
    @author( Bob )
    @dateOfCreation( 01-Feb-2009 )

    name : String @key @maxLength( 30 )
    dateOfBirth : Date
    address : Address
end</pre>
						</p></div><p>
						For declarations of metadata attributes for existing types, you can identify the fully qualified class name as part of the <code class="literal">import</code> clause for all declarations or as part of the individual <code class="literal">declare</code> clause:
					</p><div class="formalpara"><p class="title"><strong>Example metadata declaration for an imported type</strong></p><p>
							
<pre class="screen">import org.drools.examples.Person

declare Person
    @author( Bob )
    @dateOfCreation( 01-Feb-2009 )
end</pre>
						</p></div><div class="formalpara"><p class="title"><strong>Example metadata declaration for a declared type</strong></p><p>
							
<pre class="screen">declare org.drools.examples.Person
    @author( Bob )
    @dateOfCreation( 01-Feb-2009 )
end</pre>
						</p></div></section><section class="section" id="drl-declarations-metadata-tags-ref_drl-rules"><div class="titlepage"><div><div><h3 class="title">15.5.5. Metadata tags for fact type and attribute declarations in DRL</h3></div></div></div><p>
						Although you can define custom metadata attributes in DRL declarations, the decision engine also supports the following predefined metadata tags for declarations of fact types or fact type attributes.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The examples in this section that refer to the <code class="literal">VoiceCall</code> class assume that the sample application domain model includes the following class details:
						</p><div class="formalpara"><p class="title"><strong>VoiceCall fact class in an example Telecom domain model</strong></p><p>
								
<pre class="programlisting language-java">public class VoiceCall {
  private String  originNumber;
  private String  destinationNumber;
  private Date    callDateTime;
  private long    callDuration;  // in milliseconds

  // Constructors, getters, and setters
}</pre>
							</p></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">@role</span></dt><dd><p class="simpara">
									This tag determines whether a given fact type is handled as a regular fact or an event in the decision engine during complex event processing.
								</p><p class="simpara">
									Default parameter: <code class="literal">fact</code>
								</p><p class="simpara">
									Supported parameters: <code class="literal">fact</code>, <code class="literal">event</code>
								</p><pre class="screen">@role( fact | event )</pre><div class="formalpara"><p class="title"><strong>Example: Declare VoiceCall as event type</strong></p><p>
										
<pre class="screen">declare VoiceCall
  @role( event )
end</pre>
									</p></div></dd><dt><span class="term">@timestamp</span></dt><dd><p class="simpara">
									This tag is automatically assigned to every event in the decision engine. By default, the time is provided by the session clock and assigned to the event when it is inserted into the working memory of the decision engine. You can specify a custom time stamp attribute instead of the default time stamp added by the session clock.
								</p><p class="simpara">
									Default parameter: The time added by the decision engine session clock
								</p><p class="simpara">
									Supported parameters: Session clock time or custom time stamp attribute
								</p><pre class="screen">@timestamp( &lt;attributeName&gt; )</pre><div class="formalpara"><p class="title"><strong>Example: Declare VoiceCall timestamp attribute</strong></p><p>
										
<pre class="screen">declare VoiceCall
  @role( event )
  @timestamp( callDateTime )
end</pre>
									</p></div></dd><dt><span class="term">@duration</span></dt><dd><p class="simpara">
									This tag determines the duration time for events in the decision engine. Events can be interval-based events or point-in-time events. Interval-based events have a duration time and persist in the working memory of the decision engine until their duration time has lapsed. Point-in-time events have no duration and are essentially interval-based events with a duration of zero. By default, every event in the decision engine has a duration of zero. You can specify a custom duration attribute instead of the default.
								</p><p class="simpara">
									Default parameter: Null (zero)
								</p><p class="simpara">
									Supported parameters: Custom duration attribute
								</p><pre class="screen">@duration( &lt;attributeName&gt; )</pre><div class="formalpara"><p class="title"><strong>Example: Declare VoiceCall duration attribute</strong></p><p>
										
<pre class="screen">declare VoiceCall
  @role( event )
  @timestamp( callDateTime )
  @duration( callDuration )
end</pre>
									</p></div></dd><dt><span class="term">@expires</span></dt><dd><p class="simpara">
									This tag determines the time duration before an event expires in the working memory of the decision engine. By default, an event expires when the event can no longer match and activate any of the current rules. You can define an amount of time after which an event should expire. This tag definition also overrides the implicit expiration offset calculated from temporal constraints and sliding windows in the KIE base. This tag is available only when the decision engine is running in stream mode.
								</p><p class="simpara">
									Default parameter: Null (event expires after event can no longer match and activate rules)
								</p><p class="simpara">
									Supported parameters: Custom <code class="literal">timeOffset</code> attribute in the format <code class="literal">[<span class="marked marked">#d][#h][#m][#s][</span>[ms]]</code>
								</p><pre class="screen">@expires( &lt;timeOffset&gt; )</pre><div class="formalpara"><p class="title"><strong>Example: Declare expiration offset for VoiceCall events</strong></p><p>
										
<pre class="screen">declare VoiceCall
  @role( event )
  @timestamp( callDateTime )
  @duration( callDuration )
  @expires( 1h35m )
end</pre>
									</p></div></dd><dt><span class="term">@typesafe</span></dt><dd><p class="simpara">
									This tab determines whether a given fact type is compiled with or without type safety. By default, all type declarations are compiled with type safety enabled. You can override this behavior to type-unsafe evaluation, where all constraints are generated as MVEL constraints and executed dynamically. This is useful when dealing with collections that do not have any generics or mixed type collections.
								</p><p class="simpara">
									Default parameter: <code class="literal">true</code>
								</p><p class="simpara">
									Supported parameters: <code class="literal">true</code>, <code class="literal">false</code>
								</p><pre class="screen">@typesafe( &lt;boolean&gt; )</pre><div class="formalpara"><p class="title"><strong>Example: Declare VoiceCall for type-unsafe evaluation</strong></p><p>
										
<pre class="screen">declare VoiceCall
  @role( fact )
  @typesafe( false )
end</pre>
									</p></div></dd><dt><span class="term">@serialVersionUID</span></dt><dd><p class="simpara">
									This tag defines an identifying <code class="literal">serialVersionUID</code> value for a serializable class in a fact declaration. If a serializable class does not explicitly declare a <code class="literal">serialVersionUID</code>, the serialization run time calculates a default <code class="literal">serialVersionUID</code> value for that class based on various aspects of the class, as described in the <a class="link" href="https://docs.oracle.com/javase/10/docs/specs/serialization/index.html">Java Object Serialization Specification</a>. However, for optimal deserialization results and for greater compatibility with serialized KIE sessions, set the <code class="literal">serialVersionUID</code> as needed in the relevant class or in your DRL declarations.
								</p><p class="simpara">
									Default parameter: Null
								</p><p class="simpara">
									Supported parameters: Custom <code class="literal">serialVersionUID</code> integer
								</p><pre class="screen">@serialVersionUID( &lt;integer&gt; )</pre><div class="formalpara"><p class="title"><strong>Example: Declare serialVersionUID for a VoiceCall class</strong></p><p>
										
<pre class="screen">declare VoiceCall
  @serialVersionUID( 42 )
end</pre>
									</p></div></dd><dt><span class="term">@key</span></dt><dd><p class="simpara">
									This tag enables a fact type attribute to be used as a key identifier for the fact type. The generated class can then implement the <code class="literal">equals()</code> and <code class="literal">hashCode()</code> methods to determine if two instances of the type are equal to each other. The decision engine can also generate a constructor using all the key attributes as parameters.
								</p><p class="simpara">
									Default parameter: None
								</p><p class="simpara">
									Supported parameters: None
								</p><pre class="screen">&lt;attributeDefinition&gt; @key</pre><div class="formalpara"><p class="title"><strong>Example: Declare Person type attributes as keys</strong></p><p>
										
<pre class="screen">declare Person
    firstName : String @key
    lastName : String @key
    age : int
end</pre>
									</p></div><p class="simpara">
									For this example, the decision engine checks the <code class="literal">firstName</code> and <code class="literal">lastName</code> attributes to determine if two instances of <code class="literal">Person</code> are equal to each other, but it does not check the <code class="literal">age</code> attribute. The decision engine also implicitly generates three constructors: one without parameters, one with the <code class="literal">@key</code> fields, and one with all fields:
								</p><div class="formalpara"><p class="title"><strong>Example constructors from the key declarations</strong></p><p>
										
<pre class="screen">Person() // Empty constructor

Person( String firstName, String lastName )

Person( String firstName, String lastName, int age )</pre>
									</p></div><p class="simpara">
									You can then create instances of the type based on the key constructors, as shown in the following example:
								</p><div class="formalpara"><p class="title"><strong>Example instance using the key constructor</strong></p><p>
										
<pre class="programlisting language-java">Person person = new Person( "John", "Doe" );</pre>
									</p></div></dd><dt><span class="term">@position</span></dt><dd><p class="simpara">
									This tag determines the position of a declared fact type attribute or field in a positional argument, overriding the default declared order of attributes. You can use this tag to modify positional constraints in patterns while maintaining a consistent format in your type declarations and positional arguments. You can use this tag only for fields in classes on the classpath. If some fields in a single class use this tag and some do not, the attributes without this tag are positioned last, in the declared order. Inheritance of classes is supported, but not interfaces of methods.
								</p><p class="simpara">
									Default parameter: None
								</p><p class="simpara">
									Supported parameters: Any integer
								</p><pre class="screen">&lt;attributeDefinition&gt; @position ( &lt;integer&gt; )</pre><div class="formalpara"><p class="title"><strong>Example: Declare a fact type and override declared order</strong></p><p>
										
<pre class="screen">declare Person
    firstName : String @position( 1 )
    lastName : String @position( 0 )
    age : int @position( 2 )
    occupation: String
end</pre>
									</p></div><p class="simpara">
									In this example, the attributes are prioritized in positional arguments in the following order:
								</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
											<code class="literal">lastName</code>
										</li><li class="listitem">
											<code class="literal">firstName</code>
										</li><li class="listitem">
											<code class="literal">age</code>
										</li><li class="listitem">
											<code class="literal">occupation</code>
										</li></ol></div><p class="simpara">
									In positional arguments, you do not need to specify the field name because the position maps to a known named field. For example, the argument <code class="literal">Person( lastName == "Doe" )</code> is the same as <code class="literal">Person( "Doe"; )</code>, where the <code class="literal">lastName</code> field has the highest position annotation in the DRL declaration. The semicolon <code class="literal">;</code> indicates that everything before it is a positional argument. You can mix positional and named arguments on a pattern by using the semicolon to separate them. Any variables in a positional argument that have not yet been bound are bound to the field that maps to that position.
								</p><p class="simpara">
									The following example patterns illustrate different ways of constructing positional and named arguments. The patterns have two constraints and a binding, and the semicolon differentiates the positional section from the named argument section. Variables and literals and expressions using only literals are supported in positional arguments, but not variables alone.
								</p><div class="formalpara"><p class="title"><strong>Example patterns with positional and named arguments</strong></p><p>
										
<pre class="screen">Person( "Doe", "John", $a; )

Person( "Doe", "John"; $a : age )

Person( "Doe"; firstName == "John", $a : age )

Person( lastName == "Doe"; firstName == "John", $a : age )</pre>
									</p></div><p class="simpara">
									Positional arguments can be classified as <span class="emphasis"><em>input arguments</em></span> or <span class="emphasis"><em>output arguments</em></span>. Input arguments contain a previously declared binding and constrain against that binding using unification. Output arguments generate the declaration and bind it to the field represented by the positional argument when the binding does not yet exist.
								</p><p class="simpara">
									In extended type declarations, use caution when defining <code class="literal">@position</code> annotations because the attribute positions are inherited in subtypes. This inheritance can result in a mixed attribute order that can be confusing in some cases. Two fields can have the same <code class="literal">@position</code> value and consecutive values do not need to be declared. If a position is repeated, the conflict is solved using inheritance, where position values in the parent type have precedence, and then using the declaration order from the first to last declaration.
								</p><p class="simpara">
									For example, the following extended type declarations result in mixed positional priorities:
								</p><div class="formalpara"><p class="title"><strong>Example extended fact type with mixed position annotations</strong></p><p>
										
<pre class="screen">declare Person
    firstName : String @position( 1 )
    lastName : String @position( 0 )
    age : int @position( 2 )
    occupation: String
end

declare Student extends Person
    degree : String @position( 1 )
    school : String @position( 0 )
    graduationDate : Date
end</pre>
									</p></div><p class="simpara">
									In this example, the attributes are prioritized in positional arguments in the following order:
								</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
											<code class="literal">lastName</code> (position 0 in the parent type)
										</li><li class="listitem">
											<code class="literal">school</code> (position 0 in the subtype)
										</li><li class="listitem">
											<code class="literal">firstName</code> (position 1 in the parent type)
										</li><li class="listitem">
											<code class="literal">degree</code> (position 1 in the subtype)
										</li><li class="listitem">
											<code class="literal">age</code> (position 2 in the parent type)
										</li><li class="listitem">
											<code class="literal">occupation</code> (first field with no position annotation)
										</li><li class="listitem">
											<code class="literal">graduationDate</code> (second field with no position annotation)
										</li></ol></div></dd></dl></div></section><section class="section" id="property-change-listeners-con_drl-rules"><div class="titlepage"><div><div><h3 class="title">15.5.6. Property-change settings and listeners for fact types</h3></div></div></div><p>
						By default, the decision engine does not re-evaluate all fact patterns for fact types each time a rule is triggered, but instead reacts only to modified properties that are constrained or bound inside a given pattern. For example, if a rule calls <code class="literal">modify()</code> as part of the rule actions but the action does not generate new data in the KIE base, the decision engine does not automatically re-evaluate all fact patterns because no data was modified. This property reactivity behavior prevents unwanted recursions in the KIE base and results in more efficient rule evaluation. This behavior also means that you do not always need to use the <code class="literal">no-loop</code> rule attribute to avoid infinite recursion.
					</p><p>
						You can modify or disable this property reactivity behavior with the following <code class="literal">KnowledgeBuilderConfiguration</code> options, and then use a property-change setting in your Java class or DRL files to fine-tune property reactivity as needed:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">ALWAYS</code>: (Default) All types are property reactive, but you can disable property reactivity for a specific type by using the <code class="literal">@classReactive</code> property-change setting.
							</li><li class="listitem">
								<code class="literal">ALLOWED</code>: No types are property reactive, but you can enable property reactivity for a specific type by using the <code class="literal">@propertyReactive</code> property-change setting.
							</li><li class="listitem">
								<code class="literal">DISABLED</code>: No types are property reactive. All property-change listeners are ignored.
							</li></ul></div><div class="formalpara"><p class="title"><strong>Example property reactivity setting in KnowledgeBuilderConfiguration</strong></p><p>
							
<pre class="screen">KnowledgeBuilderConfiguration config = KnowledgeBuilderFactory.newKnowledgeBuilderConfiguration();
config.setOption(PropertySpecificOption.ALLOWED);
KnowledgeBuilder kbuilder = KnowledgeBuilderFactory.newKnowledgeBuilder(config);</pre>
						</p></div><p>
						Alternatively, you can update the <code class="literal">drools.propertySpecific</code> system property in the <code class="literal">standalone.xml</code> file of your Red Hat Process Automation Manager distribution:
					</p><div class="formalpara"><p class="title"><strong>Example property reactivity setting in system properties</strong></p><p>
							
<pre class="programlisting language-xml">&lt;system-properties&gt;
  ...
  &lt;property name="drools.propertySpecific" value="ALLOWED"/&gt;
  ...
&lt;/system-properties&gt;</pre>
						</p></div><p>
						The decision engine supports the following property-change settings and listeners for fact classes or declared DRL fact types:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">@classReactive</span></dt><dd><p class="simpara">
									If property reactivity is set to <code class="literal">ALWAYS</code> in the decision engine (all types are property reactive), this tag disables the default property reactivity behavior for a specific Java class or a declared DRL fact type. You can use this tag if you want the decision engine to re-evaluate all fact patterns for the specified fact type each time the rule is triggered, instead of reacting only to modified properties that are constrained or bound inside a given pattern.
								</p><div class="formalpara"><p class="title"><strong>Example: Disable default property reactivity in a DRL type declaration</strong></p><p>
										
<pre class="screen">declare Person
  @classReactive
    firstName : String
    lastName : String
end</pre>
									</p></div><div class="formalpara"><p class="title"><strong>Example: Disable default property reactivity in a Java class</strong></p><p>
										
<pre class="programlisting language-java">@classReactive
public static class Person {
    private String firstName;
    private String lastName;
}</pre>
									</p></div></dd><dt><span class="term">@propertyReactive</span></dt><dd><p class="simpara">
									If property reactivity is set to <code class="literal">ALLOWED</code> in the decision engine (no types are property reactive unless specified), this tag enables property reactivity for a specific Java class or a declared DRL fact type. You can use this tag if you want the decision engine to react only to modified properties that are constrained or bound inside a given pattern for the specified fact type, instead of re-evaluating all fact patterns for the fact each time the rule is triggered.
								</p><div class="formalpara"><p class="title"><strong>Example: Enable property reactivity in a DRL type declaration (when reactivity is disabled globally)</strong></p><p>
										
<pre class="screen">declare Person
  @propertyReactive
    firstName : String
    lastName : String
end</pre>
									</p></div><div class="formalpara"><p class="title"><strong>Example: Enable property reactivity in a Java class (when reactivity is disabled globally)</strong></p><p>
										
<pre class="programlisting language-java">@propertyReactive
public static class Person {
    private String firstName;
    private String lastName;
}</pre>
									</p></div></dd><dt><span class="term">@watch</span></dt><dd><p class="simpara">
									This tag enables property reactivity for additional properties that you specify in-line in fact patterns in DRL rules. This tag is supported only if property reactivity is set to <code class="literal">ALWAYS</code> in the decision engine, or if property reactivity is set to <code class="literal">ALLOWED</code> and the relevant fact type uses the <code class="literal">@propertyReactive</code> tag. You can use this tag in DRL rules to add or exclude specific properties in fact property reactivity logic.
								</p><p class="simpara">
									Default parameter: None
								</p><p class="simpara">
									Supported parameters: Property name, <code class="literal">*</code> (all), <code class="literal">!</code> (not), <code class="literal">!*</code> (no properties)
								</p><pre class="screen">&lt;factPattern&gt; @watch ( &lt;property&gt; )</pre><div class="formalpara"><p class="title"><strong>Example: Enable or disable property reactivity in fact patterns</strong></p><p>
										
<pre class="screen">// Listens for changes in both `firstName` (inferred) and `lastName`:
Person(firstName == $expectedFirstName) @watch( lastName )

// Listens for changes in all properties of the `Person` fact:
Person(firstName == $expectedFirstName) @watch( * )

// Listens for changes in `lastName` and explicitly excludes changes in `firstName`:
Person(firstName == $expectedFirstName) @watch( lastName, !firstName )

// Listens for changes in all properties of the `Person` fact except `age`:
Person(firstName == $expectedFirstName) @watch( *, !age )

// Excludes changes in all properties of the `Person` fact (equivalent to using `@classReactivity` tag):
Person(firstName == $expectedFirstName) @watch( !* )</pre>
									</p></div><p class="simpara">
									The decision engine generates a compilation error if you use the <code class="literal">@watch</code> tag for properties in a fact type that uses the <code class="literal">@classReactive</code> tag (disables property reactivity) or when property reactivity is set to <code class="literal">ALLOWED</code> in the decision engine and the relevant fact type does not use the <code class="literal">@propertyReactive</code> tag. Compilation errors also arise if you duplicate properties in listener annotations, such as <code class="literal">@watch( firstName, ! firstName )</code>.
								</p></dd><dt><span class="term">@propertyChangeSupport</span></dt><dd><p class="simpara">
									For facts that implement support for property changes as defined in the <a class="link" href="https://download.oracle.com/otndocs/jcp/7224-javabeans-1.01-fr-spec-oth-JSpec/">JavaBeans Specification</a>, this tag enables the decision engine to monitor changes in the fact properties.
								</p><div class="formalpara"><p class="title"><strong>Example: Declare property change support in JavaBeans object</strong></p><p>
										
<pre class="screen">declare Person
    @propertyChangeSupport
end</pre>
									</p></div></dd></dl></div></section><section class="section" id="drl-declarations-access-con_drl-rules"><div class="titlepage"><div><div><h3 class="title">15.5.7. Access to DRL declared types in application code</h3></div></div></div><p>
						Declared types in DRL are typically used within the DRL files while Java models are typically used when the model is shared between rules and applications. Because declared types are generated at KIE base compile time, an application cannot access them until application run time. In some cases, an application needs to access and handle facts directly from the declared types, especially when the application wraps the decision engine and provides higher-level, domain-specific user interfaces for rules management.
					</p><p>
						To handle declared types directly from the application code, you can use the <code class="literal">org.drools.definition.type.FactType</code> API in Red Hat Process Automation Manager. Through this API, you can instantiate, read, and write fields in the declared fact types.
					</p><p>
						The following example code modifies a <code class="literal">Person</code> fact type directly from an application:
					</p><div class="formalpara"><p class="title"><strong>Example application code to handle a declared fact type through the FactType API</strong></p><p>
							
<pre class="programlisting language-java">import java.util.Date;

import org.kie.api.definition.type.FactType;
import org.kie.api.KieBase;
import org.kie.api.runtime.KieSession;

...

// Get a reference to a KIE base with the declared type:
KieBase kbase = ...

// Get the declared fact type:
FactType personType = kbase.getFactType("org.drools.examples", "Person");

// Create instances:
Object bob = personType.newInstance();

// Set attribute values:
personType.set(bob, "name", "Bob" );
personType.set(bob, "dateOfBirth", new Date());
personType.set(bob, "address", new Address("King's Road","London","404"));

// Insert the fact into a KIE session:
KieSession ksession = ...
ksession.insert(bob);
ksession.fireAllRules();

// Read attributes:
String name = (String) personType.get(bob, "name");
Date date = (Date) personType.get(bob, "dateOfBirth");</pre>
						</p></div><p>
						The API also includes other helpful methods, such as setting all the attributes at once, reading values from a <code class="literal">Map</code> collection, or reading all attributes at once into a <code class="literal">Map</code> collection.
					</p><p>
						Although the API behavior is similar to Java reflection, the API does not use reflection and relies on more performant accessors that are implemented with generated bytecode.
					</p></section></section><section class="section" id="drl-globals-con_drl-rules"><div class="titlepage"><div><div><h2 class="title">15.6. Global variables in DRL</h2></div></div></div><p>
					Global variables in DRL files typically provide data or services for the rules, such as application services used in rule consequences, and return data from rules, such as logs or values added in rule consequences. You set the global value in the working memory of the decision engine through a KIE session configuration or REST operation, declare the global variable above the rules in the DRL file, and then use it in an action (<code class="literal">then</code>) part of the rule. For multiple global variables, use separate lines in the DRL file.
				</p><p>
					The following example illustrates a global variable list configuration for the decision engine and the corresponding global variable definition in the DRL file:
				</p><div class="formalpara"><p class="title"><strong>Example global list configuration for the decision engine</strong></p><p>
						
<pre class="screen">List&lt;String&gt; list = new ArrayList&lt;&gt;();
KieSession kieSession = kiebase.newKieSession();
kieSession.setGlobal( "myGlobalList", list );</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Example global variable definition with a rule</strong></p><p>
						
<pre class="screen">global java.util.List myGlobalList;

rule "Using a global"
  when
    // Empty
  then
    myGlobalList.add( "My global list" );
end</pre>
					</p></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						Do not use global variables to establish conditions in rules unless a global variable has a constant immutable value. Global variables are not inserted into the working memory of the decision engine, so the decision engine cannot track value changes of variables.
					</p><p>
						Do not use global variables to share data between rules. Rules always reason and react to the working memory state, so if you want to pass data from rule to rule, assert the data as facts into the working memory of the decision engine.
					</p></div></div><p>
					A use case for a global variable might be an instance of an email service. In your integration code that is calling the decision engine, you obtain your <code class="literal">emailService</code> object and then set it in the working memory of the decision engine. In the DRL file, you declare that you have a global of type <code class="literal">emailService</code> and give it the name <code class="literal">"email"</code>, and then in your rule consequences, you can use actions such as <code class="literal">email.sendSMS(number, message)</code>.
				</p><p>
					If you declare global variables with the same identifier in multiple packages, then you must set all the packages with the same type so that they all reference the same global value.
				</p></section><section class="section" id="rules-attributes-ref_drl-rules"><div class="titlepage"><div><div><h2 class="title">15.7. Rule attributes in DRL</h2></div></div></div><p>
					Rule attributes are additional specifications that you can add to business rules to modify rule behavior. In DRL files, you typically define rule attributes above the rule conditions and actions, with multiple attributes on separate lines, in the following format:
				</p><pre class="screen">rule "rule_name"
    // Attribute
    // Attribute
    when
        // Conditions
    then
        // Actions
end</pre><p>
					The following table lists the names and supported values of the attributes that you can assign to rules:
				</p><div class="table" id="idm139921829141728"><p class="title"><strong>Table 15.1. Rule attributes</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921829136896" scope="col">Attribute</th><th align="left" valign="top" id="idm139921829135808" scope="col">Value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921829136896">
								<p>
									<code class="literal">salience</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921829135808">
								<p>
									An integer defining the priority of the rule. Rules with a higher salience value are given higher priority when ordered in the activation queue.
								</p>
								<p>
									Example: <code class="literal">salience 10</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921829136896">
								<p>
									<code class="literal">enabled</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921829135808">
								<p>
									A Boolean value. When the option is selected, the rule is enabled. When the option is not selected, the rule is disabled.
								</p>
								<p>
									Example: <code class="literal">enabled true</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921829136896">
								<p>
									<code class="literal">date-effective</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921829135808">
								<p>
									A string containing a date and time definition. The rule can be activated only if the current date and time is after a <code class="literal">date-effective</code> attribute.
								</p>
								<p>
									Example: <code class="literal">date-effective "4-Sep-2018"</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921829136896">
								<p>
									<code class="literal">date-expires</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921829135808">
								<p>
									A string containing a date and time definition. The rule cannot be activated if the current date and time is after the <code class="literal">date-expires</code> attribute.
								</p>
								<p>
									Example: <code class="literal">date-expires "4-Oct-2018"</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921829136896">
								<p>
									<code class="literal">no-loop</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921829135808">
								<p>
									A Boolean value. When the option is selected, the rule cannot be reactivated (looped) if a consequence of the rule re-triggers a previously met condition. When the condition is not selected, the rule can be looped in these circumstances.
								</p>
								<p>
									Example: <code class="literal">no-loop true</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921829136896">
								<p>
									<code class="literal">agenda-group</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921829135808">
								<p>
									A string identifying an agenda group to which you want to assign the rule. Agenda groups allow you to partition the agenda to provide more execution control over groups of rules. Only rules in an agenda group that has acquired a focus are able to be activated.
								</p>
								<p>
									Example: <code class="literal">agenda-group "GroupName"</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921829136896">
								<p>
									<code class="literal">activation-group</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921829135808">
								<p>
									A string identifying an activation (or XOR) group to which you want to assign the rule. In activation groups, only one rule can be activated. The first rule to fire will cancel all pending activations of all rules in the activation group.
								</p>
								<p>
									Example: <code class="literal">activation-group "GroupName"</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921829136896">
								<p>
									<code class="literal">duration</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921829135808">
								<p>
									A long integer value defining the duration of time in milliseconds after which the rule can be activated, if the rule conditions are still met.
								</p>
								<p>
									Example: <code class="literal">duration 10000</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921829136896">
								<p>
									<code class="literal">timer</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921829135808">
								<p>
									A string identifying either <code class="literal">int</code> (interval) or <code class="literal">cron</code> timer definitions for scheduling the rule.
								</p>
								<p>
									Example: <code class="literal">timer ( cron:* 0/15 * * * ? )</code> (every 15 minutes)
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921829136896">
								<p>
									<code class="literal">calendar</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921829135808">
								<p>
									A <a class="link" href="http://www.quartz-scheduler.org/">Quartz</a> calendar definition for scheduling the rule.
								</p>
								<p>
									Example: <code class="literal">calendars "* * 0-7,18-23 ? * *"</code> (exclude non-business hours)
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921829136896">
								<p>
									<code class="literal">auto-focus</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921829135808">
								<p>
									A Boolean value, applicable only to rules within agenda groups. When the option is selected, the next time the rule is activated, a focus is automatically given to the agenda group to which the rule is assigned.
								</p>
								<p>
									Example: <code class="literal">auto-focus true</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921829136896">
								<p>
									<code class="literal">lock-on-active</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921829135808">
								<p>
									A Boolean value, applicable only to rules within rule flow groups or agenda groups. When the option is selected, the next time the ruleflow group for the rule becomes active or the agenda group for the rule receives a focus, the rule cannot be activated again until the ruleflow group is no longer active or the agenda group loses the focus. This is a stronger version of the <code class="literal">no-loop</code> attribute, because the activation of a matching rule is discarded regardless of the origin of the update (not only by the rule itself). This attribute is ideal for calculation rules where you have a number of rules that modify a fact and you do not want any rule re-matching and firing again.
								</p>
								<p>
									Example: <code class="literal">lock-on-active true</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921829136896">
								<p>
									<code class="literal">ruleflow-group</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921829135808">
								<p>
									A string identifying a rule flow group. In rule flow groups, rules can fire only when the group is activated by the associated rule flow.
								</p>
								<p>
									Example: <code class="literal">ruleflow-group "GroupName"</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921829136896">
								<p>
									<code class="literal">dialect</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921829135808">
								<p>
									A string identifying either <code class="literal">JAVA</code> or <code class="literal">MVEL</code> as the language to be used for code expressions in the rule. By default, the rule uses the dialect specified at the package level. Any dialect specified here overrides the package dialect setting for the rule.
								</p>
								<p>
									Example: <code class="literal">dialect "JAVA"</code>
								</p>
								<div class="admonition note"><div class="admonition_header">Note</div><div><p>
										When you use Red Hat Process Automation Manager without the executable model, the <code class="literal">dialect "JAVA"</code> rule consequences support only Java 5 syntax. For more information about executable models, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#executable-model-con_packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>.
									</p></div></div>
								</td></tr></tbody></table></div></div><section class="section" id="drl-timers-calendars-con_drl-rules"><div class="titlepage"><div><div><h3 class="title">15.7.1. Timer and calendar rule attributes in DRL</h3></div></div></div><p>
						Timers and calendars are DRL rule attributes that enable you to apply scheduling and timing constraints to your DRL rules. These attributes require additional configurations depending on the use case.
					</p><p>
						The <code class="literal">timer</code> attribute in DRL rules is a string identifying either <code class="literal">int</code> (interval) or <code class="literal">cron</code> timer definitions for scheduling a rule and supports the following formats:
					</p><div class="formalpara"><p class="title"><strong>Timer attribute formats</strong></p><p>
							
<pre class="screen">timer ( int: &lt;initial delay&gt; &lt;repeat interval&gt; )

timer ( cron: &lt;cron expression&gt; )</pre>
						</p></div><div class="formalpara"><p class="title"><strong>Example interval timer attributes</strong></p><p>
							
<pre class="screen">// Run after a 30-second delay
timer ( int: 30s )

// Run every 5 minutes after a 30-second delay each time
timer ( int: 30s 5m )</pre>
						</p></div><div class="formalpara"><p class="title"><strong>Example cron timer attribute</strong></p><p>
							
<pre class="screen">// Run every 15 minutes
timer ( cron:* 0/15 * * * ? )</pre>
						</p></div><p>
						Interval timers follow the semantics of <code class="literal">java.util.Timer</code> objects, with an initial delay and an optional repeat interval. Cron timers follow standard Unix cron expressions.
					</p><p>
						The following example DRL rule uses a cron timer to send an SMS text message every 15 minutes:
					</p><div class="formalpara"><p class="title"><strong>Example DRL rule with a cron timer</strong></p><p>
							
<pre class="screen">rule "Send SMS message every 15 minutes"
  timer ( cron:* 0/15 * * * ? )
  when
    $a : Alarm( on == true )
  then
    channels[ "sms" ].insert( new Sms( $a.mobileNumber, "The alarm is still on." );
end</pre>
						</p></div><p>
						Generally, a rule that is controlled by a timer becomes active when the rule is triggered and the rule consequence is executed repeatedly, according to the timer settings. The execution stops when the rule condition no longer matches incoming facts. However, the way the decision engine handles rules with timers depends on whether the decision engine is in <span class="emphasis"><em>active mode</em></span> or in <span class="emphasis"><em>passive mode</em></span>.
					</p><p>
						By default, the decision engine runs in <span class="emphasis"><em>passive mode</em></span> and evaluates rules, according to the defined timer settings, when a user or an application explicitly calls <code class="literal">fireAllRules()</code>. Conversely, if a user or application calls <code class="literal">fireUntilHalt()</code>, the decision engine starts in <span class="emphasis"><em>active mode</em></span> and evaluates rules continually until the user or application explicitly calls <code class="literal">halt()</code>.
					</p><p>
						When the decision engine is in active mode, rule consequences are executed even after control returns from a call to <code class="literal">fireUntilHalt()</code> and the decision engine remains <span class="emphasis"><em>reactive</em></span> to any changes made to the working memory. For example, removing a fact that was involved in triggering the timer rule execution causes the repeated execution to terminate, and inserting a fact so that some rule matches causes that rule to be executed. However, the decision engine is not continually <span class="emphasis"><em>active</em></span>, but is active only after a rule is executed. Therefore, the decision engine does not react to asynchronous fact insertions until the next execution of a timer-controlled rule. Disposing a KIE session terminates all timer activity.
					</p><p>
						When the decision engine is in passive mode, rule consequences of timed rules are evaluated only when <code class="literal">fireAllRules()</code> is invoked again. However, you can change the default timer-execution behavior in passive mode by configuring the KIE session with a <code class="literal">TimedRuleExecutionOption</code> option, as shown in the following example:
					</p><div class="formalpara"><p class="title"><strong>KIE session configuration to automatically execute timed rules in passive mode</strong></p><p>
							
<pre class="programlisting language-java">KieSessionConfiguration ksconf = KieServices.Factory.get().newKieSessionConfiguration();
ksconf.setOption( TimedRuleExecutionOption.YES );
KSession ksession = kbase.newKieSession(ksconf, null);</pre>
						</p></div><p>
						You can additionally set a <code class="literal">FILTERED</code> specification on the <code class="literal">TimedRuleExecutionOption</code> option that enables you to define a callback to filter those rules, as shown in the following example:
					</p><div class="formalpara"><p class="title"><strong>KIE session configuration to filter which timed rules are automatically executed</strong></p><p>
							
<pre class="programlisting language-java">KieSessionConfiguration ksconf = KieServices.Factory.get().newKieSessionConfiguration();
conf.setOption( new TimedRuleExecutionOption.FILTERED(new TimedRuleExecutionFilter() {
    public boolean accept(Rule[] rules) {
        return rules[0].getName().equals("MyRule");
    }
}) );</pre>
						</p></div><p>
						For interval timers, you can also use an expression timer with <code class="literal">expr</code> instead of <code class="literal">int</code> to define both the delay and interval as an expression instead of a fixed value.
					</p><p>
						The following example DRL file declares a fact type with a delay and period that are then used in the subsequent rule with an expression timer:
					</p><div class="formalpara"><p class="title"><strong>Example rule with an expression timer</strong></p><p>
							
<pre class="screen">declare Bean
  delay   : String = "30s"
  period  : long = 60000
end

rule "Expression timer"
  timer ( expr: $d, $p )
  when
    Bean( $d : delay, $p : period )
  then
    // Actions
end</pre>
						</p></div><p>
						The expressions, such as <code class="literal">$d</code> and <code class="literal">$p</code> in this example, can use any variable defined in the pattern-matching part of the rule. The variable can be any <code class="literal">String</code> value that can be parsed into a time duration or any numeric value that is internally converted in a <code class="literal">long</code> value for a duration in milliseconds.
					</p><p>
						Both interval and expression timers can use the following optional parameters:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">start</code> and <code class="literal">end</code>: A <code class="literal">Date</code> or a <code class="literal">String</code> representing a <code class="literal">Date</code> or a <code class="literal">long</code> value. The value can also be a <code class="literal">Number</code> that is transformed into a Java <code class="literal">Date</code> in the format <code class="literal">new Date( ((Number) n).longValue() )</code>.
							</li><li class="listitem">
								<code class="literal">repeat-limit</code>: An integer that defines the maximum number of repetitions allowed by the timer. If both the <code class="literal">end</code> and the <code class="literal">repeat-limit</code> parameters are set, the timer stops when the first of the two is reached.
							</li></ul></div><div class="formalpara"><p class="title"><strong>Example timer attribute with optional <code class="literal">start</code>, <code class="literal">end</code>, and <code class="literal">repeat-limit</code> parameters</strong></p><p>
							
<pre class="programlisting language-java">timer (int: 30s 1h; start=3-JAN-2020, end=4-JAN-2020, repeat-limit=50)</pre>
						</p></div><p>
						In this example, the rule is scheduled for every hour, after a delay of 30 seconds each hour, beginning on 3 January 2020 and ending either on 4 January 2020 or when the cycle repeats 50 times.
					</p><p>
						If the system is paused (for example, the session is serialized and then later deserialized), the rule is scheduled only one time to recover from missing activations regardless of how many activations were missed during the pause, and then the rule is subsequently scheduled again to continue in sync with the timer setting.
					</p><p>
						The <code class="literal">calendar</code> attribute in DRL rules is a <a class="link" href="http://www.quartz-scheduler.org/">Quartz</a> calendar definition for scheduling a rule and supports the following format:
					</p><div class="formalpara"><p class="title"><strong>Calendar attribute format</strong></p><p>
							
<pre class="screen">calendars "&lt;definition or registered name&gt;"</pre>
						</p></div><div class="formalpara"><p class="title"><strong>Example calendar attributes</strong></p><p>
							
<pre class="screen">// Exclude non-business hours
calendars "* * 0-7,18-23 ? * *"

// Weekdays only, as registered in the KIE session
calendars "weekday"</pre>
						</p></div><p>
						You can adapt a Quartz calendar based on the Quartz calendar API and then register the calendar in the KIE session, as shown in the following example:
					</p><div class="formalpara"><p class="title"><strong>Adapting a Quartz Calendar</strong></p><p>
							
<pre class="programlisting language-java">Calendar weekDayCal = QuartzHelper.quartzCalendarAdapter(org.quartz.Calendar quartzCal)</pre>
						</p></div><div class="formalpara"><p class="title"><strong>Registering the calendar in the KIE session</strong></p><p>
							
<pre class="programlisting language-java">ksession.getCalendars().set( "weekday", weekDayCal );</pre>
						</p></div><p>
						You can use calendars with standard rules and with rules that use timers. The calendar attribute can contain one or more comma-separated calendar names written as <code class="literal">String</code> literals.
					</p><p>
						The following example rules use both calendars and timers to schedule the rules:
					</p><div class="formalpara"><p class="title"><strong>Example rules with calendars and timers</strong></p><p>
							
<pre class="screen">rule "Weekdays are high priority"
  calendars "weekday"
  timer ( int:0 1h )
  when
    Alarm()
  then
    send( "priority high - we have an alarm" );
end

rule "Weekends are low priority"
  calendars "weekend"
  timer ( int:0 4h )
  when
    Alarm()
  then
    send( "priority low - we have an alarm" );
end</pre>
						</p></div></section></section><section class="section" id="drl-rules-WHEN-con_drl-rules"><div class="titlepage"><div><div><h2 class="title">15.8. Rule conditions in DRL (WHEN)</h2></div></div></div><p>
					The <code class="literal">when</code> part of a DRL rule (also known as the <span class="emphasis"><em>Left Hand Side (LHS)</em></span> of the rule) contains the conditions that must be met to execute an action. Conditions consist of a series of stated <span class="emphasis"><em>patterns</em></span> and <span class="emphasis"><em>constraints</em></span>, with optional <span class="emphasis"><em>bindings</em></span> and supported rule condition elements (keywords), based on the available data objects in the package. For example, if a bank requires loan applicants to have over 21 years of age, then the <code class="literal">when</code> condition of an <code class="literal">"Underage"</code> rule would be <code class="literal">Applicant( age &lt; 21 )</code>.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						DRL uses <code class="literal">when</code> instead of <code class="literal">if</code> because <code class="literal">if</code> is typically part of a procedural execution flow during which a condition is checked at a specific point in time. In contrast, <code class="literal">when</code> indicates that the condition evaluation is not limited to a specific evaluation sequence or point in time, but instead occurs continually at any time. Whenever the condition is met, the actions are executed.
					</p></div></div><p>
					If the <code class="literal">when</code> section is empty, then the conditions are considered to be true and the actions in the <code class="literal">then</code> section are executed the first time a <code class="literal">fireAllRules()</code> call is made in the decision engine. This is useful if you want to use rules to set up the decision engine state.
				</p><p>
					The following example rule uses empty conditions to insert a fact every time the rule is executed:
				</p><div class="formalpara"><p class="title"><strong>Example rule without conditions</strong></p><p>
						
<pre class="screen">rule "Always insert applicant"
  when
    // Empty
  then   // Actions to be executed once
    insert( new Applicant() );
end

// The rule is internally rewritten in the following way:

rule "Always insert applicant"
  when
    eval( true )
  then
    insert( new Applicant() );
end</pre>
					</p></div><p>
					If rule conditions use multiple patterns with no defined keyword conjunctions (such as <code class="literal">and</code>, <code class="literal">or</code>, or <code class="literal">not</code>), the default conjunction is <code class="literal">and</code>:
				</p><div class="formalpara"><p class="title"><strong>Example rule without keyword conjunctions</strong></p><p>
						
<pre class="screen">rule "Underage"
  when
    application : LoanApplication()
    Applicant( age &lt; 21 )
  then
    // Actions
end

// The rule is internally rewritten in the following way:

rule "Underage"
  when
    application : LoanApplication()
    and Applicant( age &lt; 21 )
  then
    // Actions
end</pre>
					</p></div><section class="section" id="patterns_and_constraints"><div class="titlepage"><div><div><h3 class="title">15.8.1. Patterns and constraints</h3></div></div></div><p>
						A <span class="emphasis"><em>pattern</em></span> in a DRL rule condition is the segment to be matched by the decision engine. A pattern can potentially match each fact that is inserted into the working memory of the decision engine. A pattern can also contain <span class="emphasis"><em>constraints</em></span> to further define the facts to be matched.
					</p><p>
						In the simplest form, with no constraints, a pattern matches a fact of the given type. In the following example, the type is <code class="literal">Person</code>, so the pattern will match against all <code class="literal">Person</code> objects in the working memory of the decision engine:
					</p><div class="formalpara"><p class="title"><strong>Example pattern for a single fact type</strong></p><p>
							
<pre class="screen">Person()</pre>
						</p></div><p>
						The type does not need to be the actual class of some fact object. Patterns can refer to superclasses or even interfaces, potentially matching facts from many different classes. For example, the following pattern matches all objects in the working memory of the decision engine:
					</p><div class="formalpara"><p class="title"><strong>Example pattern for all objects</strong></p><p>
							
<pre class="screen">Object() // Matches all objects in the working memory</pre>
						</p></div><p>
						The parentheses of a pattern enclose the constraints, such as the following constraint on the person’s age:
					</p><div class="formalpara"><p class="title"><strong>Example pattern with a constraint</strong></p><p>
							
<pre class="screen">Person( age == 50 )</pre>
						</p></div><p>
						A <span class="emphasis"><em>constraint</em></span> is an expression that returns <code class="literal">true</code> or <code class="literal">false</code>. Pattern constraints in DRL are essentially Java expressions with some enhancements, such as property access, and some differences, such as <code class="literal">equals()</code> and <code class="literal">!equals()</code> semantics for <code class="literal">==</code> and <code class="literal">!=</code> (instead of the usual <code class="literal">same</code> and <code class="literal">not same</code> semantics).
					</p><p>
						Any JavaBeans property can be accessed directly from pattern constraints. A bean property is exposed internally using a standard JavaBeans getter that takes no arguments and returns something. For example, the <code class="literal">age</code> property is written as <code class="literal">age</code> in DRL instead of the getter <code class="literal">getAge()</code>:
					</p><div class="formalpara"><p class="title"><strong>DRL constraint syntax with JavaBeans properties</strong></p><p>
							
<pre class="screen">Person( age == 50 )

// This is the same as the following getter format:

Person( getAge() == 50 )</pre>
						</p></div><p>
						Red Hat Process Automation Manager uses the standard JDK <code class="literal">Introspector</code> class to achieve this mapping, so it follows the standard JavaBeans specification. For optimal decision engine performance, use the property access format, such as <code class="literal">age</code>, instead of using getters explicitly, such as <code class="literal">getAge()</code>.
					</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							Do not use property accessors to change the state of the object in a way that might affect the rules because the decision engine caches the results of the match between invocations for higher efficiency.
						</p><p>
							For example, do not use property accessors in the following ways:
						</p><pre class="programlisting language-java">public int getAge() {
    age++; // Do not do this.
    return age;
}</pre><pre class="programlisting language-java">public int getAge() {
    Date now = DateUtil.now(); // Do not do this.
    return DateUtil.differenceInYears(now, birthday);
}</pre><p>
							Instead of following the second example, insert a fact that wraps the current date in the working memory and update that fact between <code class="literal">fireAllRules()</code> as needed.
						</p></div></div><p>
						However, if the getter of a property cannot be found, the compiler uses the property name as a fallback method name, without arguments:
					</p><div class="formalpara"><p class="title"><strong>Fallback method if object is not found</strong></p><p>
							
<pre class="screen">Person( age == 50 )

// If `Person.getAge()` does not exist, the compiler uses the following syntax:

Person( age() == 50 )</pre>
						</p></div><p>
						You can also nest access properties in patterns, as shown in the following example. Nested properties are indexed by the decision engine.
					</p><div class="formalpara"><p class="title"><strong>Example pattern with nested property access</strong></p><p>
							
<pre class="screen">Person( address.houseNumber == 50 )

// This is the same as the following format:

Person( getAddress().getHouseNumber() == 50 )</pre>
						</p></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							In stateful KIE sessions, use nested accessors carefully because the working memory of the decision engine is not aware of any of the nested values and does not detect when they change. Either consider the nested values immutable while any of their parent references are inserted into the working memory, or, if you want to modify a nested value, mark all of the outer facts as updated. In the previous example, when the <code class="literal">houseNumber</code> property changes, any <code class="literal">Person</code> with that <code class="literal">Address</code> must be marked as updated.
						</p></div></div><p>
						You can use any Java expression that returns a <code class="literal">boolean</code> value as a constraint inside the parentheses of a pattern. Java expressions can be mixed with other expression enhancements, such as property access:
					</p><div class="formalpara"><p class="title"><strong>Example pattern with a constraint using property access and Java expression</strong></p><p>
							
<pre class="screen">Person( age == 50 )</pre>
						</p></div><p>
						You can change the evaluation priority by using parentheses, as in any logical or mathematical expression:
					</p><div class="formalpara"><p class="title"><strong>Example evaluation order of constraints</strong></p><p>
							
<pre class="screen">Person( age &gt; 100 &amp;&amp; ( age % 10 == 0 ) )</pre>
						</p></div><p>
						You can also reuse Java methods in constraints, as shown in the following example:
					</p><div class="formalpara"><p class="title"><strong>Example constraints with reused Java methods</strong></p><p>
							
<pre class="screen">Person( Math.round( weight / ( height * height ) ) &lt; 25.0 )</pre>
						</p></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							Do not use constraints to change the state of the object in a way that might affect the rules because the decision engine caches the results of the match between invocations for higher efficiency. Any method that is executed on a fact in the rule conditions must be a read-only method. Also, the state of a fact should not change between rule invocations unless those facts are marked as updated in the working memory on every change.
						</p><p>
							For example, do not use a pattern constraint in the following ways:
						</p><pre class="screen">Person( incrementAndGetAge() == 10 ) // Do not do this.</pre><pre class="screen">Person( System.currentTimeMillis() % 1000 == 0 ) // Do not do this.</pre></div></div><p>
						Standard Java operator precedence applies to constraint operators in DRL, and DRL operators follow standard Java semantics except for the <code class="literal">==</code> and <code class="literal">!=</code> operators.
					</p><p>
						The <code class="literal">==</code> operator uses null-safe <code class="literal">equals()</code> semantics instead of the usual <code class="literal">same</code> semantics. For example, the pattern <code class="literal">Person( firstName == "John" )</code> is similar to <code class="literal">java.util.Objects.equals(person.getFirstName(), "John")</code>, and because <code class="literal">"John"</code> is not null, the pattern is also similar to <code class="literal">"John".equals(person.getFirstName())</code>.
					</p><p>
						The <code class="literal">!=</code> operator uses null-safe <code class="literal">!equals()</code> semantics instead of the usual <code class="literal">not same</code> semantics. For example, the pattern <code class="literal">Person( firstName != "John" )</code> is similar to <code class="literal">!java.util.Objects.equals(person.getFirstName(), "John")</code>.
					</p><p>
						If the field and the value of a constraint are of different types, the decision engine uses type coercion to resolve the conflict and reduce compilation errors. For instance, if <code class="literal">"ten"</code> is provided as a string in a numeric evaluator, a compilation error occurs, whereas <code class="literal">"10"</code> is coerced to a numeric 10. In coercion, the field type always takes precedence over the value type:
					</p><div class="formalpara"><p class="title"><strong>Example constraint with a value that is coerced</strong></p><p>
							
<pre class="screen">Person( age == "10" ) // "10" is coerced to 10</pre>
						</p></div><p>
						For groups of constraints, you can use a delimiting comma <code class="literal">,</code> to use implicit <code class="literal">and</code> connective semantics:
					</p><div class="formalpara"><p class="title"><strong>Example patterns with multiple constraints</strong></p><p>
							
<pre class="screen">// Person is at least 50 years old and weighs at least 80 kilograms:
Person( age &gt; 50, weight &gt; 80 )

// Person is at least 50 years old, weighs at least 80 kilograms, and is taller than 2 meters:
Person( age &gt; 50, weight &gt; 80, height &gt; 2 )</pre>
						</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Although the <code class="literal">&amp;&amp;</code> and <code class="literal">,</code> operators have the same semantics, they are resolved with different priorities. The <code class="literal">&amp;&amp;</code> operator precedes the <code class="literal">||</code> operator, and both the <code class="literal">&amp;&amp;</code> and <code class="literal">||</code> operators together precede the <code class="literal">,</code> operator. Use the comma operator at the top-level constraint for optimal decision engine performance and human readability.
						</p></div></div><p>
						You cannot embed a comma operator in a composite constraint expression, such as in parentheses:
					</p><div class="formalpara"><p class="title"><strong>Example of misused comma in composite constraint expression</strong></p><p>
							
<pre class="screen">// Do not use the following format:
Person( ( age &gt; 50, weight &gt; 80 ) || height &gt; 2 )

// Use the following format instead:
Person( ( age &gt; 50 &amp;&amp; weight &gt; 80 ) || height &gt; 2 )</pre>
						</p></div></section><section class="section" id="bound_variables_in_patterns_and_constraints"><div class="titlepage"><div><div><h3 class="title">15.8.2. Bound variables in patterns and constraints</h3></div></div></div><p>
						You can bind variables to patterns and constraints to refer to matched objects in other portions of a rule. Bound variables can help you define rules more efficiently or more consistently with how you annotate facts in your data model. To differentiate more easily between variables and fields in a rule, use the standard format <code class="literal">$variable</code> for variables, especially in complex rules. This convention is helpful but not required in DRL.
					</p><p>
						For example, the following DRL rule uses the variable <code class="literal">$p</code> for a pattern with the <code class="literal">Person</code> fact:
					</p><div class="formalpara"><p class="title"><strong>Pattern with a bound variable</strong></p><p>
							
<pre class="screen">rule "simple rule"
  when
    $p : Person()
  then
    System.out.println( "Person " + $p );
end</pre>
						</p></div><p>
						Similarly, you can also bind variables to properties in pattern constraints, as shown in the following example:
					</p><pre class="screen">// Two persons of the same age:
Person( $firstAge : age ) // Binding
Person( age == $firstAge ) // Constraint expression</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Ensure that you separate constraint bindings and constraint expressions for clearer and more efficient rule definitions. Although mixed bindings and expressions are supported, they can complicate patterns and affect evaluation efficiency.
						</p><pre class="screen">// Do not use the following format:
Person( $age : age * 2 &lt; 100 )

// Use the following format instead:
Person( age * 2 &lt; 100, $age : age )</pre></div></div><p>
						The decision engine does not support bindings to the same declaration, but does support <span class="emphasis"><em>unification</em></span> of arguments across several properties. While positional arguments are always processed with unification, the unification symbol <code class="literal">:=</code> exists for named arguments.
					</p><p>
						The following example patterns unify the <code class="literal">age</code> property across two <code class="literal">Person</code> facts:
					</p><div class="formalpara"><p class="title"><strong>Example pattern with unification</strong></p><p>
							
<pre class="screen">Person( $age := age )
Person( $age := age )</pre>
						</p></div><p>
						Unification declares a binding for the first occurrence and constrains to the same value of the bound field for sequence occurrences.
					</p></section><section class="section" id="nested_constraints_and_inline_casts"><div class="titlepage"><div><div><h3 class="title">15.8.3. Nested constraints and inline casts</h3></div></div></div><p>
						In some cases, you might need to access multiple properties of a nested object, as shown in the following example:
					</p><div class="formalpara"><p class="title"><strong>Example pattern to access multiple properties</strong></p><p>
							
<pre class="screen">Person( name == "mark", address.city == "london", address.country == "uk" )</pre>
						</p></div><p>
						You can group these property accessors to nested objects with the syntax <code class="literal">.( &lt;constraints&gt; )</code> for more readable rules, as shown in the following example:
					</p><div class="formalpara"><p class="title"><strong>Example pattern with grouped constraints</strong></p><p>
							
<pre class="screen">Person( name == "mark", address.( city == "london", country == "uk") )</pre>
						</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The period prefix <code class="literal">.</code> differentiates the nested object constraints from a method call.
						</p></div></div><p>
						When you work with nested objects in patterns, you can use the syntax <code class="literal">&lt;type&gt;#&lt;subtype&gt;</code> to cast to a subtype and make the getters from the parent type available to the subtype. You can use either the object name or fully qualified class name, and you can cast to one or multiple subtypes, as shown in the following examples:
					</p><div class="formalpara"><p class="title"><strong>Example patterns with inline casting to a subtype</strong></p><p>
							
<pre class="screen">// Inline casting with subtype name:
Person( name == "mark", address#LongAddress.country == "uk" )

// Inline casting with fully qualified class name:
Person( name == "mark", address#org.domain.LongAddress.country == "uk" )

// Multiple inline casts:
Person( name == "mark", address#LongAddress.country#DetailedCountry.population &gt; 10000000 )</pre>
						</p></div><p>
						These example patterns cast <code class="literal">Address</code> to <code class="literal">LongAddress</code>, and additionally to <code class="literal">DetailedCountry</code> in the last example, making the parent getters available to the subtypes in each case.
					</p><p>
						You can use the <code class="literal">instanceof</code> operator to infer the results of the specified type in subsequent uses of that field with the pattern, as shown in the following example:
					</p><pre class="screen">Person( name == "mark", address instanceof LongAddress, address.country == "uk" )</pre><p>
						If an inline cast is not possible (for example, if <code class="literal">instanceof</code> returns <code class="literal">false</code>), the evaluation is considered <code class="literal">false</code>.
					</p></section><section class="section" id="date_literal_in_constraints"><div class="titlepage"><div><div><h3 class="title">15.8.4. Date literal in constraints</h3></div></div></div><p>
						By default, the decision engine supports the date format <code class="literal">dd-mmm-yyyy</code>. You can customize the date format, including a time format mask if needed, by providing an alternative format mask with the system property <code class="literal">drools.dateformat="dd-mmm-yyyy hh:mm"</code>. You can also customize the date format by changing the language locale with the <code class="literal">drools.defaultlanguage</code> and <code class="literal">drools.defaultcountry</code> system properties (for example, the locale of Thailand is set as <code class="literal">drools.defaultlanguage=th</code> and <code class="literal">drools.defaultcountry=TH</code>).
					</p><div class="formalpara"><p class="title"><strong>Example pattern with a date literal restriction</strong></p><p>
							
<pre class="screen">Person( bornBefore &lt; "27-Oct-2009" )</pre>
						</p></div></section><section class="section" id="drl-operators-ref_drl-rules"><div class="titlepage"><div><div><h3 class="title">15.8.5. Supported operators in DRL pattern constraints</h3></div></div></div><p>
						DRL supports standard Java semantics for operators in pattern constraints, with some exceptions and with some additional operators that are unique in DRL. The following list summarizes the operators that are handled differently in DRL constraints than in standard Java semantics or that are unique in DRL constraints.
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">.()</code>, <code class="literal">#</code></span></dt><dd><p class="simpara">
									Use the <code class="literal">.()</code> operator to group property accessors to nested objects, and use the <code class="literal">#</code> operator to cast to a subtype in nested objects. Casting to a subtype makes the getters from the parent type available to the subtype. You can use either the object name or fully qualified class name, and you can cast to one or multiple subtypes.
								</p><div class="formalpara"><p class="title"><strong>Example patterns with nested objects</strong></p><p>
										
<pre class="screen">// Ungrouped property accessors:
Person( name == "mark", address.city == "london", address.country == "uk" )

// Grouped property accessors:
Person( name == "mark", address.( city == "london", country == "uk") )</pre>
									</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										The period prefix <code class="literal">.</code> differentiates the nested object constraints from a method call.
									</p></div></div><div class="formalpara"><p class="title"><strong>Example patterns with inline casting to a subtype</strong></p><p>
										
<pre class="screen">// Inline casting with subtype name:
Person( name == "mark", address#LongAddress.country == "uk" )

// Inline casting with fully qualified class name:
Person( name == "mark", address#org.domain.LongAddress.country == "uk" )

// Multiple inline casts:
Person( name == "mark", address#LongAddress.country#DetailedCountry.population &gt; 10000000 )</pre>
									</p></div></dd><dt><span class="term"><code class="literal">!.</code></span></dt><dd><p class="simpara">
									Use this operator to dereference a property in a null-safe way. The value to the left of the <code class="literal">!.</code> operator must be not null (interpreted as <code class="literal">!= null</code>) in order to give a positive result for pattern matching.
								</p><div class="formalpara"><p class="title"><strong>Example constraint with null-safe dereferencing</strong></p><p>
										
<pre class="screen">Person( $streetName : address!.street )

// This is internally rewritten in the following way:

Person( address != null, $streetName : address.street )</pre>
									</p></div></dd><dt><span class="term"><code class="literal">[]</code></span></dt><dd><p class="simpara">
									Use this operator to access a <code class="literal">List</code> value by index or a <code class="literal">Map</code> value by key.
								</p><div class="formalpara"><p class="title"><strong>Example constraints with <code class="literal">List</code> and <code class="literal">Map</code> access</strong></p><p>
										
<pre class="screen">// The following format is the same as `childList(0).getAge() == 18`:
Person(childList[0].age == 18)

// The following format is the same as `credentialMap.get("jdoe").isValid()`:
Person(credentialMap["jdoe"].valid)</pre>
									</p></div></dd><dt><span class="term"><code class="literal">&lt;</code>, <code class="literal">&lt;=</code>, <code class="literal">&gt;</code>, <code class="literal">&gt;=</code></span></dt><dd><p class="simpara">
									Use these operators on properties with natural ordering. For example, for <code class="literal">Date</code> fields, the <code class="literal">&lt;</code> operator means <span class="emphasis"><em>before</em></span>, and for <code class="literal">String</code> fields, the operator means <span class="emphasis"><em>alphabetically before</em></span>. These properties apply only to comparable properties.
								</p><div class="formalpara"><p class="title"><strong>Example constraints with <code class="literal">before</code> operator</strong></p><p>
										
<pre class="screen">Person( birthDate &lt; $otherBirthDate )

Person( firstName &lt; $otherFirstName )</pre>
									</p></div></dd><dt><span class="term"><code class="literal">==</code>, <code class="literal">!=</code></span></dt><dd><p class="simpara">
									Use these operators as <code class="literal">equals()</code> and <code class="literal">!equals()</code> methods in constraints, instead of the usual <code class="literal">same</code> and <code class="literal">not same</code> semantics.
								</p><div class="formalpara"><p class="title"><strong>Example constraint with null-safe equality</strong></p><p>
										
<pre class="screen">Person( firstName == "John" )

// This is similar to the following formats:

java.util.Objects.equals(person.getFirstName(), "John")
"John".equals(person.getFirstName())</pre>
									</p></div><div class="formalpara"><p class="title"><strong>Example constraint with null-safe not equality</strong></p><p>
										
<pre class="screen">Person( firstName != "John" )

// This is similar to the following format:

!java.util.Objects.equals(person.getFirstName(), "John")</pre>
									</p></div></dd><dt><span class="term"><code class="literal">&amp;&amp;</code>, <code class="literal">||</code></span></dt><dd><p class="simpara">
									Use these operators to create an abbreviated combined relation condition that adds more than one restriction on a field. You can group constraints with parentheses <code class="literal">()</code> to create a recursive syntax pattern.
								</p><div class="formalpara"><p class="title"><strong>Example constraints with abbreviated combined relation</strong></p><p>
										
<pre class="screen">// Simple abbreviated combined relation condition using a single `&amp;&amp;`:
Person(age &gt; 30 &amp;&amp; &lt; 40)

// Complex abbreviated combined relation using groupings:
Person(age ((&gt; 30 &amp;&amp; &lt; 40) || (&gt; 20 &amp;&amp; &lt; 25)))

// Mixing abbreviated combined relation with constraint connectives:
Person(age &gt; 30 &amp;&amp; &lt; 40 || location == "london")</pre>
									</p></div></dd><dt><span class="term"><code class="literal">matches</code>, <code class="literal">not matches</code></span></dt><dd><p class="simpara">
									Use these operators to indicate that a field matches or does not match a specified Java regular expression. Typically, the regular expression is a <code class="literal">String</code> literal, but variables that resolve to a valid regular expression are also supported. These operators apply only to <code class="literal">String</code> properties. If you use <code class="literal">matches</code> against a <code class="literal">null</code> value, the resulting evaluation is always <code class="literal">false</code>. If you use <code class="literal">not matches</code> against a <code class="literal">null</code> value, the resulting evaluation is always <code class="literal">true</code>. As in Java, regular expressions that you write as <code class="literal">String</code> literals must use a double backslash <code class="literal">\\</code> to escape.
								</p><div class="formalpara"><p class="title"><strong>Example constraint to match or not match a regular expression</strong></p><p>
										
<pre class="screen">Person( country matches "(USA)?\\S*UK" )

Person( country not matches "(USA)?\\S*UK" )</pre>
									</p></div></dd><dt><span class="term"><code class="literal">contains</code>, <code class="literal">not contains</code></span></dt><dd><p class="simpara">
									Use these operators to verify whether a field that is an <code class="literal">Array</code> or a <code class="literal">Collection</code> contains or does not contain a specified value. These operators apply to <code class="literal">Array</code> or <code class="literal">Collection</code> properties, but you can also use these operators in place of <code class="literal">String.contains()</code> and <code class="literal">!String.contains()</code> constraints checks.
								</p><div class="formalpara"><p class="title"><strong>Example constraints with <code class="literal">contains</code> and <code class="literal">not contains</code> for a Collection</strong></p><p>
										
<pre class="screen">// Collection with a specified field:
FamilyTree( countries contains "UK" )

FamilyTree( countries not contains "UK" )


// Collection with a variable:
FamilyTree( countries contains $var )

FamilyTree( countries not contains $var )</pre>
									</p></div><div class="formalpara"><p class="title"><strong>Example constraints with <code class="literal">contains</code> and <code class="literal">not contains</code> for a String literal</strong></p><p>
										
<pre class="screen">// Sting literal with a specified field:
Person( fullName contains "Jr" )

Person( fullName not contains "Jr" )


// String literal with a variable:
Person( fullName contains $var )

Person( fullName not contains $var )</pre>
									</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										For backward compatibility, the <code class="literal">excludes</code> operator is a supported synonym for <code class="literal">not contains</code>.
									</p></div></div></dd><dt><span class="term"><code class="literal">memberOf</code>, <code class="literal">not memberOf</code></span></dt><dd><p class="simpara">
									Use these operators to verify whether a field is a member of or is not a member of an <code class="literal">Array</code> or a <code class="literal">Collection</code> that is defined as a variable. The <code class="literal">Array</code> or <code class="literal">Collection</code> must be a variable.
								</p><div class="formalpara"><p class="title"><strong>Example constraints with <code class="literal">memberOf</code> and <code class="literal">not memberOf</code> with a Collection</strong></p><p>
										
<pre class="screen">FamilyTree( person memberOf $europeanDescendants )

FamilyTree( person not memberOf $europeanDescendants )</pre>
									</p></div></dd><dt><span class="term"><code class="literal">soundslike</code></span></dt><dd><p class="simpara">
									Use this operator to verify whether a word has almost the same sound, using English pronunciation, as the given value (similar to the <code class="literal">matches</code> operator). This operator uses the Soundex algorithm.
								</p><div class="formalpara"><p class="title"><strong>Example constraint with <code class="literal">soundslike</code></strong></p><p>
										
<pre class="screen">// Match firstName "Jon" or "John":
Person( firstName soundslike "John" )</pre>
									</p></div></dd><dt><span class="term"><code class="literal">str</code></span></dt><dd><p class="simpara">
									Use this operator to verify whether a field that is a <code class="literal">String</code> starts with or ends with a specified value. You can also use this operator to verify the length of the <code class="literal">String</code>.
								</p><div class="formalpara"><p class="title"><strong>Example constraints with <code class="literal">str</code></strong></p><p>
										
<pre class="screen">// Verify what the String starts with:
Message( routingValue str[startsWith] "R1" )

// Verify what the String ends with:
Message( routingValue str[endsWith] "R2" )

// Verify the length of the String:
Message( routingValue str[length] 17 )</pre>
									</p></div></dd><dt><span class="term"><code class="literal">in</code>, <code class="literal">notin</code></span></dt><dd><p class="simpara">
									Use these operators to specify more than one possible value to match in a constraint (compound value restriction). This functionality of compound value restriction is supported only in the <code class="literal">in</code> and <code class="literal">not in</code> operators. The second operand of these operators must be a comma-separated list of values enclosed in parentheses. You can provide values as variables, literals, return values, or qualified identifiers. These operators are internally rewritten as a list of multiple restrictions using the operators <code class="literal">==</code> or <code class="literal">!=</code>.
								</p><div class="formalpara"><p class="title"><strong>Example constraints with <code class="literal">in</code> and <code class="literal">notin</code></strong></p><p>
										
<pre class="screen">Person( $color : favoriteColor )
Color( type in ( "red", "blue", $color ) )

Person( $color : favoriteColor )
Color( type notin ( "red", "blue", $color ) )</pre>
									</p></div></dd></dl></div></section><section class="section" id="drl-operator-precedence-ref_drl-rules"><div class="titlepage"><div><div><h3 class="title">15.8.6. Operator precedence in DRL pattern constraints</h3></div></div></div><p>
						DRL supports standard Java operator precedence for applicable constraint operators, with some exceptions and with some additional operators that are unique in DRL. The following table lists DRL operator precedence where applicable, from highest to lowest precedence:
					</p><div class="table" id="idm139921832772944"><p class="title"><strong>Table 15.2. Operator precedence in DRL pattern constraints</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 29%; " class="col_1"/><col style="width: 29%; " class="col_2"/><col style="width: 43%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921836360288" scope="col">Operator type</th><th align="left" valign="top" id="idm139921836359200" scope="col">Operators</th><th align="left" valign="top" id="idm139921836358112" scope="col">Notes</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921836360288">
									<p>
										Nested or null-safe property access
									</p>
									</td><td align="left" valign="top" headers="idm139921836359200">
									<p>
										<code class="literal">.</code>, <code class="literal">.()</code>, <code class="literal">!.</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921836358112">
									<p>
										Not standard Java semantics
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921836360288">
									<p>
										<code class="literal">List</code> or <code class="literal">Map</code> access
									</p>
									</td><td align="left" valign="top" headers="idm139921836359200">
									<p>
										<code class="literal">[]</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921836358112">
									<p>
										Not standard Java semantics
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921836360288">
									<p>
										Constraint binding
									</p>
									</td><td align="left" valign="top" headers="idm139921836359200">
									<p>
										<code class="literal">:</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921836358112">
									<p>
										Not standard Java semantics
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921836360288">
									<p>
										Multiplicative
									</p>
									</td><td align="left" valign="top" headers="idm139921836359200">
									<p>
										<code class="literal">*</code>, <code class="literal">/%</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921836358112"> </td></tr><tr><td align="left" valign="top" headers="idm139921836360288">
									<p>
										Additive
									</p>
									</td><td align="left" valign="top" headers="idm139921836359200">
									<p>
										<code class="literal">+</code>, <code class="literal">-</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921836358112"> </td></tr><tr><td align="left" valign="top" headers="idm139921836360288">
									<p>
										Shift
									</p>
									</td><td align="left" valign="top" headers="idm139921836359200">
									<p>
										<code class="literal">&gt;&gt;</code>, <code class="literal">&gt;&gt;&gt;</code>, <code class="literal">&lt;&lt;</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921836358112"> </td></tr><tr><td align="left" valign="top" headers="idm139921836360288">
									<p>
										Relational
									</p>
									</td><td align="left" valign="top" headers="idm139921836359200">
									<p>
										<code class="literal">&lt;</code>, <code class="literal">&lt;=</code>, <code class="literal">&gt;</code>, <code class="literal">&gt;=</code>, <code class="literal">instanceof</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921836358112"> </td></tr><tr><td align="left" valign="top" headers="idm139921836360288">
									<p>
										Equality
									</p>
									</td><td align="left" valign="top" headers="idm139921836359200">
									<p>
										<code class="literal">== !=</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921836358112">
									<p>
										Uses <code class="literal">equals()</code> and <code class="literal">!equals()</code> semantics, not standard Java <code class="literal">same</code> and <code class="literal">not same</code> semantics
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921836360288">
									<p>
										Non-short-circuiting <code class="literal">AND</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921836359200">
									<p>
										<code class="literal">&amp;</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921836358112"> </td></tr><tr><td align="left" valign="top" headers="idm139921836360288">
									<p>
										Non-short-circuiting exclusive <code class="literal">OR</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921836359200">
									<p>
										<code class="literal">^</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921836358112"> </td></tr><tr><td align="left" valign="top" headers="idm139921836360288">
									<p>
										Non-short-circuiting inclusive <code class="literal">OR</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921836359200">
									<p>
										<code class="literal">|</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921836358112"> </td></tr><tr><td align="left" valign="top" headers="idm139921836360288">
									<p>
										Logical <code class="literal">AND</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921836359200">
									<p>
										<code class="literal">&amp;&amp;</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921836358112"> </td></tr><tr><td align="left" valign="top" headers="idm139921836360288">
									<p>
										Logical <code class="literal">OR</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921836359200">
									<p>
										<code class="literal">||</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921836358112"> </td></tr><tr><td align="left" valign="top" headers="idm139921836360288">
									<p>
										Ternary
									</p>
									</td><td align="left" valign="top" headers="idm139921836359200">
									<p>
										<code class="literal">? :</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921836358112"> </td></tr><tr><td align="left" valign="top" headers="idm139921836360288">
									<p>
										Comma-separated <code class="literal">AND</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921836359200">
									<p>
										<code class="literal">,</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921836358112">
									<p>
										Not standard Java semantics
									</p>
									</td></tr></tbody></table></div></div></section><section class="section" id="drl-rules-WHEN-elements-ref_drl-rules"><div class="titlepage"><div><div><h3 class="title">15.8.7. Supported rule condition elements in DRL (keywords)</h3></div></div></div><p>
						DRL supports the following rule condition elements (keywords) that you can use with the patterns that you define in DRL rule conditions:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">and</code></span></dt><dd><p class="simpara">
									Use this to group conditional components into a logical conjunction. Infix and prefix <code class="literal">and</code> are supported. You can group patterns explicitly with parentheses <code class="literal">()</code>. By default, all listed patterns are combined with <code class="literal">and</code> when no conjunction is specified.
								</p><div class="formalpara"><p class="title"><strong>Example patterns with <code class="literal">and</code></strong></p><p>
										
<pre class="screen">//Infix `and`:
Color( colorType : type ) and Person( favoriteColor == colorType )

//Infix `and` with grouping:
(Color( colorType : type ) and (Person( favoriteColor == colorType ) or Person( favoriteColor == colorType ))

// Prefix `and`:
(and Color( colorType : type ) Person( favoriteColor == colorType ))

// Default implicit `and`:
Color( colorType : type )
Person( favoriteColor == colorType )</pre>
									</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										Do not use a leading declaration binding with the <code class="literal">and</code> keyword (as you can with <code class="literal">or</code>, for example). A declaration can only reference a single fact at a time, and if you use a declaration binding with <code class="literal">and</code>, then when <code class="literal">and</code> is satisfied, it matches both facts and results in an error.
									</p><div class="formalpara"><p class="title"><strong>Example misuse of <code class="literal">and</code></strong></p><p>
											
<pre class="screen">// Causes compile error:
$person : (Person( name == "Romeo" ) and Person( name == "Juliet"))</pre>
										</p></div></div></div></dd><dt><span class="term"><code class="literal">or</code></span></dt><dd><p class="simpara">
									Use this to group conditional components into a logical disjunction. Infix and prefix <code class="literal">or</code> are supported. You can group patterns explicitly with parentheses <code class="literal">()</code>. You can also use pattern binding with <code class="literal">or</code>, but each pattern must be bound separately.
								</p><div class="formalpara"><p class="title"><strong>Example patterns with <code class="literal">or</code></strong></p><p>
										
<pre class="screen">//Infix `or`:
Color( colorType : type ) or Person( favoriteColor == colorType )

//Infix `or` with grouping:
(Color( colorType : type ) or (Person( favoriteColor == colorType ) and Person( favoriteColor == colorType ))

// Prefix `or`:
(or Color( colorType : type ) Person( favoriteColor == colorType ))</pre>
									</p></div><div class="formalpara"><p class="title"><strong>Example patterns with <code class="literal">or</code> and pattern binding</strong></p><p>
										
<pre class="screen">pensioner : (Person( sex == "f", age &gt; 60 ) or Person( sex == "m", age &gt; 65 ))

(or pensioner : Person( sex == "f", age &gt; 60 )
    pensioner : Person( sex == "m", age &gt; 65 ))</pre>
									</p></div><p class="simpara">
									The behavior of the <code class="literal">or</code> condition element is different from the connective <code class="literal">||</code> operator for constraints and restrictions in field constraints. The decision engine does not directly interpret the <code class="literal">or</code> element but uses logical transformations to rewrite a rule with <code class="literal">or</code> as a number of sub-rules. This process ultimately results in a rule that has a single <code class="literal">or</code> as the root node and one sub-rule for each of its condition elements. Each sub-rule is activated and executed like any normal rule, with no special behavior or interaction between the sub-rules.
								</p><p class="simpara">
									Therefore, consider the <code class="literal">or</code> condition element a shortcut for generating two or more similar rules that, in turn, can create multiple activations when two or more terms of the disjunction are true.
								</p></dd><dt><span class="term"><code class="literal">exists</code></span></dt><dd><p class="simpara">
									Use this to specify facts and constraints that must exist. This option is triggered on only the first match, not subsequent matches. If you use this element with multiple patterns, enclose the patterns with parentheses <code class="literal">()</code>.
								</p><div class="formalpara"><p class="title"><strong>Example patterns with <code class="literal">exists</code></strong></p><p>
										
<pre class="screen">exists Person( firstName == "John")

exists (Person( firstName == "John", age == 42 ))

exists (Person( firstName == "John" ) and
        Person( lastName == "Doe" ))</pre>
									</p></div></dd><dt><span class="term"><code class="literal">not</code></span></dt><dd><p class="simpara">
									Use this to specify facts and constraints that must not exist. If you use this element with multiple patterns, enclose the patterns with parentheses <code class="literal">()</code>.
								</p><div class="formalpara"><p class="title"><strong>Example patterns with <code class="literal">not</code></strong></p><p>
										
<pre class="screen">not Person( firstName == "John")

not (Person( firstName == "John", age == 42 ))

not (Person( firstName == "John" ) and
     Person( lastName == "Doe" ))</pre>
									</p></div></dd><dt><span class="term"><code class="literal">forall</code></span></dt><dd><p class="simpara">
									Use this to verify whether all facts that match the first pattern match all the remaining patterns. When a <code class="literal">forall</code> construct is satisfied, the rule evaluates to <code class="literal">true</code>. This element is a scope delimiter, so it can use any previously bound variable, but no variable bound inside of it is available for use outside of it.
								</p><div class="formalpara"><p class="title"><strong>Example rule with <code class="literal">forall</code></strong></p><p>
										
<pre class="screen">rule "All full-time employees have red ID badges"
  when
    forall( $emp : Employee( type == "fulltime" )
                   Employee( this == $emp, badgeColor = "red" ) )
  then
    // True, all full-time employees have red ID badges.
end</pre>
									</p></div><p class="simpara">
									In this example, the rule selects all <code class="literal">Employee</code> objects whose type is <code class="literal">"fulltime"</code>. For each fact that matches this pattern, the rule evaluates the patterns that follow (badge color) and if they match, the rule evaluates to <code class="literal">true</code>.
								</p><p class="simpara">
									To state that all facts of a given type in the working memory of the decision engine must match a set of constraints, you can use <code class="literal">forall</code> with a single pattern for simplicity.
								</p><div class="formalpara"><p class="title"><strong>Example rule with <code class="literal">forall</code> and a single pattern</strong></p><p>
										
<pre class="screen">rule "All full-time employees have red ID badges"
  when
    forall( Employee( badgeColor = "red" ) )
  then
    // True, all full-time employees have red ID badges.
end</pre>
									</p></div><p class="simpara">
									You can use <code class="literal">forall</code> constructs with multiple patterns or nest them with other condition elements, such as inside a <code class="literal">not</code> element construct.
								</p><div class="formalpara"><p class="title"><strong>Example rule with <code class="literal">forall</code> and multiple patterns</strong></p><p>
										
<pre class="screen">rule "All employees have health and dental care programs"
  when
    forall( $emp : Employee()
            HealthCare( employee == $emp )
            DentalCare( employee == $emp )
          )
  then
    // True, all employees have health and dental care.
end</pre>
									</p></div><div class="formalpara"><p class="title"><strong>Example rule with <code class="literal">forall</code> and <code class="literal">not</code></strong></p><p>
										
<pre class="screen">rule "Not all employees have health and dental care"
  when
    not ( forall( $emp : Employee()
                  HealthCare( employee == $emp )
                  DentalCare( employee == $emp ) )
        )
  then
    // True, not all employees have health and dental care.
end</pre>
									</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										The format <code class="literal">forall( p1 p2 p3 …​)</code> is equivalent to <code class="literal">not( p1 and not( and p2 p3 …​ ) )</code>.
									</p></div></div></dd><dt><span class="term"><code class="literal">from</code></span></dt><dd><p class="simpara">
									Use this to specify a data source for a pattern. This enables the decision engine to reason over data that is not in the working memory. The data source can be a sub-field on a bound variable or the result of a method call. The expression used to define the object source is any expression that follows regular MVEL syntax. Therefore, the <code class="literal">from</code> element enables you to easily use object property navigation, execute method calls, and access maps and collection elements.
								</p><div class="formalpara"><p class="title"><strong>Example rule with <code class="literal">from</code> and pattern binding</strong></p><p>
										
<pre class="screen">rule "Validate zipcode"
  when
    Person( $personAddress : address )
    Address( zipcode == "23920W" ) from $personAddress
  then
    // Zip code is okay.
end</pre>
									</p></div><div class="formalpara"><p class="title"><strong>Example rule with <code class="literal">from</code> and a graph notation</strong></p><p>
										
<pre class="screen">rule "Validate zipcode"
  when
    $p : Person()
    $a : Address( zipcode == "23920W" ) from $p.address
  then
    // Zip code is okay.
end</pre>
									</p></div><div class="formalpara"><p class="title"><strong>Example rule with <code class="literal">from</code> to iterate over all objects</strong></p><p>
										
<pre class="screen">rule "Apply 10% discount to all items over US$ 100 in an order"
  when
    $order : Order()
    $item  : OrderItem( value &gt; 100 ) from $order.items
  then
    // Apply discount to `$item`.
end</pre>
									</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										For large collections of objects, instead of adding an object with a large graph that the decision engine must iterate over frequently, add the collection directly to the KIE session and then join the collection in the condition, as shown in the following example:
									</p><pre class="screen">when
  $order : Order()
  OrderItem( value &gt; 100, order == $order )</pre></div></div><div class="formalpara"><p class="title"><strong>Example rule with <code class="literal">from</code> and <code class="literal">lock-on-active</code> rule attribute</strong></p><p>
										
<pre class="screen">rule "Assign people in North Carolina (NC) to sales region 1"
  ruleflow-group "test"
  lock-on-active true
  when
    $p : Person()
    $a : Address( state == "NC" ) from $p.address
  then
    modify ($p) {} // Assign the person to sales region 1.
end

rule "Apply a discount to people in the city of Raleigh"
  ruleflow-group "test"
  lock-on-active true
  when
    $p : Person()
    $a : Address( city == "Raleigh" ) from $p.address
  then
    modify ($p) {} // Apply discount to the person.
end</pre>
									</p></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
										Using <code class="literal">from</code> with <code class="literal">lock-on-active</code> rule attribute can result in rules not being executed. You can address this issue in one of the following ways:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												Avoid using the <code class="literal">from</code> element when you can insert all facts into the working memory of the decision engine or use nested object references in your constraint expressions.
											</li><li class="listitem">
												Place the variable used in the <code class="literal">modify()</code> block as the last sentence in your rule condition.
											</li><li class="listitem">
												Avoid using the <code class="literal">lock-on-active</code> rule attribute when you can explicitly manage how rules within the same ruleflow group place activations on one another.
											</li></ul></div></div></div><p class="simpara">
									The pattern that contains a <code class="literal">from</code> clause cannot be followed by another pattern starting with a parenthesis. The reason for this restriction is that the DRL parser reads the <code class="literal">from</code> expression as <code class="literal">"from $l (String() or Number())"</code> and it cannot differentiate this expression from a function call. The simplest workaround to this is to wrap the <code class="literal">from</code> clause in parentheses, as shown in the following example:
								</p><div class="formalpara"><p class="title"><strong>Example rules with <code class="literal">from</code> used incorrectly and correctly</strong></p><p>
										
<pre class="screen">// Do not use `from` in this way:
rule R
  when
    $l : List()
    String() from $l
    (String() or Number())
  then
    // Actions
end

// Use `from` in this way instead:
rule R
  when
    $l : List()
    (String() from $l)
    (String() or Number())
  then
    // Actions
end</pre>
									</p></div></dd><dt><span class="term"><code class="literal">entry-point</code></span></dt><dd><p class="simpara">
									Use this to define an entry point, or <span class="emphasis"><em>event stream</em></span>, corresponding to a data source for the pattern. This element is typically used with the <code class="literal">from</code> condition element. You can declare an entry point for events so that the decision engine uses data from only that entry point to evaluate the rules. You can declare an entry point either implicitly by referencing it in DRL rules or explicitly in your Java application.
								</p><div class="formalpara"><p class="title"><strong>Example rule with <code class="literal">from entry-point</code></strong></p><p>
										
<pre class="screen">rule "Authorize withdrawal"
  when
    WithdrawRequest( $ai : accountId, $am : amount ) from entry-point "ATM Stream"
    CheckingAccount( accountId == $ai, balance &gt; $am )
  then
    // Authorize withdrawal.
end</pre>
									</p></div><div class="formalpara"><p class="title"><strong>Example Java application code with EntryPoint object and inserted facts</strong></p><p>
										
<pre class="programlisting language-java">import org.kie.api.runtime.KieSession;
import org.kie.api.runtime.rule.EntryPoint;

// Create your KIE base and KIE session as usual:
KieSession session = ...

// Create a reference to the entry point:
EntryPoint atmStream = session.getEntryPoint("ATM Stream");

// Start inserting your facts into the entry point:
atmStream.insert(aWithdrawRequest);</pre>
									</p></div></dd><dt><span class="term"><code class="literal">collect</code></span></dt><dd><p class="simpara">
									Use this to define a collection of objects that the rule can use as part of the condition. The rule obtains the collection either from a specified source or from the working memory of the decision engine. The result pattern of the <code class="literal">collect</code> element can be any concrete class that implements the <code class="literal">java.util.Collection</code> interface and provides a default no-arg public constructor. You can use Java collections like <code class="literal">List</code>, <code class="literal">LinkedList</code>, and <code class="literal">HashSet</code>, or your own class. If variables are bound before the <code class="literal">collect</code> element in a condition, you can use the variables to constrain both your source and result patterns. However, any binding made inside the <code class="literal">collect</code> element is not available for use outside of it.
								</p><div class="formalpara"><p class="title"><strong>Example rule with <code class="literal">collect</code></strong></p><p>
										
<pre class="screen">import java.util.List

rule "Raise priority when system has more than three pending alarms"
  when
    $system : System()
    $alarms : List( size &gt;= 3 )
              from collect( Alarm( system == $system, status == 'pending' ) )
  then
    // Raise priority because `$system` has three or more `$alarms` pending.
end</pre>
									</p></div><p class="simpara">
									In this example, the rule assesses all pending alarms in the working memory of the decision engine for each given system and groups them in a <code class="literal">List</code>. If three or more alarms are found for a given system, the rule is executed.
								</p><p class="simpara">
									You can also use the <code class="literal">collect</code> element with nested <code class="literal">from</code> elements, as shown in the following example:
								</p><div class="formalpara"><p class="title"><strong>Example rule with <code class="literal">collect</code> and nested <code class="literal">from</code></strong></p><p>
										
<pre class="screen">import java.util.LinkedList;

rule "Send a message to all parents"
  when
    $town : Town( name == 'Paris' )
    $mothers : LinkedList()
               from collect( Person( children &gt; 0 )
                             from $town.getPeople()
                           )
  then
    // Send a message to all parents.
end</pre>
									</p></div></dd><dt><span class="term"><code class="literal">accumulate</code></span></dt><dd><p class="simpara">
									Use this to iterate over a collection of objects, execute custom actions for each of the elements, and return one or more result objects (if the constraints evaluate to <code class="literal">true</code>). This element is a more flexible and powerful form of the <code class="literal">collect</code> condition element. You can use predefined functions in your <code class="literal">accumulate</code> conditions or implement custom functions as needed. You can also use the abbreviation <code class="literal">acc</code> for <code class="literal">accumulate</code> in rule conditions.
								</p><p class="simpara">
									Use the following format to define <code class="literal">accumulate</code> conditions in rules:
								</p><div class="formalpara"><p class="title"><strong>Preferred format for <code class="literal">accumulate</code></strong></p><p>
										
<pre class="screen">accumulate( &lt;source pattern&gt;; &lt;functions&gt; [;&lt;constraints&gt;] )</pre>
									</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										Although the decision engine supports alternate formats for the <code class="literal">accumulate</code> element for backward compatibility, this format is preferred for optimal performance in rules and applications.
									</p></div></div><p class="simpara">
									The decision engine supports the following predefined <code class="literal">accumulate</code> functions. These functions accept any expression as input.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											<code class="literal">average</code>
										</li><li class="listitem">
											<code class="literal">min</code>
										</li><li class="listitem">
											<code class="literal">max</code>
										</li><li class="listitem">
											<code class="literal">count</code>
										</li><li class="listitem">
											<code class="literal">sum</code>
										</li><li class="listitem">
											<code class="literal">collectList</code>
										</li><li class="listitem">
											<code class="literal">collectSet</code>
										</li></ul></div><p class="simpara">
									In the following example rule, <code class="literal">min</code>, <code class="literal">max</code>, and <code class="literal">average</code> are <code class="literal">accumulate</code> functions that calculate the minimum, maximum, and average temperature values over all the readings for each sensor:
								</p><div class="formalpara"><p class="title"><strong>Example rule with <code class="literal">accumulate</code> to calculate temperature values</strong></p><p>
										
<pre class="screen">rule "Raise alarm"
  when
    $s : Sensor()
    accumulate( Reading( sensor == $s, $temp : temperature );
                $min : min( $temp ),
                $max : max( $temp ),
                $avg : average( $temp );
                $min &lt; 20, $avg &gt; 70 )
  then
    // Raise the alarm.
end</pre>
									</p></div><p class="simpara">
									The following example rule uses the <code class="literal">average</code> function with <code class="literal">accumulate</code> to calculate the average profit for all items in an order:
								</p><div class="formalpara"><p class="title"><strong>Example rule with <code class="literal">accumulate</code> to calculate average profit</strong></p><p>
										
<pre class="screen">rule "Average profit"
  when
    $order : Order()
    accumulate( OrderItem( order == $order, $cost : cost, $price : price );
                $avgProfit : average( 1 - $cost / $price ) )
  then
    // Average profit for `$order` is `$avgProfit`.
end</pre>
									</p></div><p class="simpara">
									To use custom, domain-specific functions in <code class="literal">accumulate</code> conditions, create a Java class that implements the <code class="literal">org.kie.api.runtime.rule.AccumulateFunction</code> interface. For example, the following Java class defines a custom implementation of an <code class="literal">AverageData</code> function:
								</p><div class="formalpara"><p class="title"><strong>Example Java class with custom implementation of <code class="literal">average</code> function</strong></p><p>
										
<pre class="programlisting language-java">// An implementation of an accumulator capable of calculating average values

public class AverageAccumulateFunction implements org.kie.api.runtime.rule.AccumulateFunction&lt;AverageAccumulateFunction.AverageData&gt; {

    public void readExternal(ObjectInput in) throws IOException, ClassNotFoundException {

    }

    public void writeExternal(ObjectOutput out) throws IOException {

    }

    public static class AverageData implements Externalizable {
        public int    count = 0;
        public double total = 0;

        public AverageData() {}

        public void readExternal(ObjectInput in) throws IOException, ClassNotFoundException {
            count   = in.readInt();
            total   = in.readDouble();
        }

        public void writeExternal(ObjectOutput out) throws IOException {
            out.writeInt(count);
            out.writeDouble(total);
        }

    }

    /* (non-Javadoc)
     * @see org.kie.api.runtime.rule.AccumulateFunction#createContext()
     */
    public AverageData createContext() {
        return new AverageData();
    }

    /* (non-Javadoc)
     * @see org.kie.api.runtime.rule.AccumulateFunction#init(java.io.Serializable)
     */
    public void init(AverageData context) {
        context.count = 0;
        context.total = 0;
    }

    /* (non-Javadoc)
     * @see org.kie.api.runtime.rule.AccumulateFunction#accumulate(java.io.Serializable, java.lang.Object)
     */
    public void accumulate(AverageData context,
                           Object value) {
        context.count++;
        context.total += ((Number) value).doubleValue();
    }

    /* (non-Javadoc)
     * @see org.kie.api.runtime.rule.AccumulateFunction#reverse(java.io.Serializable, java.lang.Object)
     */
    public void reverse(AverageData context, Object value) {
        context.count--;
        context.total -= ((Number) value).doubleValue();
    }

    /* (non-Javadoc)
     * @see org.kie.api.runtime.rule.AccumulateFunction#getResult(java.io.Serializable)
     */
    public Object getResult(AverageData context) {
        return new Double( context.count == 0 ? 0 : context.total / context.count );
    }

    /* (non-Javadoc)
     * @see org.kie.api.runtime.rule.AccumulateFunction#supportsReverse()
     */
    public boolean supportsReverse() {
        return true;
    }

    /* (non-Javadoc)
     * @see org.kie.api.runtime.rule.AccumulateFunction#getResultType()
     */
    public Class&lt; ? &gt; getResultType() {
        return Number.class;
    }

}</pre>
									</p></div><p class="simpara">
									To use the custom function in a DRL rule, import the function using the <code class="literal">import accumulate</code> statement:
								</p><div class="formalpara"><p class="title"><strong>Format to import a custom function</strong></p><p>
										
<pre class="screen">import accumulate &lt;class_name&gt; &lt;function_name&gt;</pre>
									</p></div><div class="formalpara"><p class="title"><strong>Example rule with the imported <code class="literal">average</code> function</strong></p><p>
										
<pre class="screen">import accumulate AverageAccumulateFunction.AverageData average

rule "Average profit"
  when
    $order : Order()
    accumulate( OrderItem( order == $order, $cost : cost, $price : price );
                $avgProfit : average( 1 - $cost / $price ) )
  then
    // Average profit for `$order` is `$avgProfit`.
end</pre>
									</p></div></dd></dl></div></section><section class="section" id="drl-rules-oopath-con_drl-rules"><div class="titlepage"><div><div><h3 class="title">15.8.8. OOPath syntax with graphs of objects in DRL rule conditions</h3></div></div></div><p>
						OOPath is an object-oriented syntax extension of XPath that is designed for browsing graphs of objects in DRL rule condition constraints. OOPath uses the compact notation from XPath for navigating through related elements while handling collections and filtering constraints, and is specifically useful for graphs of objects.
					</p><p>
						When the field of a fact is a collection, you can use the <code class="literal">from</code> condition element (keyword) to bind and reason over all the items in that collection one by one. If you need to browse a graph of objects in the rule condition constraints, the extensive use of the <code class="literal">from</code> condition element results in a verbose and repetitive syntax, as shown in the following example:
					</p><div class="formalpara"><p class="title"><strong>Example rule that browses a graph of objects with <code class="literal">from</code></strong></p><p>
							
<pre class="screen">rule "Find all grades for Big Data exam"
  when
    $student: Student( $plan: plan )
    $exam: Exam( course == "Big Data" ) from $plan.exams
    $grade: Grade() from $exam.grades
  then
    // Actions
end</pre>
						</p></div><p>
						In this example, the domain model contains a <code class="literal">Student</code> object with a <code class="literal">Plan</code> of study. The <code class="literal">Plan</code> can have zero or more <code class="literal">Exam</code> instances and an <code class="literal">Exam</code> can have zero or more <code class="literal">Grade</code> instances. Only the root object of the graph, the <code class="literal">Student</code> in this case, needs to be in the working memory of the decision engine for this rule setup to function.
					</p><p>
						As a more efficient alternative to using extensive <code class="literal">from</code> statements, you can use the abbreviated OOPath syntax, as shown in the following example:
					</p><div class="formalpara"><p class="title"><strong>Example rule that browses a graph of objects with OOPath syntax</strong></p><p>
							
<pre class="screen">rule "Find all grades for Big Data exam"
  when
    Student( $grade: /plan/exams[course == "Big Data"]/grades )
  then
    // Actions
end</pre>
						</p></div><p>
						Formally, the core grammar of an OOPath expression is defined in extended Backus-Naur form (EBNF) notation in the following way:
					</p><div class="formalpara"><p class="title"><strong>EBNF notation for OOPath expressions</strong></p><p>
							
<pre class="screen">OOPExpr = [ID ( ":" | ":=" )] ( "/" | "?/" ) OOPSegment { ( "/" | "?/" | "." ) OOPSegment } ;
OOPSegment = ID ["#" ID] ["[" ( Number | Constraints ) "]"]</pre>
						</p></div><p>
						In practice, an OOPath expression has the following features and capabilities:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Starts with a forward slash <code class="literal">/</code> or with a question mark and forward slash <code class="literal">?/</code> if it is a non-reactive OOPath expression (described later in this section).
							</li><li class="listitem">
								Can dereference a single property of an object with the period <code class="literal">.</code> operator.
							</li><li class="listitem">
								Can dereference multiple properties of an object with the forward slash <code class="literal">/</code> operator. If a collection is returned, the expression iterates over the values in the collection.
							</li><li class="listitem"><p class="simpara">
								Can filter out traversed objects that do not satisfy one or more constraints. The constraints are written as predicate expressions between square brackets, as shown in the following example:
							</p><div class="formalpara"><p class="title"><strong>Constraints as a predicate expression</strong></p><p>
									
<pre class="screen">Student( $grade: /plan/exams[ course == "Big Data" ]/grades )</pre>
								</p></div></li><li class="listitem"><p class="simpara">
								Can downcast a traversed object to a subclass of the class declared in the generic collection. Subsequent constraints can also safely access the properties declared only in that subclass, as shown in the following example. Objects that are not instances of the class specified in this inline cast are automatically filtered out.
							</p><div class="formalpara"><p class="title"><strong>Constraints with downcast objects</strong></p><p>
									
<pre class="screen">Student( $grade: /plan/exams#AdvancedExam[ course == "Big Data", level &gt; 3 ]/grades )</pre>
								</p></div></li><li class="listitem"><p class="simpara">
								Can backreference an object of the graph that was traversed before the currently iterated graph. For example, the following OOPath expression matches only the grades that are above the average for the passed exam:
							</p><div class="formalpara"><p class="title"><strong>Constraints with backreferenced object</strong></p><p>
									
<pre class="screen">Student( $grade: /plan/exams/grades[ result &gt; ../averageResult ] )</pre>
								</p></div></li><li class="listitem"><p class="simpara">
								Can recursively be another OOPath expression, as shown in the following example:
							</p><div class="formalpara"><p class="title"><strong>Recursive constraint expression</strong></p><p>
									
<pre class="screen">Student( $exam: /plan/exams[ /grades[ result &gt; 20 ] ] )</pre>
								</p></div></li><li class="listitem"><p class="simpara">
								Can access objects by their index between square brackets <code class="literal">[]</code>, as shown in the following example. To adhere to Java convention, OOPath indexes are 0-based, while XPath indexes are 1-based.
							</p><div class="formalpara"><p class="title"><strong>Constraints with access to objects by index</strong></p><p>
									
<pre class="screen">Student( $grade: /plan/exams[0]/grades )</pre>
								</p></div></li></ul></div><p>
						OOPath expressions can be reactive or non-reactive. The decision engine does not react to updates involving a deeply nested object that is traversed during the evaluation of an OOPath expression.
					</p><p>
						To make these objects reactive to changes, modify the objects to extend the class <code class="literal">org.drools.core.phreak.ReactiveObject</code>. After you modify an object to extend the <code class="literal">ReactiveObject</code> class, the domain object invokes the inherited method <code class="literal">notifyModification</code> to notify the decision engine when one of the fields has been updated, as shown in the following example:
					</p><div class="formalpara"><p class="title"><strong>Example object method to notify the decision engine that an exam has been moved to a different course</strong></p><p>
							
<pre class="programlisting language-java">public void setCourse(String course) {
        this.course = course;
        notifyModification(this);
        }</pre>
						</p></div><p>
						With the following corresponding OOPath expression, when an exam is moved to a different course, the rule is re-executed and the list of grades matching the rule is recomputed:
					</p><div class="formalpara"><p class="title"><strong>Example OOPath expression from "Big Data" rule</strong></p><p>
							
<pre class="screen">Student( $grade: /plan/exams[ course == "Big Data" ]/grades )</pre>
						</p></div><p>
						You can also use the <code class="literal">?/</code> separator instead of the <code class="literal">/</code> separator to disable reactivity in only one sub-portion of an OOPath expression, as shown in the following example:
					</p><div class="formalpara"><p class="title"><strong>Example OOPath expression that is partially non-reactive</strong></p><p>
							
<pre class="screen">Student( $grade: /plan/exams[ course == "Big Data" ]?/grades )</pre>
						</p></div><p>
						With this example, the decision engine reacts to a change made to an exam or if an exam is added to the plan, but not if a new grade is added to an existing exam.
					</p><p>
						If an OOPath portion is non-reactive, all remaining portions of the OOPath expression also become non-reactive. For example, the following OOPath expression is completely non-reactive:
					</p><div class="formalpara"><p class="title"><strong>Example OOPath expression that is completely non-reactive</strong></p><p>
							
<pre class="screen">Student( $grade: ?/plan/exams[ course == "Big Data" ]/grades )</pre>
						</p></div><p>
						For this reason, you cannot use the <code class="literal">?/</code> separator more than once in the same OOPath expression. For example, the following expression causes a compilation error:
					</p><div class="formalpara"><p class="title"><strong>Example OOPath expression with duplicate non-reactivity markers</strong></p><p>
							
<pre class="screen">Student( $grade: /plan?/exams[ course == "Big Data" ]?/grades )</pre>
						</p></div><p>
						Another alternative for enabling OOPath expression reactivity is to use the dedicated implementations for <code class="literal">List</code> and <code class="literal">Set</code> interfaces in Red Hat Process Automation Manager. These implementations are the <code class="literal">ReactiveList</code> and <code class="literal">ReactiveSet</code> classes. A <code class="literal">ReactiveCollection</code> class is also available. The implementations also provide reactive support for performing mutable operations through the <code class="literal">Iterator</code> and <code class="literal">ListIterator</code> classes.
					</p><p>
						The following example class uses these classes to configure OOPath expression reactivity:
					</p><div class="formalpara"><p class="title"><strong>Example Java class to configure OOPath expression reactivity</strong></p><p>
							
<pre class="programlisting language-java">public class School extends AbstractReactiveObject {
    private String name;
    private final List&lt;Child&gt; children = new ReactiveList&lt;Child&gt;(); <span id="CO8-1"/><span class="callout">1</span>

    public void setName(String name) {
        this.name = name;
        notifyModification(); <span id="CO8-2"/><span class="callout">2</span>
    }

    public void addChild(Child child) {
        children.add(child); <span id="CO8-3"/><span class="callout">3</span>
        // No need to call `notifyModification()` here
    }
  }</pre>
						</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO8-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Uses the <code class="literal">ReactiveList</code> instance for reactive support over the standard Java <code class="literal">List</code> instance.
							</div></dd><dt><a href="#CO8-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								Uses the required <code class="literal">notifyModification()</code> method for when a field is changed in reactive support.
							</div></dd><dt><a href="#CO8-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								The <code class="literal">children</code> field is a <code class="literal">ReactiveList</code> instance, so the <code class="literal">notifyModification()</code> method call is not required. The notification is handled automatically, like all other mutating operations performed over the <code class="literal">children</code> field.
							</div></dd></dl></div></section></section><section class="section" id="drl-rules-THEN-con_drl-rules"><div class="titlepage"><div><div><h2 class="title">15.9. Rule actions in DRL (THEN)</h2></div></div></div><p>
					The <code class="literal">then</code> part of the rule (also known as the <span class="emphasis"><em>Right Hand Side (RHS)</em></span> of the rule) contains the actions to be performed when the conditional part of the rule has been met. Actions consist of one or more <span class="emphasis"><em>methods</em></span> that execute consequences based on the rule conditions and on available data objects in the package. For example, if a bank requires loan applicants to have over 21 years of age (with a rule condition <code class="literal">Applicant( age &lt; 21 )</code>) and a loan applicant is under 21 years old, the <code class="literal">then</code> action of an <code class="literal">"Underage"</code> rule would be <code class="literal">setApproved( false )</code>, declining the loan because the applicant is under age.
				</p><p>
					The main purpose of rule actions is to to insert, delete, or modify data in the working memory of the decision engine. Effective rule actions are small, declarative, and readable. If you need to use imperative or conditional code in rule actions, then divide the rule into multiple smaller and more declarative rules.
				</p><div class="formalpara"><p class="title"><strong>Example rule for loan application age limit</strong></p><p>
						
<pre class="screen">rule "Underage"
  when
    application : LoanApplication()
    Applicant( age &lt; 21 )
  then
    application.setApproved( false );
    application.setExplanation( "Underage" );
end</pre>
					</p></div><section class="section" id="drl-rules-THEN-methods-ref_drl-rules"><div class="titlepage"><div><div><h3 class="title">15.9.1. Supported rule action methods in DRL</h3></div></div></div><p>
						DRL supports the following rule action methods that you can use in DRL rule actions. You can use these methods to modify the working memory of the decision engine without having to first reference a working memory instance. These methods act as shortcuts to the methods provided by the <code class="literal">KnowledgeHelper</code> class in your Red Hat Process Automation Manager distribution.
					</p><p>
						For all rule action methods, download the <span class="strong strong"><strong>Red Hat Process Automation Manager 7.10.0 Source Distribution</strong></span> ZIP file from the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Red Hat Customer Portal</a> and navigate to <code class="literal">~/rhpam-7.10.0-sources/src/drools-$VERSION/drools-core/src/main/java/org/drools/core/spi/KnowledgeHelper.java</code>.
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">set</code></span></dt><dd><p class="simpara">
									Use this to set the value of a field.
								</p><pre class="screen">set&lt;field&gt; ( &lt;value&gt; )</pre><div class="formalpara"><p class="title"><strong>Example rule action to set the values of a loan application approval</strong></p><p>
										
<pre class="screen">$application.setApproved ( false );
$application.setExplanation( "has been bankrupt" );</pre>
									</p></div></dd><dt><span class="term"><code class="literal">modify</code></span></dt><dd><p class="simpara">
									Use this to specify fields to be modified for a fact and to notify the decision engine of the change. This method provides a structured approach to fact updates. It combines the <code class="literal">update</code> operation with setter calls to change object fields.
								</p><pre class="screen">modify ( &lt;fact-expression&gt; ) {
    &lt;expression&gt;,
    &lt;expression&gt;,
    ...
}</pre><div class="formalpara"><p class="title"><strong>Example rule action to modify a loan application amount and approval</strong></p><p>
										
<pre class="screen">modify( LoanApplication ) {
        setAmount( 100 ),
        setApproved ( true )
}</pre>
									</p></div></dd><dt><span class="term"><code class="literal">update</code></span></dt><dd><p class="simpara">
									Use this to specify fields and the entire related fact to be updated and to notify the decision engine of the change. After a fact has changed, you must call <code class="literal">update</code> before changing another fact that might be affected by the updated values. To avoid this added step, use the <code class="literal">modify</code> method instead.
								</p><pre class="screen">update ( &lt;object, &lt;handle&gt; )  // Informs the decision engine that an object has changed

update ( &lt;object&gt; )  // Causes `KieSession` to search for a fact handle of the object</pre><div class="formalpara"><p class="title"><strong>Example rule action to update a loan application amount and approval</strong></p><p>
										
<pre class="screen">LoanApplication.setAmount( 100 );
update( LoanApplication );</pre>
									</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										If you provide property-change listeners, you do not need to call this method when an object changes. For more information about property-change listeners, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#property-change-listeners-con_decision-engine"><span class="emphasis"><em>Decision engine in Red Hat Process Automation Manager</em></span></a>.
									</p></div></div></dd><dt><span class="term"><code class="literal">insert</code></span></dt><dd><p class="simpara">
									Use this to insert a <code class="literal">new</code> fact into the working memory of the decision engine and to define resulting fields and values as needed for the fact.
								</p><pre class="screen">insert( new &lt;object&gt; );</pre><div class="formalpara"><p class="title"><strong>Example rule action to insert a new loan applicant object</strong></p><p>
										
<pre class="screen">insert( new Applicant() );</pre>
									</p></div></dd><dt><span class="term"><code class="literal">insertLogical</code></span></dt><dd><p class="simpara">
									Use this to insert a <code class="literal">new</code> fact logically into the decision engine. The decision engine is responsible for logical decisions on insertions and retractions of facts. After regular or stated insertions, facts must be retracted explicitly. After logical insertions, the facts that were inserted are automatically retracted when the conditions in the rules that inserted the facts are no longer true.
								</p><pre class="screen">insertLogical( new &lt;object&gt; );</pre><div class="formalpara"><p class="title"><strong>Example rule action to logically insert a new loan applicant object</strong></p><p>
										
<pre class="screen">insertLogical( new Applicant() );</pre>
									</p></div></dd><dt><span class="term"><code class="literal">delete</code></span></dt><dd><p class="simpara">
									Use this to remove an object from the decision engine. The keyword <code class="literal">retract</code> is also supported in DRL and executes the same action, but <code class="literal">delete</code> is typically preferred in DRL code for consistency with the keyword <code class="literal">insert</code>.
								</p><pre class="screen">delete( &lt;object&gt; );</pre><div class="formalpara"><p class="title"><strong>Example rule action to delete a loan applicant object</strong></p><p>
										
<pre class="screen">delete( Applicant );</pre>
									</p></div></dd></dl></div></section><section class="section" id="drl-rules-THEN-methods-variables-ref_drl-rules"><div class="titlepage"><div><div><h3 class="title">15.9.2. Other rule action methods from <code class="literal">drools</code> and <code class="literal">kcontext</code> variables</h3></div></div></div><p>
						In addition to the standard rule action methods, the decision engine supports methods in conjunction with the predefined <code class="literal">drools</code> and <code class="literal">kcontext</code> variables that you can also use in rule actions.
					</p><p>
						You can use the <code class="literal">drools</code> variable to call methods from the <code class="literal">KnowledgeHelper</code> class in your Red Hat Process Automation Manager distribution, which is also the class that the standard rule action methods are based on. For all <code class="literal">drools</code> rule action options, download the <span class="strong strong"><strong>Red Hat Process Automation Manager 7.10.0 Source Distribution</strong></span> ZIP file from the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Red Hat Customer Portal</a> and navigate to <code class="literal">~/rhpam-7.10.0-sources/src/drools-$VERSION/drools-core/src/main/java/org/drools/core/spi/KnowledgeHelper.java</code>.
					</p><p>
						The following examples are common methods that you can use with the <code class="literal">drools</code> variable:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">drools.halt()</code>: Terminates rule execution if a user or application has previously called <code class="literal">fireUntilHalt()</code>. When a user or application calls <code class="literal">fireUntilHalt()</code>, the decision engine starts in <span class="emphasis"><em>active mode</em></span> and evaluates rules continually until the user or application explicitly calls <code class="literal">halt()</code>. Otherwise, by default, the decision engine runs in <span class="emphasis"><em>passive mode</em></span> and evaluates rules only when a user or an application explicitly calls <code class="literal">fireAllRules()</code>.
							</li><li class="listitem">
								<code class="literal">drools.getWorkingMemory()</code>: Returns the <code class="literal">WorkingMemory</code> object.
							</li><li class="listitem">
								<code class="literal">drools.setFocus( "&lt;agenda_group&gt;" )</code>: Sets the focus to a specified agenda group to which the rule belongs.
							</li><li class="listitem">
								<code class="literal">drools.getRule().getName()</code>: Returns the name of the rule.
							</li><li class="listitem">
								<code class="literal">drools.getTuple()</code>, <code class="literal">drools.getActivation()</code>: Returns the <code class="literal">Tuple</code> that matches the currently executing rule and then delivers the corresponding <code class="literal">Activation</code>. These calls are useful for logging and debugging purposes.
							</li></ul></div><p>
						You can use the <code class="literal">kcontext</code> variable with the <code class="literal">getKieRuntime()</code> method to call other methods from the <code class="literal">KieContext</code> class and, by extension, the <code class="literal">RuleContext</code> class in your Red Hat Process Automation Manager distribution. The full Knowledge Runtime API is exposed through the <code class="literal">kcontext</code> variable and provides extensive rule action methods. For all <code class="literal">kcontext</code> rule action options, download the <span class="strong strong"><strong>Red Hat Process Automation Manager 7.10.0 Source Distribution</strong></span> ZIP file from the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Red Hat Customer Portal</a> and navigate to <code class="literal">~/rhpam-7.10.0-sources/src/kie-api-parent-$VERSION/kie-api/src/main/java/org/kie/api/runtime/rule/RuleContext.java</code>.
					</p><p>
						The following examples are common methods that you can use with the <code class="literal">kcontext.getKieRuntime()</code> variable-method combination:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">kcontext.getKieRuntime().halt()</code>: Terminates rule execution if a user or application has previously called <code class="literal">fireUntilHalt()</code>. This method is equivalent to the <code class="literal">drools.halt()</code> method. When a user or application calls <code class="literal">fireUntilHalt()</code>, the decision engine starts in <span class="emphasis"><em>active mode</em></span> and evaluates rules continually until the user or application explicitly calls <code class="literal">halt()</code>. Otherwise, by default, the decision engine runs in <span class="emphasis"><em>passive mode</em></span> and evaluates rules only when a user or an application explicitly calls <code class="literal">fireAllRules()</code>.
							</li><li class="listitem"><p class="simpara">
								<code class="literal">kcontext.getKieRuntime().getAgenda()</code>: Returns a reference to the KIE session <code class="literal">Agenda</code>, and in turn provides access to rule activation groups, rule agenda groups, and ruleflow groups.
							</p><div class="formalpara"><p class="title"><strong>Example call to access agenda group "CleanUp" and set the focus</strong></p><p>
									
<pre class="programlisting language-java">kcontext.getKieRuntime().getAgenda().getAgendaGroup( "CleanUp" ).setFocus();</pre>
								</p></div><p class="simpara">
								This example is equivalent to <code class="literal">drools.setFocus( "CleanUp" )</code>.
							</p></li><li class="listitem">
								<code class="literal">kcontext.getKieRuntime().getQueryResults(&lt;string&gt; query)</code>: Runs a query and returns the results. This method is equivalent to <code class="literal">drools.getKieRuntime().getQueryResults()</code>.
							</li><li class="listitem">
								<code class="literal">kcontext.getKieRuntime().getKieBase()</code>: Returns the <code class="literal">KieBase</code> object. The KIE base is the source of all the knowledge in your rule system and the originator of the current KIE session.
							</li><li class="listitem">
								<code class="literal">kcontext.getKieRuntime().setGlobal()</code>, <code class="literal">~.getGlobal()</code>, <code class="literal">~.getGlobals()</code>: Sets or retrieves global variables.
							</li><li class="listitem">
								<code class="literal">kcontext.getKieRuntime().getEnvironment()</code>: Returns the runtime <code class="literal">Environment</code>, similar to your operating system environment.
							</li></ul></div></section><section class="section" id="drl-rules-THEN-advanced-con_drl-rules"><div class="titlepage"><div><div><h3 class="title">15.9.3. Advanced rule actions with conditional and named consequences</h3></div></div></div><p>
						In general, effective rule actions are small, declarative, and readable. However, in some cases, the limitation of having a single consequence for each rule can be challenging and lead to verbose and repetitive rule syntax, as shown in the following example rules:
					</p><div class="formalpara"><p class="title"><strong>Example rules with verbose and repetitive syntax</strong></p><p>
							
<pre class="screen">rule "Give 10% discount to customers older than 60"
  when
    $customer : Customer( age &gt; 60 )
  then
    modify($customer) { setDiscount( 0.1 ) };
end

rule "Give free parking to customers older than 60"
  when
    $customer : Customer( age &gt; 60 )
    $car : Car( owner == $customer )
  then
    modify($car) { setFreeParking( true ) };
end</pre>
						</p></div><p>
						A partial solution to the repetition is to make the second rule extend the first rule, as shown in the following modified example:
					</p><div class="formalpara"><p class="title"><strong>Partially enhanced example rules with an extended condition</strong></p><p>
							
<pre class="screen">rule "Give 10% discount to customers older than 60"
  when
    $customer : Customer( age &gt; 60 )
  then
    modify($customer) { setDiscount( 0.1 ) };
end

rule "Give free parking to customers older than 60"
    extends "Give 10% discount to customers older than 60"
  when
    $car : Car( owner == $customer )
  then
    modify($car) { setFreeParking( true ) };
end</pre>
						</p></div><p>
						As a more efficient alternative, you can consolidate the two rules into a single rule with modified conditions and labelled corresponding rule actions, as shown in the following consolidated example:
					</p><div class="formalpara"><p class="title"><strong>Consolidated example rule with conditional and named consequences</strong></p><p>
							
<pre class="screen">rule "Give 10% discount and free parking to customers older than 60"
  when
    $customer : Customer( age &gt; 60 )
    do[giveDiscount]
    $car : Car( owner == $customer )
  then
    modify($car) { setFreeParking( true ) };
  then[giveDiscount]
    modify($customer) { setDiscount( 0.1 ) };
end</pre>
						</p></div><p>
						This example rule uses two actions: the usual default action and another action named <code class="literal">giveDiscount</code>. The <code class="literal">giveDiscount</code> action is activated in the condition with the keyword <code class="literal">do</code> when a customer older than 60 years old is found in the KIE base, regardless of whether or not the customer owns a car.
					</p><p>
						You can configure the activation of a named consequence with an additional condition, such as the <code class="literal">if</code> statement in the following example. The condition in the <code class="literal">if</code> statement is always evaluated on the pattern that immediately precedes it.
					</p><div class="formalpara"><p class="title"><strong>Consolidated example rule with an additional condition</strong></p><p>
							
<pre class="screen">rule "Give free parking to customers older than 60 and 10% discount to golden ones among them"
  when
    $customer : Customer( age &gt; 60 )
    if ( type == "Golden" ) do[giveDiscount]
    $car : Car( owner == $customer )
  then
    modify($car) { setFreeParking( true ) };
  then[giveDiscount]
    modify($customer) { setDiscount( 0.1 ) };
end</pre>
						</p></div><p>
						You can also evaluate different rule conditions using a nested <code class="literal">if</code> and <code class="literal">else if</code> construct, as shown in the following more complex example:
					</p><div class="formalpara"><p class="title"><strong>Consolidated example rule with more complex conditions</strong></p><p>
							
<pre class="screen">rule "Give free parking and 10% discount to over 60 Golden customer and 5% to Silver ones"
  when
    $customer : Customer( age &gt; 60 )
    if ( type == "Golden" ) do[giveDiscount10]
    else if ( type == "Silver" ) break[giveDiscount5]
    $car : Car( owner == $customer )
  then
    modify($car) { setFreeParking( true ) };
  then[giveDiscount10]
    modify($customer) { setDiscount( 0.1 ) };
  then[giveDiscount5]
    modify($customer) { setDiscount( 0.05 ) };
end</pre>
						</p></div><p>
						This example rule gives a 10% discount and free parking to Golden customers over 60, but only a 5% discount without free parking to Silver customers. The rule activates the consequence named <code class="literal">giveDiscount5</code> with the keyword <code class="literal">break</code> instead of <code class="literal">do</code>. The keyword <code class="literal">do</code> schedules a consequence in the decision engine agenda, enabling the remaining part of the rule conditions to continue being evaluated, while <code class="literal">break</code> blocks any further condition evaluation. If a named consequence does not correspond to any condition with <code class="literal">do</code> but is activated with <code class="literal">break</code>, the rule fails to compile because the conditional part of the rule is never reached.
					</p></section></section><section class="section" id="drl-rules-comments-con_drl-rules"><div class="titlepage"><div><div><h2 class="title">15.10. Comments in DRL files</h2></div></div></div><p>
					DRL supports single-line comments prefixed with a double forward slash <code class="literal">//</code> and multi-line comments enclosed with a forward slash and asterisk <code class="literal">/* …​ */</code>. You can use DRL comments to annotate rules or any related components in DRL files. DRL comments are ignored by the decision engine when the DRL file is processed.
				</p><div class="formalpara"><p class="title"><strong>Example rule with comments</strong></p><p>
						
<pre class="screen">rule "Underage"
  // This is a single-line comment.
  when
    $application : LoanApplication()  // This is an in-line comment.
    Applicant( age &lt; 21 )
  then
    /* This is a multi-line comment
    in the rule actions. */
    $application.setApproved( false );
    $application.setExplanation( "Underage" );
end</pre>
					</p></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						The hash symbol <code class="literal">#</code> is not supported for DRL comments.
					</p></div></div></section><section class="section" id="drl-rules-errors-ref_drl-rules"><div class="titlepage"><div><div><h2 class="title">15.11. Error messages for DRL troubleshooting</h2></div></div></div><p>
					Red Hat Process Automation Manager provides standardized messages for DRL errors to help you troubleshoot and resolve problems in your DRL files. The error messages use the following format:
				</p><div class="figure" id="idm139921838506528"><p class="title"><strong>Figure 15.1. Error message format for DRL file problems</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/LanguageReference/error_message.png" alt="error message"/></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>1st Block:</strong></span> Error code
						</li><li class="listitem">
							<span class="strong strong"><strong>2nd Block:</strong></span> Line and column in the DRL source where the error occurred
						</li><li class="listitem">
							<span class="strong strong"><strong>3rd Block:</strong></span> Description of the problem
						</li><li class="listitem">
							<span class="strong strong"><strong>4th Block:</strong></span> Component in the DRL source (rule, function, query) where the error occurred
						</li><li class="listitem">
							<span class="strong strong"><strong>5th Block:</strong></span> Pattern in the DRL source where the error occurred (if applicable)
						</li></ul></div><p>
					Red Hat Process Automation Manager supports the following standardized error messages:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">101: no viable alternative</span></dt><dd><p class="simpara">
								Indicates that the parser reached a decision point but could not identify an alternative.
							</p><div class="formalpara"><p class="title"><strong>Example rule with incorrect spelling</strong></p><p>
									
<pre class="screen">1: rule "simple rule"
2:   when
3:     exists Person()
4:     exits Student()  // Must be `exists`
5:   then
6: end</pre>
								</p></div><div class="formalpara"><p class="title"><strong>Error message</strong></p><p>
									
<pre class="screen">[ERR 101] Line 4:4 no viable alternative at input 'exits' in rule "simple rule"</pre>
								</p></div><div class="formalpara"><p class="title"><strong>Example rule without a rule name</strong></p><p>
									
<pre class="screen">1: package org.drools.examples;
2: rule    // Must be `rule "rule name"` (or `rule rule_name` if no spacing)
3:   when
4:     Object()
5:   then
6:     System.out.println("A RHS");
7: end</pre>
								</p></div><div class="formalpara"><p class="title"><strong>Error message</strong></p><p>
									
<pre class="screen">[ERR 101] Line 3:2 no viable alternative at input 'when'</pre>
								</p></div><p class="simpara">
								In this example, the parser encountered the keyword <code class="literal">when</code> but expected the rule name, so it flags <code class="literal">when</code> as the incorrect expected token.
							</p><div class="formalpara"><p class="title"><strong>Example rule with incorrect syntax</strong></p><p>
									
<pre class="screen">1: rule "simple rule"
2:   when
3:     Student( name == "Andy )  // Must be `"Andy"`
4:   then
5: end</pre>
								</p></div><div class="formalpara"><p class="title"><strong>Error message</strong></p><p>
									
<pre class="screen">[ERR 101] Line 0:-1 no viable alternative at input '&lt;eof&gt;' in rule "simple rule" in pattern Student</pre>
								</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									A line and column value of <code class="literal">0:-1</code> means the parser reached the end of the source file (<code class="literal">&lt;eof&gt;</code>) but encountered incomplete constructs, usually due to missing quotation marks <code class="literal">"…​"</code>, apostrophes <code class="literal">'…​'</code>, or parentheses <code class="literal">(…​)</code>.
								</p></div></div></dd><dt><span class="term">102: mismatched input</span></dt><dd><p class="simpara">
								Indicates that the parser expected a particular symbol that is missing at the current input position.
							</p><div class="formalpara"><p class="title"><strong>Example rule with an incomplete rule statement</strong></p><p>
									
<pre class="screen">1: rule simple_rule
2:   when
3:     $p : Person(
        // Must be a complete rule statement</pre>
								</p></div><div class="formalpara"><p class="title"><strong>Error message</strong></p><p>
									
<pre class="screen">[ERR 102] Line 0:-1 mismatched input '&lt;eof&gt;' expecting ')' in rule "simple rule" in pattern Person</pre>
								</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									A line and column value of <code class="literal">0:-1</code> means the parser reached the end of the source file (<code class="literal">&lt;eof&gt;</code>) but encountered incomplete constructs, usually due to missing quotation marks <code class="literal">"…​"</code>, apostrophes <code class="literal">'…​'</code>, or parentheses <code class="literal">(…​)</code>.
								</p></div></div><div class="formalpara"><p class="title"><strong>Example rule with incorrect syntax</strong></p><p>
									
<pre class="screen">1: package org.drools.examples;
2:
3: rule "Wrong syntax"
4:   when
5:     not( Car( ( type == "tesla", price == 10000 ) || ( type == "kia", price == 1000 ) ) from $carList )
       // Must use `&amp;&amp;` operators instead of commas `,`
6:   then
7:     System.out.println("OK");
8: end</pre>
								</p></div><div class="formalpara"><p class="title"><strong>Error messages</strong></p><p>
									
<pre class="screen">[ERR 102] Line 5:36 mismatched input ',' expecting ')' in rule "Wrong syntax" in pattern Car
[ERR 101] Line 5:57 no viable alternative at input 'type' in rule "Wrong syntax"
[ERR 102] Line 5:106 mismatched input ')' expecting 'then' in rule "Wrong syntax"</pre>
								</p></div><p class="simpara">
								In this example, the syntactic problem results in multiple error messages related to each other. The single solution of replacing the commas <code class="literal">,</code> with <code class="literal">&amp;&amp;</code> operators resolves all errors. If you encounter multiple errors, resolve one at a time in case errors are consequences of previous errors.
							</p></dd><dt><span class="term">103: failed predicate</span></dt><dd><p class="simpara">
								Indicates that a validating semantic predicate evaluated to <code class="literal">false</code>. These semantic predicates are typically used to identify component keywords in DRL files, such as <code class="literal">declare</code>, <code class="literal">rule</code>, <code class="literal">exists</code>, <code class="literal">not</code>, and others.
							</p><div class="formalpara"><p class="title"><strong>Example rule with an invalid keyword</strong></p><p>
									
<pre class="screen"> 1: package nesting;
 2:
 3: import org.drools.compiler.Person
 4: import org.drools.compiler.Address
 5:
 6: Some text  // Must be a valid DRL keyword
 7:
 8: rule "test something"
 9:   when
10:     $p: Person( name=="Michael" )
11:   then
12:     $p.name = "other";
13:     System.out.println(p.name);
14: end</pre>
								</p></div><div class="formalpara"><p class="title"><strong>Error message</strong></p><p>
									
<pre class="screen">[ERR 103] Line 6:0 rule 'rule_key' failed predicate: {(validateIdentifierKey(DroolsSoftKeywords.RULE))}? in rule</pre>
								</p></div><p class="simpara">
								The <code class="literal">Some text</code> line is invalid because it does not begin with or is not a part of a DRL keyword construct, so the parser fails to validate the rest of the DRL file.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									This error is similar to <code class="literal">102: mismatched input</code>, but usually involves DRL keywords.
								</p></div></div></dd><dt><span class="term">104: trailing semi-colon not allowed</span></dt><dd><p class="simpara">
								Indicates that an <code class="literal">eval()</code> clause in a rule condition uses a semicolon <code class="literal">;</code> but must not use one.
							</p><div class="formalpara"><p class="title"><strong>Example rule with <code class="literal">eval()</code> and trailing semicolon</strong></p><p>
									
<pre class="screen">1: rule "simple rule"
2:   when
3:     eval( abc(); )  // Must not use semicolon `;`
4:   then
5: end</pre>
								</p></div><div class="formalpara"><p class="title"><strong>Error message</strong></p><p>
									
<pre class="screen">[ERR 104] Line 3:4 trailing semi-colon not allowed in rule "simple rule"</pre>
								</p></div></dd><dt><span class="term">105: did not match anything</span></dt><dd><p class="simpara">
								Indicates that the parser reached a sub-rule in the grammar that must match an alternative at least once, but the sub-rule did not match anything. The parser has entered a branch with no way out.
							</p><div class="formalpara"><p class="title"><strong>Example rule with invalid text in an empty condition</strong></p><p>
									
<pre class="screen">1: rule "empty condition"
2:   when
3:     None  // Must remove `None` if condition is empty
4:   then
5:      insert( new Person() );
6: end</pre>
								</p></div><div class="formalpara"><p class="title"><strong>Error message</strong></p><p>
									
<pre class="screen">[ERR 105] Line 2:2 required (...)+ loop did not match anything at input 'WHEN' in rule "empty condition"</pre>
								</p></div><p class="simpara">
								In this example, the condition is intended to be empty but the word <code class="literal">None</code> is used. This error is resolved by removing <code class="literal">None</code>, which is not a valid DRL keyword, data type, or pattern construct.
							</p></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you encounter other DRL error messages that you cannot resolve, contact your Red Hat Technical Account Manager.
					</p></div></div></section><section class="section" id="drl-rule-units-con_drl-rules"><div class="titlepage"><div><div><h2 class="title">15.12. Rule units in DRL rule sets</h2></div></div></div><p>
					Rule units are groups of data sources, global variables, and DRL rules that function together for a specific purpose. You can use rule units to partition a rule set into smaller units, bind different data sources to those units, and then execute the individual unit. Rule units are an enhanced alternative to rule-grouping DRL attributes such as rule agenda groups or activation groups for execution control.
				</p><p>
					Rule units are helpful when you want to coordinate rule execution so that the complete execution of one rule unit triggers the start of another rule unit and so on. For example, assume that you have a set of rules for data enrichment, another set of rules that processes that data, and another set of rules that extract the output from the processed data. If you add these rule sets into three distinct rule units, you can coordinate those rule units so that complete execution of the first unit triggers the start of the second unit and the complete execution of the second unit triggers the start of third unit.
				</p><p>
					To define a rule unit, implement the <code class="literal">RuleUnit</code> interface as shown in the following example:
				</p><div class="formalpara"><p class="title"><strong>Example rule unit class</strong></p><p>
						
<pre class="programlisting language-java">package org.mypackage.myunit;

public static class AdultUnit implements RuleUnit {
    private int adultAge;
    private DataSource&lt;Person&gt; persons;

    public AdultUnit( ) { }

    public AdultUnit( DataSource&lt;Person&gt; persons, int age ) {
        this.persons = persons;
        this.age = age;
    }

    // A data source of `Persons` in this rule unit:
    public DataSource&lt;Person&gt; getPersons() {
        return persons;
    }

    // A global variable in this rule unit:
    public int getAdultAge() {
        return adultAge;
    }

    // Life-cycle methods:
    @Override
    public void onStart() {
        System.out.println("AdultUnit started.");
    }

    @Override
    public void onEnd() {
        System.out.println("AdultUnit ended.");
    }
}</pre>
					</p></div><p>
					In this example, <code class="literal">persons</code> is a source of facts of type <code class="literal">Person</code>. A rule unit data source is a source of the data processed by a given rule unit and represents the entry point that the decision engine uses to evaluate the rule unit. The <code class="literal">adultAge</code> global variable is accessible from all the rules belonging to this rule unit. The last two methods are part of the rule unit life cycle and are invoked by the decision engine.
				</p><p>
					The decision engine supports the following optional life-cycle methods for rule units:
				</p><div class="table" id="idm139921833244848"><p class="title"><strong>Table 15.3. Rule unit life-cycle methods</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 50%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921833240000" scope="col">Method</th><th align="left" valign="top" id="idm139921833238912" scope="col">Invoked when</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921833240000">
								<p>
									<code class="literal">onStart()</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921833238912">
								<p>
									Rule unit execution starts
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921833240000">
								<p>
									<code class="literal">onEnd()</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921833238912">
								<p>
									Rule unit execution ends
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921833240000">
								<p>
									<code class="literal">onSuspend()</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921833238912">
								<p>
									Rule unit execution is suspended (used only with <code class="literal">runUntilHalt()</code>)
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921833240000">
								<p>
									<code class="literal">onResume()</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921833238912">
								<p>
									Rule unit execution is resumed (used only with <code class="literal">runUntilHalt()</code>)
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921833240000">
								<p>
									<code class="literal">onYield(RuleUnit other)</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921833238912">
								<p>
									The consequence of a rule in the rule unit triggers the execution of a different rule unit
								</p>
								</td></tr></tbody></table></div></div><p>
					You can add one or more rules to a rule unit. By default, all the rules in a DRL file are automatically associated with a rule unit that follows the naming convention of the DRL file name. If the DRL file is in the same package and has the same name as a class that implements the <code class="literal">RuleUnit</code> interface, then all of the rules in that DRL file implicitly belong to that rule unit. For example, all the rules in the <code class="literal">AdultUnit.drl</code> file in the <code class="literal">org.mypackage.myunit</code> package are automatically part of the rule unit <code class="literal">org.mypackage.myunit.AdultUnit</code>.
				</p><p>
					To override this naming convention and explicitly declare the rule unit that the rules in a DRL file belong to, use the <code class="literal">unit</code> keyword in the DRL file. The <code class="literal">unit</code> declaration must immediately follow the package declaration and contain the name of the class in that package that the rules in the DRL file are part of.
				</p><div class="formalpara"><p class="title"><strong>Example rule unit declaration in a DRL file</strong></p><p>
						
<pre class="screen">package org.mypackage.myunit
unit AdultUnit

rule Adult
  when
    $p : Person(age &gt;= adultAge) from persons
  then
    System.out.println($p.getName() + " is adult and greater than " + adultAge);
end</pre>
					</p></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						Do not mix rules with and without a rule unit in the same KIE base. Mixing two rule paradigms in a KIE base results in a compilation error.
					</p></div></div><p>
					You can also rewrite the same pattern in a more convenient way using OOPath notation, as shown in the following example:
				</p><div class="formalpara"><p class="title"><strong>Example rule unit declaration in a DRL file that uses OOPath notation</strong></p><p>
						
<pre class="screen">package org.mypackage.myunit
unit AdultUnit

rule Adult
  when
    $p : /persons[age &gt;= adultAge]
  then
    System.out.println($p.getName() + " is adult and greater than " + adultAge);
end</pre>
					</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						OOPath is an object-oriented syntax extension of XPath that is designed for browsing graphs of objects in DRL rule condition constraints. OOPath uses the compact notation from XPath for navigating through related elements while handling collections and filtering constraints, and is specifically useful for graphs of objects.
					</p></div></div><p>
					In this example, any matching facts in the rule conditions are retrieved from the <code class="literal">persons</code> data source defined in the <code class="literal">DataSource</code> definition in the rule unit class. The rule condition and action use the <code class="literal">adultAge</code> variable in the same way that a global variable is defined at the DRL file level.
				</p><p>
					To execute one or more rule units defined in a KIE base, create a new <code class="literal">RuleUnitExecutor</code> class bound to the KIE base, create the rule unit from the relevant data source, and run the rule unit executer:
				</p><div class="formalpara"><p class="title"><strong>Example rule unit execution</strong></p><p>
						
<pre class="programlisting language-java">// Create a `RuleUnitExecutor` class and bind it to the KIE base:
KieBase kbase = kieContainer.getKieBase();
RuleUnitExecutor executor = RuleUnitExecutor.create().bind( kbase );

// Create the `AdultUnit` rule unit using the `persons` data source and run the executor:
RuleUnit adultUnit = new AdultUnit(persons, 18);
executor.run( adultUnit );</pre>
					</p></div><p>
					Rules are executed by the <code class="literal">RuleUnitExecutor</code> class. The <code class="literal">RuleUnitExecutor</code> class creates KIE sessions and adds the required <code class="literal">DataSource</code> objects to those sessions, and then executes the rules based on the <code class="literal">RuleUnit</code> that is passed as a parameter to the <code class="literal">run()</code> method.
				</p><p>
					The example execution code produces the following output when the relevant <code class="literal">Person</code> facts are inserted in the <code class="literal">persons</code> data source:
				</p><div class="formalpara"><p class="title"><strong>Example rule unit execution output</strong></p><p>
						
<pre class="screen">org.mypackage.myunit.AdultUnit started.
Jane is adult and greater than 18
John is adult and greater than 18
org.mypackage.myunit.AdultUnit ended.</pre>
					</p></div><p>
					Instead of explicitly creating the rule unit instance, you can register the rule unit variables in the executor and pass to the executor the rule unit class that you want to run, and then the executor creates an instance of the rule unit. You can then set the <code class="literal">DataSource</code> definition and other variables as needed before running the rule unit.
				</p><div class="formalpara"><p class="title"><strong>Alternate rule unit execution option with registered variables</strong></p><p>
						
<pre class="programlisting language-java">executor.bindVariable( "persons", persons );
        .bindVariable( "adultAge", 18 );
executor.run( AdultUnit.class );</pre>
					</p></div><p>
					The name that you pass to the <code class="literal">RuleUnitExecutor.bindVariable()</code> method is used at run time to bind the variable to the field of the rule unit class with the same name. In the previous example, the <code class="literal">RuleUnitExecutor</code> inserts into the new rule unit the data source bound to the <code class="literal">"persons"</code> name and inserts the value <code class="literal">18</code> bound to the String <code class="literal">"adultAge"</code> into the fields with the corresponding names inside the <code class="literal">AdultUnit</code> class.
				</p><p>
					To override this default variable-binding behavior, use the <code class="literal">@UnitVar</code> annotation to explicitly define a logical binding name for each field of the rule unit class. For example, the field bindings in the following class are redefined with alternative names:
				</p><div class="formalpara"><p class="title"><strong>Example code to modify variable binding names with <code class="literal">@UnitVar</code></strong></p><p>
						
<pre class="programlisting language-java">package org.mypackage.myunit;

public static class AdultUnit implements RuleUnit {
    @UnitVar("minAge")
    private int adultAge = 18;

    @UnitVar("data")
    private DataSource&lt;Person&gt; persons;
}</pre>
					</p></div><p>
					You can then bind the variables to the executor using those alternative names and run the rule unit:
				</p><div class="formalpara"><p class="title"><strong>Example rule unit execution with modified variable names</strong></p><p>
						
<pre class="programlisting language-java">executor.bindVariable( "data", persons );
        .bindVariable( "minAge", 18 );
executor.run( AdultUnit.class );</pre>
					</p></div><p>
					You can execute a rule unit in <span class="emphasis"><em>passive mode</em></span> by using the <code class="literal">run()</code> method (equivalent to invoking <code class="literal">fireAllRules()</code> on a KIE session) or in <span class="emphasis"><em>active mode</em></span> using the <code class="literal">runUntilHalt()</code> method (equivalent to invoking <code class="literal">fireUntilHalt()</code> on a KIE session). By default, the decision engine runs in <span class="emphasis"><em>passive mode</em></span> and evaluates rule units only when a user or an application explicitly calls <code class="literal">run()</code> (or <code class="literal">fireAllRules()</code> for standard rules). If a user or application calls <code class="literal">runUntilHalt()</code> for rule units (or <code class="literal">fireUntilHalt()</code> for standard rules), the decision engine starts in <span class="emphasis"><em>active mode</em></span> and evaluates rule units continually until the user or application explicitly calls <code class="literal">halt()</code>.
				</p><p>
					If you use the <code class="literal">runUntilHalt()</code> method, invoke the method on a separate execution thread to avoid blocking the main thread:
				</p><div class="formalpara"><p class="title"><strong>Example rule unit execution with <code class="literal">runUntilHalt()</code> on a separate thread</strong></p><p>
						
<pre class="programlisting language-java">new Thread( () -&gt; executor.runUntilHalt( adultUnit ) ).start();</pre>
					</p></div><section class="section" id="data_sources_for_rule_units"><div class="titlepage"><div><div><h3 class="title">15.12.1. Data sources for rule units</h3></div></div></div><p>
						A rule unit data source is a source of the data processed by a given rule unit and represents the entry point that the decision engine uses to evaluate the rule unit. A rule unit can have zero or more data sources and each <code class="literal">DataSource</code> definition declared inside a rule unit can correspond to a different entry point into the rule unit executor. Multiple rule units can share a single data source, but each rule unit must use different entry points through which the same objects are inserted.
					</p><p>
						You can create a <code class="literal">DataSource</code> definition with a fixed set of data in a rule unit class, as shown in the following example:
					</p><div class="formalpara"><p class="title"><strong>Example data source definition</strong></p><p>
							
<pre class="programlisting language-java">DataSource&lt;Person&gt; persons = DataSource.create( new Person( "John", 42 ),
                                                new Person( "Jane", 44 ),
                                                new Person( "Sally", 4 ) );</pre>
						</p></div><p>
						Because a data source represents the entry point of the rule unit, you can insert, update, or delete facts in a rule unit:
					</p><div class="formalpara"><p class="title"><strong>Example code to insert, modify, and delete a fact in a rule unit</strong></p><p>
							
<pre class="programlisting language-java">// Insert a fact:
Person john = new Person( "John", 42 );
FactHandle johnFh = persons.insert( john );

// Modify the fact and optionally specify modified properties (for property reactivity):
john.setAge( 43 );
persons.update( johnFh, john, "age" );

// Delete the fact:
persons.delete( johnFh );</pre>
						</p></div></section><section class="section" id="rule_unit_execution_control"><div class="titlepage"><div><div><h3 class="title">15.12.2. Rule unit execution control</h3></div></div></div><p>
						Rule units are helpful when you want to coordinate rule execution so that the execution of one rule unit triggers the start of another rule unit and so on.
					</p><p>
						To facilitate rule unit execution control, the decision engine supports the following rule unit methods that you can use in DRL rule actions to coordinate the execution of rule units:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">drools.run()</code>: Triggers the execution of a specified rule unit class. This method imperatively interrupts the execution of the rule unit and activates the other specified rule unit.
							</li><li class="listitem">
								<code class="literal">drools.guard()</code>: Prevents (guards) a specified rule unit class from being executed until the associated rule condition is met. This method declaratively schedules the execution of the other specified rule unit. When the decision engine produces at least one match for the condition in the guarding rule, the guarded rule unit is considered active. A rule unit can contain multiple guarding rules.
							</li></ul></div><p>
						As an example of the <code class="literal">drools.run()</code> method, consider the following DRL rules that each belong to a specified rule unit. The <code class="literal">NotAdult</code> rule uses the <code class="literal">drools.run( AdultUnit.class )</code> method to trigger the execution of the <code class="literal">AdultUnit</code> rule unit:
					</p><div class="formalpara"><p class="title"><strong>Example DRL rules with controlled execution using <code class="literal">drools.run()</code></strong></p><p>
							
<pre class="screen">package org.mypackage.myunit
unit AdultUnit

rule Adult
  when
    Person(age &gt;= 18, $name : name) from persons
  then
    System.out.println($name + " is adult");
end</pre>
						</p></div><pre class="screen">package org.mypackage.myunit
unit NotAdultUnit

rule NotAdult
  when
    $p : Person(age &lt; 18, $name : name) from persons
  then
    System.out.println($name + " is NOT adult");
    modify($p) { setAge(18); }
    drools.run( AdultUnit.class );
end</pre><p>
						The example also uses a <code class="literal">RuleUnitExecutor</code> class created from the KIE base that was built from these rules and a <code class="literal">DataSource</code> definition of <code class="literal">persons</code> bound to it:
					</p><div class="formalpara"><p class="title"><strong>Example rule executor and data source definitions</strong></p><p>
							
<pre class="programlisting language-java">RuleUnitExecutor executor = RuleUnitExecutor.create().bind( kbase );
DataSource&lt;Person&gt; persons = executor.newDataSource( "persons",
                                                     new Person( "John", 42 ),
                                                     new Person( "Jane", 44 ),
                                                     new Person( "Sally", 4 ) );</pre>
						</p></div><p>
						In this case, the example creates the <code class="literal">DataSource</code> definition directly from the <code class="literal">RuleUnitExecutor</code> class and binds it to the <code class="literal">"persons"</code> variable in a single statement.
					</p><p>
						The example execution code produces the following output when the relevant <code class="literal">Person</code> facts are inserted in the <code class="literal">persons</code> data source:
					</p><div class="formalpara"><p class="title"><strong>Example rule unit execution output</strong></p><p>
							
<pre class="screen">Sally is NOT adult
John is adult
Jane is adult
Sally is adult</pre>
						</p></div><p>
						The <code class="literal">NotAdult</code> rule detects a match when evaluating the person <code class="literal">"Sally"</code>, who is under 18 years old. The rule then modifies her age to <code class="literal">18</code> and uses the <code class="literal">drools.run( AdultUnit.class )</code> method to trigger the execution of the <code class="literal">AdultUnit</code> rule unit. The <code class="literal">AdultUnit</code> rule unit contains a rule that can now be executed for all of the 3 <code class="literal">persons</code> in the <code class="literal">DataSource</code> definition.
					</p><p>
						As an example of the <code class="literal">drools.guard()</code> method, consider the following <code class="literal">BoxOffice</code> class and <code class="literal">BoxOfficeUnit</code> rule unit class:
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">BoxOffice</code> class</strong></p><p>
							
<pre class="programlisting language-java">public class BoxOffice {
    private boolean open;

    public BoxOffice( boolean open ) {
        this.open = open;
    }

    public boolean isOpen() {
        return open;
    }

    public void setOpen( boolean open ) {
        this.open = open;
    }
}</pre>
						</p></div><div class="formalpara"><p class="title"><strong>Example <code class="literal">BoxOfficeUnit</code> rule unit class</strong></p><p>
							
<pre class="programlisting language-java">public class BoxOfficeUnit implements RuleUnit {
    private DataSource&lt;BoxOffice&gt; boxOffices;

    public DataSource&lt;BoxOffice&gt; getBoxOffices() {
        return boxOffices;
    }
}</pre>
						</p></div><p>
						The example also uses the following <code class="literal">TicketIssuerUnit</code> rule unit class to keep selling box office tickets for the event as long as at least one box office is open. This rule unit uses <code class="literal">DataSource</code> definitions of <code class="literal">persons</code> and <code class="literal">tickets</code>:
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">TicketIssuerUnit</code> rule unit class</strong></p><p>
							
<pre class="programlisting language-java">public class TicketIssuerUnit implements RuleUnit {
    private DataSource&lt;Person&gt; persons;
    private DataSource&lt;AdultTicket&gt; tickets;

    private List&lt;String&gt; results;

    public TicketIssuerUnit() { }

    public TicketIssuerUnit( DataSource&lt;Person&gt; persons, DataSource&lt;AdultTicket&gt; tickets ) {
        this.persons = persons;
        this.tickets = tickets;
    }

    public DataSource&lt;Person&gt; getPersons() {
        return persons;
    }

    public DataSource&lt;AdultTicket&gt; getTickets() {
        return tickets;
    }

    public List&lt;String&gt; getResults() {
        return results;
    }
}</pre>
						</p></div><p>
						The <code class="literal">BoxOfficeUnit</code> rule unit contains a <code class="literal">BoxOfficeIsOpen</code> DRL rule that uses the <code class="literal">drools.guard( TicketIssuerUnit.class )</code> method to guard the execution of the <code class="literal">TicketIssuerUnit</code> rule unit that distributes the event tickets, as shown in the following DRL rule examples:
					</p><div class="formalpara"><p class="title"><strong>Example DRL rules with controlled execution using <code class="literal">drools.guard()</code></strong></p><p>
							
<pre class="screen">package org.mypackage.myunit;
unit TicketIssuerUnit;

rule IssueAdultTicket when
    $p: /persons[ age &gt;= 18 ]
then
    tickets.insert(new AdultTicket($p));
end
rule RegisterAdultTicket when
    $t: /tickets
then
    results.add( $t.getPerson().getName() );
end</pre>
						</p></div><pre class="screen">package org.mypackage.myunit;
unit BoxOfficeUnit;

rule BoxOfficeIsOpen
  when
    $box: /boxOffices[ open ]
  then
    drools.guard( TicketIssuerUnit.class );
end</pre><p>
						In this example, so long as at least one box office is <code class="literal">open</code>, the guarded <code class="literal">TicketIssuerUnit</code> rule unit is active and distributes event tickets. When no more box offices are in <code class="literal">open</code> state, the guarded <code class="literal">TicketIssuerUnit</code> rule unit is prevented from being executed.
					</p><p>
						The following example class illustrates a more complete box office scenario:
					</p><div class="formalpara"><p class="title"><strong>Example class for the box office scenario</strong></p><p>
							
<pre class="programlisting language-java">DataSource&lt;Person&gt; persons = executor.newDataSource( "persons" );
DataSource&lt;BoxOffice&gt; boxOffices = executor.newDataSource( "boxOffices" );
DataSource&lt;AdultTicket&gt; tickets = executor.newDataSource( "tickets" );

List&lt;String&gt; list = new ArrayList&lt;&gt;();
executor.bindVariable( "results", list );

// Two box offices are open:
BoxOffice office1 = new BoxOffice(true);
FactHandle officeFH1 = boxOffices.insert( office1 );
BoxOffice office2 = new BoxOffice(true);
FactHandle officeFH2 = boxOffices.insert( office2 );

persons.insert(new Person("John", 40));

// Execute `BoxOfficeIsOpen` rule, run `TicketIssuerUnit` rule unit, and execute `RegisterAdultTicket` rule:
executor.run(BoxOfficeUnit.class);

assertEquals( 1, list.size() );
assertEquals( "John", list.get(0) );
list.clear();

persons.insert(new Person("Matteo", 30));

// Execute `RegisterAdultTicket` rule:
executor.run(BoxOfficeUnit.class);

assertEquals( 1, list.size() );
assertEquals( "Matteo", list.get(0) );
list.clear();

// One box office is closed, the other is open:
office1.setOpen(false);
boxOffices.update(officeFH1, office1);
persons.insert(new Person("Mark", 35));
executor.run(BoxOfficeUnit.class);

assertEquals( 1, list.size() );
assertEquals( "Mark", list.get(0) );
list.clear();

// All box offices are closed:
office2.setOpen(false);
boxOffices.update(officeFH2, office2); // Guarding rule is no longer true.
persons.insert(new Person("Edson", 35));
executor.run(BoxOfficeUnit.class); // No execution

assertEquals( 0, list.size() );</pre>
						</p></div></section><section class="section" id="rule_unit_identity_conflicts"><div class="titlepage"><div><div><h3 class="title">15.12.3. Rule unit identity conflicts</h3></div></div></div><p>
						In rule unit execution scenarios with guarded rule units, a rule can guard multiple rule units and at the same time a rule unit can be guarded and then activated by multiple rules. For these two-way guarding scenarios, rule units must have a clearly defined identity to avoid identity conflicts.
					</p><p>
						By default, the identity of a rule unit is the rule unit class name and is treated as a singleton class by the <code class="literal">RuleUnitExecutor</code>. This identification behavior is encoded in the <code class="literal">getUnitIdentity()</code> default method of the <code class="literal">RuleUnit</code> interface:
					</p><div class="formalpara"><p class="title"><strong>Default identity method in the <code class="literal">RuleUnit</code> interface</strong></p><p>
							
<pre class="programlisting language-java">default Identity getUnitIdentity() {
    return new Identity( getClass() );
}</pre>
						</p></div><p>
						In some cases, you may need to override this default identification behavior to avoid conflicting identities between rule units.
					</p><p>
						For example, the following <code class="literal">RuleUnit</code> class contains a <code class="literal">DataSource</code> definition that accepts any kind of object:
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">Unit0</code> rule unit class</strong></p><p>
							
<pre class="programlisting language-java">public class Unit0 implements RuleUnit {
    private DataSource&lt;Object&gt; input;

    public DataSource&lt;Object&gt; getInput() {
        return input;
    }
}</pre>
						</p></div><p>
						This rule unit contains the following DRL rule that guards another rule unit based on two conditions (in OOPath notation):
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">GuardAgeCheck</code> DRL rule in the rule unit</strong></p><p>
							
<pre class="screen">package org.mypackage.myunit
unit Unit0

rule GuardAgeCheck
  when
    $i: /input#Integer
    $s: /input#String
  then
    drools.guard( new AgeCheckUnit($i) );
    drools.guard( new AgeCheckUnit($s.length()) );
end</pre>
						</p></div><p>
						The guarded <code class="literal">AgeCheckUnit</code> rule unit verifies the age of a set of <code class="literal">persons</code>. The <code class="literal">AgeCheckUnit</code> contains a <code class="literal">DataSource</code> definition of the <code class="literal">persons</code> to check, a <code class="literal">minAge</code> variable that it verifies against, and a <code class="literal">List</code> for gathering the results:
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">AgeCheckUnit</code> rule unit</strong></p><p>
							
<pre class="programlisting language-java">public class AgeCheckUnit implements RuleUnit {
    private final int minAge;
    private DataSource&lt;Person&gt; persons;
    private List&lt;String&gt; results;

    public AgeCheckUnit( int minAge ) {
        this.minAge = minAge;
    }

    public DataSource&lt;Person&gt; getPersons() {
        return persons;
    }

    public int getMinAge() {
        return minAge;
    }

    public List&lt;String&gt; getResults() {
        return results;
    }
}</pre>
						</p></div><p>
						The <code class="literal">AgeCheckUnit</code> rule unit contains the following DRL rule that performs the verification of the <code class="literal">persons</code> in the data source:
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">CheckAge</code> DRL rule in the rule unit</strong></p><p>
							
<pre class="screen">package org.mypackage.myunit
unit AgeCheckUnit

rule CheckAge
  when
    $p : /persons{ age &gt; minAge }
  then
    results.add($p.getName() + "&gt;" + minAge);
end</pre>
						</p></div><p>
						This example creates a <code class="literal">RuleUnitExecutor</code> class, binds the class to the KIE base that contains these two rule units, and creates the two <code class="literal">DataSource</code> definitions for the same rule units:
					</p><div class="formalpara"><p class="title"><strong>Example executor and data source definitions</strong></p><p>
							
<pre class="programlisting language-java">RuleUnitExecutor executor = RuleUnitExecutor.create().bind( kbase );

DataSource&lt;Object&gt; input = executor.newDataSource( "input" );
DataSource&lt;Person&gt; persons = executor.newDataSource( "persons",
                                                     new Person( "John", 42 ),
                                                     new Person( "Sally", 4 ) );

List&lt;String&gt; results = new ArrayList&lt;&gt;();
executor.bindVariable( "results", results );</pre>
						</p></div><p>
						You can now insert some objects into the input data source and execute the <code class="literal">Unit0</code> rule unit:
					</p><div class="formalpara"><p class="title"><strong>Example rule unit execution with inserted objects</strong></p><p>
							
<pre class="programlisting language-java">ds.insert("test");
ds.insert(3);
ds.insert(4);
executor.run(Unit0.class);</pre>
						</p></div><div class="formalpara"><p class="title"><strong>Example results list from the execution</strong></p><p>
							
<pre class="programlisting language-java">[Sally&gt;3, John&gt;3]</pre>
						</p></div><p>
						In this example, the rule unit named <code class="literal">AgeCheckUnit</code> is considered a singleton class and then executed only once, with the <code class="literal">minAge</code> variable set to <code class="literal">3</code>. Both the String <code class="literal">"test"</code> and the Integer <code class="literal">4</code> inserted into the input data source can also trigger a second execution with the <code class="literal">minAge</code> variable set to <code class="literal">4</code>. However, the second execution does not occur because another rule unit with the same identity has already been evaluated.
					</p><p>
						To resolve this rule unit identity conflict, override the <code class="literal">getUnitIdentity()</code> method in the <code class="literal">AgeCheckUnit</code> class to include also the <code class="literal">minAge</code> variable in the rule unit identity:
					</p><div class="formalpara"><p class="title"><strong>Modified <code class="literal">AgeCheckUnit</code> rule unit to override the <code class="literal">getUnitIdentity()</code> method</strong></p><p>
							
<pre class="programlisting language-java">public class AgeCheckUnit implements RuleUnit {

    ...

    @Override
    public Identity getUnitIdentity() {
        return new Identity(getClass(), minAge);
    }
}</pre>
						</p></div><p>
						With this override in place, the previous example rule unit execution produces the following output:
					</p><div class="formalpara"><p class="title"><strong>Example results list from executing the modified rule unit</strong></p><p>
							
<pre class="programlisting language-java">[John&gt;4, Sally&gt;3, John&gt;3]</pre>
						</p></div><p>
						The rule units with <code class="literal">minAge</code> set to <code class="literal">3</code> and <code class="literal">4</code> are now considered two different rule units and both are executed.
					</p></section></section></section><section class="chapter" id="data-objects-con_drl-rules"><div class="titlepage"><div><div><h2 class="title">Chapter 16. Data objects</h2></div></div></div><p>
				Data objects are the building blocks for the rule assets that you create. Data objects are custom data types implemented as Java objects in specified packages of your project. For example, you might create a <code class="literal">Person</code> object with data fields <code class="literal">Name</code>, <code class="literal">Address</code>, and <code class="literal">DateOfBirth</code> to specify personal details for loan application rules. These custom data types determine what data your assets and your decision services are based on.
			</p><section class="section" id="data-objects-create-proc_drl-rules"><div class="titlepage"><div><div><h2 class="title">16.1. Creating data objects</h2></div></div></div><p>
					The following procedure is a generic overview of creating data objects. It is not specific to a particular business asset.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Data Object</strong></span>.
						</li><li class="listitem"><p class="simpara">
							Enter a unique <span class="strong strong"><strong>Data Object</strong></span> name and select the <span class="strong strong"><strong>Package</strong></span> where you want the data object to be available for other rule assets. Data objects with the same name cannot exist in the same package. In the specified DRL file, you can import a data object from any package.
						</p><div class="admonition important"><div class="admonition_header">Importing data objects from other packages</div><div><p>
								You can import an existing data object from another package directly into the asset designers like guided rules or guided decision table designers. Select the relevant rule asset within the project and in the asset designer, go to <span class="strong strong"><strong>Data Objects → New item</strong></span> to select the object to be imported.
							</p></div></div></li><li class="listitem">
							To make your data object persistable, select the <span class="strong strong"><strong>Persistable</strong></span> checkbox. Persistable data objects are able to be stored in a database according to the JPA specification. The default JPA is Hibernate.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Ok</strong></span>.
						</li><li class="listitem"><p class="simpara">
							In the data object designer, click <span class="strong strong"><strong>add field</strong></span> to add a field to the object with the attributes <span class="strong strong"><strong>Id</strong></span>, <span class="strong strong"><strong>Label</strong></span>, and <span class="strong strong"><strong>Type</strong></span>. Required attributes are marked with an asterisk (*).
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="strong strong"><strong>Id:</strong></span> Enter the unique ID of the field.
								</li><li class="listitem">
									<span class="strong strong"><strong>Label:</strong></span> (Optional) Enter a label for the field.
								</li><li class="listitem">
									<span class="strong strong"><strong>Type:</strong></span> Enter the data type of the field.
								</li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>List:</strong></span> (Optional) Select this check box to enable the field to hold multiple items for the specified type.
								</p><div class="figure" id="idm139921816808144"><p class="title"><strong>Figure 16.1. Add data fields to a data object</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/project-data/DataModelerNewField2-new.png" alt="Add data fields to a data object"/></div></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Create</strong></span> to add the new field, or click <span class="strong strong"><strong>Create and continue</strong></span> to add the new field and continue adding other fields.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								To edit a field, select the field row and use the <span class="strong strong"><strong>general properties</strong></span> on the right side of the screen.
							</p></div></div></li></ol></div></section></section><section class="chapter" id="drl-rules-central-create-proc"><div class="titlepage"><div><div><h2 class="title">Chapter 17. Creating DRL rules in Business Central</h2></div></div></div><p>
				You can create and manage DRL rules for your project in Business Central. In each DRL rule file, you define rule conditions, actions, and other components related to the rule, based on the data objects you create or import in the package.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>DRL file</strong></span>.
					</li><li class="listitem"><p class="simpara">
						Enter an informative <span class="strong strong"><strong>DRL file</strong></span> name and select the appropriate <span class="strong strong"><strong>Package</strong></span>. The package that you specify must be the same package where the required data objects have been assigned or will be assigned.
					</p><p class="simpara">
						You can also select <span class="strong strong"><strong>Show declared DSL sentences</strong></span> if any domain specific language (DSL) assets have been defined in your project. These DSL assets will then become usable objects for conditions and actions that you define in the DRL designer.
					</p></li><li class="listitem"><p class="simpara">
						Click <span class="strong strong"><strong>Ok</strong></span> to create the rule asset.
					</p><p class="simpara">
						The new DRL file is now listed in the <span class="strong strong"><strong>DRL</strong></span> panel of the <span class="strong strong"><strong>Project Explorer</strong></span>, or in the <span class="strong strong"><strong>DSLR</strong></span> panel if you selected the <span class="strong strong"><strong>Show declared DSL sentences</strong></span> option. The package to which you assigned this DRL file is listed at the top of the file.
					</p></li><li class="listitem">
						In the <span class="strong strong"><strong>Fact types</strong></span> list in the left panel of the DRL designer, confirm that all data objects and data object fields (expand each) required for your rules are listed. If not, you can either import relevant data objects from other packages by using <code class="literal">import</code> statements in the DRL file, or <a class="link" href="#data-objects-create-proc_drl-rules" title="16.1. Creating data objects">create data objects</a> within your package.
					</li><li class="listitem"><p class="simpara">
						After all data objects are in place, return to the <span class="strong strong"><strong>Model</strong></span> tab of the DRL designer and define the DRL file with any of the following components:
					</p><div class="formalpara"><p class="title"><strong>Components in a DRL file</strong></p><p>
							
<pre class="screen">package

import

function  // Optional

query  // Optional

declare   // Optional

global   // Optional

rule "rule name"
    // Attributes
    when
        // Conditions
    then
        // Actions
end

rule "rule2 name"

...</pre>
						</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">package</code>: (automatic) This was defined for you when you created the DRL file and selected the package.
							</li><li class="listitem"><p class="simpara">
								<code class="literal">import</code>: Use this to identify the data objects from either this package or another package that you want to use in the DRL file. Specify the package and data object in the format <code class="literal">packageName.objectName</code>, with multiple imports on separate lines.
							</p><div class="formalpara"><p class="title"><strong>Importing data objects</strong></p><p>
									
<pre class="screen">import org.mortgages.LoanApplication;</pre>
								</p></div></li><li class="listitem"><p class="simpara">
								<code class="literal">function</code>: (optional) Use this to include a function to be used by rules in the DRL file. Functions in DRL files put semantic code in your rule source file instead of in Java classes. Functions are especially useful if an action (<code class="literal">then</code>) part of a rule is used repeatedly and only the parameters differ for each rule. Above the rules in the DRL file, you can declare the function or import a static method from a helper class as a function, and then use the function by name in an action (<code class="literal">then</code>) part of the rule.
							</p><div class="formalpara"><p class="title"><strong>Declaring and using a function with a rule (option 1)</strong></p><p>
									
<pre class="screen">function String hello(String applicantName) {
    return "Hello " + applicantName + "!";
}

rule "Using a function"
  when
    // Empty
  then
    System.out.println( hello( "James" ) );
end</pre>
								</p></div><div class="formalpara"><p class="title"><strong>Importing and using the function with a rule (option 2)</strong></p><p>
									
<pre class="screen">import function my.package.applicant.hello;

rule "Using a function"
  when
    // Empty
  then
    System.out.println( hello( "James" ) );
end</pre>
								</p></div></li><li class="listitem"><p class="simpara">
								<code class="literal">query</code>: (optional) Use this to search the decision engine for facts related to the rules in the DRL file. You add the query definitions in DRL files and then obtain the matching results in your application code. Queries search for a set of defined conditions and do not require <code class="literal">when</code> or <code class="literal">then</code> specifications. Query names are global to the KIE base and therefore must be unique among all other rule queries in the project. To return the results of a query, construct a traditional <code class="literal">QueryResults</code> definition using <code class="literal">ksession.getQueryResults("name")</code>, where <code class="literal">"name"</code> is the query name. This returns a list of query results, which enable you to retrieve the objects that matched the query. Define the query and query results parameters above the rules in the DRL file.
							</p><div class="formalpara"><p class="title"><strong>Example query definition in a DRL file</strong></p><p>
									
<pre class="screen">query "people under the age of 21"
    $person : Person( age &lt; 21 )
end</pre>
								</p></div><div class="formalpara"><p class="title"><strong>Example application code to obtain query results</strong></p><p>
									
<pre class="programlisting language-java">QueryResults results = ksession.getQueryResults( "people under the age of 21" );
System.out.println( "we have " + results.size() + " people under the age  of 21" );</pre>
								</p></div></li><li class="listitem"><p class="simpara">
								<code class="literal">declare</code>: (optional) Use this to declare a new fact type to be used by rules in the DRL file. The default fact type in the <code class="literal">java.lang</code> package of Red Hat Process Automation Manager is <code class="literal">Object</code>, but you can declare other types in DRL files as needed. Declaring fact types in DRL files enables you to define a new fact model directly in the decision engine, without creating models in a lower-level language like Java.
							</p><div class="formalpara"><p class="title"><strong>Declaring and using a new fact type</strong></p><p>
									
<pre class="screen">declare Person
  name : String
  dateOfBirth : java.util.Date
  address : Address
end

rule "Using a declared type"
  when
    $p : Person( name == "James" )
  then   // Insert Mark, who is a customer of James.
    Person mark = new Person();
    mark.setName( "Mark" );
    insert( mark );
end</pre>
								</p></div></li><li class="listitem"><p class="simpara">
								<code class="literal">global</code>: (optional) Use this to include a global variable to be used by rules in the DRL file. Global variables typically provide data or services for the rules, such as application services used in rule consequences, and return data from rules, such as logs or values added in rule consequences. Set the global value in the working memory of the decision engine through a KIE session configuration or REST operation, declare the global variable above the rules in the DRL file, and then use it in an action (<code class="literal">then</code>) part of the rule. For multiple global variables, use separate lines in the DRL file.
							</p><div class="formalpara"><p class="title"><strong>Setting the global list configuration for the decision engine</strong></p><p>
									
<pre class="screen">List&lt;String&gt; list = new ArrayList&lt;&gt;();
KieSession kieSession = kiebase.newKieSession();
kieSession.setGlobal( "myGlobalList", list );</pre>
								</p></div><div class="formalpara"><p class="title"><strong>Defining the global list in a rule</strong></p><p>
									
<pre class="screen">global java.util.List myGlobalList;

rule "Using a global"
  when
    // Empty
  then
    myGlobalList.add( "My global list" );
end</pre>
								</p></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
									Do not use global variables to establish conditions in rules unless a global variable has a constant immutable value. Global variables are not inserted into the working memory of the decision engine, so the decision engine cannot track value changes of variables.
								</p><p>
									Do not use global variables to share data between rules. Rules always reason and react to the working memory state, so if you want to pass data from rule to rule, assert the data as facts into the working memory of the decision engine.
								</p></div></div></li><li class="listitem"><p class="simpara">
								<code class="literal">rule</code>: Use this to define each rule in the DRL file. Rules consist of a rule name in the format <code class="literal">rule "name"</code>, followed by optional attributes that define rule behavior (such as <code class="literal">salience</code> or <code class="literal">no-loop</code>), followed by <code class="literal">when</code> and <code class="literal">then</code> definitions. Each rule must have a unique name within the rule package. The <code class="literal">when</code> part of the rule contains the conditions that must be met to execute an action. For example, if a bank requires loan applicants to have over 21 years of age, then the <code class="literal">when</code> condition for an <code class="literal">"Underage"</code> rule would be <code class="literal">Applicant( age &lt; 21 )</code>. The <code class="literal">then</code> part of the rule contains the actions to be performed when the conditional part of the rule has been met. For example, when the loan applicant is under 21 years old, the <code class="literal">then</code> action would be <code class="literal">setApproved( false )</code>, declining the loan because the applicant is under age.
							</p><div class="formalpara"><p class="title"><strong>Rule for loan application age limit</strong></p><p>
									
<pre class="screen">rule "Underage"
  salience 15
  when
    $application : LoanApplication()
    Applicant( age &lt; 21 )
  then
    $application.setApproved( false );
    $application.setExplanation( "Underage" );
end</pre>
								</p></div><p class="simpara">
								At a minimum, each DRL file must specify the <code class="literal">package</code>, <code class="literal">import</code>, and <code class="literal">rule</code> components. All other components are optional.
							</p><p class="simpara">
								The following is an example DRL file in a loan application decision service:
							</p><div class="formalpara"><p class="title"><strong>Example DRL file for a loan application</strong></p><p>
									
<pre class="screen">package org.mortgages;

import org.mortgages.LoanApplication;
import org.mortgages.Bankruptcy;
import org.mortgages.Applicant;

rule "Bankruptcy history"
	salience 10
	when
		$a : LoanApplication()
		exists (Bankruptcy( yearOfOccurrence &gt; 1990 || amountOwed &gt; 10000 ))
	then
		$a.setApproved( false );
		$a.setExplanation( "has been bankrupt" );
		delete( $a );
end

rule "Underage"
	salience 15
	when
		$application : LoanApplication()
		Applicant( age &lt; 21 )
	then
		$application.setApproved( false );
		$application.setExplanation( "Underage" );
		delete( $application );
end</pre>
								</p></div><div class="figure" id="idm139921846264256"><p class="title"><strong>Figure 17.1. Example DRL file for a loan application in Business Central</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/drl-rules-sample.png" alt="Example DRL file with required components"/></div></div></div></li></ul></div></li><li class="listitem">
						After you define all components of the rule, click <span class="strong strong"><strong>Validate</strong></span> in the upper-right toolbar of the DRL designer to validate the DRL file. If the file validation fails, address any problems described in the error message, review all syntax and components in the DRL file, and try again to validate the file until the file passes.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Save</strong></span> in the DRL designer to save your work.
					</li></ol></div><section class="section" id="drl-rules-WHEN-proc"><div class="titlepage"><div><div><h2 class="title">17.1. Adding WHEN conditions in DRL rules</h2></div></div></div><p>
					The <code class="literal">when</code> part of the rule contains the conditions that must be met to execute an action. For example, if a bank requires loan applicants to have over 21 years of age, then the <code class="literal">when</code> condition of an <code class="literal">"Underage"</code> rule would be <code class="literal">Applicant( age &lt; 21 )</code>. Conditions consist of a series of stated patterns and constraints, with optional bindings and other supported DRL elements, based on the available data objects in the package.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal">package</code> is defined at the top of the DRL file. This should have been done for you when you created the file.
						</li><li class="listitem">
							The <code class="literal">import</code> list of data objects used in the rule is defined below the <code class="literal">package</code> line of the DRL file. Data objects can be from this package or from another package in Business Central.
						</li><li class="listitem">
							The <code class="literal">rule</code> name is defined in the format <code class="literal">rule "name"</code> below the <code class="literal">package</code>, <code class="literal">import</code>, and other lines that apply to the entire DRL file. The same rule name cannot be used more than once in the same package. Optional rule attributes (such as <code class="literal">salience</code> or <code class="literal">no-loop</code>) that define rule behavior are below the rule name, before the <code class="literal">when</code> section.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							In the DRL designer, enter <code class="literal">when</code> within the rule to begin adding condition statements. The <code class="literal">when</code> section consists of zero or more fact patterns that define conditions for the rule.
						</p><p class="simpara">
							If the <code class="literal">when</code> section is empty, then the conditions are considered to be true and the actions in the <code class="literal">then</code> section are executed the first time a <code class="literal">fireAllRules()</code> call is made in the decision engine. This is useful if you want to use rules to set up the decision engine state.
						</p><div class="formalpara"><p class="title"><strong>Example rule without conditions</strong></p><p>
								
<pre class="screen">rule "Always insert applicant"
  when
    // Empty
  then   // Actions to be executed once
    insert( new Applicant() );
end

// The rule is internally rewritten in the following way:

rule "Always insert applicant"
  when
    eval( true )
  then
    insert( new Applicant() );
end</pre>
							</p></div></li><li class="listitem"><p class="simpara">
							Enter a pattern for the first condition to be met, with optional constraints, bindings, and other supported DRL elements. A basic pattern format is <code class="literal">&lt;patternBinding&gt; : &lt;patternType&gt; ( &lt;constraints&gt; )</code>. Patterns are based on the available data objects in the package and define the conditions to be met in order to trigger actions in the <code class="literal">then</code> section.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>Simple pattern:</strong></span> A simple pattern with no constraints matches against a fact of the given type. For example, the following condition is only that the applicant exists.
								</p><pre class="screen">when
  Applicant()</pre></li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>Pattern with constraints:</strong></span> A pattern with constraints matches against a fact of the given type and the additional restrictions in parentheses that are true or false. For example, the following condition is that the applicant is under the age of 21.
								</p><pre class="screen">when
  Applicant( age &lt; 21 )</pre></li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>Pattern with binding:</strong></span> A binding on a pattern is a shorthand reference that other components of the rule can use to refer back to the defined pattern. For example, the following binding <code class="literal">a</code> on <code class="literal">LoanApplication</code> is used in a related action for underage applicants.
								</p><pre class="screen">when
  $a : LoanApplication()
  Applicant( age &lt; 21 )
then
  $a.setApproved( false );
  $a.setExplanation( "Underage" )</pre></li></ul></div></li><li class="listitem"><p class="simpara">
							Continue defining all condition patterns that apply to this rule. The following are some of the keyword options for defining DRL conditions:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									<code class="literal">and</code>: Use this to group conditional components into a logical conjunction. Infix and prefix <code class="literal">and</code> are supported. By default, all listed patterns are combined with <code class="literal">and</code> when no conjunction is specified.
								</p><pre class="screen">// All of the following examples are interpreted the same way:
$a : LoanApplication() and Applicant( age &lt; 21 )

$a : LoanApplication()
and Applicant( age &lt; 21 )

$a : LoanApplication()
Applicant( age &lt; 21 )

(and $a : LoanApplication() Applicant( age &lt; 21 ))</pre></li><li class="listitem"><p class="simpara">
									<code class="literal">or</code>: Use this to group conditional components into a logical disjunction. Infix and prefix <code class="literal">or</code> are supported.
								</p><pre class="screen">// All of the following examples are interpreted the same way:
Bankruptcy( amountOwed == 100000 ) or IncomeSource( amount == 20000 )

Bankruptcy( amountOwed == 100000 )
or IncomeSource( amount == 20000 )

(or Bankruptcy( amountOwed == 100000 ) IncomeSource( amount == 20000 ))</pre></li><li class="listitem"><p class="simpara">
									<code class="literal">exists</code>: Use this to specify facts and constraints that must exist. This option is triggered on only the first match, not subsequent matches. If you use this element with multiple patterns, enclose the patterns with parentheses <code class="literal">()</code>.
								</p><pre class="screen">exists ( Bankruptcy( yearOfOccurrence &gt; 1990 || amountOwed &gt; 10000 ) )</pre></li><li class="listitem"><p class="simpara">
									<code class="literal">not</code>: Use this to specify facts and constraints that must not exist.
								</p><pre class="screen">not ( Applicant( age &lt; 21 ) )</pre></li><li class="listitem"><p class="simpara">
									<code class="literal">forall</code>: Use this to verify whether all facts that match the first pattern match all the remaining patterns. When a <code class="literal">forall</code> construct is satisfied, the rule evaluates to <code class="literal">true</code>.
								</p><pre class="screen">forall( $app : Applicant( age &lt; 21 )
              Applicant( this == $app, status = 'underage' ) )</pre></li><li class="listitem"><p class="simpara">
									<code class="literal">from</code>: Use this to specify a data source for a pattern.
								</p><pre class="screen">Applicant( ApplicantAddress : address )
Address( zipcode == "23920W" ) from ApplicantAddress</pre></li><li class="listitem"><p class="simpara">
									<code class="literal">entry-point</code>: Use this to define an <code class="literal">Entry Point</code> corresponding to a data source for the pattern. Typically used with <code class="literal">from</code>.
								</p><pre class="screen">Applicant() from entry-point "LoanApplication"</pre></li><li class="listitem"><p class="simpara">
									<code class="literal">collect</code>: Use this to define a collection of objects that the rule can use as part of the condition. In the example, all pending applications in the decision engine for each given mortgage are grouped in a <code class="literal">List</code>. If three or more pending applications are found, the rule is executed.
								</p><pre class="screen">$m : Mortgage()
$a : List( size &gt;= 3 )
    from collect( LoanApplication( Mortgage == $m, status == 'pending' ) )</pre></li><li class="listitem"><p class="simpara">
									<code class="literal">accumulate</code>: Use this to iterate over a collection of objects, execute custom actions for each of the elements, and return one or more result objects (if the constraints evaluate to <code class="literal">true</code>). This option is a more flexible and powerful form of <code class="literal">collect</code>. Use the format <code class="literal">accumulate( &lt;source pattern&gt;; &lt;functions&gt; [;&lt;constraints&gt;] )</code>. In the example, <code class="literal">min</code>, <code class="literal">max</code>, and <code class="literal">average</code> are accumulate functions that calculate the minimum, maximum, and average temperature values over all the readings for each sensor. Other supported functions include <code class="literal">count</code>, <code class="literal">sum</code>, <code class="literal">variance</code>, <code class="literal">standardDeviation</code>, <code class="literal">collectList</code>, and <code class="literal">collectSet</code>.
								</p><pre class="screen">$s : Sensor()
accumulate( Reading( sensor == $s, $temp : temperature );
            $min : min( $temp ),
            $max : max( $temp ),
            $avg : average( $temp );
            $min &lt; 20, $avg &gt; 70 )</pre></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								For more information about DRL rule conditions, see <a class="xref" href="#drl-rules-WHEN-con_drl-rules" title="15.8. Rule conditions in DRL (WHEN)">Section 15.8, “Rule conditions in DRL (WHEN)”</a>.
							</p></div></div></li><li class="listitem">
							After you define all condition components of the rule, click <span class="strong strong"><strong>Validate</strong></span> in the upper-right toolbar of the DRL designer to validate the DRL file. If the file validation fails, address any problems described in the error message, review all syntax and components in the DRL file, and try again to validate the file until the file passes.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Save</strong></span> in the DRL designer to save your work.
						</li></ol></div></section><section class="section" id="drl-rules-THEN-proc"><div class="titlepage"><div><div><h2 class="title">17.2. Adding THEN actions in DRL rules</h2></div></div></div><p>
					The <code class="literal">then</code> part of the rule contains the actions to be performed when the conditional part of the rule has been met. For example, when a loan applicant is under 21 years old, the <code class="literal">then</code> action of an <code class="literal">"Underage"</code> rule would be <code class="literal">setApproved( false )</code>, declining the loan because the applicant is under age. Actions consist of one or more methods that execute consequences based on the rule conditions and on available data objects in the package. The main purpose of rule actions is to to insert, delete, or modify data in the working memory of the decision engine.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal">package</code> is defined at the top of the DRL file. This should have been done for you when you created the file.
						</li><li class="listitem">
							The <code class="literal">import</code> list of data objects used in the rule is defined below the <code class="literal">package</code> line of the DRL file. Data objects can be from this package or from another package in Business Central.
						</li><li class="listitem">
							The <code class="literal">rule</code> name is defined in the format <code class="literal">rule "name"</code> below the <code class="literal">package</code>, <code class="literal">import</code>, and other lines that apply to the entire DRL file. The same rule name cannot be used more than once in the same package. Optional rule attributes (such as <code class="literal">salience</code> or <code class="literal">no-loop</code>) that define rule behavior are below the rule name, before the <code class="literal">when</code> section.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the DRL designer, enter <code class="literal">then</code> after the <code class="literal">when</code> section of the rule to begin adding action statements.
						</li><li class="listitem"><p class="simpara">
							Enter one or more actions to be executed on fact patterns based on the conditions for the rule.
						</p><p class="simpara">
							The following are some of the keyword options for defining DRL actions:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									<code class="literal">set</code>: Use this to set the value of a field.
								</p><pre class="screen">$application.setApproved ( false );
$application.setExplanation( "has been bankrupt" );</pre></li><li class="listitem"><p class="simpara">
									<code class="literal">modify</code>: Use this to specify fields to be modified for a fact and to notify the decision engine of the change. This method provides a structured approach to fact updates. It combines the <code class="literal">update</code> operation with setter calls to change object fields.
								</p><pre class="screen">modify( LoanApplication ) {
        setAmount( 100 ),
        setApproved ( true )
}</pre></li><li class="listitem"><p class="simpara">
									<code class="literal">update</code>: Use this to specify fields and the entire related fact to be updated and to notify the decision engine of the change. After a fact has changed, you must call <code class="literal">update</code> before changing another fact that might be affected by the updated values. To avoid this added step, use the <code class="literal">modify</code> method instead.
								</p><pre class="screen">LoanApplication.setAmount( 100 );
update( LoanApplication );</pre></li><li class="listitem"><p class="simpara">
									<code class="literal">insert</code>: Use this to insert a <code class="literal">new</code> fact into the decision engine.
								</p><pre class="screen">insert( new Applicant() );</pre></li><li class="listitem"><p class="simpara">
									<code class="literal">insertLogical</code>: Use this to insert a <code class="literal">new</code> fact logically into the decision engine. The decision engine is responsible for logical decisions on insertions and retractions of facts. After regular or stated insertions, facts must be retracted explicitly. After logical insertions, the facts that were inserted are automatically retracted when the conditions in the rules that inserted the facts are no longer true.
								</p><pre class="screen">insertLogical( new Applicant() );</pre></li><li class="listitem"><p class="simpara">
									<code class="literal">delete</code>: Use this to remove an object from the decision engine. The keyword <code class="literal">retract</code> is also supported in DRL and executes the same action, but <code class="literal">delete</code> is typically preferred in DRL code for consistency with the keyword <code class="literal">insert</code>.
								</p><pre class="screen">delete( Applicant );</pre></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								For more information about DRL rule actions, see <a class="xref" href="#drl-rules-THEN-con_drl-rules" title="15.9. Rule actions in DRL (THEN)">Section 15.9, “Rule actions in DRL (THEN)”</a>.
							</p></div></div></li><li class="listitem">
							After you define all action components of the rule, click <span class="strong strong"><strong>Validate</strong></span> in the upper-right toolbar of the DRL designer to validate the DRL file. If the file validation fails, address any problems described in the error message, review all syntax and components in the DRL file, and try again to validate the file until the file passes.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Save</strong></span> in the DRL designer to save your work.
						</li></ol></div></section></section><section class="chapter" id="assets-executing-proc_drl-rules"><div class="titlepage"><div><div><h2 class="title">Chapter 18. Executing rules</h2></div></div></div><p>
				After you identify example rules or create your own rules in Business Central, you can build and deploy the associated project and execute rules locally or on KIE Server to test the rules.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Business Central and KIE Server are installed and running. For installation options, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/installing_and_configuring_red_hat_process_automation_manager#assembly-planning"><span class="emphasis"><em>Planning a Red Hat Process Automation Manager installation</em></span></a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
					</li><li class="listitem"><p class="simpara">
						In the upper-right corner of the project <span class="strong strong"><strong>Assets</strong></span> page, click <span class="strong strong"><strong>Deploy</strong></span> to build the project and deploy it to KIE Server. If the build fails, address any problems described in the <span class="strong strong"><strong>Alerts</strong></span> panel at the bottom of the screen.
					</p><p class="simpara">
						For more information about project deployment options, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							If the rule assets in your project are not built from an executable rule model by default, verify that the following dependency is in the <code class="literal">pom.xml</code> file of your project and rebuild the project:
						</p><pre class="programlisting language-xml">&lt;dependency&gt;
  &lt;groupId&gt;org.drools&lt;/groupId&gt;
  &lt;artifactId&gt;drools-model-compiler&lt;/artifactId&gt;
  &lt;version&gt;${rhpam.version}&lt;/version&gt;
&lt;/dependency&gt;</pre><p>
							This dependency is required for rule assets in Red Hat Process Automation Manager to be built from executable rule models by default. This dependency is included as part of the Red Hat Process Automation Manager core packaging, but depending on your Red Hat Process Automation Manager upgrade history, you may need to manually add this dependency to enable the executable rule model behavior.
						</p><p>
							For more information about executable rule models, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#executable-model-con_packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Create a Maven or Java project outside of Business Central, if not created already, that you can use for executing rules locally or that you can use as a client application for executing rules on KIE Server. The project must contain a <code class="literal">pom.xml</code> file and any other required components for executing the project resources.
					</p><p class="simpara">
						For example test projects, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#drl-rules-other-con">"Other methods for creating and executing DRL rules"</a>.
					</p></li><li class="listitem"><p class="simpara">
						Open the <code class="literal">pom.xml</code> file of your test project or client application and add the following dependencies, if not added already:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">kie-ci</code>: Enables your client application to load Business Central project data locally using <code class="literal">ReleaseId</code>
							</li><li class="listitem">
								<code class="literal">kie-server-client</code>: Enables your client application to interact remotely with assets on KIE Server
							</li><li class="listitem">
								<code class="literal">slf4j</code>: (Optional) Enables your client application to use Simple Logging Facade for Java (SLF4J) to return debug logging information after you interact with KIE Server
							</li></ul></div><p class="simpara">
						Example dependencies for Red Hat Process Automation Manager 7.10 in a client application <code class="literal">pom.xml</code> file:
					</p><pre class="programlisting language-xml">&lt;!-- For local execution --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-ci&lt;/artifactId&gt;
  &lt;version&gt;7.48.0.Final-redhat-00002&lt;/version&gt;
&lt;/dependency&gt;

&lt;!-- For remote execution on KIE Server --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie.server&lt;/groupId&gt;
  &lt;artifactId&gt;kie-server-client&lt;/artifactId&gt;
  &lt;version&gt;7.48.0.Final-redhat-00002&lt;/version&gt;
&lt;/dependency&gt;

&lt;!-- For debug logging (optional) --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
  &lt;artifactId&gt;slf4j-simple&lt;/artifactId&gt;
  &lt;version&gt;1.7.25&lt;/version&gt;
&lt;/dependency&gt;</pre><p class="simpara">
						For available versions of these artifacts, search the group ID and artifact ID in the <a class="link" href="https://repository.jboss.org/nexus/index.html#welcome">Nexus Repository Manager</a> online.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Instead of specifying a Red Hat Process Automation Manager <code class="literal">&lt;version&gt;</code> for individual dependencies, consider adding the Red Hat Business Automation bill of materials (BOM) dependency to your project <code class="literal">pom.xml</code> file. The Red Hat Business Automation BOM applies to both Red Hat Decision Manager and Red Hat Process Automation Manager. When you add the BOM files, the correct versions of transitive dependencies from the provided Maven repositories are included in the project.
						</p><p>
							Example BOM dependency:
						</p><pre class="programlisting language-xml">&lt;dependency&gt;
  &lt;groupId&gt;com.redhat.ba&lt;/groupId&gt;
  &lt;artifactId&gt;ba-platform-bom&lt;/artifactId&gt;
  &lt;version&gt;7.10.0.redhat-00002&lt;/version&gt;
  &lt;scope&gt;import&lt;/scope&gt;
  &lt;type&gt;pom&lt;/type&gt;
&lt;/dependency&gt;</pre><p>
							For more information about the Red Hat Business Automation BOM, see <a class="link" href="https://access.redhat.com/solutions/3405361">What is the mapping between Red Hat Process Automation Manager and the Maven library version?</a>.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Ensure that the dependencies for artifacts containing model classes are defined in the client application <code class="literal">pom.xml</code> file exactly as they appear in the <code class="literal">pom.xml</code> file of the deployed project. If dependencies for model classes differ between the client application and your projects, execution errors can occur.
					</p><p class="simpara">
						To access the project <code class="literal">pom.xml</code> file in Business Central, select any existing asset in the project and then in the <span class="strong strong"><strong>Project Explorer</strong></span> menu on the left side of the screen, click the <span class="strong strong"><strong>Customize View</strong></span> gear icon and select <span class="strong strong"><strong>Repository View</strong></span> → <span class="strong strong"><strong>pom.xml</strong></span>.
					</p><p class="simpara">
						For example, the following <code class="literal">Person</code> class dependency appears in both the client and deployed project <code class="literal">pom.xml</code> files:
					</p><pre class="programlisting language-xml">&lt;dependency&gt;
  &lt;groupId&gt;com.sample&lt;/groupId&gt;
  &lt;artifactId&gt;Person&lt;/artifactId&gt;
  &lt;version&gt;1.0.0&lt;/version&gt;
&lt;/dependency&gt;</pre></li><li class="listitem"><p class="simpara">
						If you added the <code class="literal">slf4j</code> dependency to the client application <code class="literal">pom.xml</code> file for debug logging, create a <code class="literal">simplelogger.properties</code> file on the relevant classpath (for example, in <code class="literal">src/main/resources/META-INF</code> in Maven) with the following content:
					</p><pre class="programlisting language-java">org.slf4j.simpleLogger.defaultLogLevel=debug</pre></li><li class="listitem"><p class="simpara">
						In your client application, create a <code class="literal">.java</code> main class containing the necessary imports and a <code class="literal">main()</code> method to load the KIE base, insert facts, and execute the rules.
					</p><p class="simpara">
						For example, a <code class="literal">Person</code> object in a project contains getter and setter methods to set and retrieve the first name, last name, hourly rate, and the wage of a person. The following <code class="literal">Wage</code> rule in a project calculates the wage and hourly rate values and displays a message based on the result:
					</p><pre class="programlisting language-java">package com.sample;

import com.sample.Person;

dialect "java"

rule "Wage"
  when
    Person(hourlyRate * wage &gt; 100)
    Person(name : firstName, surname : lastName)
  then
    System.out.println("Hello" + " " + name + " " + surname + "!");
    System.out.println("You are rich!");
end</pre><p class="simpara">
						To test this rule locally outside of KIE Server (if needed), configure the <code class="literal">.java</code> class to import KIE services, a KIE container, and a KIE session, and then use the <code class="literal">main()</code> method to fire all rules against a defined fact model:
					</p><div class="formalpara"><p class="title"><strong>Executing rules locally</strong></p><p>
							
<pre class="programlisting language-java">import org.kie.api.KieServices;
import org.kie.api.builder.ReleaseId;
import org.kie.api.runtime.KieContainer;
import org.kie.api.runtime.KieSession;
import org.drools.compiler.kproject.ReleaseIdImpl;

public class RulesTest {

  public static final void main(String[] args) {
    try {
      // Identify the project in the local repository:
      ReleaseId rid = new ReleaseIdImpl("com.myspace", "MyProject", "1.0.0");

      // Load the KIE base:
      KieServices ks = KieServices.Factory.get();
      KieContainer kContainer = ks.newKieContainer(rid);
      KieSession kSession = kContainer.newKieSession();

      // Set up the fact model:
      Person p = new Person();
      p.setWage(12);
      p.setFirstName("Tom");
      p.setLastName("Summers");
      p.setHourlyRate(10);

      // Insert the person into the session:
      kSession.insert(p);

      // Fire all rules:
      kSession.fireAllRules();
      kSession.dispose();
    }

    catch (Throwable t) {
      t.printStackTrace();
    }
  }
}</pre>
						</p></div><p class="simpara">
						To test this rule on KIE Server, configure the <code class="literal">.java</code> class with the imports and rule execution information similarly to the local example, and additionally specify KIE services configuration and KIE services client details:
					</p><div class="formalpara"><p class="title"><strong>Executing rules on KIE Server</strong></p><p>
							
<pre class="programlisting language-java">package com.sample;

import java.util.ArrayList;
import java.util.HashSet;
import java.util.List;
import java.util.Set;

import org.kie.api.command.BatchExecutionCommand;
import org.kie.api.command.Command;
import org.kie.api.KieServices;
import org.kie.api.runtime.ExecutionResults;
import org.kie.api.runtime.KieContainer;
import org.kie.api.runtime.KieSession;
import org.kie.server.api.marshalling.MarshallingFormat;
import org.kie.server.api.model.ServiceResponse;
import org.kie.server.client.KieServicesClient;
import org.kie.server.client.KieServicesConfiguration;
import org.kie.server.client.KieServicesFactory;
import org.kie.server.client.RuleServicesClient;

import com.sample.Person;

public class RulesTest {

  private static final String containerName = "testProject";
  private static final String sessionName = "myStatelessSession";

  public static final void main(String[] args) {
    try {
      // Define KIE services configuration and client:
      Set&lt;Class&lt;?&gt;&gt; allClasses = new HashSet&lt;Class&lt;?&gt;&gt;();
      allClasses.add(Person.class);
      String serverUrl = "http://$HOST:$PORT/kie-server/services/rest/server";
      String username = "$USERNAME";
      String password = "$PASSWORD";
      KieServicesConfiguration config =
        KieServicesFactory.newRestConfiguration(serverUrl,
                                                username,
                                                password);
      config.setMarshallingFormat(MarshallingFormat.JAXB);
      config.addExtraClasses(allClasses);
      KieServicesClient kieServicesClient =
        KieServicesFactory.newKieServicesClient(config);

      // Set up the fact model:
      Person p = new Person();
      p.setWage(12);
      p.setFirstName("Tom");
      p.setLastName("Summers");
      p.setHourlyRate(10);

      // Insert Person into the session:
      KieCommands kieCommands = KieServices.Factory.get().getCommands();
      List&lt;Command&gt; commandList = new ArrayList&lt;Command&gt;();
      commandList.add(kieCommands.newInsert(p, "personReturnId"));

      // Fire all rules:
      commandList.add(kieCommands.newFireAllRules("numberOfFiredRules"));
      BatchExecutionCommand batch = kieCommands.newBatchExecution(commandList, sessionName);

      // Use rule services client to send request:
      RuleServicesClient ruleClient = kieServicesClient.getServicesClient(RuleServicesClient.class);
      ServiceResponse&lt;ExecutionResults&gt; executeResponse = ruleClient.executeCommandsWithResults(containerName, batch);
      System.out.println("number of fired rules:" + executeResponse.getResult().getValue("numberOfFiredRules"));
    }

    catch (Throwable t) {
      t.printStackTrace();
    }
  }
}</pre>
						</p></div></li><li class="listitem"><p class="simpara">
						Run the configured <code class="literal">.java</code> class from your project directory. You can run the file in your development platform (such as Red Hat CodeReady Studio) or in the command line.
					</p><p class="simpara">
						Example Maven execution (within project directory):
					</p><pre class="screen">mvn clean install exec:java -Dexec.mainClass="com.sample.app.RulesTest"</pre><p class="simpara">
						Example Java execution (within project directory)
					</p><pre class="screen">javac -classpath "./$DEPENDENCIES/*:." RulesTest.java
java -classpath "./$DEPENDENCIES/*:." RulesTest</pre></li><li class="listitem">
						Review the rule execution status in the command line and in the server log. If any rules do not execute as expected, review the configured rules in the project and the main class configuration to validate the data provided.
					</li></ol></div></section><section class="chapter" id="drl-rules-other-con"><div class="titlepage"><div><div><h2 class="title">Chapter 19. Other methods for creating and executing DRL rules</h2></div></div></div><p>
				As an alternative to creating and managing DRL rules within the Business Central interface, you can create DRL rule files externally as part of a Maven or Java project using Red Hat CodeReady Studio or another integrated development environment (IDE). These standalone projects can then be integrated as knowledge JAR (KJAR) dependencies in existing Red Hat Process Automation Manager projects in Business Central. The DRL files in your standalone project must contain at a minimum the required <code class="literal">package</code> specification, <code class="literal">import</code> lists, and <code class="literal">rule</code> definitions. Any other DRL components, such as global variables and functions, are optional. All data objects related to a DRL rule must be included with your standalone DRL project or deployment.
			</p><p>
				You can also use executable rule models in your Maven or Java projects to provide a Java-based representation of a rule set for execution at build time. The executable model is a more efficient alternative to the standard asset packaging in Red Hat Process Automation Manager and enables KIE containers and KIE bases to be created more quickly, especially when you have large lists of DRL (Drools Rule Language) files and other Red Hat Process Automation Manager assets.
			</p><section class="section" id="drl-rules-codeready-studio-create-proc_drl-rules"><div class="titlepage"><div><div><h2 class="title">19.1. Creating and executing DRL rules in Red Hat CodeReady Studio</h2></div></div></div><p>
					You can use Red Hat CodeReady Studio to create DRL files with rules and integrate the files with your Red Hat Process Automation Manager decision service. This method of creating DRL rules is helpful if you already use Red Hat CodeReady Studio for your decision service and want to continue with the same workflow. If you do not already use this method, then the Business Central interface of Red Hat Process Automation Manager is recommended for creating DRL files and other rule assets.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Red Hat CodeReady Studio has been installed from the <a class="link" href="https://access.redhat.com/downloads/">Red Hat Customer Portal</a>.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the Red Hat CodeReady Studio, click <span class="strong strong"><strong>File</strong></span> → <span class="strong strong"><strong>New</strong></span> → <span class="strong strong"><strong>Project</strong></span>.
						</li><li class="listitem">
							In the <span class="strong strong"><strong>New Project</strong></span> window that opens, select <span class="strong strong"><strong>Drools</strong></span> → <span class="strong strong"><strong>Drools Project</strong></span> and click <span class="strong strong"><strong>Next</strong></span>.
						</li><li class="listitem">
							Click the second icon to <span class="strong strong"><strong>Create a project and populate it with some example files to help you get started quickly</strong></span>. Click <span class="strong strong"><strong>Next</strong></span>.
						</li><li class="listitem"><p class="simpara">
							Enter a <span class="strong strong"><strong>Project name</strong></span> and select the <span class="strong strong"><strong>Maven</strong></span> radio button as the project building option. The GAV values are generated automatically. You can update these values as needed for your project:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="strong strong"><strong>Group ID:</strong></span> <code class="literal">com.sample</code>
								</li><li class="listitem">
									<span class="strong strong"><strong>Artifact ID:</strong></span> <code class="literal">my-project</code>
								</li><li class="listitem">
									<span class="strong strong"><strong>Version:</strong></span> <code class="literal">1.0.0-SNAPSHOT</code>
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Finish</strong></span> to create the project.
						</p><p class="simpara">
							This configuration sets up a basic project structure, class path, and sample rules. The following is an overview of the project structure:
						</p><pre class="screen">my-project
 `-- src/main/java
    | `-- com.sample
    |    `-- DecisionTableTest.java
    |    `-- DroolsTest.java
    |    `-- ProcessTest.java
    |
 `-- src/main/resources
    | `-- dtables
    |    `-- Sample.xls
    | `-- process
    |    `-- sample.bpmn
    | `-- rules
    |    `-- Sample.drl
    | `-- META-INF
    |
 `-- JRE System Library
    |
 `-- Maven Dependencies
    |
 `-- Drools Library
    |
 `-- src
    |
 `-- target
    |
 `-- pom.xml</pre><p class="simpara">
							Notice the following elements:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									A <code class="literal">Sample.drl</code> rule file in the <code class="literal">src/main/resources</code> directory, containing an example <code class="literal">Hello World</code> and <code class="literal">GoodBye</code> rules.
								</li><li class="listitem">
									A <code class="literal">DroolsTest.java</code> file under the <code class="literal">src/main/java</code> directory in the <code class="literal">com.sample</code> package. The <code class="literal">DroolsTest</code> class can be used to execute the <code class="literal">Sample.drl</code> rule.
								</li><li class="listitem">
									The <code class="literal">Drools Library</code> directory, which acts as a custom class path containing JAR files necessary for execution.
								</li></ul></div><p class="simpara">
							You can edit the existing <code class="literal">Sample.drl</code> file and <code class="literal">DroolsTest.java</code> files with new configurations as needed, or create new rule and object files. In this procedure, you are creating a new rule and new Java objects.
						</p></li><li class="listitem"><p class="simpara">
							Create a Java object on which the rule or rules will operate.
						</p><p class="simpara">
							In this example, a <code class="literal">Person.java</code> file is created in <code class="literal">my-project/src/main/java/com.sample</code>. The <code class="literal">Person</code> class contains getter and setter methods to set and retrieve the first name, last name, hourly rate, and the wage of a person:
						</p><pre class="programlisting language-java">  public class Person {
    private String firstName;
    private String lastName;
    private Integer hourlyRate;
    private Integer wage;

    public String getFirstName() {
      return firstName;
    }

    public void setFirstName(String firstName) {
      this.firstName = firstName;
    }

    public String getLastName() {
      return lastName;
    }

    public void setLastName(String lastName) {
      this.lastName = lastName;
    }

    public Integer getHourlyRate() {
      return hourlyRate;
    }

    public void setHourlyRate(Integer hourlyRate) {
      this.hourlyRate = hourlyRate;
    }

    public Integer getWage(){
      return wage;
    }

    public void setWage(Integer wage){
      this.wage = wage;
    }
  }</pre></li><li class="listitem">
							Click <span class="strong strong"><strong>File</strong></span> → <span class="strong strong"><strong>Save</strong></span> to save the file.
						</li><li class="listitem"><p class="simpara">
							Create a rule file in <code class="literal">.drl</code> format in <code class="literal">my-project/src/main/resources/rules</code>. The DRL file must contain at a minimum a package specification, an import list of data objects to be used by the rule or rules, and one or more rules with <code class="literal">when</code> conditions and <code class="literal">then</code> actions.
						</p><p class="simpara">
							The following <code class="literal">Wage.drl</code> file contains a <code class="literal">Wage</code> rule that imports the <code class="literal">Person</code> class, calculates the wage and hourly rate values, and displays a message based on the result:
						</p><pre class="programlisting language-java">package com.sample;

import com.sample.Person;

dialect "java"

rule "Wage"
  when
    Person(hourlyRate * wage &gt; 100)
    Person(name : firstName, surname : lastName)
  then
    System.out.println("Hello" + " " + name + " " + surname + "!");
    System.out.println("You are rich!");
end</pre></li><li class="listitem">
							Click <span class="strong strong"><strong>File</strong></span> → <span class="strong strong"><strong>Save</strong></span> to save the file.
						</li><li class="listitem"><p class="simpara">
							Create a main class and save it to the same directory as the Java object that you created. The main class will load the KIE base and execute rules.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								You can also add the <code class="literal">main()</code> method and <code class="literal">Person</code> class within a single Java object file, similar to the <code class="literal">DroolsTest.java</code> sample file.
							</p></div></div></li><li class="listitem"><p class="simpara">
							In the main class, add the required <code class="literal">import</code> statements to import KIE services, a KIE container, and a KIE session. Then load the KIE base, insert facts, and execute the rule from the <code class="literal">main()</code> method that passes the fact model to the rule.
						</p><p class="simpara">
							In this example, a <code class="literal">RulesTest.java</code> file is created in <code class="literal">my-project/src/main/java/com.sample</code> with the required imports and <code class="literal">main()</code> method:
						</p><pre class="programlisting language-java">package com.sample;

import org.kie.api.KieServices;
import org.kie.api.runtime.KieContainer;
import org.kie.api.runtime.KieSession;

public class RulesTest {
  public static final void main(String[] args) {
    try {
      // Load the KIE base:
      KieServices ks = KieServices.Factory.get();
      KieContainer kContainer = ks.getKieClasspathContainer();
      KieSession kSession = kContainer.newKieSession();

      // Set up the fact model:
      Person p = new Person();
      p.setWage(12);
      p.setFirstName("Tom");
      p.setLastName("Summers");
      p.setHourlyRate(10);

      // Insert the person into the session:
      kSession.insert(p);

      // Fire all rules:
      kSession.fireAllRules();
      kSession.dispose();
    }

    catch (Throwable t) {
      t.printStackTrace();
    }
  }
}</pre></li><li class="listitem">
							Click <span class="strong strong"><strong>File</strong></span> → <span class="strong strong"><strong>Save</strong></span> to save the file.
						</li><li class="listitem">
							After you create and save all DRL assets in your project, right-click your project folder and select <span class="strong strong"><strong>Run As</strong></span> → <span class="strong strong"><strong>Java Application</strong></span> to build the project. If the project build fails, address any problems described in the <span class="strong strong"><strong>Problems</strong></span> tab of the lower window in CodeReady Studio, and try again to validate the project until the project builds.
						</li></ol></div><div class="admonition note"><div class="admonition_header">If the <span class="strong strong"><strong>Run As</strong></span> → <span class="strong strong"><strong>Java Application</strong></span> option is not available</div><div><p>
						If <span class="strong strong"><strong>Java Application</strong></span> is not an option when you right-click your project and select <span class="strong strong"><strong>Run As</strong></span>, then go to <span class="strong strong"><strong>Run As</strong></span> → <span class="strong strong"><strong>Run Configurations</strong></span>, right-click <span class="strong strong"><strong>Java Application</strong></span>, and click <span class="strong strong"><strong>New</strong></span>. Then in the <span class="strong strong"><strong>Main</strong></span> tab, browse for and select your <span class="strong strong"><strong>Project</strong></span> and the associated <span class="strong strong"><strong>Main class</strong></span>. Click <span class="strong strong"><strong>Apply</strong></span> and then click <span class="strong strong"><strong>Run</strong></span> to test the project. The next time you right-click your project folder, the <span class="strong strong"><strong>Java Application</strong></span> option will appear.
					</p></div></div><p>
					To integrate the new rule assets with an existing project in Red Hat Process Automation Manager, you can compile the new project as a knowledge JAR (KJAR) and add it as a dependency in the <code class="literal">pom.xml</code> file of the project in Business Central. To access the project <code class="literal">pom.xml</code> file in Business Central, you can select any existing asset in the project and then in the <span class="strong strong"><strong>Project Explorer</strong></span> menu on the left side of the screen, click the <span class="strong strong"><strong>Customize View</strong></span> gear icon and select <span class="strong strong"><strong>Repository View</strong></span> → <span class="strong strong"><strong>pom.xml</strong></span>.
				</p></section><section class="section" id="drl-rules-java-create-proc_drl-rules"><div class="titlepage"><div><div><h2 class="title">19.2. Creating and executing DRL rules using Java</h2></div></div></div><p>
					You can use Java objects to create DRL files with rules and integrate the objects with your Red Hat Process Automation Manager decision service. This method of creating DRL rules is helpful if you already use external Java objects for your decision service and want to continue with the same workflow. If you do not already use this method, then the Business Central interface of Red Hat Process Automation Manager is recommended for creating DRL files and other rule assets.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a Java object on which the rule or rules will operate.
						</p><p class="simpara">
							In this example, a <code class="literal">Person.java</code> file is created in a directory <code class="literal">my-project</code>. The <code class="literal">Person</code> class contains getter and setter methods to set and retrieve the first name, last name, hourly rate, and the wage of a person:
						</p><pre class="programlisting language-java">  public class Person {
    private String firstName;
    private String lastName;
    private Integer hourlyRate;
    private Integer wage;

    public String getFirstName() {
      return firstName;
    }

    public void setFirstName(String firstName) {
      this.firstName = firstName;
    }

    public String getLastName() {
      return lastName;
    }

    public void setLastName(String lastName) {
      this.lastName = lastName;
    }

    public Integer getHourlyRate() {
      return hourlyRate;
    }

    public void setHourlyRate(Integer hourlyRate) {
      this.hourlyRate = hourlyRate;
    }

    public Integer getWage(){
      return wage;
    }

    public void setWage(Integer wage){
      this.wage = wage;
    }
  }</pre></li><li class="listitem"><p class="simpara">
							Create a rule file in <code class="literal">.drl</code> format under the <code class="literal">my-project</code> directory. The DRL file must contain at a minimum a package specification (if applicable), an import list of data objects to be used by the rule or rules, and one or more rules with <code class="literal">when</code> conditions and <code class="literal">then</code> actions.
						</p><p class="simpara">
							The following <code class="literal">Wage.drl</code> file contains a <code class="literal">Wage</code> rule that calculates the wage and hourly rate values and displays a message based on the result:
						</p><pre class="programlisting language-java">package com.sample;

import com.sample.Person;

dialect "java"

rule "Wage"
  when
    Person(hourlyRate * wage &gt; 100)
    Person(name : firstName, surname : lastName)
  then
    System.out.println("Hello" + " " + name + " " + surname + "!");
    System.out.println("You are rich!");
end</pre></li><li class="listitem">
							Create a main class and save it to the same directory as the Java object that you created. The main class will load the KIE base and execute rules.
						</li><li class="listitem"><p class="simpara">
							In the main class, add the required <code class="literal">import</code> statements to import KIE services, a KIE container, and a KIE session. Then load the KIE base, insert facts, and execute the rule from the <code class="literal">main()</code> method that passes the fact model to the rule.
						</p><p class="simpara">
							In this example, a <code class="literal">RulesTest.java</code> file is created in <code class="literal">my-project</code> with the required imports and <code class="literal">main()</code> method:
						</p><pre class="programlisting language-java">import org.kie.api.KieServices;
import org.kie.api.runtime.KieContainer;
import org.kie.api.runtime.KieSession;

public class RulesTest {
  public static final void main(String[] args) {
    try {
      // Load the KIE base:
      KieServices ks = KieServices.Factory.get();
      KieContainer kContainer = ks.getKieClasspathContainer();
      KieSession kSession = kContainer.newKieSession();

      // Set up the fact model:
      Person p = new Person();
      p.setWage(12);
      p.setFirstName("Tom");
      p.setLastName("Summers");
      p.setHourlyRate(10);

      // Insert the person into the session:
      kSession.insert(p);

      // Fire all rules:
      kSession.fireAllRules();
      kSession.dispose();
    }

    catch (Throwable t) {
      t.printStackTrace();
    }
  }
}</pre></li><li class="listitem">
							Download the <span class="strong strong"><strong>Red Hat Process Automation Manager 7.10.0 Source Distribution</strong></span> ZIP file from the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Red Hat Customer Portal</a> and extract it under <code class="literal">my-project/pam-engine-jars/</code>.
						</li><li class="listitem"><p class="simpara">
							In the <code class="literal">my-project/META-INF</code> directory, create a <code class="literal">kmodule.xml</code> metadata file with the following content:
						</p><pre class="programlisting language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;kmodule xmlns="http://www.drools.org/xsd/kmodule"&gt;
&lt;/kmodule&gt;</pre><p class="simpara">
							This <code class="literal">kmodule.xml</code> file is a KIE module descriptor that selects resources to KIE bases and configures sessions. This file enables you to define and configure one or more KIE bases, and to include DRL files from specific <code class="literal">packages</code> in a specific KIE base. You can also create one or more KIE sessions from each KIE base.
						</p><p class="simpara">
							The following example shows a more advanced <code class="literal">kmodule.xml</code> file:
						</p><pre class="programlisting language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;kmodule xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.drools.org/xsd/kmodule"&gt;
  &lt;kbase name="KBase1" default="true" eventProcessingMode="cloud" equalsBehavior="equality" declarativeAgenda="enabled" packages="org.domain.pkg1"&gt;
    &lt;ksession name="KSession1_1" type="stateful" default="true" /&gt;
    &lt;ksession name="KSession1_2" type="stateful" default="true" beliefSystem="jtms" /&gt;
  &lt;/kbase&gt;
  &lt;kbase name="KBase2" default="false" eventProcessingMode="stream" equalsBehavior="equality" declarativeAgenda="enabled" packages="org.domain.pkg2, org.domain.pkg3" includes="KBase1"&gt;
    &lt;ksession name="KSession2_1" type="stateless" default="true" clockType="realtime"&gt;
      &lt;fileLogger file="debugInfo" threaded="true" interval="10" /&gt;
      &lt;workItemHandlers&gt;
        &lt;workItemHandler name="name" type="new org.domain.WorkItemHandler()" /&gt;
      &lt;/workItemHandlers&gt;
      &lt;listeners&gt;
        &lt;ruleRuntimeEventListener type="org.domain.RuleRuntimeListener" /&gt;
        &lt;agendaEventListener type="org.domain.FirstAgendaListener" /&gt;
        &lt;agendaEventListener type="org.domain.SecondAgendaListener" /&gt;
        &lt;processEventListener type="org.domain.ProcessListener" /&gt;
      &lt;/listeners&gt;
    &lt;/ksession&gt;
  &lt;/kbase&gt;
&lt;/kmodule&gt;</pre><p class="simpara">
							This example defines two KIE bases. Two KIE sessions are instantiated from the <code class="literal">KBase1</code> KIE base, and one KIE session from <code class="literal">KBase2</code>. The KIE session from <code class="literal">KBase2</code> is a <code class="literal">stateless</code> KIE session, which means that data from a previous invocation of the KIE session (the previous session state) is discarded between session invocations. Specific <code class="literal">packages</code> of rule assets are included with both KIE bases. When you specify packages in this way, you must organize your DRL files in a folder structure that reflects the specified packages.
						</p></li><li class="listitem"><p class="simpara">
							After you create and save all DRL assets in your Java object, navigate to the <code class="literal">my-project</code> directory in the command line and run the following command to build your Java files. Replace <code class="literal">RulesTest.java</code> with the name of your Java main class.
						</p><pre class="screen">javac -classpath "./pam-engine-jars/*:." RulesTest.java</pre><p class="simpara">
							If the build fails, address any problems described in the command line error messages and try again to validate the Java object until the object passes.
						</p></li><li class="listitem"><p class="simpara">
							After your Java files build successfully, run the following command to execute the rules locally. Replace <code class="literal">RulesTest</code> with the prefix of your Java main class.
						</p><pre class="screen">java -classpath "./pam-engine-jars/*:." RulesTest</pre></li><li class="listitem">
							Review the rules to ensure that they executed properly, and address any needed changes in the Java files.
						</li></ol></div><p>
					To integrate the new rule assets with an existing project in Red Hat Process Automation Manager, you can compile the new Java project as a knowledge JAR (KJAR) and add it as a dependency in the <code class="literal">pom.xml</code> file of the project in Business Central. To access the project <code class="literal">pom.xml</code> file in Business Central, you can select any existing asset in the project and then in the <span class="strong strong"><strong>Project Explorer</strong></span> menu on the left side of the screen, click the <span class="strong strong"><strong>Customize View</strong></span> gear icon and select <span class="strong strong"><strong>Repository View</strong></span> → <span class="strong strong"><strong>pom.xml</strong></span>.
				</p></section><section class="section" id="drl-rules-maven-create-proc_drl-rules"><div class="titlepage"><div><div><h2 class="title">19.3. Creating and executing DRL rules using Maven</h2></div></div></div><p>
					You can use Maven archetypes to create DRL files with rules and integrate the archetypes with your Red Hat Process Automation Manager decision service. This method of creating DRL rules is helpful if you already use external Maven archetypes for your decision service and want to continue with the same workflow. If you do not already use this method, then the Business Central interface of Red Hat Process Automation Manager is recommended for creating DRL files and other rule assets.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Navigate to a directory where you want to create a Maven archetype and run the following command:
						</p><pre class="screen">mvn archetype:generate -DgroupId=com.sample.app -DartifactId=my-app -DarchetypeArtifactId=maven-archetype-quickstart -DinteractiveMode=false</pre><p class="simpara">
							This creates a directory <code class="literal">my-app</code> with the following structure:
						</p><pre class="screen">my-app
|-- pom.xml
`-- src
    |-- main
    |   `-- java
    |       `-- com
    |           `-- sample
    |               `-- app
    |                   `-- App.java
    `-- test
        `-- java
            `-- com
                `-- sample
                    `-- app
                        `-- AppTest.java</pre><p class="simpara">
							The <code class="literal">my-app</code> directory contains the following key components:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									A <code class="literal">src/main</code> directory for storing the application sources
								</li><li class="listitem">
									A <code class="literal">src/test</code> directory for storing the test sources
								</li><li class="listitem">
									A <code class="literal">pom.xml</code> file with the project configuration
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Create a Java object on which the rule or rules will operate within the Maven archetype.
						</p><p class="simpara">
							In this example, a <code class="literal">Person.java</code> file is created in the directory <code class="literal">my-app/src/main/java/com/sample/app</code>. The <code class="literal">Person</code> class contains getter and setter methods to set and retrieve the first name, last name, hourly rate, and the wage of a person:
						</p><pre class="programlisting language-java">package com.sample.app;

  public class Person {

    private String firstName;
    private String lastName;
    private Integer hourlyRate;
    private Integer wage;

    public String getFirstName() {
      return firstName;
    }

    public void setFirstName(String firstName) {
      this.firstName = firstName;
    }

    public String getLastName() {
      return lastName;
    }

    public void setLastName(String lastName) {
      this.lastName = lastName;
    }

    public Integer getHourlyRate() {
      return hourlyRate;
    }

    public void setHourlyRate(Integer hourlyRate) {
      this.hourlyRate = hourlyRate;
    }

    public Integer getWage(){
      return wage;
    }

    public void setWage(Integer wage){
      this.wage = wage;
    }
  }</pre></li><li class="listitem"><p class="simpara">
							Create a rule file in <code class="literal">.drl</code> format in <code class="literal">my-app/src/main/resources/rules</code>. The DRL file must contain at a minimum a package specification, an import list of data objects to be used by the rule or rules, and one or more rules with <code class="literal">when</code> conditions and <code class="literal">then</code> actions.
						</p><p class="simpara">
							The following <code class="literal">Wage.drl</code> file contains a <code class="literal">Wage</code> rule that imports the <code class="literal">Person</code> class, calculates the wage and hourly rate values, and displays a message based on the result:
						</p><pre class="programlisting language-java">package com.sample.app;

import com.sample.app.Person;

dialect "java"

rule "Wage"
  when
    Person(hourlyRate * wage &gt; 100)
    Person(name : firstName, surname : lastName)
  then
    System.out.println("Hello " + name + " " + surname + "!");
    System.out.println("You are rich!");
end</pre></li><li class="listitem"><p class="simpara">
							In the <code class="literal">my-app/src/main/resources/META-INF</code> directory, create a <code class="literal">kmodule.xml</code> metadata file with the following content:
						</p><pre class="programlisting language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;kmodule xmlns="http://www.drools.org/xsd/kmodule"&gt;
&lt;/kmodule&gt;</pre><p class="simpara">
							This <code class="literal">kmodule.xml</code> file is a KIE module descriptor that selects resources to KIE bases and configures sessions. This file enables you to define and configure one or more KIE bases, and to include DRL files from specific <code class="literal">packages</code> in a specific KIE base. You can also create one or more KIE sessions from each KIE base.
						</p><p class="simpara">
							The following example shows a more advanced <code class="literal">kmodule.xml</code> file:
						</p><pre class="programlisting language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;kmodule xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.drools.org/xsd/kmodule"&gt;
  &lt;kbase name="KBase1" default="true" eventProcessingMode="cloud" equalsBehavior="equality" declarativeAgenda="enabled" packages="org.domain.pkg1"&gt;
    &lt;ksession name="KSession1_1" type="stateful" default="true" /&gt;
    &lt;ksession name="KSession1_2" type="stateful" default="true" beliefSystem="jtms" /&gt;
  &lt;/kbase&gt;
  &lt;kbase name="KBase2" default="false" eventProcessingMode="stream" equalsBehavior="equality" declarativeAgenda="enabled" packages="org.domain.pkg2, org.domain.pkg3" includes="KBase1"&gt;
    &lt;ksession name="KSession2_1" type="stateless" default="true" clockType="realtime"&gt;
      &lt;fileLogger file="debugInfo" threaded="true" interval="10" /&gt;
      &lt;workItemHandlers&gt;
        &lt;workItemHandler name="name" type="new org.domain.WorkItemHandler()" /&gt;
      &lt;/workItemHandlers&gt;
      &lt;listeners&gt;
        &lt;ruleRuntimeEventListener type="org.domain.RuleRuntimeListener" /&gt;
        &lt;agendaEventListener type="org.domain.FirstAgendaListener" /&gt;
        &lt;agendaEventListener type="org.domain.SecondAgendaListener" /&gt;
        &lt;processEventListener type="org.domain.ProcessListener" /&gt;
      &lt;/listeners&gt;
    &lt;/ksession&gt;
  &lt;/kbase&gt;
&lt;/kmodule&gt;</pre><p class="simpara">
							This example defines two KIE bases. Two KIE sessions are instantiated from the <code class="literal">KBase1</code> KIE base, and one KIE session from <code class="literal">KBase2</code>. The KIE session from <code class="literal">KBase2</code> is a <code class="literal">stateless</code> KIE session, which means that data from a previous invocation of the KIE session (the previous session state) is discarded between session invocations. Specific <code class="literal">packages</code> of rule assets are included with both KIE bases. When you specify packages in this way, you must organize your DRL files in a folder structure that reflects the specified packages.
						</p></li><li class="listitem"><p class="simpara">
							In the <code class="literal">my-app/pom.xml</code> configuration file, specify the libraries that your application requires. Provide the Red Hat Process Automation Manager dependencies as well as the <code class="literal">group ID</code>, <code class="literal">artifact ID</code>, and <code class="literal">version</code> (GAV) of your application.
						</p><pre class="programlisting language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
&lt;groupId&gt;com.sample.app&lt;/groupId&gt;
&lt;artifactId&gt;my-app&lt;/artifactId&gt;
&lt;version&gt;1.0.0&lt;/version&gt;
&lt;repositories&gt;
  &lt;repository&gt;
    &lt;id&gt;jboss-ga-repository&lt;/id&gt;
    &lt;url&gt;http://maven.repository.redhat.com/ga/&lt;/url&gt;
  &lt;/repository&gt;
&lt;/repositories&gt;
&lt;dependencies&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.drools&lt;/groupId&gt;
    &lt;artifactId&gt;drools-compiler&lt;/artifactId&gt;
    &lt;version&gt;VERSION&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.kie&lt;/groupId&gt;
    &lt;artifactId&gt;kie-api&lt;/artifactId&gt;
    &lt;version&gt;VERSION&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;junit&lt;/groupId&gt;
    &lt;artifactId&gt;junit&lt;/artifactId&gt;
    &lt;version&gt;4.11&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
  &lt;/dependency&gt;
&lt;/dependencies&gt;
&lt;/project&gt;</pre><p class="simpara">
							For information about Maven dependencies and the BOM (Bill of Materials) in Red Hat Process Automation Manager, see <a class="link" href="https://access.redhat.com/solutions/3405361">What is the mapping between Red Hat Process Automation Manager and Maven library version?</a>.
						</p></li><li class="listitem">
							Use the <code class="literal">testApp</code> method in <code class="literal">my-app/src/test/java/com/sample/app/AppTest.java</code> to test the rule. The <code class="literal">AppTest.java</code> file is created by Maven by default.
						</li><li class="listitem"><p class="simpara">
							In the <code class="literal">AppTest.java</code> file, add the required <code class="literal">import</code> statements to import KIE services, a KIE container, and a KIE session. Then load the KIE base, insert facts, and execute the rule from the <code class="literal">testApp()</code> method that passes the fact model to the rule.
						</p><pre class="programlisting language-java">import org.kie.api.KieServices;
import org.kie.api.runtime.KieContainer;
import org.kie.api.runtime.KieSession;

public void testApp() {

  // Load the KIE base:
  KieServices ks = KieServices.Factory.get();
  KieContainer kContainer = ks.getKieClasspathContainer();
  KieSession kSession = kContainer.newKieSession();

  // Set up the fact model:
  Person p = new Person();
  p.setWage(12);
  p.setFirstName("Tom");
  p.setLastName("Summers");
  p.setHourlyRate(10);

  // Insert the person into the session:
  kSession.insert(p);

  // Fire all rules:
  kSession.fireAllRules();
  kSession.dispose();
}</pre></li><li class="listitem"><p class="simpara">
							After you create and save all DRL assets in your Maven archetype, navigate to the <code class="literal">my-app</code> directory in the command line and run the following command to build your files:
						</p><pre class="screen">mvn clean install</pre><p class="simpara">
							If the build fails, address any problems described in the command line error messages and try again to validate the files until the build is successful.
						</p></li><li class="listitem"><p class="simpara">
							After your files build successfully, run the following command to execute the rules locally. Replace <code class="literal">com.sample.app</code> with your package name.
						</p><pre class="screen">mvn exec:java -Dexec.mainClass="com.sample.app"</pre></li><li class="listitem">
							Review the rules to ensure that they executed properly, and address any needed changes in the files.
						</li></ol></div><p>
					To integrate the new rule assets with an existing project in Red Hat Process Automation Manager, you can compile the new Maven project as a knowledge JAR (KJAR) and add it as a dependency in the <code class="literal">pom.xml</code> file of the project in Business Central. To access the project <code class="literal">pom.xml</code> file in Business Central, you can select any existing asset in the project and then in the <span class="strong strong"><strong>Project Explorer</strong></span> menu on the left side of the screen, click the <span class="strong strong"><strong>Customize View</strong></span> gear icon and select <span class="strong strong"><strong>Repository View</strong></span> → <span class="strong strong"><strong>pom.xml</strong></span>.
				</p></section></section><section class="chapter" id="decision-examples-IDE-con_drl-rules"><div class="titlepage"><div><div><h2 class="title">Chapter 20. Example decisions in Red Hat Process Automation Manager for an IDE</h2></div></div></div><p>
				Red Hat Process Automation Manager provides example decisions distributed as Java classes that you can import into your integrated development environment (IDE). You can use these examples to better understand decision engine capabilities or use them as a reference for the decisions that you define in your own Red Hat Process Automation Manager projects.
			</p><p>
				The following example decision sets are some of the examples available in Red Hat Process Automation Manager:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="strong strong"><strong>Hello World example</strong></span>: Demonstrates basic rule execution and use of debug output
					</li><li class="listitem">
						<span class="strong strong"><strong>State example</strong></span>: Demonstrates forward chaining and conflict resolution through rule salience and agenda groups
					</li><li class="listitem">
						<span class="strong strong"><strong>Fibonacci example</strong></span>: Demonstrates recursion and conflict resolution through rule salience
					</li><li class="listitem">
						<span class="strong strong"><strong>Banking example</strong></span>: Demonstrates pattern matching, basic sorting, and calculation
					</li><li class="listitem">
						<span class="strong strong"><strong>Pet Store example</strong></span>: Demonstrates rule agenda groups, global variables, callbacks, and GUI integration
					</li><li class="listitem">
						<span class="strong strong"><strong>Sudoku example</strong></span>: Demonstrates complex pattern matching, problem solving, callbacks, and GUI integration
					</li><li class="listitem">
						<span class="strong strong"><strong>House of Doom example</strong></span>: Demonstrates backward chaining and recursion
					</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					For optimization examples provided with Red Hat Business Optimizer, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/getting_started_with_red_hat_process_automation_manager#examples-con"><span class="emphasis"><em>Getting started with Red Hat Business Optimizer</em></span></a>.
				</p></div></div><section class="section" id="decision-examples-IDE-proc_drl-rules"><div class="titlepage"><div><div><h2 class="title">20.1. Importing and executing Red Hat Process Automation Manager example decisions in an IDE</h2></div></div></div><p>
					You can import Red Hat Process Automation Manager example decisions into your integrated development environment (IDE) and execute them to explore how the rules and code function. You can use these examples to better understand decision engine capabilities or use them as a reference for the decisions that you define in your own Red Hat Process Automation Manager projects.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Java 8 or later is installed.
						</li><li class="listitem">
							Maven 3.5.x or later is installed.
						</li><li class="listitem">
							An IDE is installed, such as Red Hat CodeReady Studio.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Download and unzip the <span class="strong strong"><strong>Red Hat Process Automation Manager 7.10.0 Source Distribution</strong></span> from the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Red Hat Customer Portal</a> to a temporary directory, such as <code class="literal">/rhpam-7.10.0-sources</code>.
						</li><li class="listitem">
							Open your IDE and select <span class="strong strong"><strong>File</strong></span> → <span class="strong strong"><strong>Import</strong></span> → <span class="strong strong"><strong>Maven</strong></span> → <span class="strong strong"><strong>Existing Maven Projects</strong></span>, or the equivalent option for importing a Maven project.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Browse</strong></span>, navigate to <code class="literal">~/rhpam-7.10.0-sources/src/drools-$VERSION/drools-examples</code> (or, for the Conway’s Game of Life example, <code class="literal">~/rhpam-7.10.0-sources/src/droolsjbpm-integration-$VERSION/droolsjbpm-integration-examples</code>), and import the project.
						</li><li class="listitem">
							Navigate to the example package that you want to run and find the Java class with the <code class="literal">main</code> method.
						</li><li class="listitem"><p class="simpara">
							Right-click the Java class and select <span class="strong strong"><strong>Run As</strong></span> → <span class="strong strong"><strong>Java Application</strong></span> to run the example.
						</p><p class="simpara">
							To run all examples through a basic user interface, run the <code class="literal">DroolsExamplesApp.java</code> class (or, for Conway’s Game of Life, the <code class="literal">DroolsJbpmIntegrationExamplesApp.java</code> class) in the <code class="literal">org.drools.examples</code> main class.
						</p><div class="figure" id="idm139921813420848"><p class="title"><strong>Figure 20.1. Interface for all examples in drools-examples (DroolsExamplesApp.java)</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/All/drools-examples-run-all.png" alt="drools examples run all"/></div></div></div><div class="figure" id="idm139921813416656"><p class="title"><strong>Figure 20.2. Interface for all examples in droolsjbpm-integration-examples (DroolsJbpmIntegrationExamplesApp.java)</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/All/droolsjbpm-examples-run-all.png" alt="droolsjbpm examples run all"/></div></div></div></li></ol></div></section><section class="section" id="decision-examples-helloworld-ref_drl-rules"><div class="titlepage"><div><div><h2 class="title">20.2. Hello World example decisions (basic rules and debugging)</h2></div></div></div><p>
					The Hello World example decision set demonstrates how to insert objects into the decision engine working memory, how to match the objects using rules, and how to configure logging to trace the internal activity of the decision engine.
				</p><p>
					The following is an overview of the Hello World example:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Name</strong></span>: <code class="literal">helloworld</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Main class</strong></span>: <code class="literal">org.drools.examples.helloworld.HelloWorldExample</code> (in <code class="literal">src/main/java</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Module</strong></span>: <code class="literal">drools-examples</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Type</strong></span>: Java application
						</li><li class="listitem">
							<span class="strong strong"><strong>Rule file</strong></span>: <code class="literal">org.drools.examples.helloworld.HelloWorld.drl</code> (in <code class="literal">src/main/resources</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Objective</strong></span>: Demonstrates basic rule execution and use of debug output
						</li></ul></div><p>
					In the Hello World example, a KIE session is generated to enable rule execution. All rules require a KIE session for execution.
				</p><div class="formalpara"><p class="title"><strong>KIE session for rule execution</strong></p><p>
						
<pre class="programlisting language-java">KieServices ks = KieServices.Factory.get(); <span id="CO9-1"/><span class="callout">1</span>
KieContainer kc = ks.getKieClasspathContainer(); <span id="CO9-2"/><span class="callout">2</span>
KieSession ksession = kc.newKieSession("HelloWorldKS"); <span id="CO9-3"/><span class="callout">3</span></pre>
					</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO9-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							Obtains the <code class="literal">KieServices</code> factory. This is the main interface that applications use to interact with the decision engine.
						</div></dd><dt><a href="#CO9-2"><span class="callout">2</span></a> </dt><dd><div class="para">
							Creates a <code class="literal">KieContainer</code> from the project class path. This detects a <span class="strong strong"><strong>/META-INF/kmodule.xml</strong></span> file from which it configures and instantiates a <code class="literal">KieContainer</code> with a <code class="literal">KieModule</code>.
						</div></dd><dt><a href="#CO9-3"><span class="callout">3</span></a> </dt><dd><div class="para">
							Creates a <code class="literal">KieSession</code> based on the <code class="literal">"HelloWorldKS"</code> KIE session configuration defined in the <span class="strong strong"><strong>/META-INF/kmodule.xml</strong></span> file.
						</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						For more information about Red Hat Process Automation Manager project packaging, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>.
					</p></div></div><p>
					Red Hat Process Automation Manager has an event model that exposes internal engine activity. Two default debug listeners, <code class="literal">DebugAgendaEventListener</code> and <code class="literal">DebugRuleRuntimeEventListener</code>, print debug event information to the <code class="literal">System.err</code> output. The <code class="literal">KieRuntimeLogger</code> provides execution auditing, the result of which you can view in a graphical viewer.
				</p><div class="formalpara"><p class="title"><strong>Debug listeners and audit loggers</strong></p><p>
						
<pre class="programlisting language-java">// Set up listeners.
ksession.addEventListener( new DebugAgendaEventListener() );
ksession.addEventListener( new DebugRuleRuntimeEventListener() );

// Set up a file-based audit logger.
KieRuntimeLogger logger = KieServices.get().getLoggers().newFileLogger( ksession, "./target/helloworld" );

// Set up a ThreadedFileLogger so that the audit view reflects events while debugging.
KieRuntimeLogger logger = ks.getLoggers().newThreadedFileLogger( ksession, "./target/helloworld", 1000 );</pre>
					</p></div><p>
					The logger is a specialized implementation built on the <code class="literal">Agenda</code> and <code class="literal">RuleRuntime</code> listeners. When the decision engine has finished executing, <code class="literal">logger.close()</code> is called.
				</p><p>
					The example creates a single <code class="literal">Message</code> object with the message <code class="literal">"Hello World"</code>, inserts the status <code class="literal">HELLO</code> into the <code class="literal">KieSession</code>, executes rules with <code class="literal">fireAllRules()</code>.
				</p><div class="formalpara"><p class="title"><strong>Data insertion and execution</strong></p><p>
						
<pre class="programlisting language-java">// Insert facts into the KIE session.
final Message message = new Message();
message.setMessage( "Hello World" );
message.setStatus( Message.HELLO );
ksession.insert( message );

// Fire the rules.
ksession.fireAllRules();</pre>
					</p></div><p>
					Rule execution uses a data model to pass data as inputs and outputs to the <code class="literal">KieSession</code>. The data model in this example has two fields: the <code class="literal">message</code>, which is a <code class="literal">String</code>, and the <code class="literal">status</code>, which can be <code class="literal">HELLO</code> or <code class="literal">GOODBYE</code>.
				</p><div class="formalpara"><p class="title"><strong>Data model class</strong></p><p>
						
<pre class="programlisting language-java">public static class Message {
    public static final int HELLO   = 0;
    public static final int GOODBYE = 1;

    private String          message;
    private int             status;
    ...
}</pre>
					</p></div><p>
					The two rules are located in the file <code class="literal">src/main/resources/org/drools/examples/helloworld/HelloWorld.drl</code>.
				</p><p>
					The <code class="literal">when</code> condition of the <code class="literal">"Hello World"</code> rule states that the rule is activated for each <code class="literal">Message</code> object inserted into the KIE session that has the status <code class="literal">Message.HELLO</code>. Additionally, two variable bindings are created: the variable <code class="literal">message</code> is bound to the <code class="literal">message</code> attribute and the variable <code class="literal">m</code> is bound to the matched <code class="literal">Message</code> object itself.
				</p><p>
					The <code class="literal">then</code> action of the rule specifies to print the content of the bound variable <code class="literal">message</code> to <code class="literal">System.out</code>, and then changes the values of the <code class="literal">message</code> and <code class="literal">status</code> attributes of the <code class="literal">Message</code> object bound to <code class="literal">m</code>. The rule uses the <code class="literal">modify</code> statement to apply a block of assignments in one statement and to notify the decision engine of the changes at the end of the block.
				</p><div class="formalpara"><p class="title"><strong>"Hello World" rule</strong></p><p>
						
<pre class="screen">rule "Hello World"
  when
    m : Message( status == Message.HELLO, message : message )
  then
    System.out.println( message );
    modify ( m ) { message = "Goodbye cruel world",
                   status = Message.GOODBYE };
end</pre>
					</p></div><p>
					The <code class="literal">"Good Bye"</code> rule is similar to the <code class="literal">"Hello World"</code> rule except that it matches <code class="literal">Message</code> objects that have the status <code class="literal">Message.GOODBYE</code>.
				</p><div class="formalpara"><p class="title"><strong>"Good Bye" rule</strong></p><p>
						
<pre class="screen">rule "Good Bye"
  when
    Message( status == Message.GOODBYE, message : message )
  then
    System.out.println( message );
end</pre>
					</p></div><p>
					To execute the example, run the <code class="literal">org.drools.examples.helloworld.HelloWorldExample</code> class as a Java application in your IDE. The rule writes to <code class="literal">System.out</code>, the debug listener writes to <code class="literal">System.err</code>, and the audit logger creates a log file in <code class="literal">target/helloworld.log</code>.
				</p><div class="formalpara"><p class="title"><strong>System.out output in the IDE console</strong></p><p>
						
<pre class="screen">Hello World
Goodbye cruel world</pre>
					</p></div><div class="formalpara"><p class="title"><strong>System.err output in the IDE console</strong></p><p>
						
<pre class="screen">==&gt;[ActivationCreated(0): rule=Hello World;
                   tuple=[fid:1:1:org.drools.examples.helloworld.HelloWorldExample$Message@17cec96]]
[ObjectInserted: handle=[fid:1:1:org.drools.examples.helloworld.HelloWorldExample$Message@17cec96];
                 object=org.drools.examples.helloworld.HelloWorldExample$Message@17cec96]
[BeforeActivationFired: rule=Hello World;
                   tuple=[fid:1:1:org.drools.examples.helloworld.HelloWorldExample$Message@17cec96]]
==&gt;[ActivationCreated(4): rule=Good Bye;
                   tuple=[fid:1:2:org.drools.examples.helloworld.HelloWorldExample$Message@17cec96]]
[ObjectUpdated: handle=[fid:1:2:org.drools.examples.helloworld.HelloWorldExample$Message@17cec96];
                old_object=org.drools.examples.helloworld.HelloWorldExample$Message@17cec96;
                new_object=org.drools.examples.helloworld.HelloWorldExample$Message@17cec96]
[AfterActivationFired(0): rule=Hello World]
[BeforeActivationFired: rule=Good Bye;
                   tuple=[fid:1:2:org.drools.examples.helloworld.HelloWorldExample$Message@17cec96]]
[AfterActivationFired(4): rule=Good Bye]</pre>
					</p></div><p>
					To better understand the execution flow of this example, you can load the audit log file from <code class="literal">target/helloworld.log</code> into your IDE debug view or <span class="strong strong"><strong>Audit View</strong></span>, if available (for example, in <span class="strong strong"><strong>Window</strong></span> → <span class="strong strong"><strong>Show View</strong></span> in some IDEs).
				</p><p>
					In this example, the <span class="strong strong"><strong>Audit view</strong></span> shows that the object is inserted, which creates an activation for the <code class="literal">"Hello World"</code> rule. The activation is then executed, which updates the <code class="literal">Message</code> object and causes the <code class="literal">"Good Bye"</code> rule to activate. Finally, the <code class="literal">"Good Bye"</code> rule is executed. When you select an event in the <span class="strong strong"><strong>Audit View</strong></span>, the origin event, which is the <code class="literal">"Activation created"</code> event in this example, is highlighted in green.
				</p><div class="figure" id="idm139921814442064"><p class="title"><strong>Figure 20.3. Hello World example Audit View</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/HelloWorldExample/helloworld_auditview1.png" alt="helloworld auditview1"/></div></div></div></section><section class="section" id="decision-examples-state-ref_drl-rules"><div class="titlepage"><div><div><h2 class="title">20.3. State example decisions (forward chaining and conflict resolution)</h2></div></div></div><p>
					The State example decision set demonstrates how the decision engine uses forward chaining and any changes to facts in the working memory to resolve execution conflicts for rules in a sequence. The example focuses on resolving conflicts through salience values or through agenda groups that you can define in rules.
				</p><p>
					The following is an overview of the State example:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Name</strong></span>: <code class="literal">state</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Main classes</strong></span>: <code class="literal">org.drools.examples.state.StateExampleUsingSalience</code>, <code class="literal">org.drools.examples.state.StateExampleUsingAgendaGroup</code> (in <code class="literal">src/main/java</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Module</strong></span>: <code class="literal">drools-examples</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Type</strong></span>: Java application
						</li><li class="listitem">
							<span class="strong strong"><strong>Rule files</strong></span>: <code class="literal">org.drools.examples.state.*.drl</code> (in <code class="literal">src/main/resources</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Objective</strong></span>: Demonstrates forward chaining and conflict resolution through rule salience and agenda groups
						</li></ul></div><p>
					A forward-chaining rule system is a data-driven system that starts with a fact in the working memory of the decision engine and reacts to changes to that fact. When objects are inserted into working memory, any rule conditions that become true as a result of the change are scheduled for execution by the agenda.
				</p><p>
					In contrast, a backward-chaining rule system is a goal-driven system that starts with a conclusion that the decision engine attempts to satisfy, often using recursion. If the system cannot reach the conclusion or goal, it searches for subgoals, which are conclusions that complete part of the current goal. The system continues this process until either the initial conclusion is satisfied or all subgoals are satisfied.
				</p><p>
					The decision engine in Red Hat Process Automation Manager uses both forward and backward chaining to evaluate rules.
				</p><p>
					The following diagram illustrates how the decision engine evaluates rules using forward chaining overall with a backward-chaining segment in the logic flow:
				</p><div class="figure" id="idm139921815760720"><p class="title"><strong>Figure 20.4. Rule evaluation logic using forward and backward chaining</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/BackwardChaining/RuleEvaluation_Enterprise.png" alt="RuleEvaluation Enterprise"/></div></div></div><p>
					In the State example, each <code class="literal">State</code> class has fields for its name and its current state (see the class <code class="literal">org.drools.examples.state.State</code>). The following states are the two possible states for each object:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">NOTRUN</code>
						</li><li class="listitem">
							<code class="literal">FINISHED</code>
						</li></ul></div><div class="formalpara"><p class="title"><strong>State class</strong></p><p>
						
<pre class="programlisting language-java">public class State {
    public static final int NOTRUN   = 0;
    public static final int FINISHED = 1;

    private final PropertyChangeSupport changes =
        new PropertyChangeSupport( this );

    private String name;
    private int    state;

    ... setters and getters go here...
}</pre>
					</p></div><p>
					The State example contains two versions of the same example to resolve rule execution conflicts:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							A <code class="literal">StateExampleUsingSalience</code> version that resolves conflicts by using rule salience
						</li><li class="listitem">
							A <code class="literal">StateExampleUsingAgendaGroups</code> version that resolves conflicts by using rule agenda groups
						</li></ul></div><p>
					Both versions of the state example involve four <code class="literal">State</code> objects: <code class="literal">A</code>, <code class="literal">B</code>, <code class="literal">C</code>, and <code class="literal">D</code>. Initially, their states are set to <code class="literal">NOTRUN</code>, which is the default value for the constructor that the example uses.
				</p><h4 id="state_example_using_salience">State example using salience</h4><p>
					The <code class="literal">StateExampleUsingSalience</code> version of the State example uses salience values in rules to resolve rule execution conflicts. Rules with a higher salience value are given higher priority when ordered in the activation queue.
				</p><p>
					The example inserts each <code class="literal">State</code> instance into the KIE session and then calls <code class="literal">fireAllRules()</code>.
				</p><div class="formalpara"><p class="title"><strong>Salience State example execution</strong></p><p>
						
<pre class="programlisting language-java">final State a = new State( "A" );
final State b = new State( "B" );
final State c = new State( "C" );
final State d = new State( "D" );

ksession.insert( a );
ksession.insert( b );
ksession.insert( c );
ksession.insert( d );

ksession.fireAllRules();

// Dispose KIE session if stateful (not required if stateless).
ksession.dispose();</pre>
					</p></div><p>
					To execute the example, run the <code class="literal">org.drools.examples.state.StateExampleUsingSalience</code> class as a Java application in your IDE.
				</p><p>
					After the execution, the following output appears in the IDE console window:
				</p><div class="formalpara"><p class="title"><strong>Salience State example output in the IDE console</strong></p><p>
						
<pre class="screen">A finished
B finished
C finished
D finished</pre>
					</p></div><p>
					Four rules are present.
				</p><p>
					First, the <code class="literal">"Bootstrap"</code> rule fires, setting <code class="literal">A</code> to state <code class="literal">FINISHED</code>, which then causes <code class="literal">B</code> to change its state to <code class="literal">FINISHED</code>. Objects <code class="literal">C</code> and <code class="literal">D</code> are both dependent on <code class="literal">B</code>, causing a conflict that is resolved by the salience values.
				</p><p>
					To better understand the execution flow of this example, you can load the audit log file from <code class="literal">target/state.log</code> into your IDE debug view or <span class="strong strong"><strong>Audit View</strong></span>, if available (for example, in <span class="strong strong"><strong>Window</strong></span> → <span class="strong strong"><strong>Show View</strong></span> in some IDEs).
				</p><p>
					In this example, the <span class="strong strong"><strong>Audit View</strong></span> shows that the assertion of the object <code class="literal">A</code> in the state <code class="literal">NOTRUN</code> activates the <code class="literal">"Bootstrap"</code> rule, while the assertions of the other objects have no immediate effect.
				</p><div class="figure" id="idm139921814013792"><p class="title"><strong>Figure 20.5. Salience State example Audit View</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/StateExample/state_example_audit1.png" alt="state example audit1"/></div></div></div><div class="formalpara"><p class="title"><strong>Rule "Bootstrap" in salience State example</strong></p><p>
						
<pre class="screen">rule "Bootstrap"
  when
    a : State(name == "A", state == State.NOTRUN )
  then
    System.out.println(a.getName() + " finished" );
    a.setState( State.FINISHED );
end</pre>
					</p></div><p>
					The execution of the <code class="literal">"Bootstrap"</code> rule changes the state of <code class="literal">A</code> to <code class="literal">FINISHED</code>, which activates rule <code class="literal">"A to B"</code>.
				</p><div class="formalpara"><p class="title"><strong>Rule "A to B" in salience State example</strong></p><p>
						
<pre class="screen">rule "A to B"
  when
    State(name == "A", state == State.FINISHED )
    b : State(name == "B", state == State.NOTRUN )
  then
    System.out.println(b.getName() + " finished" );
    b.setState( State.FINISHED );
end</pre>
					</p></div><p>
					The execution of rule <code class="literal">"A to B"</code> changes the state of <code class="literal">B</code> to <code class="literal">FINISHED</code>, which activates both rules <code class="literal">"B to C"</code> and <code class="literal">"B to D"</code>, placing their activations onto the decision engine agenda.
				</p><div class="formalpara"><p class="title"><strong>Rules "B to C" and "B to D" in salience State example</strong></p><p>
						
<pre class="screen">rule "B to C"
    salience 10
  when
    State(name == "B", state == State.FINISHED )
    c : State(name == "C", state == State.NOTRUN )
  then
    System.out.println(c.getName() + " finished" );
    c.setState( State.FINISHED );
end

rule "B to D"
  when
    State(name == "B", state == State.FINISHED )
    d : State(name == "D", state == State.NOTRUN )
  then
    System.out.println(d.getName() + " finished" );
    d.setState( State.FINISHED );
end</pre>
					</p></div><p>
					From this point on, both rules may fire and, therefore, the rules are in conflict. The conflict resolution strategy enables the decision engine agenda to decide which rule to fire. Rule <code class="literal">"B to C"</code> has the higher salience value (<code class="literal">10</code> versus the default salience value of <code class="literal">0</code>), so it fires first, modifying object <code class="literal">C</code> to state <code class="literal">FINISHED</code>.
				</p><p>
					The <span class="strong strong"><strong>Audit View</strong></span> in your IDE shows the modification of the <code class="literal">State</code> object in the rule <code class="literal">"A to B"</code>, which results in two activations being in conflict.
				</p><p>
					You can also use the <span class="strong strong"><strong>Agenda View</strong></span> in your IDE to investigate the state of the decision engine agenda. In this example, the <span class="strong strong"><strong>Agenda View</strong></span> shows the breakpoint in the rule <code class="literal">"A to B"</code> and the state of the agenda with the two conflicting rules. Rule <code class="literal">"B to D"</code> fires last, modifying object <code class="literal">D</code> to state <code class="literal">FINISHED</code>.
				</p><div class="figure" id="idm139921813583584"><p class="title"><strong>Figure 20.6. Salience State example Agenda View</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/StateExample/state_example_agenda1.png" alt="state example agenda1"/></div></div></div><h4 id="state_example_using_agenda_groups">State example using agenda groups</h4><p>
					The <code class="literal">StateExampleUsingAgendaGroups</code> version of the State example uses agenda groups in rules to resolve rule execution conflicts. Agenda groups enable you to partition the decision engine agenda to provide more execution control over groups of rules. By default, all rules are in the agenda group <code class="literal">MAIN</code>. You can use the <code class="literal">agenda-group</code> attribute to specify a different agenda group for the rule.
				</p><p>
					Initially, a working memory has its focus on the agenda group <code class="literal">MAIN</code>. Rules in an agenda group only fire when the group receives the focus. You can set the focus either by using the method <code class="literal">setFocus()</code> or the rule attribute <code class="literal">auto-focus</code>. The <code class="literal">auto-focus</code> attribute enables the rule to be given a focus automatically for its agenda group when the rule is matched and activated.
				</p><p>
					In this example, the <code class="literal">auto-focus</code> attribute enables rule <code class="literal">"B to C"</code> to fire before <code class="literal">"B to D"</code>.
				</p><div class="formalpara"><p class="title"><strong>Rule "B to C" in agenda group State example</strong></p><p>
						
<pre class="screen">rule "B to C"
    agenda-group "B to C"
    auto-focus true
  when
    State(name == "B", state == State.FINISHED )
    c : State(name == "C", state == State.NOTRUN )
  then
    System.out.println(c.getName() + " finished" );
    c.setState( State.FINISHED );
    kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup( "B to D" ).setFocus();
end</pre>
					</p></div><p>
					The rule <code class="literal">"B to C"</code> calls <code class="literal">setFocus()</code> on the agenda group <code class="literal">"B to D"</code>, enabling its active rules to fire, which then enables the rule <code class="literal">"B to D"</code> to fire.
				</p><div class="formalpara"><p class="title"><strong>Rule "B to D" in agenda group State example</strong></p><p>
						
<pre class="screen">rule "B to D"
    agenda-group "B to D"
  when
    State(name == "B", state == State.FINISHED )
    d : State(name == "D", state == State.NOTRUN )
  then
    System.out.println(d.getName() + " finished" );
    d.setState( State.FINISHED );
end</pre>
					</p></div><p>
					To execute the example, run the <code class="literal">org.drools.examples.state.StateExampleUsingAgendaGroups</code> class as a Java application in your IDE.
				</p><p>
					After the execution, the following output appears in the IDE console window (same as the salience version of the State example):
				</p><div class="formalpara"><p class="title"><strong>Agenda group State example output in the IDE console</strong></p><p>
						
<pre class="screen">A finished
B finished
C finished
D finished</pre>
					</p></div><h4 id="dynamic_facts_in_the_state_example">Dynamic facts in the State example</h4><p>
					Another notable concept in this State example is the use of <span class="emphasis"><em>dynamic facts</em></span>, based on objects that implement a <code class="literal">PropertyChangeListener</code> object. In order for the decision engine to see and react to changes of fact properties, the application must notify the decision engine that changes occurred. You can configure this communication explicitly in the rules by using the <code class="literal">modify</code> statement, or implicitly by specifying that the facts implement the <code class="literal">PropertyChangeSupport</code> interface as defined by the JavaBeans specification.
				</p><p>
					This example demonstrates how to use the <code class="literal">PropertyChangeSupport</code> interface to avoid the need for explicit <code class="literal">modify</code> statements in the rules. To make use of this interface, ensure that your facts implement <code class="literal">PropertyChangeSupport</code> in the same way that the class <code class="literal">org.drools.example.State</code> implements it, and then use the following code in the DRL rule file to configure the decision engine to listen for property changes on those facts:
				</p><div class="formalpara"><p class="title"><strong>Declaring a dynamic fact</strong></p><p>
						
<pre class="screen">declare type State
  @propertyChangeSupport
end</pre>
					</p></div><p>
					When you use <code class="literal">PropertyChangeListener</code> objects, each setter must implement additional code for the notification. For example, the following setter for <code class="literal">state</code> is in the class <code class="literal">org.drools.examples</code>:
				</p><div class="formalpara"><p class="title"><strong>Setter example with PropertyChangeSupport</strong></p><p>
						
<pre class="programlisting language-java">public void setState(final int newState) {
    int oldState = this.state;
    this.state = newState;
    this.changes.firePropertyChange( "state",
                                     oldState,
                                     newState );
}</pre>
					</p></div></section><section class="section" id="decision-examples-fibonacci-ref_drl-rules"><div class="titlepage"><div><div><h2 class="title">20.4. Fibonacci example decisions (recursion and conflict resolution)</h2></div></div></div><p>
					The Fibonacci example decision set demonstrates how the decision engine uses recursion to resolve execution conflicts for rules in a sequence. The example focuses on resolving conflicts through salience values that you can define in rules.
				</p><p>
					The following is an overview of the Fibonacci example:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Name</strong></span>: <code class="literal">fibonacci</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Main class</strong></span>: <code class="literal">org.drools.examples.fibonacci.FibonacciExample</code> (in <code class="literal">src/main/java</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Module</strong></span>: <code class="literal">drools-examples</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Type</strong></span>: Java application
						</li><li class="listitem">
							<span class="strong strong"><strong>Rule file</strong></span>: <code class="literal">org.drools.examples.fibonacci.Fibonacci.drl</code> (in <code class="literal">src/main/resources</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Objective</strong></span>: Demonstrates recursion and conflict resolution through rule salience
						</li></ul></div><p>
					The Fibonacci Numbers form a sequence starting with 0 and 1. The next Fibonacci number is obtained by adding the two preceding Fibonacci numbers: 0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610, 987, 1597, 2584, 4181, 6765, 10946, and so on.
				</p><p>
					The Fibonacci example uses the single fact class <code class="literal">Fibonacci</code> with the following two fields:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">sequence</code>
						</li><li class="listitem">
							<code class="literal">value</code>
						</li></ul></div><p>
					The <code class="literal">sequence</code> field indicates the position of the object in the Fibonacci number sequence. The <code class="literal">value</code> field shows the value of that Fibonacci object for that sequence position, where <code class="literal">-1</code> indicates a value that still needs to be computed.
				</p><div class="formalpara"><p class="title"><strong>Fibonacci class</strong></p><p>
						
<pre class="programlisting language-java">public static class Fibonacci {
    private int  sequence;
    private long value;

    public Fibonacci( final int sequence ) {
        this.sequence = sequence;
        this.value = -1;
    }

    ... setters and getters go here...
}</pre>
					</p></div><p>
					To execute the example, run the <code class="literal">org.drools.examples.fibonacci.FibonacciExample</code> class as a Java application in your IDE.
				</p><p>
					After the execution, the following output appears in the IDE console window:
				</p><div class="formalpara"><p class="title"><strong>Fibonacci example output in the IDE console</strong></p><p>
						
<pre class="screen">recurse for 50
recurse for 49
recurse for 48
recurse for 47
...
recurse for 5
recurse for 4
recurse for 3
recurse for 2
1 == 1
2 == 1
3 == 2
4 == 3
5 == 5
6 == 8
...
47 == 2971215073
48 == 4807526976
49 == 7778742049
50 == 12586269025</pre>
					</p></div><p>
					To achieve this behavior in Java, the example inserts a single <code class="literal">Fibonacci</code> object with a sequence field of <code class="literal">50</code>. The example then uses a recursive rule to insert the other 49 <code class="literal">Fibonacci</code> objects.
				</p><p>
					Instead of implementing the <code class="literal">PropertyChangeSupport</code> interface to use dynamic facts, this example uses the MVEL dialect <code class="literal">modify</code> keyword to enable a block setter action and notify the decision engine of changes.
				</p><div class="formalpara"><p class="title"><strong>Fibonacci example execution</strong></p><p>
						
<pre class="programlisting language-java">ksession.insert( new Fibonacci( 50 ) );
ksession.fireAllRules();</pre>
					</p></div><p>
					This example uses the following three rules:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">"Recurse"</code>
						</li><li class="listitem">
							<code class="literal">"Bootstrap"</code>
						</li><li class="listitem">
							<code class="literal">"Calculate"</code>
						</li></ul></div><p>
					The rule <code class="literal">"Recurse"</code> matches each asserted <code class="literal">Fibonacci</code> object with a value of <code class="literal">-1</code>, creating and asserting a new <code class="literal">Fibonacci</code> object with a sequence of one less than the currently matched object. Each time a Fibonacci object is added while the one with a sequence field equal to <code class="literal">1</code> does not exist, the rule re-matches and fires again. The <code class="literal">not</code> conditional element is used to stop the rule matching once you have all 50 Fibonacci objects in memory. The rule also has a <code class="literal">salience</code> value because you need to have all 50 <code class="literal">Fibonacci</code> objects asserted before you execute the <code class="literal">"Bootstrap"</code> rule.
				</p><div class="formalpara"><p class="title"><strong>Rule "Recurse"</strong></p><p>
						
<pre class="screen">rule "Recurse"
    salience 10
  when
    f : Fibonacci ( value == -1 )
    not ( Fibonacci ( sequence == 1 ) )
  then
    insert( new Fibonacci( f.sequence - 1 ) );
    System.out.println( "recurse for " + f.sequence );
end</pre>
					</p></div><p>
					To better understand the execution flow of this example, you can load the audit log file from <code class="literal">target/fibonacci.log</code> into your IDE debug view or <span class="strong strong"><strong>Audit View</strong></span>, if available (for example, in <span class="strong strong"><strong>Window</strong></span> → <span class="strong strong"><strong>Show View</strong></span> in some IDEs).
				</p><p>
					In this example, the <span class="strong strong"><strong>Audit View</strong></span> shows the original assertion of the <code class="literal">Fibonacci</code> object with a <code class="literal">sequence</code> field of <code class="literal">50</code>, done from Java code. From there on, the <span class="strong strong"><strong>Audit View</strong></span> shows the continual recursion of the rule, where each asserted <code class="literal">Fibonacci</code> object causes the <code class="literal">"Recurse"</code> rule to become activated and to fire again.
				</p><div class="figure" id="idm139921813066912"><p class="title"><strong>Figure 20.7. Rule "Recurse" in Audit View</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/FibonacciExample/fibonacci1.png" alt="fibonacci1"/></div></div></div><p>
					When a <code class="literal">Fibonacci</code> object with a <code class="literal">sequence</code> field of <code class="literal">2</code> is asserted, the <code class="literal">"Bootstrap"</code> rule is matched and activated along with the <code class="literal">"Recurse"</code> rule. Notice the multiple restrictions on field <code class="literal">sequence</code> that test for equality with <code class="literal">1</code> or <code class="literal">2</code>:
				</p><div class="formalpara"><p class="title"><strong>Rule "Bootstrap"</strong></p><p>
						
<pre class="screen">rule "Bootstrap"
  when
    f : Fibonacci( sequence == 1 || == 2, value == -1 ) // multi-restriction
  then
    modify ( f ){ value = 1 };
    System.out.println( f.sequence + " == " + f.value );
end</pre>
					</p></div><p>
					You can also use the <span class="strong strong"><strong>Agenda View</strong></span> in your IDE to investigate the state of the decision engine agenda. The <code class="literal">"Bootstrap"</code> rule does not fire yet because the <code class="literal">"Recurse"</code> rule has a higher salience value.
				</p><div class="figure" id="idm139921812157840"><p class="title"><strong>Figure 20.8. Rules "Recurse" and "Bootstrap" in Agenda View 1</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/FibonacciExample/fibonacci_agenda1.png" alt="fibonacci agenda1"/></div></div></div><p>
					When a <code class="literal">Fibonacci</code> object with a <code class="literal">sequence</code> of <code class="literal">1</code> is asserted, the <code class="literal">"Bootstrap"</code> rule is matched again, causing two activations for this rule. The <code class="literal">"Recurse"</code> rule does not match and activate because the <code class="literal">not</code> conditional element stops the rule matching as soon as a <code class="literal">Fibonacci</code> object with a <code class="literal">sequence</code> of <code class="literal">1</code> exists.
				</p><div class="figure" id="idm139921812148720"><p class="title"><strong>Figure 20.9. Rules "Recurse" and "Bootstrap" in Agenda View 2</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/FibonacciExample/fibonacci_agenda2.png" alt="fibonacci agenda2"/></div></div></div><p>
					The <code class="literal">"Bootstrap"</code> rule sets the objects with a <code class="literal">sequence</code> of <code class="literal">1</code> and <code class="literal">2</code> to a value of <code class="literal">1</code>. Now that you have two <code class="literal">Fibonacci</code> objects with values not equal to <code class="literal">-1</code>, the <code class="literal">"Calculate"</code> rule is able to match.
				</p><p>
					At this point in the example, nearly 50 <code class="literal">Fibonacci</code> objects exist in the working memory. You need to select a suitable triple to calculate each of their values in turn. If you use three Fibonacci patterns in a rule without field constraints to confine the possible cross products, the result would be 50x49x48 possible combinations, leading to about 125,000 possible rule firings, most of them incorrect.
				</p><p>
					The <code class="literal">"Calculate"</code> rule uses field constraints to evaluate the three Fibonacci patterns in the correct order. This technique is called <span class="emphasis"><em>cross-product matching</em></span>.
				</p><p>
					The first pattern finds any <code class="literal">Fibonacci</code> object with a value <code class="literal">!= -1</code> and binds both the pattern and the field. The second <code class="literal">Fibonacci</code> object does the same thing, but adds an additional field constraint to ensure that its sequence is greater by one than the <code class="literal">Fibonacci</code> object bound to <code class="literal">f1</code>. When this rule fires for the first time, you know that only sequences <code class="literal">1</code> and <code class="literal">2</code> have values of <code class="literal">1</code>, and the two constraints ensure that <code class="literal">f1</code> references sequence <code class="literal">1</code> and that <code class="literal">f2</code> references sequence <code class="literal">2</code>.
				</p><p>
					The final pattern finds the <code class="literal">Fibonacci</code> object with a value equal to <code class="literal">-1</code> and with a sequence one greater than <code class="literal">f2</code>.
				</p><p>
					At this point in the example, three <code class="literal">Fibonacci</code> objects are correctly selected from the available cross products, and you can calculate the value for the third <code class="literal">Fibonacci</code> object that is bound to <code class="literal">f3</code>.
				</p><div class="formalpara"><p class="title"><strong>Rule "Calculate"</strong></p><p>
						
<pre class="screen">rule "Calculate"
  when
    // Bind f1 and s1.
    f1 : Fibonacci( s1 : sequence, value != -1 )
    // Bind f2 and v2, refer to bound variable s1.
    f2 : Fibonacci( sequence == (s1 + 1), v2 : value != -1 )
    // Bind f3 and s3, alternative reference of f2.sequence.
    f3 : Fibonacci( s3 : sequence == (f2.sequence + 1 ), value == -1 )
  then
    // Note the various referencing techniques.
    modify ( f3 ) { value = f1.value + v2 };
    System.out.println( s3 + " == " + f3.value );
end</pre>
					</p></div><p>
					The <code class="literal">modify</code> statement updates the value of the <code class="literal">Fibonacci</code> object bound to <code class="literal">f3</code>. This means that you now have another new <code class="literal">Fibonacci</code> object with a value not equal to <code class="literal">-1</code>, which allows the <code class="literal">"Calculate"</code> rule to re-match and calculate the next Fibonacci number.
				</p><p>
					The debug view or <span class="strong strong"><strong>Audit View</strong></span> of your IDE shows how the firing of the last <code class="literal">"Bootstrap"</code> rule modifies the <code class="literal">Fibonacci</code> object, enabling the <code class="literal">"Calculate"</code> rule to match, which then modifies another <code class="literal">Fibonacci</code> object that enables the <code class="literal">"Calculate"</code> rule to match again. This process continues until the value is set for all <code class="literal">Fibonacci</code> objects.
				</p><div class="figure" id="idm139921815900864"><p class="title"><strong>Figure 20.10. Rules in Audit View</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/FibonacciExample/fibonacci4.png" alt="fibonacci4"/></div></div></div></section><section class="section" id="decision-examples-pricing-ref_drl-rules"><div class="titlepage"><div><div><h2 class="title">20.5. Pricing example decisions (decision tables)</h2></div></div></div><p>
					The Pricing example decision set demonstrates how to use a spreadsheet decision table for calculating the retail cost of an insurance policy in tabular format instead of directly in a DRL file.
				</p><p>
					The following is an overview of the Pricing example:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Name</strong></span>: <code class="literal">decisiontable</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Main class</strong></span>: <code class="literal">org.drools.examples.decisiontable.PricingRuleDTExample</code> (in <code class="literal">src/main/java</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Module</strong></span>: <code class="literal">drools-examples</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Type</strong></span>: Java application
						</li><li class="listitem">
							<span class="strong strong"><strong>Rule file</strong></span>: <code class="literal">org.drools.examples.decisiontable.ExamplePolicyPricing.xls</code> (in <code class="literal">src/main/resources</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Objective</strong></span>: Demonstrates use of spreadsheet decision tables to define rules
						</li></ul></div><p>
					Spreadsheet decision tables are XLS or XLSX spreadsheets that contain business rules defined in a tabular format. You can include spreadsheet decision tables with standalone Red Hat Process Automation Manager projects or upload them to projects in Business Central. Each row in a decision table is a rule, and each column is a condition, an action, or another rule attribute. After you create and upload your decision tables into your Red Hat Process Automation Manager project, the rules you defined are compiled into Drools Rule Language (DRL) rules as with all other rule assets.
				</p><p>
					The purpose of the Pricing example is to provide a set of business rules to calculate the base price and a discount for a car driver applying for a specific type of insurance policy. The driver’s age and history and the policy type all contribute to calculate the basic premium, and additional rules calculate potential discounts for which the driver might be eligible.
				</p><p>
					To execute the example, run the <code class="literal">org.drools.examples.decisiontable.PricingRuleDTExample</code> class as a Java application in your IDE.
				</p><p>
					After the execution, the following output appears in the IDE console window:
				</p><pre class="screen">Cheapest possible
BASE PRICE IS: 120
DISCOUNT IS: 20</pre><p>
					The code to execute the example follows the typical execution pattern: the rules are loaded, the facts are inserted, and a stateless KIE session is created. The difference in this example is that the rules are defined in an <code class="literal">ExamplePolicyPricing.xls</code> file instead of a DRL file or other source. The spreadsheet file is loaded into the decision engine using templates and DRL rules.
				</p><h4 id="spreadsheet_decision_table_setup">Spreadsheet decision table setup</h4><p>
					The <code class="literal">ExamplePolicyPricing.xls</code> spreadsheet contains two decision tables in the first tab:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">Base pricing rules</code>
						</li><li class="listitem">
							<code class="literal">Promotional discount rules</code>
						</li></ul></div><p>
					As the example spreadsheet demonstrates, you can use only the first tab of a spreadsheet to create decision tables, but multiple tables can be within a single tab. Decision tables do not necessarily follow top-down logic, but are more of a means to capture data resulting in rules. The evaluation of the rules is not necessarily in the given order, because all of the normal mechanics of the decision engine still apply. This is why you can have multiple decision tables in the same tab of a spreadsheet.
				</p><p>
					The decision tables are executed through the corresponding rule template files <code class="literal">BasePricing.drt</code> and <code class="literal">PromotionalPricing.drt</code>. These template files reference the decision tables through their template parameter and directly reference the various headers for the conditions and actions in the decision tables.
				</p><div class="formalpara"><p class="title"><strong>BasePricing.drt rule template file</strong></p><p>
						
<pre class="screen">template header
age[]
profile
priorClaims
policyType
base
reason

package org.drools.examples.decisiontable;

template "Pricing bracket"
age
policyType
base

rule "Pricing bracket_@{row.rowNumber}"
  when
    Driver(age &gt;= @{age0}, age &lt;= @{age1}
        , priorClaims == "@{priorClaims}"
        , locationRiskProfile == "@{profile}"
    )
    policy: Policy(type == "@{policyType}")
  then
    policy.setBasePrice(@{base});
    System.out.println("@{reason}");
end
end template</pre>
					</p></div><div class="formalpara"><p class="title"><strong>PromotionalPricing.drt rule template file</strong></p><p>
						
<pre class="screen">template header
age[]
priorClaims
policyType
discount

package org.drools.examples.decisiontable;

template "discounts"
age
priorClaims
policyType
discount

rule "Discounts_@{row.rowNumber}"
  when
    Driver(age &gt;= @{age0}, age &lt;= @{age1}, priorClaims == "@{priorClaims}")
    policy: Policy(type == "@{policyType}")
  then
    policy.applyDiscount(@{discount});
end
end template</pre>
					</p></div><p>
					The rules are executed through the <code class="literal">kmodule.xml</code> reference of the KIE Session <code class="literal">DTableWithTemplateKB</code>, which specifically mentions the <code class="literal">ExamplePolicyPricing.xls</code> spreadsheet and is required for successful execution of the rules. This execution method enables you to execute the rules as a standalone unit (as in this example) or to include the rules in a packaged knowledge JAR (KJAR) file, so that the spreadsheet is packaged along with the rules for execution.
				</p><p>
					The following section of the <code class="literal">kmodule.xml</code> file is required for the execution of the rules and spreadsheet to work successfully:
				</p><pre class="programlisting language-xml">    &lt;kbase name="DecisionTableKB" packages="org.drools.examples.decisiontable"&gt;
        &lt;ksession name="DecisionTableKS" type="stateless"/&gt;
    &lt;/kbase&gt;

    &lt;kbase name="DTableWithTemplateKB" packages="org.drools.examples.decisiontable-template"&gt;
        &lt;ruleTemplate dtable="org/drools/examples/decisiontable-template/ExamplePolicyPricingTemplateData.xls"
                      template="org/drools/examples/decisiontable-template/BasePricing.drt"
                      row="3" col="3"/&gt;
        &lt;ruleTemplate dtable="org/drools/examples/decisiontable-template/ExamplePolicyPricingTemplateData.xls"
                      template="org/drools/examples/decisiontable-template/PromotionalPricing.drt"
                      row="18" col="3"/&gt;
        &lt;ksession name="DTableWithTemplateKS"/&gt;
    &lt;/kbase&gt;</pre><p>
					As an alternative to executing the decision tables using rule template files, you can use the <code class="literal">DecisionTableConfiguration</code> object and specify an input spreadsheet as the input type, such as <code class="literal">DecisionTableInputType.xls</code>:
				</p><pre class="programlisting language-java">DecisionTableConfiguration dtableconfiguration =
    KnowledgeBuilderFactory.newDecisionTableConfiguration();
        dtableconfiguration.setInputType( DecisionTableInputType.XLS );

        KnowledgeBuilder kbuilder = KnowledgeBuilderFactory.newKnowledgeBuilder();

        Resource xlsRes = ResourceFactory.newClassPathResource( "ExamplePolicyPricing.xls",
                                                                getClass() );
        kbuilder.add( xlsRes,
                      ResourceType.DTABLE,
                      dtableconfiguration );</pre><p>
					The Pricing example uses two fact types:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">Driver</code>
						</li><li class="listitem">
							<code class="literal">Policy</code>.
						</li></ul></div><p>
					The example sets the default values for both facts in their respective Java classes <code class="literal">Driver.java</code> and <code class="literal">Policy.java</code>. The <code class="literal">Driver</code> is 30 years old, has had no prior claims, and currently has a risk profile of <code class="literal">LOW</code>. The <code class="literal">Policy</code> that the driver is applying for is <code class="literal">COMPREHENSIVE</code>.
				</p><p>
					In any decision table, each row is considered a different rule and each column is a condition or an action. Each row is evaluated in a decision table unless the agenda is cleared upon execution.
				</p><p>
					Decision table spreadsheets (XLS or XLSX) require two key areas that define rule data:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							A <code class="literal">RuleSet</code> area
						</li><li class="listitem">
							A <code class="literal">RuleTable</code> area
						</li></ul></div><p>
					The <code class="literal">RuleSet</code> area of the spreadsheet defines elements that you want to apply globally to all rules in the same package (not only the spreadsheet), such as a rule set name or universal rule attributes. The <code class="literal">RuleTable</code> area defines the actual rules (rows) and the conditions, actions, and other rule attributes (columns) that constitute that rule table within the specified rule set. A decision table spreadsheet can contain multiple <code class="literal">RuleTable</code> areas, but only one <code class="literal">RuleSet</code> area.
				</p><div class="figure" id="idm139921817308336"><p class="title"><strong>Figure 20.11. Decision table configuration</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/PricingExample/DT_Config.png" alt="DT Config"/></div></div></div><p>
					The <code class="literal">RuleTable</code> area also defines the objects to which the rule attributes apply, in this case <code class="literal">Driver</code> and <code class="literal">Policy</code>, followed by constraints on the objects. For example, the <code class="literal">Driver</code> object constraint that defines the <code class="literal">Age Bracket</code> column is <code class="literal">age &gt;= $1, age &lt;= $2</code>, where the comma-separated range is defined in the table column values, such as <code class="literal">18,24</code>.
				</p><h4 id="base_pricing_rules">Base pricing rules</h4><p>
					The <code class="literal">Base pricing rules</code> decision table in the Pricing example evaluates the age, risk profile, number of claims, and policy type of the driver and produces the base price of the policy based on these conditions.
				</p><div class="figure" id="idm139921816204608"><p class="title"><strong>Figure 20.12. Base price calculation</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/PricingExample/DT_Table1.png" alt="DT Table1"/></div></div></div><p>
					The <code class="literal">Driver</code> attributes are defined in the following table columns:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">Age Bracket</code>: The age bracket has a definition for the condition <code class="literal">age &gt;=$1, age &lt;=$2</code>, which defines the condition boundaries for the driver’s age. This condition column highlights the use of <code class="literal">$1 and $2</code>, which is comma delimited in the spreadsheet. You can write these values as <code class="literal">18,24</code> or <code class="literal">18, 24</code> and both formats work in the execution of the business rules.
						</li><li class="listitem">
							<code class="literal">Location risk profile</code>: The risk profile is a string that the example program passes always as <code class="literal">LOW</code> but can be changed to reflect <code class="literal">MED</code> or <code class="literal">HIGH</code>.
						</li><li class="listitem">
							<code class="literal">Number of prior claims</code>: The number of claims is defined as an integer that the condition column must exactly equal to trigger the action. The value is not a range, only exact matches.
						</li></ul></div><p>
					The <code class="literal">Policy</code> of the decision table is used in both the conditions and the actions of the rule and has attributes defined in the following table columns:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">Policy type applying for</code>: The policy type is a condition that is passed as a string that defines the type of coverage: <code class="literal">COMPREHENSIVE</code>, <code class="literal">FIRE_THEFT</code>, or <code class="literal">THIRD_PARTY</code>.
						</li><li class="listitem">
							<code class="literal">Base $ AUD</code>: The <code class="literal">basePrice</code> is defined as an <code class="literal">ACTION</code> that sets the price through the constraint <code class="literal">policy.setBasePrice($param);</code> based on the spreadsheet cells corresponding to this value. When you execute the corresponding DRL rule for this decision table, the <code class="literal">then</code> portion of the rule executes this action statement on the true conditions matching the facts and sets the base price to the corresponding value.
						</li><li class="listitem">
							<code class="literal">Record Reason</code>: When the rule successfully executes, this action generates an output message to the <code class="literal">System.out</code> console reflecting which rule fired. This is later captured in the application and printed.
						</li></ul></div><p>
					The example also uses the first column on the left to categorize rules. This column is for annotation only and has no affect on rule execution.
				</p><h4 id="promotional_discount_rules">Promotional discount rules</h4><p>
					The <code class="literal">Promotional discount rules</code> decision table in the Pricing example evaluates the age, number of prior claims, and policy type of the driver to generate a potential discount on the price of the insurance policy.
				</p><div class="figure" id="idm139921812620288"><p class="title"><strong>Figure 20.13. Discount calculation</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/PricingExample/DT_Table2.png" alt="DT Table2"/></div></div></div><p>
					This decision table contains the conditions for the discount for which the driver might be eligible. Similar to the base price calculation, this table evaluates the <code class="literal">Age</code>, <code class="literal">Number of prior claims</code> of the driver, and the <code class="literal">Policy type applying for</code> to determine a <code class="literal">Discount %</code> rate to be applied. For example, if the driver is 30 years old, has no prior claims, and is applying for a <code class="literal">COMPREHENSIVE</code> policy, the driver is given a discount of <code class="literal">20</code> percent.
				</p></section><section class="section" id="decision-examples-petstore-ref_drl-rules"><div class="titlepage"><div><div><h2 class="title">20.6. Pet Store example decisions (agenda groups, global variables, callbacks, and GUI integration)</h2></div></div></div><p>
					The Pet Store example decision set demonstrates how to use agenda groups and global variables in rules and how to integrate Red Hat Process Automation Manager rules with a graphical user interface (GUI), in this case a Swing-based desktop application. The example also demonstrates how to use callbacks to interact with a running decision engine to update the GUI based on changes in the working memory at run time.
				</p><p>
					The following is an overview of the Pet Store example:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Name</strong></span>: <code class="literal">petstore</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Main class</strong></span>: <code class="literal">org.drools.examples.petstore.PetStoreExample</code> (in <code class="literal">src/main/java</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Module</strong></span>: <code class="literal">drools-examples</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Type</strong></span>: Java application
						</li><li class="listitem">
							<span class="strong strong"><strong>Rule file</strong></span>: <code class="literal">org.drools.examples.petstore.PetStore.drl</code> (in <code class="literal">src/main/resources</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Objective</strong></span>: Demonstrates rule agenda groups, global variables, callbacks, and GUI integration
						</li></ul></div><p>
					In the Pet Store example, the sample <code class="literal">PetStoreExample.java</code> class defines the following principal classes (in addition to several classes to handle Swing events):
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">Petstore</code> contains the <code class="literal">main()</code> method.
						</li><li class="listitem">
							<code class="literal">PetStoreUI</code> is responsible for creating and displaying the Swing-based GUI. This class contains several smaller classes, mainly for responding to various GUI events, such as user mouse clicks.
						</li><li class="listitem">
							<code class="literal">TableModel</code> holds the table data. This class is essentially a JavaBean that extends the Swing class <code class="literal">AbstractTableModel</code>.
						</li><li class="listitem">
							<code class="literal">CheckoutCallback</code> enables the GUI to interact with the rules.
						</li><li class="listitem">
							<code class="literal">Ordershow</code> keeps the items that you want to buy.
						</li><li class="listitem">
							<code class="literal">Purchase</code> stores details of the order and the products that you are buying.
						</li><li class="listitem">
							<code class="literal">Product</code> is a JavaBean containing details of the product available for purchase and its price.
						</li></ul></div><p>
					Much of the Java code in this example is either plain JavaBean or Swing based. For more information about Swing components, see the Java tutorial on <a class="link" href="https://docs.oracle.com/javase/tutorial/uiswing/">Creating a GUI with JFC/Swing</a>.
				</p><h4 id="rule_execution_behavior_in_the_pet_store_example">Rule execution behavior in the Pet Store example</h4><p>
					Unlike other example decision sets where the facts are asserted and fired immediately, the Pet Store example does not execute the rules until more facts are gathered based on user interaction. The example executes rules through a <code class="literal">PetStoreUI</code> object, created by a constructor, that accepts the <code class="literal">Vector</code> object <code class="literal">stock</code> for collecting the products. The example then uses an instance of the <code class="literal">CheckoutCallback</code> class containing the rule base that was previously loaded.
				</p><div class="formalpara"><p class="title"><strong>Pet Store KIE container and fact execution setup</strong></p><p>
						
<pre class="programlisting language-java">// KieServices is the factory for all KIE services.
KieServices ks = KieServices.Factory.get();

// Create a KIE container on the class path.
KieContainer kc = ks.getKieClasspathContainer();

// Create the stock.
Vector&lt;Product&gt; stock = new Vector&lt;Product&gt;();
stock.add( new Product( "Gold Fish", 5 ) );
stock.add( new Product( "Fish Tank", 25 ) );
stock.add( new Product( "Fish Food", 2 ) );

// A callback is responsible for populating the working memory and for firing all rules.
PetStoreUI ui = new PetStoreUI( stock,
                                new CheckoutCallback( kc ) );
ui.createAndShowGUI();</pre>
					</p></div><p>
					The Java code that fires the rules is in the <code class="literal">CheckoutCallBack.checkout()</code> method. This method is triggered when the user clicks <span class="strong strong"><strong>Checkout</strong></span> in the UI.
				</p><div class="formalpara"><p class="title"><strong>Rule execution from CheckoutCallBack.checkout()</strong></p><p>
						
<pre class="programlisting language-java">public String checkout(JFrame frame, List&lt;Product&gt; items) {
    Order order = new Order();

    // Iterate through list and add to cart.
    for ( Product p: items ) {
        order.addItem( new Purchase( order, p ) );
    }

    // Add the JFrame to the ApplicationData to allow for user interaction.

    // From the KIE container, a KIE session is created based on
    // its definition and configuration in the META-INF/kmodule.xml file.
    KieSession ksession = kcontainer.newKieSession("PetStoreKS");

    ksession.setGlobal( "frame", frame );
    ksession.setGlobal( "textArea", this.output );

    ksession.insert( new Product( "Gold Fish", 5 ) );
    ksession.insert( new Product( "Fish Tank", 25 ) );
    ksession.insert( new Product( "Fish Food", 2 ) );

    ksession.insert( new Product( "Fish Food Sample", 0 ) );

    ksession.insert( order );

    // Execute rules.
    ksession.fireAllRules();

    // Return the state of the cart
    return order.toString();
}</pre>
					</p></div><p>
					The example code passes two elements into the <code class="literal">CheckoutCallBack.checkout()</code> method. One element is the handle for the <code class="literal">JFrame</code> Swing component surrounding the output text frame, found at the bottom of the GUI. The second element is a list of order items, which comes from the <code class="literal">TableModel</code> that stores the information from the <code class="literal">Table</code> area at the upper-right section of the GUI.
				</p><p>
					The <code class="literal">for</code> loop transforms the list of order items coming from the GUI into the <code class="literal">Order</code> JavaBean, also contained in the file <code class="literal">PetStoreExample.java</code>.
				</p><p>
					In this case, the rule is firing in a stateless KIE session because all of the data is stored in Swing components and is not executed until the user clicks <span class="strong strong"><strong>Checkout</strong></span> in the UI. Each time the user clicks <span class="strong strong"><strong>Checkout</strong></span>, the content of the list is moved from the Swing <code class="literal">TableModel</code> into the KIE session working memory and is then executed with the <code class="literal">ksession.fireAllRules()</code> method.
				</p><p>
					Within this code, there are nine calls to <code class="literal">KieSession</code>. The first of these creates a new <code class="literal">KieSession</code> from the <code class="literal">KieContainer</code> (the example passed in this <code class="literal">KieContainer</code> from the <code class="literal">CheckoutCallBack</code> class in the <code class="literal">main()</code> method). The next two calls pass in the two objects that hold the global variables in the rules: the Swing text area and the Swing frame used for writing messages. More inserts put information on products into the <code class="literal">KieSession</code>, as well as the order list. The final call is the standard <code class="literal">fireAllRules()</code>.
				</p><h4 id="pet_store_rule_file_imports_global_variables_and_java_functions">Pet Store rule file imports, global variables, and Java functions</h4><p>
					The <code class="literal">PetStore.drl</code> file contains the standard package and import statements to make various Java classes available to the rules. The rule file also includes <span class="emphasis"><em>global variables</em></span> to be used within the rules, defined as <code class="literal">frame</code> and <code class="literal">textArea</code>. The global variables hold references to the Swing components <code class="literal">JFrame</code> and <code class="literal">JTextArea</code> components that were previously passed on by the Java code that called the <code class="literal">setGlobal()</code> method. Unlike standard variables in rules, which expire as soon as the rule has fired, global variables retain their value for the lifetime of the KIE session. This means the contents of these global variables are available for evaluation on all subsequent rules.
				</p><div class="formalpara"><p class="title"><strong>PetStore.drl package, imports, and global variables</strong></p><p>
						
<pre class="programlisting language-java">package org.drools.examples;

import org.kie.api.runtime.KieRuntime;
import org.drools.examples.petstore.PetStoreExample.Order;
import org.drools.examples.petstore.PetStoreExample.Purchase;
import org.drools.examples.petstore.PetStoreExample.Product;
import java.util.ArrayList;
import javax.swing.JOptionPane;

import javax.swing.JFrame;

global JFrame frame
global javax.swing.JTextArea textArea</pre>
					</p></div><p>
					The <code class="literal">PetStore.drl</code> file also contains two functions that the rules in the file use:
				</p><div class="formalpara"><p class="title"><strong>PetStore.drl Java functions</strong></p><p>
						
<pre class="programlisting language-java">function void doCheckout(JFrame frame, KieRuntime krt) {
        Object[] options = {"Yes",
                            "No"};

        int n = JOptionPane.showOptionDialog(frame,
                                             "Would you like to checkout?",
                                             "",
                                             JOptionPane.YES_NO_OPTION,
                                             JOptionPane.QUESTION_MESSAGE,
                                             null,
                                             options,
                                             options[0]);

       if (n == 0) {
            krt.getAgenda().getAgendaGroup( "checkout" ).setFocus();
       }
}

function boolean requireTank(JFrame frame, KieRuntime krt, Order order, Product fishTank, int total) {
        Object[] options = {"Yes",
                            "No"};

        int n = JOptionPane.showOptionDialog(frame,
                                             "Would you like to buy a tank for your " + total + " fish?",
                                             "Purchase Suggestion",
                                             JOptionPane.YES_NO_OPTION,
                                             JOptionPane.QUESTION_MESSAGE,
                                             null,
                                             options,
                                             options[0]);

       System.out.print( "SUGGESTION: Would you like to buy a tank for your "
                           + total + " fish? - " );

       if (n == 0) {
             Purchase purchase = new Purchase( order, fishTank );
             krt.insert( purchase );
             order.addItem( purchase );
             System.out.println( "Yes" );
       } else {
            System.out.println( "No" );
       }
       return true;
}</pre>
					</p></div><p>
					The two functions perform the following actions:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">doCheckout()</code> displays a dialog that asks the user if she or he wants to check out. If the user does, the focus is set to the <code class="literal">checkout</code> agenda group, enabling rules in that group to (potentially) fire.
						</li><li class="listitem">
							<code class="literal">requireTank()</code> displays a dialog that asks the user if she or he wants to buy a fish tank. If the user does, a new fish tank <code class="literal">Product</code> is added to the order list in the working memory.
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						For this example, all rules and functions are within the same rule file for efficiency. In a production environment, you typically separate the rules and functions in different files or build a static Java method and import the files using the import function, such as <code class="literal">import function my.package.name.hello</code>.
					</p></div></div><h4 id="pet_store_rules_with_agenda_groups">Pet Store rules with agenda groups</h4><p>
					Most of the rules in the Pet Store example use agenda groups to control rule execution. Agenda groups allow you to partition the decision engine agenda to provide more execution control over groups of rules. By default, all rules are in the agenda group <code class="literal">MAIN</code>. You can use the <code class="literal">agenda-group</code> attribute to specify a different agenda group for the rule.
				</p><p>
					Initially, a working memory has its focus on the agenda group <code class="literal">MAIN</code>. Rules in an agenda group only fire when the group receives the focus. You can set the focus either by using the method <code class="literal">setFocus()</code> or the rule attribute <code class="literal">auto-focus</code>. The <code class="literal">auto-focus</code> attribute enables the rule to be given a focus automatically for its agenda group when the rule is matched and activated.
				</p><p>
					The Pet Store example uses the following agenda groups for rules:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">"init"</code>
						</li><li class="listitem">
							<code class="literal">"evaluate"</code>
						</li><li class="listitem">
							<code class="literal">"show items"</code>
						</li><li class="listitem">
							<code class="literal">"checkout"</code>
						</li></ul></div><p>
					For example, the sample rule <code class="literal">"Explode Cart"</code> uses the <code class="literal">"init"</code> agenda group to ensure that it has the option to fire and insert shopping cart items into the KIE session working memory:
				</p><div class="formalpara"><p class="title"><strong>Rule "Explode Cart"</strong></p><p>
						
<pre class="screen">// Insert each item in the shopping cart into the working memory.
rule "Explode Cart"
    agenda-group "init"
    auto-focus true
    salience 10
  when
    $order : Order( grossTotal == -1 )
    $item : Purchase() from $order.items
  then
    insert( $item );
    kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup( "show items" ).setFocus();
    kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup( "evaluate" ).setFocus();
end</pre>
					</p></div><p>
					This rule matches against all orders that do not yet have their <code class="literal">grossTotal</code> calculated. The execution loops for each purchase item in that order.
				</p><p>
					The rule uses the following features related to its agenda group:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">agenda-group "init"</code> defines the name of the agenda group. In this case, only one rule is in the group. However, neither the Java code nor a rule consequence sets the focus to this group, and therefore it relies on the <code class="literal">auto-focus</code> attribute for its chance to fire.
						</li><li class="listitem">
							<code class="literal">auto-focus true</code> ensures that this rule, while being the only rule in the agenda group, gets a chance to fire when <code class="literal">fireAllRules()</code> is called from the Java code.
						</li><li class="listitem">
							<code class="literal">kcontext…​.setFocus()</code> sets the focus to the <code class="literal">"show items"</code> and <code class="literal">"evaluate"</code> agenda groups, enabling their rules to fire. In practice, you loop through all items in the order, insert them into memory, and then fire the other rules after each insertion.
						</li></ul></div><p>
					The <code class="literal">"show items"</code> agenda group contains only one rule, <code class="literal">"Show Items"</code>. For each purchase in the order currently in the KIE session working memory, the rule logs details to the text area at the bottom of the GUI, based on the <code class="literal">textArea</code> variable defined in the rule file.
				</p><div class="formalpara"><p class="title"><strong>Rule "Show Items"</strong></p><p>
						
<pre class="screen">rule "Show Items"
    agenda-group "show items"
  when
    $order : Order()
    $p : Purchase( order == $order )
  then
   textArea.append( $p.product + "\n");
end</pre>
					</p></div><p>
					The <code class="literal">"evaluate"</code> agenda group also gains focus from the <code class="literal">"Explode Cart"</code> rule. This agenda group contains two rules, <code class="literal">"Free Fish Food Sample"</code> and <code class="literal">"Suggest Tank"</code>, which are executed in that order.
				</p><div class="formalpara"><p class="title"><strong>Rule "Free Fish Food Sample"</strong></p><p>
						
<pre class="screen">// Free fish food sample when users buy a goldfish if they did not already buy
// fish food and do not already have a fish food sample.
rule "Free Fish Food Sample"
    agenda-group "evaluate" <span id="CO10-1"/><span class="callout">1</span>
  when
    $order : Order()
    not ( $p : Product( name == "Fish Food") &amp;&amp; Purchase( product == $p ) ) <span id="CO10-2"/><span class="callout">2</span>
    not ( $p : Product( name == "Fish Food Sample") &amp;&amp; Purchase( product == $p ) ) <span id="CO10-3"/><span class="callout">3</span>
    exists ( $p : Product( name == "Gold Fish") &amp;&amp; Purchase( product == $p ) ) <span id="CO10-4"/><span class="callout">4</span>
    $fishFoodSample : Product( name == "Fish Food Sample" );
  then
    System.out.println( "Adding free Fish Food Sample to cart" );
    purchase = new Purchase($order, $fishFoodSample);
    insert( purchase );
    $order.addItem( purchase );
end</pre>
					</p></div><p>
					The rule <code class="literal">"Free Fish Food Sample"</code> fires only if all of the following conditions are true:
				</p><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO10-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							The agenda group <code class="literal">"evaluate"</code> is being evaluated in the rules execution.
						</div></dd><dt><a href="#CO10-2"><span class="callout">2</span></a> </dt><dd><div class="para">
							User does not already have fish food.
						</div></dd><dt><a href="#CO10-3"><span class="callout">3</span></a> </dt><dd><div class="para">
							User does not already have a free fish food sample.
						</div></dd><dt><a href="#CO10-4"><span class="callout">4</span></a> </dt><dd><div class="para">
							User has a goldfish in the order.
						</div></dd></dl></div><p>
					If the order facts meet all of these requirements, then a new product is created (Fish Food Sample) and is added to the order in working memory.
				</p><div class="formalpara"><p class="title"><strong>Rule "Suggest Tank"</strong></p><p>
						
<pre class="screen">// Suggest a fish tank if users buy more than five goldfish and
// do not already have a tank.
rule "Suggest Tank"
    agenda-group "evaluate"
  when
    $order : Order()
    not ( $p : Product( name == "Fish Tank") &amp;&amp; Purchase( product == $p ) ) <span id="CO11-1"/><span class="callout">1</span>
    ArrayList( $total : size &gt; 5 ) from collect( Purchase( product.name == "Gold Fish" ) ) <span id="CO11-2"/><span class="callout">2</span>
    $fishTank : Product( name == "Fish Tank" )
  then
    requireTank(frame, kcontext.getKieRuntime(), $order, $fishTank, $total);
end</pre>
					</p></div><p>
					The rule <code class="literal">"Suggest Tank"</code> fires only if the following conditions are true:
				</p><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO11-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							User does not have a fish tank in the order.
						</div></dd><dt><a href="#CO11-2"><span class="callout">2</span></a> </dt><dd><div class="para">
							User has more than five fish in the order.
						</div></dd></dl></div><p>
					When the rule fires, it calls the <code class="literal">requireTank()</code> function defined in the rule file. This function displays a dialog that asks the user if she or he wants to buy a fish tank. If the user does, a new fish tank <code class="literal">Product</code> is added to the order list in the working memory. When the rule calls the <code class="literal">requireTank()</code> function, the rule passes the <code class="literal">frame</code> global variable so that the function has a handle for the Swing GUI.
				</p><p>
					The <code class="literal">"do checkout"</code> rule in the Pet Store example has no agenda group and no <code class="literal">when</code> conditions, so the rule is always executed and considered part of the default <code class="literal">MAIN</code> agenda group.
				</p><div class="formalpara"><p class="title"><strong>Rule "do checkout"</strong></p><p>
						
<pre class="screen">rule "do checkout"
  when
  then
    doCheckout(frame, kcontext.getKieRuntime());
end</pre>
					</p></div><p>
					When the rule fires, it calls the <code class="literal">doCheckout()</code> function defined in the rule file. This function displays a dialog that asks the user if she or he wants to check out. If the user does, the focus is set to the <code class="literal">checkout</code> agenda group, enabling rules in that group to (potentially) fire. When the rule calls the <code class="literal">doCheckout()</code> function, the rule passes the <code class="literal">frame</code> global variable so that the function has a handle for the Swing GUI.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						This example also demonstrates a troubleshooting technique if results are not executing as you expect: You can remove the conditions from the <code class="literal">when</code> statement of a rule and test the action in the <code class="literal">then</code> statement to verify that the action is performed correctly.
					</p></div></div><p>
					The <code class="literal">"checkout"</code> agenda group contains three rules for processing the order checkout and applying any discounts: <code class="literal">"Gross Total"</code>, <code class="literal">"Apply 5% Discount"</code>, and <code class="literal">"Apply 10% Discount"</code>.
				</p><div class="formalpara"><p class="title"><strong>Rules "Gross Total", "Apply 5% Discount", and "Apply 10% Discount"</strong></p><p>
						
<pre class="screen">rule "Gross Total"
    agenda-group "checkout"
  when
    $order : Order( grossTotal == -1)
    Number( total : doubleValue ) from accumulate( Purchase( $price : product.price ),
                                                              sum( $price ) )
  then
    modify( $order ) { grossTotal = total }
    textArea.append( "\ngross total=" + total + "\n" );
end

rule "Apply 5% Discount"
    agenda-group "checkout"
  when
    $order : Order( grossTotal &gt;= 10 &amp;&amp; &lt; 20 )
  then
    $order.discountedTotal = $order.grossTotal * 0.95;
    textArea.append( "discountedTotal total=" + $order.discountedTotal + "\n" );
end

rule "Apply 10% Discount"
    agenda-group "checkout"
  when
    $order : Order( grossTotal &gt;= 20 )
  then
    $order.discountedTotal = $order.grossTotal * 0.90;
    textArea.append( "discountedTotal total=" + $order.discountedTotal + "\n" );
end</pre>
					</p></div><p>
					If the user has not already calculated the gross total, the <code class="literal">Gross Total</code> accumulates the product prices into a total, puts this total into the KIE session, and displays it through the Swing <code class="literal">JTextArea</code> using the <code class="literal">textArea</code> global variable.
				</p><p>
					If the gross total is between <code class="literal">10</code> and <code class="literal">20</code> (currency units), the <code class="literal">"Apply 5% Discount"</code> rule calculates the discounted total, adds it to the KIE session, and displays it in the text area.
				</p><p>
					If the gross total is not less than <code class="literal">20</code>, the <code class="literal">"Apply 10% Discount"</code> rule calculates the discounted total, adds it to the KIE session, and displays it in the text area.
				</p><h4 id="pet_store_example_execution">Pet Store example execution</h4><p>
					Similar to other Red Hat Process Automation Manager decision examples, you execute the Pet Store example by running the <code class="literal">org.drools.examples.petstore.PetStoreExample</code> class as a Java application in your IDE.
				</p><p>
					When you execute the Pet Store example, the <code class="literal">Pet Store Demo</code> GUI window appears. This window displays a list of available products (upper left), an empty list of selected products (upper right), <span class="strong strong"><strong>Checkout</strong></span> and <span class="strong strong"><strong>Reset</strong></span> buttons (middle), and an empty system messages area (bottom).
				</p><div class="figure" id="idm139921812700512"><p class="title"><strong>Figure 20.14. Pet Store example GUI after launch</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/PetStoreExample/1-PetStore-Start-Screen.png" alt="1 PetStore Start Screen"/></div></div></div><p>
					The following events occurred in this example to establish this execution behavior:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							The <code class="literal">main()</code> method has run and loaded the rule base but has not yet fired the rules. So far, this is the only code in connection with rules that has been run.
						</li><li class="listitem">
							A new <code class="literal">PetStoreUI</code> object has been created and given a handle for the rule base, for later use.
						</li><li class="listitem">
							Various Swing components have performed their functions, and the initial UI screen is displayed and waits for user input.
						</li></ol></div><p>
					You can click various products from the list to explore the UI setup:
				</p><div class="figure" id="idm139921812791232"><p class="title"><strong>Figure 20.15. Explore the Pet Store example GUI</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/PetStoreExample/2-stock-added-to-order-list.png" alt="2 stock added to order list"/></div></div></div><p>
					No rules code has been fired yet. The UI uses Swing code to detect user mouse clicks and add selected products to the <code class="literal">TableModel</code> object for display in the upper-right corner of the UI. This example illustrates the Model-View-Controller design pattern.
				</p><p>
					When you click <span class="strong strong"><strong>Checkout</strong></span>, the rules are then fired in the following way:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Method <code class="literal">CheckOutCallBack.checkout()</code> is called (eventually) by the Swing class waiting for a user to click <span class="strong strong"><strong>Checkout</strong></span>. This inserts the data from the <code class="literal">TableModel</code> object (upper-right corner of the UI) into the KIE session working memory. The method then fires the rules.
						</li><li class="listitem"><p class="simpara">
							The <code class="literal">"Explode Cart"</code> rule is the first to fire, with the <code class="literal">auto-focus</code> attribute set to <code class="literal">true</code>. The rule loops through all of the products in the cart, ensures that the products are in the working memory, and then gives the <code class="literal">"show Items"</code> and <code class="literal">"evaluate"</code> agenda groups the option to fire. The rules in these groups add the contents of the cart to the text area (bottom of the UI), evaluate if you are eligible for free fish food, and determine whether to ask if you want to buy a fish tank.
						</p><div class="figure" id="idm139921812777504"><p class="title"><strong>Figure 20.16. Fish tank qualification</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/PetStoreExample/3-purchase-suggestion.png" alt="3 purchase suggestion"/></div></div></div></li><li class="listitem">
							The <code class="literal">"do checkout"</code> rule is the next to fire because no other agenda group currently has focus and because it is part of the default <code class="literal">MAIN</code> agenda group. This rule always calls the <code class="literal">doCheckout()</code> function, which asks you if you want to check out.
						</li><li class="listitem">
							The <code class="literal">doCheckout()</code> function sets the focus to the <code class="literal">"checkout"</code> agenda group, giving the rules in that group the option to fire.
						</li><li class="listitem">
							The rules in the <code class="literal">"checkout"</code> agenda group display the contents of the cart and apply the appropriate discount.
						</li><li class="listitem"><p class="simpara">
							Swing then waits for user input to either select more products (and cause the rules to fire again) or to close the UI.
						</p><div class="figure" id="idm139921814432576"><p class="title"><strong>Figure 20.17. Pet Store example GUI after all rules have fired</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/PetStoreExample/4-Petstore-final-screen.png" alt="4 Petstore final screen"/></div></div></div></li></ol></div><p>
					You can add more <code class="literal">System.out</code> calls to demonstrate this flow of events in your IDE console:
				</p><div class="formalpara"><p class="title"><strong>System.out output in the IDE console</strong></p><p>
						
<pre class="screen">Adding free Fish Food Sample to cart
SUGGESTION: Would you like to buy a tank for your 6 fish? - Yes</pre>
					</p></div></section><section class="section" id="decision-examples-politician-ref_drl-rules"><div class="titlepage"><div><div><h2 class="title">20.7. Honest Politician example decisions (truth maintenance and salience)</h2></div></div></div><p>
					The Honest Politician example decision set demonstrates the concept of truth maintenance with logical insertions and the use of salience in rules.
				</p><p>
					The following is an overview of the Honest Politician example:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Name</strong></span>: <code class="literal">honestpolitician</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Main class</strong></span>: <code class="literal">org.drools.examples.honestpolitician.HonestPoliticianExample</code> (in <code class="literal">src/main/java</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Module</strong></span>: <code class="literal">drools-examples</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Type</strong></span>: Java application
						</li><li class="listitem">
							<span class="strong strong"><strong>Rule file</strong></span>: <code class="literal">org.drools.examples.honestpolitician.HonestPolitician.drl</code> (in <code class="literal">src/main/resources</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Objective</strong></span>: Demonstrates the concept of truth maintenance based on the logical insertion of facts and the use of salience in rules
						</li></ul></div><p>
					The basic premise of the Honest Politician example is that an object can only exist while a statement is true. A rule consequence can logically insert an object with the <code class="literal">insertLogical()</code> method. This means the object remains in the KIE session working memory as long as the rule that logically inserted it remains true. When the rule is no longer true, the object is automatically retracted.
				</p><p>
					In this example, rule execution causes a group of politicians to change from being honest to being dishonest as a result of a corrupt corporation. As each politician is evaluated, they start out with their honesty attribute being set to <code class="literal">true</code>, but a rule fires that makes the politicians no longer honest. As they switch their state from being honest to dishonest, they are then removed from the working memory. The rule salience notifies the decision engine how to prioritize any rules that have a salience defined for them, otherwise utilizing the default salience value of <code class="literal">0</code>. Rules with a higher salience value are given higher priority when ordered in the activation queue.
				</p><h4 id="politician_and_hope_classes">Politician and Hope classes</h4><p>
					The sample class <code class="literal">Politician</code> in the example is configured for an honest politician. The <code class="literal">Politician</code> class is made up of a String item <code class="literal">name</code> and a Boolean item <code class="literal">honest</code>:
				</p><div class="formalpara"><p class="title"><strong>Politician class</strong></p><p>
						
<pre class="programlisting language-java">public class Politician {
    private String name;
    private boolean honest;
    ...
}</pre>
					</p></div><p>
					The <code class="literal">Hope</code> class determines if a <code class="literal">Hope</code> object exists. This class has no meaningful members, but is present in the working memory as long as society has hope.
				</p><div class="formalpara"><p class="title"><strong>Hope class</strong></p><p>
						
<pre class="programlisting language-java">public class Hope {

    public Hope() {

    }
  }</pre>
					</p></div><h4 id="rule_definitions_for_politician_honesty">Rule definitions for politician honesty</h4><p>
					In the Honest Politician example, when at least one honest politician exists in the working memory, the <code class="literal">"We have an honest Politician"</code> rule logically inserts a new <code class="literal">Hope</code> object. As soon as all politicians become dishonest, the <code class="literal">Hope</code> object is automatically retracted. This rule has a <code class="literal">salience</code> attribute with a value of <code class="literal">10</code> to ensure that it fires before any other rule, because at that stage the <code class="literal">"Hope is Dead"</code> rule is true.
				</p><div class="formalpara"><p class="title"><strong>Rule "We have an honest politician"</strong></p><p>
						
<pre class="screen">rule "We have an honest Politician"
    salience 10
  when
    exists( Politician( honest == true ) )
  then
    insertLogical( new Hope() );
end</pre>
					</p></div><p>
					As soon as a <code class="literal">Hope</code> object exists, the <code class="literal">"Hope Lives"</code> rule matches and fires. This rule also has a <code class="literal">salience</code> value of <code class="literal">10</code> so that it takes priority over the <code class="literal">"Corrupt the Honest"</code> rule.
				</p><div class="formalpara"><p class="title"><strong>Rule "Hope Lives"</strong></p><p>
						
<pre class="screen">rule "Hope Lives"
    salience 10
  when
    exists( Hope() )
  then
    System.out.println("Hurrah!!! Democracy Lives");
end</pre>
					</p></div><p>
					Initially, four honest politicians exist so this rule has four activations, all in conflict. Each rule fires in turn, corrupting each politician so that they are no longer honest. When all four politicians have been corrupted, no politicians have the property <code class="literal">honest == true</code>. The rule <code class="literal">"We have an honest Politician"</code> is no longer true and the object it logically inserted (due to the last execution of <code class="literal">new Hope()</code>) is automatically retracted.
				</p><div class="formalpara"><p class="title"><strong>Rule "Corrupt the Honest"</strong></p><p>
						
<pre class="screen">rule "Corrupt the Honest"
  when
    politician : Politician( honest == true )
    exists( Hope() )
  then
    System.out.println( "I'm an evil corporation and I have corrupted " + politician.getName() );
    modify ( politician ) { honest = false };
end</pre>
					</p></div><p>
					With the <code class="literal">Hope</code> object automatically retracted through the truth maintenance system, the conditional element <code class="literal">not</code> applied to <code class="literal">Hope</code> is no longer true so that the <code class="literal">"Hope is Dead"</code> rule matches and fires.
				</p><div class="formalpara"><p class="title"><strong>Rule "Hope is Dead"</strong></p><p>
						
<pre class="screen">rule "Hope is Dead"
  when
    not( Hope() )
  then
    System.out.println( "We are all Doomed!!! Democracy is Dead" );
end</pre>
					</p></div><h4 id="example_execution_and_audit_trail">Example execution and audit trail</h4><p>
					In the <code class="literal">HonestPoliticianExample.java</code> class, the four politicians with the honest state set to <code class="literal">true</code> are inserted for evaluation against the defined business rules:
				</p><div class="formalpara"><p class="title"><strong>HonestPoliticianExample.java class execution</strong></p><p>
						
<pre class="programlisting language-java">public static void execute( KieContainer kc ) {
        KieSession ksession = kc.newKieSession("HonestPoliticianKS");

        final Politician p1 = new Politician( "President of Umpa Lumpa", true );
        final Politician p2 = new Politician( "Prime Minster of Cheeseland", true );
        final Politician p3 = new Politician( "Tsar of Pringapopaloo", true );
        final Politician p4 = new Politician( "Omnipotence Om", true );

        ksession.insert( p1 );
        ksession.insert( p2 );
        ksession.insert( p3 );
        ksession.insert( p4 );

        ksession.fireAllRules();

        ksession.dispose();
    }</pre>
					</p></div><p>
					To execute the example, run the <code class="literal">org.drools.examples.honestpolitician.HonestPoliticianExample</code> class as a Java application in your IDE.
				</p><p>
					After the execution, the following output appears in the IDE console window:
				</p><div class="formalpara"><p class="title"><strong>Execution output in the IDE console</strong></p><p>
						
<pre class="screen">Hurrah!!! Democracy Lives
I'm an evil corporation and I have corrupted President of Umpa Lumpa
I'm an evil corporation and I have corrupted Prime Minster of Cheeseland
I'm an evil corporation and I have corrupted Tsar of Pringapopaloo
I'm an evil corporation and I have corrupted Omnipotence Om
We are all Doomed!!! Democracy is Dead</pre>
					</p></div><p>
					The output shows that, while there is at least one honest politician, democracy lives. However, as each politician is corrupted by some corporation, all politicians become dishonest, and democracy is dead.
				</p><p>
					To better understand the execution flow of this example, you can modify the <code class="literal">HonestPoliticianExample.java</code> class to include a <code class="literal">DebugRuleRuntimeEventListener</code> listener and an audit logger to view execution details:
				</p><div class="formalpara"><p class="title"><strong>HonestPoliticianExample.java class with an audit logger</strong></p><p>
						
<pre class="programlisting language-java">package org.drools.examples.honestpolitician;

import org.kie.api.KieServices;
import org.kie.api.event.rule.DebugAgendaEventListener; <span id="CO12-1"/><span class="callout">1</span>
import org.kie.api.event.rule.DebugRuleRuntimeEventListener;
import org.kie.api.runtime.KieContainer;
import org.kie.api.runtime.KieSession;

public class HonestPoliticianExample {

    /**
     * @param args
     */
    public static void main(final String[] args) {
    	KieServices ks = KieServices.Factory.get(); <span id="CO12-2"/><span class="callout">2</span>
    	//ks = KieServices.Factory.get();
        KieContainer kc = KieServices.Factory.get().getKieClasspathContainer();
        System.out.println(kc.verify().getMessages().toString());
        //execute( kc );
        execute( ks, kc); <span id="CO12-3"/><span class="callout">3</span>
    }

    public static void execute( KieServices ks, KieContainer kc ) { <span id="CO12-4"/><span class="callout">4</span>
        KieSession ksession = kc.newKieSession("HonestPoliticianKS");

        final Politician p1 = new Politician( "President of Umpa Lumpa", true );
        final Politician p2 = new Politician( "Prime Minster of Cheeseland", true );
        final Politician p3 = new Politician( "Tsar of Pringapopaloo", true );
        final Politician p4 = new Politician( "Omnipotence Om", true );

        ksession.insert( p1 );
        ksession.insert( p2 );
        ksession.insert( p3 );
        ksession.insert( p4 );

        // The application can also setup listeners <span id="CO12-5"/><span class="callout">5</span>
        ksession.addEventListener( new DebugAgendaEventListener() );
        ksession.addEventListener( new DebugRuleRuntimeEventListener() );

        // Set up a file-based audit logger.
        ks.getLoggers().newFileLogger( ksession, "./target/honestpolitician" ); <span id="CO12-6"/><span class="callout">6</span>

        ksession.fireAllRules();

        ksession.dispose();
    }

}</pre>
					</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO12-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							Adds to your imports the packages that handle the <code class="literal">DebugAgendaEventListener</code> and <code class="literal">DebugRuleRuntimeEventListener</code>
						</div></dd><dt><a href="#CO12-2"><span class="callout">2</span></a> </dt><dd><div class="para">
							Creates a <code class="literal">KieServices Factory</code> and a <code class="literal">ks</code> element to produce the logs because this audit log is not available at the <code class="literal">KieContainer</code> level
						</div></dd><dt><a href="#CO12-3"><span class="callout">3</span></a> </dt><dd><div class="para">
							Modifies the <code class="literal">execute</code> method to use both <code class="literal">KieServices</code> and <code class="literal">KieContainer</code>
						</div></dd><dt><a href="#CO12-4"><span class="callout">4</span></a> </dt><dd><div class="para">
							Modifies the <code class="literal">execute</code> method to pass in <code class="literal">KieServices</code> in addition to the <code class="literal">KieContainer</code>
						</div></dd><dt><a href="#CO12-5"><span class="callout">5</span></a> </dt><dd><div class="para">
							Creates the listeners
						</div></dd><dt><a href="#CO12-6"><span class="callout">6</span></a> </dt><dd><div class="para">
							Builds the log that can be passed into the debug view or <span class="strong strong"><strong>Audit View</strong></span> or your IDE after executing of the rules
						</div></dd></dl></div><p>
					When you run the Honest Politician with this modified logging capability, you can load the audit log file from <code class="literal">target/honestpolitician.log</code> into your IDE debug view or <span class="strong strong"><strong>Audit View</strong></span>, if available (for example, in <span class="strong strong"><strong>Window</strong></span> → <span class="strong strong"><strong>Show View</strong></span> in some IDEs).
				</p><p>
					In this example, the <span class="strong strong"><strong>Audit View</strong></span> shows the flow of executions, insertions, and retractions as defined in the example classes and rules:
				</p><div class="figure" id="idm139921816991408"><p class="title"><strong>Figure 20.18. Honest Politician example Audit View</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/HonestPoliticianExample/honest_politician_audit.png" alt="honest politician audit"/></div></div></div><p>
					When the first politician is inserted, two activations occur. The rule <code class="literal">"We have an honest Politician"</code> is activated only one time for the first inserted politician because it uses an <code class="literal">exists</code> conditional element, which matches when at least one politician is inserted. The rule <code class="literal">"Hope is Dead"</code> is also activated at this stage because the <code class="literal">Hope</code> object is not yet inserted. The rule <code class="literal">"We have an honest Politician"</code> fires first because it has a higher <code class="literal">salience</code> value than the rule <code class="literal">"Hope is Dead"</code>, and inserts the <code class="literal">Hope</code> object (highlighted in green). The insertion of the <code class="literal">Hope</code> object activates the rule <code class="literal">"Hope Lives"</code> and deactivates the rule <code class="literal">"Hope is Dead"</code>. The insertion also activates the rule <code class="literal">"Corrupt the Honest"</code> for each inserted honest politician. The rule <code class="literal">"Hope Lives"</code> is executed and prints <code class="literal">"Hurrah!!! Democracy Lives"</code>.
				</p><p>
					Next, for each politician, the rule <code class="literal">"Corrupt the Honest"</code> fires, printing <code class="literal">"I’m an evil corporation and I have corrupted X"</code>, where <code class="literal">X</code> is the name of the politician, and modifies the politician honesty value to <code class="literal">false</code>. When the last honest politician is corrupted, <code class="literal">Hope</code> is automatically retracted by the truth maintenance system (highlighted in blue). The green highlighted area shows the origin of the currently selected blue highlighted area. After the <code class="literal">Hope</code> fact is retracted, the rule <code class="literal">"Hope is dead"</code> fires, printing <code class="literal">"We are all Doomed!!! Democracy is Dead"</code>.
				</p></section><section class="section" id="decision-examples-sudoku-ref_drl-rules"><div class="titlepage"><div><div><h2 class="title">20.8. Sudoku example decisions (complex pattern matching, callbacks, and GUI integration)</h2></div></div></div><p>
					The Sudoku example decision set, based on the popular number puzzle Sudoku, demonstrates how to use rules in Red Hat Process Automation Manager to find a solution in a large potential solution space based on various constraints. This example also shows how to integrate Red Hat Process Automation Manager rules into a graphical user interface (GUI), in this case a Swing-based desktop application, and how to use callbacks to interact with a running decision engine to update the GUI based on changes in the working memory at run time.
				</p><p>
					The following is an overview of the Sudoku example:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Name</strong></span>: <code class="literal">sudoku</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Main class</strong></span>: <code class="literal">org.drools.examples.sudoku.SudokuExample</code> (in <code class="literal">src/main/java</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Module</strong></span>: <code class="literal">drools-examples</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Type</strong></span>: Java application
						</li><li class="listitem">
							<span class="strong strong"><strong>Rule files</strong></span>: <code class="literal">org.drools.examples.sudoku.*.drl</code> (in <code class="literal">src/main/resources</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Objective</strong></span>: Demonstrates complex pattern matching, problem solving, callbacks, and GUI integration
						</li></ul></div><p>
					Sudoku is a logic-based number placement puzzle. The objective is to fill a 9x9 grid so that each column, each row, and each of the nine 3x3 zones contains the digits from 1 to 9 only one time. The puzzle setter provides a partially completed grid and the puzzle solver’s task is to complete the grid with these constraints.
				</p><p>
					The general strategy to solve the problem is to ensure that when you insert a new number, it must be unique in its particular 3x3 zone, row, and column. This Sudoku example decision set uses Red Hat Process Automation Manager rules to solve Sudoku puzzles from a range of difficulty levels, and to attempt to resolve flawed puzzles that contain invalid entries.
				</p><h4 id="sudoku_example_execution_and_interaction">Sudoku example execution and interaction</h4><p>
					Similar to other Red Hat Process Automation Manager decision examples, you execute the Sudoku example by running the <code class="literal">org.drools.examples.sudoku.SudokuExample</code> class as a Java application in your IDE.
				</p><p>
					When you execute the Sudoku example, the <code class="literal">Drools Sudoku Example</code> GUI window appears. This window contains an empty grid, but the program comes with various grids stored internally that you can load and solve.
				</p><p>
					Click <span class="strong strong"><strong>File</strong></span> → <span class="strong strong"><strong>Samples</strong></span> → <span class="strong strong"><strong>Simple</strong></span> to load one of the examples. Notice that all buttons are disabled until a grid is loaded.
				</p><div class="figure" id="idm139921812763040"><p class="title"><strong>Figure 20.19. Sudoku example GUI after launch</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/SudokuExample/sudoku1.png" alt="sudoku1"/></div></div></div><p>
					When you load the <span class="strong strong"><strong>Simple</strong></span> example, the grid is filled according to the puzzle’s initial state.
				</p><div class="figure" id="idm139921812757456"><p class="title"><strong>Figure 20.20. Sudoku example GUI after loading Simple sample</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/SudokuExample/sudoku2.png" alt="sudoku2"/></div></div></div><p>
					Choose from the following options:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Solve</strong></span> to fire the rules defined in the Sudoku example that fill out the remaining values and that make the buttons inactive again.
						</p><div class="figure" id="idm139921812750752"><p class="title"><strong>Figure 20.21. Simple sample solved</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/SudokuExample/sudoku3.png" alt="sudoku3"/></div></div></div></li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Step</strong></span> to see the next digit found by the rule set. The console window in your IDE displays detailed information about the rules that are executing to solve the step.
						</p><div class="formalpara"><p class="title"><strong>Step execution output in the IDE console</strong></p><p>
								
<pre class="screen">single 8 at [0,1]
column elimination due to [1,2]: remove 9 from [4,2]
hidden single 9 at [1,2]
row elimination due to [2,8]: remove 7 from [2,4]
remove 6 from [3,8] due to naked pair at [3,2] and [3,7]
hidden pair in row at [4,6] and [4,4]</pre>
							</p></div></li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Dump</strong></span> to see the state of the grid, with cells showing either the established value or the remaining possibilities.
						</p><div class="formalpara"><p class="title"><strong>Dump execution output in the IDE console</strong></p><p>
								
<pre class="screen">        Col: 0     Col: 1     Col: 2     Col: 3     Col: 4     Col: 5     Col: 6     Col: 7     Col: 8
Row 0:  123456789  --- 5 ---  --- 6 ---  --- 8 ---  123456789  --- 1 ---  --- 9 ---  --- 4 ---  123456789
Row 1:  --- 9 ---  123456789  123456789  --- 6 ---  123456789  --- 5 ---  123456789  123456789  --- 3 ---
Row 2:  --- 7 ---  123456789  123456789  --- 4 ---  --- 9 ---  --- 3 ---  123456789  123456789  --- 8 ---
Row 3:  --- 8 ---  --- 9 ---  --- 7 ---  123456789  --- 4 ---  123456789  --- 6 ---  --- 3 ---  --- 5 ---
Row 4:  123456789  123456789  --- 3 ---  --- 9 ---  123456789  --- 6 ---  --- 8 ---  123456789  123456789
Row 5:  --- 4 ---  --- 6 ---  --- 5 ---  123456789  --- 8 ---  123456789  --- 2 ---  --- 9 ---  --- 1 ---
Row 6:  --- 5 ---  123456789  123456789  --- 2 ---  --- 6 ---  --- 9 ---  123456789  123456789  --- 7 ---
Row 7:  --- 6 ---  123456789  123456789  --- 5 ---  123456789  --- 4 ---  123456789  123456789  --- 9 ---
Row 8:  123456789  --- 4 ---  --- 9 ---  --- 7 ---  123456789  --- 8 ---  --- 3 ---  --- 5 ---  123456789</pre>
							</p></div></li></ul></div><p>
					The Sudoku example includes a deliberately broken sample file that the rules defined in the example can resolve.
				</p><p>
					Click <span class="strong strong"><strong>File</strong></span> → <span class="strong strong"><strong>Samples</strong></span> → <span class="strong strong"><strong>!DELIBERATELY BROKEN!</strong></span> to load the broken sample. The grid starts with some issues, for example, the value <code class="literal">5</code> appears two times in the first row, which is not allowed.
				</p><div class="figure" id="idm139921812994528"><p class="title"><strong>Figure 20.22. Broken Sudoku example initial state</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/SudokuExample/sudoku4.png" alt="sudoku4"/></div></div></div><p>
					Click <span class="strong strong"><strong>Solve</strong></span> to apply the solving rules to this invalid grid. The associated solving rules in the Sudoku example detect the issues in the sample and attempts to solve the puzzle as far as possible. This process does not complete and leaves some cells empty.
				</p><p>
					The solving rule activity is displayed in the IDE console window:
				</p><div class="formalpara"><p class="title"><strong>Detected issues in the broken sample</strong></p><p>
						
<pre class="screen">cell [0,8]: 5 has a duplicate in row 0
cell [0,0]: 5 has a duplicate in row 0
cell [6,0]: 8 has a duplicate in col 0
cell [4,0]: 8 has a duplicate in col 0
Validation complete.</pre>
					</p></div><div class="figure" id="idm139921812986224"><p class="title"><strong>Figure 20.23. Broken sample solution attempt</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/SudokuExample/sudoku5.png" alt="sudoku5"/></div></div></div><p>
					The sample Sudoku files labeled <span class="strong strong"><strong>Hard</strong></span> are more complex and the solving rules might not be able to solve them. The unsuccessful solution attempt is displayed in the IDE console window:
				</p><div class="formalpara"><p class="title"><strong>Hard sample unresolved</strong></p><p>
						
<pre class="screen">Validation complete.
...
Sorry - can't solve this grid.</pre>
					</p></div><p>
					The rules that work to solve the broken sample implement standard solving techniques based on the sets of values that are still candidates for a cell. For example, if a set contains a single value, then this is the value for the cell. For a single occurrence of a value in one of the groups of nine cells, the rules insert a fact of type <code class="literal">Setting</code> with the solution value for some specific cell. This fact causes the elimination of this value from all other cells in any of the groups the cell belongs to and the value is retracted.
				</p><p>
					Other rules in the example reduce the permissible values for some cells. The rules <code class="literal">"naked pair"</code>, <code class="literal">"hidden pair in row"</code>, <code class="literal">"hidden pair in column"</code>, and <code class="literal">"hidden pair in square"</code> eliminate possibilities but do not establish solutions. The rules <code class="literal">"X-wings in rows"</code>, "`X-wings in columns"`, <code class="literal">"intersection removal row"</code>, and <code class="literal">"intersection removal column"</code> perform more sophisticated eliminations.
				</p><h4 id="sudoku_example_classes">Sudoku example classes</h4><p>
					The package <code class="literal">org.drools.examples.sudoku.swing</code> contains the following core set of classes that implement a framework for Sudoku puzzles:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal">SudokuGridModel</code> class defines an interface that is implemented to store a Sudoku puzzle as a 9x9 grid of <code class="literal">Cell</code> objects.
						</li><li class="listitem">
							The <code class="literal">SudokuGridView</code> class is a Swing component that can visualize any implementation of the <code class="literal">SudokuGridModel</code> class.
						</li><li class="listitem">
							The <code class="literal">SudokuGridEvent</code> and <code class="literal">SudokuGridListener</code> classes communicate state changes between the model and the view. Events are fired when a cell value is resolved or changed.
						</li><li class="listitem">
							The <code class="literal">SudokuGridSamples</code> class provides partially filled Sudoku puzzles for demonstration purposes.
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						This package does not have any dependencies on Red Hat Process Automation Manager libraries.
					</p></div></div><p>
					The package <code class="literal">org.drools.examples.sudoku</code> contains the following core set of classes that implement the elementary <code class="literal">Cell</code> object and its various aggregations:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal">CellFile</code> class, with subtypes <code class="literal">CellRow</code>, <code class="literal">CellCol</code>, and <code class="literal">CellSqr</code>, all of which are subtypes of the <code class="literal">CellGroup</code> class.
						</li><li class="listitem"><p class="simpara">
							The <code class="literal">Cell</code> and <code class="literal">CellGroup</code> subclasses of <code class="literal">SetOfNine</code>, which provides a property <code class="literal">free</code> with the type <code class="literal">Set&lt;Integer&gt;</code>. For a <code class="literal">Cell</code> class, the set represents the individual candidate set. For a <code class="literal">CellGroup</code> class, the set is the union of all candidate sets of its cells (the set of digits that still need to be allocated).
						</p><p class="simpara">
							In the Sudoku example are 81 <code class="literal">Cell</code> and 27 <code class="literal">CellGroup</code> objects and a linkage provided by the <code class="literal">Cell</code> properties <code class="literal">cellRow</code>, <code class="literal">cellCol</code>, and <code class="literal">cellSqr</code>, and by the <code class="literal">CellGroup</code> property <code class="literal">cells</code> (a list of <code class="literal">Cell</code> objects). With these components, you can write rules that detect the specific situations that permit the allocation of a value to a cell or the elimination of a value from some candidate set.
						</p></li><li class="listitem">
							The <code class="literal">Setting</code> class is used to trigger the operations that accompany the allocation of a value. The presence of a <code class="literal">Setting</code> fact is used in all rules that detect a new situation in order to avoid reactions to inconsistent intermediary states.
						</li><li class="listitem">
							The <code class="literal">Stepping</code> class is used in a low priority rule to execute an emergency halt when a <code class="literal">"Step"</code> does not terminate regularly. This behavior indicates that the program cannot solve the puzzle.
						</li><li class="listitem">
							The main class <code class="literal">org.drools.examples.sudoku.SudokuExample</code> implements a Java application combining all of these components.
						</li></ul></div><h4 id="sudoku_validation_rules_validate_drl">Sudoku validation rules (validate.drl)</h4><p>
					The <code class="literal">validate.drl</code> file in the Sudoku example contains validation rules that detect duplicate numbers in cell groups. They are combined in a <code class="literal">"validate"</code> agenda group that enables the rules to be explicitly activated after a user loads the puzzle.
				</p><p>
					The <code class="literal">when</code> conditions of the three rules <code class="literal">"duplicate in cell …​"</code> all function in the following ways:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The first condition in the rule locates a cell with an allocated value.
						</li><li class="listitem">
							The second condition in the rule pulls in any of the three cell groups to which the cell belongs.
						</li><li class="listitem">
							The final condition finds a cell (other than the first one) with the same value as the first cell and in the same row, column, or square, depending on the rule.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Rules "duplicate in cell …​"</strong></p><p>
						
<pre class="screen">rule "duplicate in cell row"
  when
    $c: Cell( $v: value != null )
    $cr: CellRow( cells contains $c )
    exists Cell( this != $c, value == $v, cellRow == $cr )
  then
    System.out.println( "cell " + $c.toString() + " has a duplicate in row " + $cr.getNumber() );
end

rule "duplicate in cell col"
  when
    $c: Cell( $v: value != null )
    $cc: CellCol( cells contains $c )
    exists Cell( this != $c, value == $v, cellCol == $cc )
  then
    System.out.println( "cell " + $c.toString() + " has a duplicate in col " + $cc.getNumber() );
end

rule "duplicate in cell sqr"
  when
    $c: Cell( $v: value != null )
    $cs: CellSqr( cells contains $c )
    exists Cell( this != $c, value == $v, cellSqr == $cs )
  then
    System.out.println( "cell " + $c.toString() + " has duplicate in its square of nine." );
end</pre>
					</p></div><p>
					The rule <code class="literal">"terminate group"</code> is the last to fire. This rule prints a message and stops the sequence.
				</p><div class="formalpara"><p class="title"><strong>Rule "terminate group"</strong></p><p>
						
<pre class="screen">rule "terminate group"
    salience -100
  when
  then
    System.out.println( "Validation complete." );
    drools.halt();
end</pre>
					</p></div><h4 id="sudoku_solving_rules_sudoku_drl">Sudoku solving rules (sudoku.drl)</h4><p>
					The <code class="literal">sudoku.drl</code> file in the Sudoku example contains three types of rules: one group handles the allocation of a number to a cell, another group detects feasible allocations, and the third group eliminates values from candidate sets.
				</p><p>
					The rules <code class="literal">"set a value"</code>, <code class="literal">"eliminate a value from Cell"</code>, and <code class="literal">"retract setting"</code> depend on the presence of a <code class="literal">Setting</code> object. The first rule handles the assignment to the cell and the operations for removing the value from the <code class="literal">free</code> sets of the three groups of the cell. This group also reduces a counter that, when zero, returns control to the Java application that has called <code class="literal">fireUntilHalt()</code>.
				</p><p>
					The purpose of the rule <code class="literal">"eliminate a value from Cell"</code> is to reduce the candidate lists of all cells that are related to the newly assigned cell. Finally, when all eliminations have been made, the rule <code class="literal">"retract setting"</code> retracts the triggering <code class="literal">Setting</code> fact.
				</p><div class="formalpara"><p class="title"><strong>Rules "set a value", "eliminate a value from a Cell", and "retract setting"</strong></p><p>
						
<pre class="screen">// A Setting object is inserted to define the value of a Cell.
// Rule for updating the cell and all cell groups that contain it
rule "set a value"
  when
    // A Setting with row and column number, and a value
    $s: Setting( $rn: rowNo, $cn: colNo, $v: value )

    // A matching Cell, with no value set
    $c: Cell( rowNo == $rn, colNo == $cn, value == null,
              $cr: cellRow, $cc: cellCol, $cs: cellSqr )

    // Count down
    $ctr: Counter( $count: count )
  then
    // Modify the Cell by setting its value.
    modify( $c ){ setValue( $v ) }
    // System.out.println( "set cell " + $c.toString() );
    modify( $cr ){ blockValue( $v ) }
    modify( $cc ){ blockValue( $v ) }
    modify( $cs ){ blockValue( $v ) }
    modify( $ctr ){ setCount( $count - 1 ) }
end

// Rule for removing a value from all cells that are siblings
// in one of the three cell groups
rule "eliminate a value from Cell"
  when
    // A Setting with row and column number, and a value
    $s: Setting( $rn: rowNo, $cn: colNo, $v: value )

    // The matching Cell, with the value already set
    Cell( rowNo == $rn, colNo == $cn, value == $v, $exCells: exCells )

    // For all Cells that are associated with the updated cell
    $c: Cell( free contains $v ) from $exCells
  then
    // System.out.println( "clear " + $v + " from cell " + $c.posAsString()  );
    // Modify a related Cell by blocking the assigned value.
    modify( $c ){ blockValue( $v ) }
end

// Rule for eliminating the Setting fact
rule "retract setting"
  when
    // A Setting with row and column number, and a value
    $s: Setting( $rn: rowNo, $cn: colNo, $v: value )

    // The matching Cell, with the value already set
    $c: Cell( rowNo == $rn, colNo == $cn, value == $v )

    // This is the negation of the last pattern in the previous rule.
    // Now the Setting fact can be safely retracted.
    not( $x: Cell( free contains $v )
         and
         Cell( this == $c, exCells contains $x ) )
  then
    // System.out.println( "done setting cell " + $c.toString() );
    // Discard the Setter fact.
    delete( $s );
    // Sudoku.sudoku.consistencyCheck();
end</pre>
					</p></div><p>
					Two solving rules detect a situation where an allocation of a number to a cell is possible. The rule <code class="literal">"single"</code> fires for a <code class="literal">Cell</code> with a candidate set containing a single number. The rule <code class="literal">"hidden single"</code> fires when no cell exists with a single candidate, but when a cell exists containing a candidate, this candidate is absent from all other cells in one of the three groups to which the cell belongs. Both rules create and insert a <code class="literal">Setting</code> fact.
				</p><div class="formalpara"><p class="title"><strong>Rules "single" and "hidden single"</strong></p><p>
						
<pre class="screen">// Detect a set of candidate values with cardinality 1 for some Cell.
// This is the value to be set.
rule "single"
  when
    // Currently no setting underway
    not Setting()

    // One element in the "free" set
    $c: Cell( $rn: rowNo, $cn: colNo, freeCount == 1 )
  then
    Integer i = $c.getFreeValue();
    if (explain) System.out.println( "single " + i + " at " + $c.posAsString() );
    // Insert another Setter fact.
    insert( new Setting( $rn, $cn, i ) );
end

// Detect a set of candidate values with a value that is the only one
// in one of its groups. This is the value to be set.
rule "hidden single"
  when
    // Currently no setting underway
    not Setting()
    not Cell( freeCount == 1 )

    // Some integer
    $i: Integer()

    // The "free" set contains this number
    $c: Cell( $rn: rowNo, $cn: colNo, freeCount &gt; 1, free contains $i )

    // A cell group contains this cell $c.
    $cg: CellGroup( cells contains $c )
    // No other cell from that group contains $i.
    not ( Cell( this != $c, free contains $i ) from $cg.getCells() )
  then
    if (explain) System.out.println( "hidden single " + $i + " at " + $c.posAsString() );
    // Insert another Setter fact.
    insert( new Setting( $rn, $cn, $i ) );
end</pre>
					</p></div><p>
					Rules from the largest group, either individually or in groups of two or three, implement various solving techniques used for solving Sudoku puzzles manually.
				</p><p>
					The rule <code class="literal">"naked pair"</code> detects identical candidate sets of size <code class="literal">2</code> in two cells of a group. These two values may be removed from all other candidate sets of that group.
				</p><div class="formalpara"><p class="title"><strong>Rule "naked pair"</strong></p><p>
						
<pre class="screen">// A "naked pair" is two cells in some cell group with their sets of
// permissible values being equal with cardinality 2. These two values
// can be removed from all other candidate lists in the group.
rule "naked pair"
  when
    // Currently no setting underway
    not Setting()
    not Cell( freeCount == 1 )

    // One cell with two candidates
    $c1: Cell( freeCount == 2, $f1: free, $r1: cellRow, $rn1: rowNo, $cn1: colNo, $b1: cellSqr )

    // The containing cell group
    $cg: CellGroup( freeCount &gt; 2, cells contains $c1 )

    // Another cell with two candidates, not the one we already have
    $c2: Cell( this != $c1, free == $f1 /*** , rowNo &gt;= $rn1, colNo &gt;= $cn1 ***/ ) from $cg.cells

    // Get one of the "naked pair".
    Integer( $v: intValue ) from $c1.getFree()

    // Get some other cell with a candidate equal to one from the pair.
    $c3: Cell( this != $c1 &amp;&amp; != $c2, freeCount &gt; 1, free contains $v ) from $cg.cells
  then
    if (explain) System.out.println( "remove " + $v + " from " + $c3.posAsString() + " due to naked pair at " + $c1.posAsString() + " and " + $c2.posAsString() );
    // Remove the value.
    modify( $c3 ){ blockValue( $v ) }
end</pre>
					</p></div><p>
					The three rules <code class="literal">"hidden pair in …​"</code> functions similarly to the rule <code class="literal">"naked pair"</code>. These rules detect a subset of two numbers in exactly two cells of a group, with neither value occurring in any of the other cells of the group. This means that all other candidates can be eliminated from the two cells harboring the hidden pair.
				</p><div class="formalpara"><p class="title"><strong>Rules "hidden pair in …​"</strong></p><p>
						
<pre class="screen">// If two cells within the same cell group contain candidate sets with more than
// two values, with two values being in both of them but in none of the other
// cells, then we have a "hidden pair". We can remove all other candidates from
// these two cells.
rule "hidden pair in row"
  when
    // Currently no setting underway
    not Setting()
    not Cell( freeCount == 1 )

    // Establish a pair of Integer facts.
    $i1: Integer()
    $i2: Integer( this &gt; $i1 )

    // Look for a Cell with these two among its candidates. (The upper bound on
    // the number of candidates avoids a lot of useless work during startup.)
    $c1: Cell( $rn1: rowNo, $cn1: colNo, freeCount &gt; 2 &amp;&amp; &lt; 9, free contains $i1 &amp;&amp; contains $i2, $cellRow: cellRow )

    // Get another one from the same row, with the same pair among its candidates.
    $c2: Cell( this != $c1, cellRow == $cellRow, freeCount &gt; 2, free contains $i1 &amp;&amp; contains $i2 )

    // Ascertain that no other cell in the group has one of these two values.
    not( Cell( this != $c1 &amp;&amp; != $c2, free contains $i1 || contains $i2 ) from $cellRow.getCells() )
  then
    if( explain) System.out.println( "hidden pair in row at " + $c1.posAsString() + " and " + $c2.posAsString() );
    // Set the candidate lists of these two Cells to the "hidden pair".
    modify( $c1 ){ blockExcept( $i1, $i2 ) }
    modify( $c2 ){ blockExcept( $i1, $i2 ) }
end

rule "hidden pair in column"
  when
    not Setting()
    not Cell( freeCount == 1 )

    $i1: Integer()
    $i2: Integer( this &gt; $i1 )
    $c1: Cell( $rn1: rowNo, $cn1: colNo, freeCount &gt; 2 &amp;&amp; &lt; 9, free contains $i1 &amp;&amp; contains $i2, $cellCol: cellCol )
    $c2: Cell( this != $c1, cellCol == $cellCol, freeCount &gt; 2, free contains $i1 &amp;&amp; contains $i2 )
    not( Cell( this != $c1 &amp;&amp; != $c2, free contains $i1 || contains $i2 ) from $cellCol.getCells() )
  then
    if (explain) System.out.println( "hidden pair in column at " + $c1.posAsString() + " and " + $c2.posAsString() );
    modify( $c1 ){ blockExcept( $i1, $i2 ) }
    modify( $c2 ){ blockExcept( $i1, $i2 ) }
end

rule "hidden pair in square"
  when
    not Setting()
    not Cell( freeCount == 1 )

    $i1: Integer()
    $i2: Integer( this &gt; $i1 )
    $c1: Cell( $rn1: rowNo, $cn1: colNo, freeCount &gt; 2 &amp;&amp; &lt; 9, free contains $i1 &amp;&amp; contains $i2,
               $cellSqr: cellSqr )
    $c2: Cell( this != $c1, cellSqr == $cellSqr, freeCount &gt; 2, free contains $i1 &amp;&amp; contains $i2 )
    not( Cell( this != $c1 &amp;&amp; != $c2, free contains $i1 || contains $i2 ) from $cellSqr.getCells() )
  then
    if (explain) System.out.println( "hidden pair in square " + $c1.posAsString() + " and " + $c2.posAsString() );
    modify( $c1 ){ blockExcept( $i1, $i2 ) }
    modify( $c2 ){ blockExcept( $i1, $i2 ) }
end</pre>
					</p></div><p>
					Two rules deal with <code class="literal">"X-wings"</code> in rows and columns. When only two possible cells for a value exist in each of two different rows (or columns) and these candidates lie also in the same columns (or rows), then all other candidates for this value in the columns (or rows) can be eliminated. When you follow the pattern sequence in one of these rules, notice how the conditions that are conveniently expressed by words such as <code class="literal">same</code> or <code class="literal">only</code> result in patterns with suitable constraints or that are prefixed with <code class="literal">not</code>.
				</p><div class="formalpara"><p class="title"><strong>Rules "X-wings in …​"</strong></p><p>
						
<pre class="screen">rule "X-wings in rows"
  when
    not Setting()
    not Cell( freeCount == 1 )

    $i: Integer()
    $ca1: Cell( freeCount &gt; 1, free contains $i,
                $ra: cellRow, $rano: rowNo,         $c1: cellCol,        $c1no: colNo )
    $cb1: Cell( freeCount &gt; 1, free contains $i,
                $rb: cellRow, $rbno: rowNo &gt; $rano,      cellCol == $c1 )
    not( Cell( this != $ca1 &amp;&amp; != $cb1, free contains $i ) from $c1.getCells() )

    $ca2: Cell( freeCount &gt; 1, free contains $i,
                cellRow == $ra, $c2: cellCol,       $c2no: colNo &gt; $c1no )
    $cb2: Cell( freeCount &gt; 1, free contains $i,
                cellRow == $rb,      cellCol == $c2 )
    not( Cell( this != $ca2 &amp;&amp; != $cb2, free contains $i ) from $c2.getCells() )

    $cx: Cell( rowNo == $rano || == $rbno, colNo != $c1no &amp;&amp; != $c2no,
               freeCount &gt; 1, free contains $i )
  then
    if (explain) {
        System.out.println( "X-wing with " + $i + " in rows " +
            $ca1.posAsString() + " - " + $cb1.posAsString() +
            $ca2.posAsString() + " - " + $cb2.posAsString() + ", remove from " + $cx.posAsString() );
    }
    modify( $cx ){ blockValue( $i ) }
end

rule "X-wings in columns"
  when
    not Setting()
    not Cell( freeCount == 1 )

    $i: Integer()
    $ca1: Cell( freeCount &gt; 1, free contains $i,
                $c1: cellCol, $c1no: colNo,         $ra: cellRow,        $rano: rowNo )
    $ca2: Cell( freeCount &gt; 1, free contains $i,
                $c2: cellCol, $c2no: colNo &gt; $c1no,      cellRow == $ra )
    not( Cell( this != $ca1 &amp;&amp; != $ca2, free contains $i ) from $ra.getCells() )

    $cb1: Cell( freeCount &gt; 1, free contains $i,
                cellCol == $c1, $rb: cellRow,  $rbno: rowNo &gt; $rano )
    $cb2: Cell( freeCount &gt; 1, free contains $i,
                cellCol == $c2,      cellRow == $rb )
    not( Cell( this != $cb1 &amp;&amp; != $cb2, free contains $i ) from $rb.getCells() )

    $cx: Cell( colNo == $c1no || == $c2no, rowNo != $rano &amp;&amp; != $rbno,
               freeCount &gt; 1, free contains $i )
  then
    if (explain) {
        System.out.println( "X-wing with " + $i + " in columns " +
            $ca1.posAsString() + " - " + $ca2.posAsString() +
            $cb1.posAsString() + " - " + $cb2.posAsString() + ", remove from " + $cx.posAsString()  );
    }
    modify( $cx ){ blockValue( $i ) }
end</pre>
					</p></div><p>
					The two rules <code class="literal">"intersection removal …​"</code> are based on the restricted occurrence of some number within one square, either in a single row or in a single column. This means that this number must be in one of those two or three cells of the row or column and can be removed from the candidate sets of all other cells of the group. The pattern establishes the restricted occurrence and then fires for each cell outside of the square and within the same cell file.
				</p><div class="formalpara"><p class="title"><strong>Rules "intersection removal …​"</strong></p><p>
						
<pre class="screen">rule "intersection removal column"
  when
    not Setting()
    not Cell( freeCount == 1 )

    $i: Integer()
    // Occurs in a Cell
    $c: Cell( free contains $i, $cs: cellSqr, $cc: cellCol )
    // Does not occur in another cell of the same square and a different column
    not Cell( this != $c, free contains $i, cellSqr == $cs, cellCol != $cc )

    // A cell exists in the same column and another square containing this value.
    $cx: Cell( freeCount &gt; 1, free contains $i, cellCol == $cc, cellSqr != $cs )
  then
    // Remove the value from that other cell.
    if (explain) {
        System.out.println( "column elimination due to " + $c.posAsString() +
                            ": remove " + $i + " from " + $cx.posAsString() );
    }
    modify( $cx ){ blockValue( $i ) }
end

rule "intersection removal row"
  when
    not Setting()
    not Cell( freeCount == 1 )

    $i: Integer()
    // Occurs in a Cell
    $c: Cell( free contains $i, $cs: cellSqr, $cr: cellRow )
    // Does not occur in another cell of the same square and a different row.
    not Cell( this != $c, free contains $i, cellSqr == $cs, cellRow != $cr )

    // A cell exists in the same row and another square containing this value.
    $cx: Cell( freeCount &gt; 1, free contains $i, cellRow == $cr, cellSqr != $cs )
  then
    // Remove the value from that other cell.
    if (explain) {
        System.out.println( "row elimination due to " + $c.posAsString() +
                            ": remove " + $i + " from " + $cx.posAsString() );
    }
    modify( $cx ){ blockValue( $i ) }
end</pre>
					</p></div><p>
					These rules are sufficient for many but not all Sudoku puzzles. To solve very difficult grids, the rule set requires more complex rules. (Ultimately, some puzzles can be solved only by trial and error.)
				</p></section><section class="section" id="decision-examples-conway-ref_drl-rules"><div class="titlepage"><div><div><h2 class="title">20.9. Conway’s Game of Life example decisions (ruleflow groups and GUI integration)</h2></div></div></div><p>
					The Conway’s Game of Life example decision set, based on the famous cellular automaton by John Conway, demonstrates how to use ruleflow groups in rules to control rule execution. The example also demonstrates how to integrate Red Hat Process Automation Manager rules with a graphical user interface (GUI), in this case a Swing-based implementation of Conway’s Game of Life.
				</p><p>
					The following is an overview of the Conway’s Game of Life (Conway) example:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Name</strong></span>: <code class="literal">conway</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Main classes</strong></span>: <code class="literal">org.drools.examples.conway.ConwayRuleFlowGroupRun</code>, <code class="literal">org.drools.examples.conway.ConwayAgendaGroupRun</code> (in <code class="literal">src/main/java</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Module</strong></span>: <code class="literal">droolsjbpm-integration-examples</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Type</strong></span>: Java application
						</li><li class="listitem">
							<span class="strong strong"><strong>Rule files</strong></span>: <code class="literal">org.drools.examples.conway.*.drl</code> (in <code class="literal">src/main/resources</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Objective</strong></span>: Demonstrates ruleflow groups and GUI integration
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The Conway’s Game of Life example is separate from most of the other example decision sets in Red Hat Process Automation Manager and is located in <code class="literal">~/rhpam-7.10.0-sources/src/droolsjbpm-integration-$VERSION/droolsjbpm-integration-examples</code> of the <span class="strong strong"><strong>Red Hat Process Automation Manager 7.10.0 Source Distribution</strong></span> from the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Red Hat Customer Portal</a>.
					</p></div></div><p>
					In Conway’s Game of Life, a user interacts with the game by creating an initial configuration or an advanced pattern with defined properties and then observing how the initial state evolves. The objective of the game is to show the development of a population, generation by generation. Each generation results from the preceding one, based on the simultaneous evaluation of all cells.
				</p><p>
					The following basic rules govern what the next generation looks like:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							If a live cell has fewer than two live neighbors, it dies of loneliness.
						</li><li class="listitem">
							If a live cell has more than three live neighbors, it dies from overcrowding.
						</li><li class="listitem">
							If a dead cell has exactly three live neighbors, it comes to life.
						</li></ul></div><p>
					Any cell that does not meet any of those criteria is left as is for the next generation.
				</p><p>
					The Conway’s Game of Life example uses Red Hat Process Automation Manager rules with <code class="literal">ruleflow-group</code> attributes to define the pattern implemented in the game. The example also contains a version of the decision set that achieves the same behavior using agenda groups. Agenda groups enable you to partition the decision engine agenda to provide execution control over groups of rules. By default, all rules are in the agenda group <code class="literal">MAIN</code>. You can use the <code class="literal">agenda-group</code> attribute to specify a different agenda group for the rule.
				</p><p>
					This overview does not explore the version of the Conway example using agenda groups. For more information about agenda groups, see the Red Hat Process Automation Manager example decision sets that specifically address agenda groups.
				</p><h4 id="conway_example_execution_and_interaction">Conway example execution and interaction</h4><p>
					Similar to other Red Hat Process Automation Manager decision examples, you execute the Conway ruleflow example by running the <code class="literal">org.drools.examples.conway.ConwayRuleFlowGroupRun</code> class as a Java application in your IDE.
				</p><p>
					When you execute the Conway example, the <code class="literal">Conway’s Game of Life</code> GUI window appears. This window contains an empty grid, or "arena" where the life simulation takes place. Initially the grid is empty because no live cells are in the system yet.
				</p><div class="figure" id="idm139921814899520"><p class="title"><strong>Figure 20.24. Conway example GUI after launch</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/ConwaysGameOfLifeExample/conway1.png" alt="conway1"/></div></div></div><p>
					Select a predefined pattern from the <span class="strong strong"><strong>Pattern</strong></span> drop-down menu and click <span class="strong strong"><strong>Next Generation</strong></span> to click through each population generation. Each cell is either alive or dead, where live cells contain a green ball. As the population evolves from the initial pattern, cells live or die relative to neighboring cells, according to the rules of the game.
				</p><div class="figure" id="idm139921814893008"><p class="title"><strong>Figure 20.25. Generation evolution in Conway example</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/ConwaysGameOfLifeExample/conway2.png" alt="conway2"/></div></div></div><p>
					Neighbors include not only cells to the left, right, top, and bottom but also cells that are connected diagonally, so that each cell has a total of eight neighbors. Exceptions are the corner cells, which have only three neighbors, and the cells along the four borders, with five neighbors each.
				</p><p>
					You can manually intervene to create or kill cells by clicking the cell.
				</p><p>
					To run through an evolution automatically from the initial pattern, click <span class="strong strong"><strong>Start</strong></span>.
				</p><h4 id="conway_example_rules_with_ruleflow_groups">Conway example rules with ruleflow groups</h4><p>
					The rules in the <code class="literal">ConwayRuleFlowGroupRun</code> example use ruleflow groups to control rule execution. A ruleflow group is a group of rules associated by the <code class="literal">ruleflow-group</code> rule attribute. These rules can only fire when the group is activated. The group itself can only become active when the elaboration of the ruleflow diagram reaches the node representing the group.
				</p><p>
					The Conway example uses the following ruleflow groups for rules:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">"register neighbor"</code>
						</li><li class="listitem">
							<code class="literal">"evaluate"</code>
						</li><li class="listitem">
							<code class="literal">"calculate"</code>
						</li><li class="listitem">
							<code class="literal">"reset calculate"</code>
						</li><li class="listitem">
							<code class="literal">"birth"</code>
						</li><li class="listitem">
							<code class="literal">"kill"</code>
						</li><li class="listitem">
							<code class="literal">"kill all"</code>
						</li></ul></div><p>
					All of the <code class="literal">Cell</code> objects are inserted into the KIE session and the <code class="literal">"register …​"</code> rules in the ruleflow group <code class="literal">"register neighbor"</code> are allowed to execute by the ruleflow process. This group of four rules creates <code class="literal">Neighbor</code> relations between some cell and its northeastern, northern, northwestern, and western neighbors.
				</p><p>
					This relation is bidirectional and handles the other four directions. Border cells do not require any special treatment. These cells are not paired with neighboring cells where there is not any.
				</p><p>
					By the time all activations have fired for these rules, all cells are related to all their neighboring cells.
				</p><div class="formalpara"><p class="title"><strong>Rules "register …​"</strong></p><p>
						
<pre class="screen">rule "register north east"
    ruleflow-group "register neighbor"
  when
    $cell: Cell( $row : row, $col : col )
    $northEast : Cell( row  == ($row - 1), col == ( $col + 1 ) )
  then
    insert( new Neighbor( $cell, $northEast ) );
    insert( new Neighbor( $northEast, $cell ) );
end

rule "register north"
    ruleflow-group "register neighbor"
  when
    $cell: Cell( $row : row, $col : col )
    $north : Cell( row  == ($row - 1), col == $col )
  then
    insert( new Neighbor( $cell, $north ) );
    insert( new Neighbor( $north, $cell ) );
end

rule "register north west"
    ruleflow-group "register neighbor"
  when
    $cell: Cell( $row : row, $col : col )
    $northWest : Cell( row  == ($row - 1), col == ( $col - 1 ) )
  then
    insert( new Neighbor( $cell, $northWest ) );
    insert( new Neighbor( $northWest, $cell ) );
end

rule "register west"
    ruleflow-group "register neighbor"
  when
    $cell: Cell( $row : row, $col : col )
    $west : Cell( row  == $row, col == ( $col - 1 ) )
  then
    insert( new Neighbor( $cell, $west ) );
    insert( new Neighbor( $west, $cell ) );
end</pre>
					</p></div><p>
					After all the cells are inserted, some Java code applies the pattern to the grid, setting certain cells to <code class="literal">Live</code>. Then, when the user clicks <span class="strong strong"><strong>Start</strong></span> or <span class="strong strong"><strong>Next Generation</strong></span>, the example executes the <code class="literal">Generation</code> ruleflow. This ruleflow manages all changes of cells in each generation cycle.
				</p><div class="figure" id="idm139921814464224"><p class="title"><strong>Figure 20.26. Generation ruleflow</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/ConwaysGameOfLifeExample/conway_ruleflow_generation.png" alt="conway ruleflow generation"/></div></div></div><p>
					The ruleflow process enters the <code class="literal">"evaluate"</code> ruleflow group and any active rules in the group can fire. The rules <code class="literal">"Kill the …​"</code> and <code class="literal">"Give Birth"</code> in this group apply the game rules to birth or kill cells. The example uses the <code class="literal">phase</code> attribute to drive the reasoning of the <code class="literal">Cell</code> object by specific groups of rules. Typically, the phase is tied to a ruleflow group in the ruleflow process definition.
				</p><p>
					Notice that the example does not change the state of any <code class="literal">Cell</code> objects at this point because it must complete the full evaluation before those changes can be applied. The example sets the cell to a <code class="literal">phase</code> that is either <code class="literal">Phase.KILL</code> or <code class="literal">Phase.BIRTH</code>, which is used later to control actions applied to the <code class="literal">Cell</code> object.
				</p><div class="formalpara"><p class="title"><strong>Rules "Kill the …​" and "Give Birth"</strong></p><p>
						
<pre class="screen">rule "Kill The Lonely"
    ruleflow-group "evaluate"
    no-loop
  when
    // A live cell has fewer than 2 live neighbors.
    theCell: Cell( liveNeighbors &lt; 2, cellState == CellState.LIVE,
                   phase == Phase.EVALUATE )
  then
    modify( theCell ){
        setPhase( Phase.KILL );
    }
end

rule "Kill The Overcrowded"
    ruleflow-group "evaluate"
    no-loop
  when
    // A live cell has more than 3 live neighbors.
    theCell: Cell( liveNeighbors &gt; 3, cellState == CellState.LIVE,
                   phase == Phase.EVALUATE )
  then
    modify( theCell ){
        setPhase( Phase.KILL );
    }
end

rule "Give Birth"
    ruleflow-group "evaluate"
    no-loop
  when
    // A dead cell has 3 live neighbors.
    theCell: Cell( liveNeighbors == 3, cellState == CellState.DEAD,
                   phase == Phase.EVALUATE )
  then
    modify( theCell ){
        theCell.setPhase( Phase.BIRTH );
    }
end</pre>
					</p></div><p>
					After all <code class="literal">Cell</code> objects in the grid have been evaluated, the example uses the <code class="literal">"reset calculate"</code> rule to clear any activations in the <code class="literal">"calculate"</code> ruleflow group. The example then enters a split in the ruleflow that enables the rules <code class="literal">"kill"</code> and <code class="literal">"birth"</code> to fire, if the ruleflow group is activated. These rules apply the state change.
				</p><div class="formalpara"><p class="title"><strong>Rules "reset calculate", "kill", and "birth"</strong></p><p>
						
<pre class="screen">rule "reset calculate"
    ruleflow-group "reset calculate"
  when
  then
    WorkingMemory wm = drools.getWorkingMemory();
    wm.clearRuleFlowGroup( "calculate" );
end

rule "kill"
    ruleflow-group "kill"
    no-loop
  when
    theCell: Cell( phase == Phase.KILL )
  then
    modify( theCell ){
        setCellState( CellState.DEAD ),
        setPhase( Phase.DONE );
    }
end

rule "birth"
    ruleflow-group "birth"
    no-loop
  when
    theCell: Cell( phase == Phase.BIRTH )
  then
    modify( theCell ){
        setCellState( CellState.LIVE ),
        setPhase( Phase.DONE );
    }
end</pre>
					</p></div><p>
					At this stage, several <code class="literal">Cell</code> objects have been modified with the state changed to either <code class="literal">LIVE</code> or <code class="literal">DEAD</code>. When a cell becomes live or dead, the example uses the <code class="literal">Neighbor</code> relation in the rules <code class="literal">"Calculate …​"</code> to iterate over all surrounding cells, increasing or decreasing the <code class="literal">liveNeighbor</code> count. Any cell that has its count changed is also set to the <code class="literal">EVALUATE</code> phase to make sure it is included in the reasoning during the evaluation stage of the ruleflow process.
				</p><p>
					After the live count has been determined and set for all cells, the ruleflow process ends. If the user initially clicked <span class="strong strong"><strong>Start</strong></span>, the decision engine restarts the ruleflow at that point. If the user initially clicked <span class="strong strong"><strong>Next Generation</strong></span>, the user can request another generation.
				</p><div class="formalpara"><p class="title"><strong>Rules "Calculate …​"</strong></p><p>
						
<pre class="screen">rule "Calculate Live"
    ruleflow-group "calculate"
    lock-on-active
  when
    theCell: Cell( cellState == CellState.LIVE )
    Neighbor( cell == theCell, $neighbor : neighbor )
  then
    modify( $neighbor ){
        setLiveNeighbors( $neighbor.getLiveNeighbors() + 1 ),
        setPhase( Phase.EVALUATE );
    }
end

rule "Calculate Dead"
    ruleflow-group "calculate"
    lock-on-active
  when
    theCell: Cell( cellState == CellState.DEAD )
    Neighbor( cell == theCell, $neighbor : neighbor )
  then
    modify( $neighbor ){
        setLiveNeighbors( $neighbor.getLiveNeighbors() - 1 ),
        setPhase( Phase.EVALUATE );
    }
end</pre>
					</p></div></section><section class="section" id="decision-examples-doom-ref_drl-rules"><div class="titlepage"><div><div><h2 class="title">20.10. House of Doom example decisions (backward chaining and recursion)</h2></div></div></div><p>
					The House of Doom example decision set demonstrates how the decision engine uses backward chaining and recursion to reach defined goals or subgoals in a hierarchical system.
				</p><p>
					The following is an overview of the House of Doom example:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Name</strong></span>: <code class="literal">backwardchaining</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Main class</strong></span>: <code class="literal">org.drools.examples.backwardchaining.HouseOfDoomMain</code> (in <code class="literal">src/main/java</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Module</strong></span>: <code class="literal">drools-examples</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Type</strong></span>: Java application
						</li><li class="listitem">
							<span class="strong strong"><strong>Rule file</strong></span>: <code class="literal">org.drools.examples.backwardchaining.BC-Example.drl</code> (in <code class="literal">src/main/resources</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Objective</strong></span>: Demonstrates backward chaining and recursion
						</li></ul></div><p>
					A backward-chaining rule system is a goal-driven system that starts with a conclusion that the decision engine attempts to satisfy, often using recursion. If the system cannot reach the conclusion or goal, it searches for subgoals, which are conclusions that complete part of the current goal. The system continues this process until either the initial conclusion is satisfied or all subgoals are satisfied.
				</p><p>
					In contrast, a forward-chaining rule system is a data-driven system that starts with a fact in the working memory of the decision engine and reacts to changes to that fact. When objects are inserted into working memory, any rule conditions that become true as a result of the change are scheduled for execution by the agenda.
				</p><p>
					The decision engine in Red Hat Process Automation Manager uses both forward and backward chaining to evaluate rules.
				</p><p>
					The following diagram illustrates how the decision engine evaluates rules using forward chaining overall with a backward-chaining segment in the logic flow:
				</p><div class="figure" id="idm139921816779632"><p class="title"><strong>Figure 20.27. Rule evaluation logic using forward and backward chaining</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/BackwardChaining/RuleEvaluation_Enterprise.png" alt="RuleEvaluation Enterprise"/></div></div></div><p>
					The House of Doom example uses rules with various types of queries to find the location of rooms and items within the house. The sample class <code class="literal">Location.java</code> contains the <code class="literal">item</code> and <code class="literal">location</code> elements used in the example. The sample class <code class="literal">HouseOfDoomMain.java</code> inserts the items or rooms in their respective locations in the house and executes the rules.
				</p><div class="formalpara"><p class="title"><strong>Items and locations in HouseOfDoomMain.java class</strong></p><p>
						
<pre class="programlisting language-java">ksession.insert( new Location("Office", "House") );
ksession.insert( new Location("Kitchen", "House") );
ksession.insert( new Location("Knife", "Kitchen") );
ksession.insert( new Location("Cheese", "Kitchen") );
ksession.insert( new Location("Desk", "Office") );
ksession.insert( new Location("Chair", "Office") );
ksession.insert( new Location("Computer", "Desk") );
ksession.insert( new Location("Drawer", "Desk") );</pre>
					</p></div><p>
					The example rules rely on backward chaining and recursion to determine the location of all items and rooms in the house structure.
				</p><p>
					The following diagram illustrates the structure of the House of Doom and the items and rooms within it:
				</p><div class="figure" id="idm139921816768624"><p class="title"><strong>Figure 20.28. House of Doom structure</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/BackwardChaining/TransitiveReasoning_Enterprise.png" alt="TransitiveReasoning Enterprise"/></div></div></div><p>
					To execute the example, run the <code class="literal">org.drools.examples.backwardchaining.HouseOfDoomMain</code> class as a Java application in your IDE.
				</p><p>
					After the execution, the following output appears in the IDE console window:
				</p><div class="formalpara"><p class="title"><strong>Execution output in the IDE console</strong></p><p>
						
<pre class="screen">go1
Office is in the House
---
go2
Drawer is in the House
---
go3
---
Key is in the Office
---
go4
Chair is in the Office
Desk is in the Office
Key is in the Office
Computer is in the Office
Drawer is in the Office
---
go5
Chair is in Office
Desk is in Office
Drawer is in Desk
Key is in Drawer
Kitchen is in House
Cheese is in Kitchen
Knife is in Kitchen
Computer is in Desk
Office is in House
Key is in Office
Drawer is in House
Computer is in House
Key is in House
Desk is in House
Chair is in House
Knife is in House
Cheese is in House
Computer is in Office
Drawer is in Office
Key is in Desk</pre>
					</p></div><p>
					All rules in the example have fired to detect the location of all items in the house and to print the location of each in the output.
				</p><h4 id="recursive_query_and_related_rules">Recursive query and related rules</h4><p>
					A recursive query repeatedly searches through the hierarchy of a data structure for relationships between elements.
				</p><p>
					In the House of Doom example, the <code class="literal">BC-Example.drl</code> file contains an <code class="literal">isContainedIn</code> query that most of the rules in the example use to recursively evaluate the house data structure for data inserted into the decision engine:
				</p><div class="formalpara"><p class="title"><strong>Recursive query in BC-Example.drl</strong></p><p>
						
<pre class="screen">query isContainedIn( String x, String y )
  Location( x, y; )
  or
  ( Location( z, y; ) and isContainedIn( x, z; ) )
end</pre>
					</p></div><p>
					The rule <code class="literal">"go"</code> prints every string inserted into the system to determine how items are implemented, and the rule <code class="literal">"go1"</code> calls the query <code class="literal">isContainedIn</code>:
				</p><div class="formalpara"><p class="title"><strong>Rules "go" and "go1"</strong></p><p>
						
<pre class="screen">rule "go" salience 10
  when
    $s : String()
  then
    System.out.println( $s );
end

rule "go1"
  when
    String( this == "go1" )
    isContainedIn("Office", "House"; )
  then
    System.out.println( "Office is in the House" );
end</pre>
					</p></div><p>
					The example inserts the <code class="literal">"go1"</code> string into the decision engine and activates the <code class="literal">"go1"</code> rule to detect that item <code class="literal">Office</code> is in the location <code class="literal">House</code>:
				</p><div class="formalpara"><p class="title"><strong>Insert string and fire rules</strong></p><p>
						
<pre class="screen">ksession.insert( "go1" );
ksession.fireAllRules();</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Rule "go1" output in the IDE console</strong></p><p>
						
<pre class="screen">go1
Office is in the House</pre>
					</p></div><h4 id="transitive_closure_rule">Transitive closure rule</h4><p>
					Transitive closure is a relationship between an element contained in a parent element that is multiple levels higher in a hierarchical structure.
				</p><p>
					The rule <code class="literal">"go2"</code> identifies the transitive closure relationship of the <code class="literal">Drawer</code> and the <code class="literal">House</code>: The <code class="literal">Drawer</code> is in the <code class="literal">Desk</code> in the <code class="literal">Office</code> in the <code class="literal">House</code>.
				</p><pre class="screen">rule "go2"
  when
    String( this == "go2" )
    isContainedIn("Drawer", "House"; )
  then
    System.out.println( "Drawer is in the House" );
end</pre><p>
					The example inserts the <code class="literal">"go2"</code> string into the decision engine and activates the <code class="literal">"go2"</code> rule to detect that item <code class="literal">Drawer</code> is ultimately within the location <code class="literal">House</code>:
				</p><div class="formalpara"><p class="title"><strong>Insert string and fire rules</strong></p><p>
						
<pre class="screen">ksession.insert( "go2" );
ksession.fireAllRules();</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Rule "go2" output in the IDE console</strong></p><p>
						
<pre class="screen">go2
Drawer is in the House</pre>
					</p></div><p>
					The decision engine determines this outcome based on the following logic:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							The query recursively searches through several levels in the house to detect the transitive closure between <code class="literal">Drawer</code> and <code class="literal">House</code>.
						</li><li class="listitem">
							Instead of using <code class="literal">Location( x, y; )</code>, the query uses the value of <code class="literal">(z, y; )</code> because <code class="literal">Drawer</code> is not directly in <code class="literal">House</code>.
						</li><li class="listitem">
							The <code class="literal">z</code> argument is currently unbound, which means it has no value and returns everything that is in the argument.
						</li><li class="listitem">
							The <code class="literal">y</code> argument is currently bound to <code class="literal">House</code>, so <code class="literal">z</code> returns <code class="literal">Office</code> and <code class="literal">Kitchen</code>.
						</li><li class="listitem">
							The query gathers information from the <code class="literal">Office</code> and checks recursively if the <code class="literal">Drawer</code> is in the <code class="literal">Office</code>. The query line <code class="literal">isContainedIn( x, z; )</code> is called for these parameters.
						</li><li class="listitem">
							No instance of <code class="literal">Drawer</code> exists directly in <code class="literal">Office</code>, so no match is found.
						</li><li class="listitem"><p class="simpara">
							With <code class="literal">z</code> unbound, the query returns data within the <code class="literal">Office</code> and determines that <span class="strong strong"><strong>z == Desk</strong></span>.
						</p><pre class="screen">isContainedIn(x==drawer, z==desk)</pre></li><li class="listitem"><p class="simpara">
							The <code class="literal">isContainedIn</code> query recursively searches three times, and on the third time, the query detects an instance of <code class="literal">Drawer</code> in <code class="literal">Desk</code>.
						</p><pre class="screen">Location(x==drawer, y==desk)</pre></li><li class="listitem">
							After this match on the first location, the query recursively searches back up the structure to determine that the <code class="literal">Drawer</code> is in the <code class="literal">Desk</code>, the <code class="literal">Desk</code> is in the <code class="literal">Office</code>, and the <code class="literal">Office</code> is in the <code class="literal">House</code>. Therefore, the <code class="literal">Drawer</code> is in the <code class="literal">House</code> and the rule is satisfied.
						</li></ol></div><h4 id="reactive_query_rule">Reactive query rule</h4><p>
					A reactive query searches through the hierarchy of a data structure for relationships between elements and is dynamically updated when elements in the structure are modified.
				</p><p>
					The rule <code class="literal">"go3"</code> functions as a reactive query that detects if a new item <code class="literal">Key</code> ever becomes present in the <code class="literal">Office</code> by transitive closure: A <code class="literal">Key</code> in the <code class="literal">Drawer</code> in the <code class="literal">Office</code>.
				</p><div class="formalpara"><p class="title"><strong>Rule "go3"</strong></p><p>
						
<pre class="screen">rule "go3"
  when
    String( this == "go3" )
    isContainedIn("Key", "Office"; )
  then
    System.out.println( "Key is in the Office" );
end</pre>
					</p></div><p>
					The example inserts the <code class="literal">"go3"</code> string into the decision engine and activates the <code class="literal">"go3"</code> rule. Initially, this rule is not satisfied because no item <code class="literal">Key</code> exists in the house structure, so the rule produces no output.
				</p><div class="formalpara"><p class="title"><strong>Insert string and fire rules</strong></p><p>
						
<pre class="screen">ksession.insert( "go3" );
ksession.fireAllRules();</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Rule "go3" output in the IDE console (unsatisfied)</strong></p><p>
						
<pre class="screen">go3</pre>
					</p></div><p>
					The example then inserts a new item <code class="literal">Key</code> in the location <code class="literal">Drawer</code>, which is in <code class="literal">Office</code>. This change satisfies the transitive closure in the <code class="literal">"go3"</code> rule and the output is populated accordingly.
				</p><div class="formalpara"><p class="title"><strong>Insert new item location and fire rules</strong></p><p>
						
<pre class="screen">ksession.insert( new Location("Key", "Drawer") );
ksession.fireAllRules();</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Rule "go3" output in the IDE console (satisfied)</strong></p><p>
						
<pre class="screen">Key is in the Office</pre>
					</p></div><p>
					This change also adds another level in the structure that the query includes in subsequent recursive searches.
				</p><h4 id="queries_with_unbound_arguments_in_rules">Queries with unbound arguments in rules</h4><p>
					A query with one or more unbound arguments returns all undefined (unbound) items within a defined (bound) argument of the query. If all arguments in a query are unbound, then the query returns all items within the scope of the query.
				</p><p>
					The rule <code class="literal">"go4"</code> uses an unbound argument <code class="literal">thing</code> to search for all items within the bound argument <code class="literal">Office</code>, instead of using a bound argument to search for a specific item in the <code class="literal">Office</code>:
				</p><div class="formalpara"><p class="title"><strong>Rule "go4"</strong></p><p>
						
<pre class="screen">rule "go4"
  when
    String( this == "go4" )
    isContainedIn(thing, "Office"; )
  then
    System.out.println( thing + "is in the Office" );
end</pre>
					</p></div><p>
					The example inserts the <code class="literal">"go4"</code> string into the decision engine and activates the <code class="literal">"go4"</code> rule to return all items in the <code class="literal">Office</code>:
				</p><div class="formalpara"><p class="title"><strong>Insert string and fire rules</strong></p><p>
						
<pre class="screen">ksession.insert( "go4" );
ksession.fireAllRules();</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Rule "go4" output in the IDE console</strong></p><p>
						
<pre class="screen">go4
Chair is in the Office
Desk is in the Office
Key is in the Office
Computer is in the Office
Drawer is in the Office</pre>
					</p></div><p>
					The rule <code class="literal">"go5"</code> uses both unbound arguments <code class="literal">thing</code> and <code class="literal">location</code> to search for all items and their locations in the entire <code class="literal">House</code> data structure:
				</p><div class="formalpara"><p class="title"><strong>Rule "go5"</strong></p><p>
						
<pre class="screen">rule "go5"
  when
    String( this == "go5" )
    isContainedIn(thing, location; )
  then
    System.out.println(thing + " is in " + location );
end</pre>
					</p></div><p>
					The example inserts the <code class="literal">"go5"</code> string into the decision engine and activates the <code class="literal">"go5"</code> rule to return all items and their locations in the <code class="literal">House</code> data structure:
				</p><div class="formalpara"><p class="title"><strong>Insert string and fire rules</strong></p><p>
						
<pre class="screen">ksession.insert( "go5" );
ksession.fireAllRules();</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Rule "go5" output in the IDE console</strong></p><p>
						
<pre class="screen">go5
Chair is in Office
Desk is in Office
Drawer is in Desk
Key is in Drawer
Kitchen is in House
Cheese is in Kitchen
Knife is in Kitchen
Computer is in Desk
Office is in House
Key is in Office
Drawer is in House
Computer is in House
Key is in House
Desk is in House
Chair is in House
Knife is in House
Cheese is in House
Computer is in Office
Drawer is in Office
Key is in Desk</pre>
					</p></div></section></section><section class="chapter" id="performance-tuning-drl-ref_drl-rules"><div class="titlepage"><div><div><h2 class="title">Chapter 21. Performance tuning considerations with DRL</h2></div></div></div><p>
				The following key concepts or suggested practices can help you optimize DRL rules and decision engine performance. These concepts are summarized in this section as a convenience and are explained in more detail in the cross-referenced documentation, where applicable. This section will expand or change as needed with new releases of Red Hat Process Automation Manager.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Define the property and value of pattern constraints from left to right</span></dt><dd><p class="simpara">
							In DRL pattern constraints, ensure that the fact property name is on the left side of the operator and that the value (constant or a variable) is on the right side. The property name must always be the key in the index and not the value. For example, write <code class="literal">Person( firstName == "John" )</code> instead of <code class="literal">Person( "John" == firstName )</code>. Defining the constraint property and value from right to left can hinder decision engine performance.
						</p><p class="simpara">
							For more information about DRL patterns and constraints, see <a class="xref" href="#drl-rules-WHEN-con_drl-rules" title="15.8. Rule conditions in DRL (WHEN)">Section 15.8, “Rule conditions in DRL (WHEN)”</a>.
						</p></dd><dt><span class="term">Use equality operators more than other operator types in pattern constraints when possible</span></dt><dd>
							Although the decision engine supports many DRL operator types that you can use to define your business rule logic, the equality operator <code class="literal">==</code> is evaluated most efficiently by the decision engine. Whenever practical, use this operator instead of other operator types. For example, the pattern <code class="literal">Person( firstName == "John" )</code> is evaluated more efficiently than <code class="literal">Person( firstName != "OtherName" )</code>. In some cases, using only equality operators might be impractical, so consider all of your business logic needs and options as you use DRL operators.
						</dd><dt><span class="term">List the most restrictive rule conditions first</span></dt><dd><p class="simpara">
							For rules with multiple conditions, list the conditions from most to least restrictive so that the decision engine can avoid assessing the entire set of conditions if the more restrictive conditions are not met.
						</p><p class="simpara">
							For example, the following conditions are part of a travel-booking rule that applies a discount to travelers who book both a flight and a hotel together. In this scenario, customers rarely book hotels with flights to receive this discount, so the hotel condition is rarely met and the rule is rarely executed. Therefore, the first condition ordering is more efficient because it prevents the decision engine from evaluating the flight condition frequently and unnecessarily when the hotel condition is not met.
						</p><div class="formalpara"><p class="title"><strong>Preferred condition order: hotel and flight</strong></p><p>
								
<pre class="screen">when
  $h:hotel() // Rarely booked
  $f:flight()</pre>
							</p></div><div class="formalpara"><p class="title"><strong>Inefficient condition order: flight and hotel</strong></p><p>
								
<pre class="screen">when
  $f:flight()
  $h:hotel() // Rarely booked</pre>
							</p></div><p class="simpara">
							For more information about DRL patterns and constraints, see <a class="xref" href="#drl-rules-WHEN-con_drl-rules" title="15.8. Rule conditions in DRL (WHEN)">Section 15.8, “Rule conditions in DRL (WHEN)”</a>.
						</p></dd><dt><span class="term">Avoid iterating over large collections of objects with excessive <code class="literal">from</code> clauses</span></dt><dd><p class="simpara">
							Avoid using the <code class="literal">from</code> condition element in DRL rules to iterate over large collections of objects, as shown in the following example:
						</p><div class="formalpara"><p class="title"><strong>Example conditions with <code class="literal">from</code> clause</strong></p><p>
								
<pre class="screen">when
  $c: Company()
  $e : Employee ( salary &gt; 100000.00) from $c.employees</pre>
							</p></div><p class="simpara">
							In such cases, the decision engine iterates over the large graph every time the rule condition is evaluated and impedes rule evaluation.
						</p><p class="simpara">
							Alternatively, instead of adding an object with a large graph that the decision engine must iterate over frequently, add the collection directly to the KIE session and then join the collection in the condition, as shown in the following example:
						</p><div class="formalpara"><p class="title"><strong>Example conditions without <code class="literal">from</code> clause</strong></p><p>
								
<pre class="screen">when
  $c: Company();
  Employee (salary &gt; 100000.00, company == $c)</pre>
							</p></div><p class="simpara">
							In this example, the decision engine iterates over the list only one time and can evaluate rules more efficiently.
						</p><p class="simpara">
							For more information about the <code class="literal">from</code> element or other DRL condition elements, see <a class="xref" href="#drl-rules-WHEN-elements-ref_drl-rules" title="15.8.7. Supported rule condition elements in DRL (keywords)">Section 15.8.7, “Supported rule condition elements in DRL (keywords)”</a>.
						</p></dd><dt><span class="term">Use decision engine event listeners instead of <code class="literal">System.out.println</code> statements in rules for debug logging</span></dt><dd><p class="simpara">
							You can use <code class="literal">System.out.println</code> statements in your rule actions for debug logging and console output, but doing this for many rules can impede rule evaluation. As a more efficient alternative, use the built-in decision engine event listeners when possible. If these listeners do not meet your requirements, use a system logging utility supported by the decision engine, such as Logback, Apache Commons Logging, or Apache Log4j.
						</p><p class="simpara">
							For more information about supported decision engine event listeners and logging utilities, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#engine-event-listeners-con_decision-engine"><span class="emphasis"><em>Decision engine in Red Hat Process Automation Manager</em></span></a>.
						</p></dd><dt><span class="term">Use the <code class="literal">drools-metric</code> module to identify the obstruction in your rules</span></dt><dd><p class="simpara">
							You can use the <code class="literal">drools-metric</code> module to identify slow rules especially when you process many rules. The <code class="literal">drools-metric</code> module can also assist in analyzing the decision engine performance. Note that the <code class="literal">drools-metric</code> module is not for production environment use. However, you can perform the analysis in your test environment.
						</p><p class="simpara">
							To analyze the decision engine performance using <code class="literal">drools-metric</code>, add <code class="literal">drools-metric</code> to your project dependencies and enable trace logging for <code class="literal">org.drools.metric.util.MetricLogUtils</code> , as shown in the following example:
						</p><div class="formalpara"><p class="title"><strong>Example project dependency for <code class="literal">drools-metric</code></strong></p><p>
								
<pre class="programlisting language-xml">&lt;dependency&gt;
  &lt;groupId&gt;org.drools&lt;/groupId&gt;
  &lt;artifactId&gt;drools-metric&lt;/artifactId&gt;
&lt;/dependency&gt;</pre>
							</p></div><div class="formalpara"><p class="title"><strong>Example logback.xml configuration file</strong></p><p>
								
<pre class="programlisting language-xml">&lt;configuration&gt;
  &lt;logger name="org.drools.metric.util.MetricLogUtils" level="trace"/&gt;
  ...
&lt;configuration&gt;</pre>
							</p></div><p class="simpara">
							Also, enable <code class="literal">MetricLogUtils</code> by setting the system property <code class="literal">drools.metric.logger.enabled</code> to <code class="literal">true</code>. Optionally, you can change the microseconds threshold of metric logging by setting the <code class="literal">drools.metric.logger.threshold</code> system property.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Only node executions exceeding the threshold are logged. The default value is <code class="literal">500</code>.
							</p></div></div><p class="simpara">
							After you complete the configuration, rule execution produces logs as shown in the following example:
						</p><div class="formalpara"><p class="title"><strong>Example rule execution output</strong></p><p>
								
<pre class="screen">TRACE [JoinNode(6) - [ClassObjectType class=com.sample.Order]], evalCount:1000, elapsedMicro:5962
TRACE [JoinNode(7) - [ClassObjectType class=com.sample.Order]], evalCount:100000, elapsedMicro:95553
TRACE [ AccumulateNode(8) ], evalCount:4999500, elapsedMicro:2172836
TRACE [EvalConditionNode(9)]: cond=com.sample.Rule_Collect_expensive_orders_combination930932360Eval1Invoker@ee2a6922], evalCount:49500, elapsedMicro:18787</pre>
							</p></div><p class="simpara">
							This example includes the following key parameters:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">evalCount</code> is the number of constraint evaluations against inserted facts during the node execution.
								</li><li class="listitem">
									<code class="literal">elapsedMicro</code> is the elapsed time of the node execution in microseconds.
								</li></ul></div><p class="simpara">
							If you find an outstanding <code class="literal">evalCount</code> or <code class="literal">elapsedMicro</code> log, correlate the node name with <code class="literal">ReteDumper.dumpAssociatedRulesRete()</code> output to identify the rule associated with the node.
						</p><div class="formalpara"><p class="title"><strong>Example ReteDumper usage</strong></p><p>
								
<pre class="programlisting language-java">ReteDumper.dumpAssociatedRulesRete(kbase);</pre>
							</p></div><div class="formalpara"><p class="title"><strong>Example ReteDumper output</strong></p><p>
								
<pre class="screen">[ AccumulateNode(8) ] : [Collect expensive orders combination]
...</pre>
							</p></div></dd></dl></div></section><section class="chapter" id="next_steps"><div class="titlepage"><div><div><h2 class="title">Chapter 22. Next steps</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-test-scenarios"><span class="emphasis"><em>Testing a decision service using test scenarios</em></span></a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>
					</li></ul></div></section></div><div class="part" id="assembly-guided-decision-tables"><div class="titlepage"><div><div><h1 class="title">Part IV. Designing a decision service using guided decision tables</h1></div></div></div><div class="partintro" id="idm139921812848960"><div/><p>
				As a business analyst or business rules developer, you can use guided decision tables to define business rules in a wizard-led tabular format. These rules are compiled into Drools Rule Language (DRL) and form the core of the decision service for your project.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					You can also design your decision service using Decision Model and Notation (DMN) models instead of rule-based or table-based assets. For information about DMN support in Red Hat Process Automation Manager 7.10, see the following resources:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/getting_started_with_red_hat_process_automation_manager#assembly-getting-started-decision-services"><span class="emphasis"><em>Getting started with decision services</em></span></a> (step-by-step tutorial with a DMN decision service example)
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-dmn-models"><span class="emphasis"><em>Designing a decision service using DMN models</em></span></a> (overview of DMN support and capabilities in Red Hat Process Automation Manager)
						</li></ul></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The space and project for the guided decision tables have been created in Business Central. Each asset is associated with a project assigned to a space. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/getting_started_with_red_hat_process_automation_manager#assembly-getting-started-decision-services"><span class="emphasis"><em>Getting started with decision services</em></span></a>.
					</li></ul></div><div class="toc"><p><strong>Table of Contents</strong></p><ul class="toc"><li><span class="chapter"><a href="#decision-authoring-assets-ref_guided-decision-tables">23. Decision-authoring assets in Red Hat Process Automation Manager</a></span></li><li><span class="chapter"><a href="#guided-decision-tables-con_guided-decision-tables">24. Guided decision tables</a></span></li><li><span class="chapter"><a href="#data-objects-con_guided-decision-tables">25. Data objects</a></span><ul><li><span class="section"><a href="#data-objects-create-proc_guided-decision-tables">25.1. Creating data objects</a></span></li></ul></li><li><span class="chapter"><a href="#guided-decision-tables-create-proc">26. Creating guided decision tables</a></span></li><li><span class="chapter"><a href="#hit-policies-con">27. Hit policies for guided decision tables</a></span><ul><li><span class="section"><a href="#hit-policies-examples-ref">27.1. Hit policy examples: Decision table for discounts on movie tickets</a></span><ul><li><span class="section"><a href="#guided-decision-tables-types-con">27.1.1. Types of guided decision tables</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#guided-decision-tables-columns-create-proc">28. Adding columns to guided decision tables</a></span></li><li><span class="chapter"><a href="#guided-decision-tables-columns-types-con">29. Types of columns in guided decision tables</a></span><ul><li><span class="section"><a href="#guided-decision-tables-columns-condition-con">29.1. "Add a Condition"</a></span><ul><li><span class="section"><a href="#guided-decision-tables-any-other-add-proc">29.1.1. Inserting an <code class="literal">any other</code> value in condition column cells</a></span></li></ul></li><li><span class="section"><a href="#guided-decision-tables-columns-condition-BRL-con">29.2. "Add a Condition BRL fragment"</a></span></li><li><span class="section"><a href="#guided-decision-tables-columns-metadata-con">29.3. "Add a Metadata column"</a></span></li><li><span class="section"><a href="#guided-decision-tables-columns-action-BRL-con">29.4. "Add an Action BRL fragment"</a></span></li><li><span class="section"><a href="#guided-decision-tables-columns-attribute-con">29.5. "Add an Attribute column"</a></span></li><li><span class="section"><a href="#guided-decision-tables-columns-delete-fact-con">29.6. "Delete an existing fact"</a></span></li><li><span class="section"><a href="#guided-decision-tables-columns-work-item-con">29.7. "Execute a Work Item"</a></span></li><li><span class="section"><a href="#guided-decision-tables-columns-field-con">29.8. "Set the value of a field"</a></span></li><li><span class="section"><a href="#guided-decision-tables-columns-field-work-item-con">29.9. "Set the value of a field with a Work Item result"</a></span></li></ul></li><li><span class="chapter"><a href="#guided-decision-tables-rulename-column-view-proc">30. Viewing Rule Name column in guided decision tables</a></span></li><li><span class="chapter"><a href="#guided-decision-tables-columns-edit-proc">31. Editing or deleting columns in guided decision tables</a></span></li><li><span class="chapter"><a href="#guided-decision-tables-rows-create-proc">32. Adding rows and defining rules in guided decision tables</a></span></li><li><span class="chapter"><a href="#enumerations-define-proc_guided-decision-tables">33. Defining enumerations for drop-down lists in rule assets</a></span><ul><li><span class="section"><a href="#enumerations-advanced-ref_guided-decision-tables">33.1. Advanced enumeration options for rule assets</a></span></li></ul></li><li><span class="chapter"><a href="#guided-decision-tables-validation-con">34. Real-time verification and validation of guided decision tables</a></span><ul><li><span class="section"><a href="#guided-decision-tables-errors-ref">34.1. Types of problems in guided decision tables</a></span></li><li><span class="section"><a href="#guided-decision-tables-messages-ref">34.2. Types of notifications</a></span></li><li><span class="section"><a href="#guided-decision-tables-validation-disable-proc">34.3. Disabling verification and validation of guided decision tables</a></span></li></ul></li><li><span class="chapter"><a href="#guided-decision-tables-convert-proc">35. Converting a guided decision table to a spreadsheet decision table</a></span></li><li><span class="chapter"><a href="#assets-executing-proc_guided-decision-tables">36. Executing rules</a></span></li><li><span class="chapter"><a href="#next_steps_2">37. Next steps</a></span></li></ul></div></div><section class="chapter" id="decision-authoring-assets-ref_guided-decision-tables"><div class="titlepage"><div><div><h2 class="title">Chapter 23. Decision-authoring assets in Red Hat Process Automation Manager</h2></div></div></div><p>
				Red Hat Process Automation Manager supports several assets that you can use to define business decisions for your decision service. Each decision-authoring asset has different advantages, and you might prefer to use one or a combination of multiple assets depending on your goals and needs.
			</p><p>
				The following table highlights the main decision-authoring assets supported in Red Hat Process Automation Manager projects to help you decide or confirm the best method for defining decisions in your decision service.
			</p><div class="table" id="idm139921812835664"><p class="title"><strong>Table 23.1. Decision-authoring assets supported in Red Hat Process Automation Manager</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"/><col style="width: 40%; " class="col_2"/><col style="width: 20%; " class="col_3"/><col style="width: 20%; " class="col_4"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921815877312" scope="col">Asset</th><th align="left" valign="top" id="idm139921815876224" scope="col">Highlights</th><th align="left" valign="top" id="idm139921815875136" scope="col">Authoring tools</th><th align="left" valign="top" id="idm139921815874048" scope="col">Documentation</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921815877312">
							<p>
								Decision Model and Notation (DMN) models
							</p>
							</td><td align="left" valign="top" headers="idm139921815876224">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are decision models based on a notation standard defined by the Object Management Group (OMG)
									</li><li class="listitem">
										Use graphical decision requirements diagrams (DRDs) that represent part or all of the overall decision requirements graph (DRG) to trace business decision flows
									</li><li class="listitem">
										Use an XML schema that allows the DMN models to be shared between DMN-compliant platforms
									</li><li class="listitem">
										Support Friendly Enough Expression Language (FEEL) to define decision logic in DMN decision tables and other DMN boxed expressions
									</li><li class="listitem">
										Can be integrated efficiently with Business Process Model and Notation (BPMN) process models
									</li><li class="listitem">
										Are optimal for creating comprehensive, illustrative, and stable decision flows
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921815875136">
							<p>
								Business Central or other DMN-compliant editor
							</p>
							</td><td align="left" valign="top" headers="idm139921815874048">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-dmn-models"><span class="emphasis"><em>Designing a decision service using DMN models</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921815877312">
							<p>
								Guided decision tables
							</p>
							</td><td align="left" valign="top" headers="idm139921815876224">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are tables of rules that you create in a UI-based table designer in Business Central
									</li><li class="listitem">
										Are a wizard-led alternative to spreadsheet decision tables
									</li><li class="listitem">
										Provide fields and options for acceptable input
									</li><li class="listitem">
										Support template keys and values for creating rule templates
									</li><li class="listitem">
										Support hit policies, real-time validation, and other additional features not supported in other assets
									</li><li class="listitem">
										Are optimal for creating rules in a controlled tabular format to minimize compilation errors
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921815875136">
							<p>
								Business Central
							</p>
							</td><td align="left" valign="top" headers="idm139921815874048">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-guided-decision-tables"><span class="emphasis"><em>Designing a decision service using guided decision tables</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921815877312">
							<p>
								Spreadsheet decision tables
							</p>
							</td><td align="left" valign="top" headers="idm139921815876224">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are XLS or XLSX spreadsheet decision tables that you can upload into Business Central
									</li><li class="listitem">
										Support template keys and values for creating rule templates
									</li><li class="listitem">
										Are optimal for creating rules in decision tables already managed outside of Business Central
									</li><li class="listitem">
										Have strict syntax requirements for rules to be compiled properly when uploaded
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921815875136">
							<p>
								Spreadsheet editor
							</p>
							</td><td align="left" valign="top" headers="idm139921815874048">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-decision-tables"><span class="emphasis"><em>Designing a decision service using spreadsheet decision tables</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921815877312">
							<p>
								Guided rules
							</p>
							</td><td align="left" valign="top" headers="idm139921815876224">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are individual rules that you create in a UI-based rule designer in Business Central
									</li><li class="listitem">
										Provide fields and options for acceptable input
									</li><li class="listitem">
										Are optimal for creating single rules in a controlled format to minimize compilation errors
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921815875136">
							<p>
								Business Central
							</p>
							</td><td align="left" valign="top" headers="idm139921815874048">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-guided-rules"><span class="emphasis"><em>Designing a decision service using guided rules</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921815877312">
							<p>
								Guided rule templates
							</p>
							</td><td align="left" valign="top" headers="idm139921815876224">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are reusable rule structures that you create in a UI-based template designer in Business Central
									</li><li class="listitem">
										Provide fields and options for acceptable input
									</li><li class="listitem">
										Support template keys and values for creating rule templates (fundamental to the purpose of this asset)
									</li><li class="listitem">
										Are optimal for creating many rules with the same rule structure but with different defined field values
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921815875136">
							<p>
								Business Central
							</p>
							</td><td align="left" valign="top" headers="idm139921815874048">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-guided-rule-templates"><span class="emphasis"><em>Designing a decision service using guided rule templates</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921815877312">
							<p>
								DRL rules
							</p>
							</td><td align="left" valign="top" headers="idm139921815876224">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are individual rules that you define directly in <code class="literal">.drl</code> text files
									</li><li class="listitem">
										Provide the most flexibility for defining rules and other technicalities of rule behavior
									</li><li class="listitem">
										Can be created in certain standalone environments and integrated with Red Hat Process Automation Manager
									</li><li class="listitem">
										Are optimal for creating rules that require advanced DRL options
									</li><li class="listitem">
										Have strict syntax requirements for rules to be compiled properly
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921815875136">
							<p>
								Business Central or integrated development environment (IDE)
							</p>
							</td><td align="left" valign="top" headers="idm139921815874048">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-drl-rules"><span class="emphasis"><em>Designing a decision service using DRL rules</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921815877312">
							<p>
								Predictive Model Markup Language (PMML) models
							</p>
							</td><td align="left" valign="top" headers="idm139921815876224">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are predictive data-analytic models based on a notation standard defined by the Data Mining Group (DMG)
									</li><li class="listitem">
										Use an XML schema that allows the PMML models to be shared between PMML-compliant platforms
									</li><li class="listitem">
										Support Regression, Scorecard, Tree, Mining, and other model types
									</li><li class="listitem">
										Can be included with a standalone Red Hat Process Automation Manager project or imported into a project in Business Central
									</li><li class="listitem">
										Are optimal for incorporating predictive data into decision services in Red Hat Process Automation Manager
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921815875136">
							<p>
								PMML or XML editor
							</p>
							</td><td align="left" valign="top" headers="idm139921815874048">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-pmml-models"><span class="emphasis"><em>Designing a decision service using PMML models</em></span></a>
							</p>
							</td></tr></tbody></table></div></div></section><section class="chapter" id="guided-decision-tables-con_guided-decision-tables"><div class="titlepage"><div><div><h2 class="title">Chapter 24. Guided decision tables</h2></div></div></div><p>
				Guided decision tables are a wizard-led alternative to spreadsheet decision tables for defining business rules in a tabular format. With guided decision tables, you are led by a UI-based wizard in Business Central that helps you define rule attributes, metadata, conditions, and actions based on specified data objects in your project. After you create your guided decision tables, the rules you defined are compiled into Drools Rule Language (DRL) rules as with all other rule assets.
			</p><p>
				All data objects related to a guided decision table must be in the same project package as the guided decision table. Assets in the same package are imported by default. After you create the necessary data objects and the guided decision table, you can use the <span class="strong strong"><strong>Data Objects</strong></span> tab of the guided decision tables designer to verify that all required data objects are listed or to import other existing data objects by adding a <span class="strong strong"><strong>New item</strong></span>.
			</p></section><section class="chapter" id="data-objects-con_guided-decision-tables"><div class="titlepage"><div><div><h2 class="title">Chapter 25. Data objects</h2></div></div></div><p>
				Data objects are the building blocks for the rule assets that you create. Data objects are custom data types implemented as Java objects in specified packages of your project. For example, you might create a <code class="literal">Person</code> object with data fields <code class="literal">Name</code>, <code class="literal">Address</code>, and <code class="literal">DateOfBirth</code> to specify personal details for loan application rules. These custom data types determine what data your assets and your decision services are based on.
			</p><section class="section" id="data-objects-create-proc_guided-decision-tables"><div class="titlepage"><div><div><h2 class="title">25.1. Creating data objects</h2></div></div></div><p>
					The following procedure is a generic overview of creating data objects. It is not specific to a particular business asset.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Data Object</strong></span>.
						</li><li class="listitem"><p class="simpara">
							Enter a unique <span class="strong strong"><strong>Data Object</strong></span> name and select the <span class="strong strong"><strong>Package</strong></span> where you want the data object to be available for other rule assets. Data objects with the same name cannot exist in the same package. In the specified DRL file, you can import a data object from any package.
						</p><div class="admonition important"><div class="admonition_header">Importing data objects from other packages</div><div><p>
								You can import an existing data object from another package directly into the asset designers like guided rules or guided decision table designers. Select the relevant rule asset within the project and in the asset designer, go to <span class="strong strong"><strong>Data Objects → New item</strong></span> to select the object to be imported.
							</p></div></div></li><li class="listitem">
							To make your data object persistable, select the <span class="strong strong"><strong>Persistable</strong></span> checkbox. Persistable data objects are able to be stored in a database according to the JPA specification. The default JPA is Hibernate.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Ok</strong></span>.
						</li><li class="listitem"><p class="simpara">
							In the data object designer, click <span class="strong strong"><strong>add field</strong></span> to add a field to the object with the attributes <span class="strong strong"><strong>Id</strong></span>, <span class="strong strong"><strong>Label</strong></span>, and <span class="strong strong"><strong>Type</strong></span>. Required attributes are marked with an asterisk (*).
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="strong strong"><strong>Id:</strong></span> Enter the unique ID of the field.
								</li><li class="listitem">
									<span class="strong strong"><strong>Label:</strong></span> (Optional) Enter a label for the field.
								</li><li class="listitem">
									<span class="strong strong"><strong>Type:</strong></span> Enter the data type of the field.
								</li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>List:</strong></span> (Optional) Select this check box to enable the field to hold multiple items for the specified type.
								</p><div class="figure" id="idm139921812309056"><p class="title"><strong>Figure 25.1. Add data fields to a data object</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/project-data/DataModelerNewField2-new.png" alt="Add data fields to a data object"/></div></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Create</strong></span> to add the new field, or click <span class="strong strong"><strong>Create and continue</strong></span> to add the new field and continue adding other fields.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								To edit a field, select the field row and use the <span class="strong strong"><strong>general properties</strong></span> on the right side of the screen.
							</p></div></div></li></ol></div></section></section><section class="chapter" id="guided-decision-tables-create-proc"><div class="titlepage"><div><div><h2 class="title">Chapter 26. Creating guided decision tables</h2></div></div></div><p>
				You can use guided decision tables to define rule attributes, metadata, conditions, and actions in a tabular format that can be added to your business rules project.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Guided Decision Table</strong></span>.
					</li><li class="listitem">
						Enter an informative <span class="strong strong"><strong>Guided Decision Table</strong></span> name and select the appropriate <span class="strong strong"><strong>Package</strong></span>. The package that you specify must be the same package where the required data objects have been assigned or will be assigned.
					</li><li class="listitem">
						Select <span class="strong strong"><strong>Use Wizard</strong></span> to finish setting up the table in the wizard, or leave this option unselected to finish creating the table and specify remaining configurations in the guided decision tables designer.
					</li><li class="listitem">
						Select the hit policy that you want your rows of rules in the table to conform to. For details, see <a class="xref" href="#hit-policies-con" title="Chapter 27. Hit policies for guided decision tables">Chapter 27, <em>Hit policies for guided decision tables</em></a>.
					</li><li class="listitem">
						Specify whether you want the <span class="strong strong"><strong>Extended entry</strong></span> or <span class="strong strong"><strong>Limited entry</strong></span> table. For details, see <a class="xref" href="#guided-decision-tables-types-con" title="27.1.1. Types of guided decision tables">Section 27.1.1, “Types of guided decision tables”</a>.
					</li><li class="listitem"><p class="simpara">
						Click <span class="strong strong"><strong>Ok</strong></span> to complete the setup. If you have selected <span class="strong strong"><strong>Use Wizard</strong></span>, the Guided Decision Table wizard is displayed. If you did not select the <span class="strong strong"><strong>Use Wizard</strong></span> option, this prompt does not appear and you are taken directly to the table designer.
					</p><p class="simpara">
						For example, the following wizard setup is for a guided decision table in a loan application decision service:
					</p><div class="figure" id="idm139921817197824"><p class="title"><strong>Figure 26.1. Create guided decision table</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/6326_1.png" alt="6326 1"/></div></div></div></li><li class="listitem"><p class="simpara">
						If you are using the wizard, add any available imports, fact patterns, constraints, and actions, and select whether table columns should expand. Click <span class="strong strong"><strong>Finish</strong></span> to close the wizard and view the table designer.
					</p><div class="figure" id="idm139921817192048"><p class="title"><strong>Figure 26.2. Guided Decision Table wizard</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/6328_1.png" alt="6328 1"/></div></div></div></li></ol></div><p>
				In the guided decision tables designer, you can add or edit columns and rows, and make other final adjustments.
			</p></section><section class="chapter" id="hit-policies-con"><div class="titlepage"><div><div><h2 class="title">Chapter 27. Hit policies for guided decision tables</h2></div></div></div><p>
				Hit policies determine the order in which rules (rows) in a guided decision table are applied, whether top to bottom, per specified priority, or other options.
			</p><p>
				The following hit policies are available:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="strong strong"><strong>None:</strong></span> (Default hit policy) Multiple rows can be executed and the verification warns about rows that conflict. Any decision tables that have been uploaded (using a non-guided decision table spreadsheet) will adopt this hit policy.
					</li><li class="listitem">
						<span class="strong strong"><strong>Resolved Hit:</strong></span> Only one row at a time can be executed according to specified priority, regardless of list order (you can give row 10 priority over row 5, for example). This means you can keep the order of the rows you want for visual readability, but specify priority exceptions.
					</li><li class="listitem">
						<span class="strong strong"><strong>Unique Hit:</strong></span> Only one row at a time can be executed, and each row must be unique, with no overlap of conditions being met. If more than one row is executed, then the verification produces a warning at development time.
					</li><li class="listitem">
						<span class="strong strong"><strong>First Hit:</strong></span> Only one row at a time can be executed in the order listed in the table, top to bottom.
					</li><li class="listitem">
						<span class="strong strong"><strong>Rule Order:</strong></span> Multiple rows can be executed and verification does not report conflicts between the rows since they are expected to happen.
					</li></ul></div><div class="figure" id="idm139921817174608"><p class="title"><strong>Figure 27.1. Available hit policies</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/hit-policies-image_1.png" alt="hit policies image 1"/></div></div></div><section class="section" id="hit-policies-examples-ref"><div class="titlepage"><div><div><h2 class="title">27.1. Hit policy examples: Decision table for discounts on movie tickets</h2></div></div></div><p>
					The following is part of an example decision table for discounts on movie tickets based on customer age, student status, or military status, or all three.
				</p><div class="table" id="idm139921817168752"><p class="title"><strong>Table 27.1. Example decision table for available discounts on movie tickets</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"/><col style="width: 33%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921817162944" scope="col">Row Number</th><th align="left" valign="top" id="idm139921812671600" scope="col">Discount Type</th><th align="left" valign="top" id="idm139921812670512" scope="col">Discount</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921817162944">
								<p>
									1
								</p>
								</td><td align="left" valign="top" headers="idm139921812671600">
								<p>
									Senior citizen (age 60+)
								</p>
								</td><td align="left" valign="top" headers="idm139921812670512">
								<p>
									10%
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921817162944">
								<p>
									2
								</p>
								</td><td align="left" valign="top" headers="idm139921812671600">
								<p>
									Student
								</p>
								</td><td align="left" valign="top" headers="idm139921812670512">
								<p>
									10%
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921817162944">
								<p>
									3
								</p>
								</td><td align="left" valign="top" headers="idm139921812671600">
								<p>
									Military
								</p>
								</td><td align="left" valign="top" headers="idm139921812670512">
								<p>
									10%
								</p>
								</td></tr></tbody></table></div></div><p>
					In this example, the total discount to be applied in the end will vary depending on the hit policy specified for the table:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>None/Rule Order:</strong></span> With both <span class="strong strong"><strong>None</strong></span> and <span class="strong strong"><strong>Rule Order</strong></span> hit policies, all applicable rules are incorporated, in this case allowing discounts to be stacked for each customer.
						</p><p class="simpara">
							Example: A senior citizen who is also a student and a military veteran will receive all three discounts, totaling 30%.
						</p><p class="simpara">
							Key difference: With <span class="strong strong"><strong>None</strong></span>, warnings are created for multiple rows applied. With <span class="strong strong"><strong>Rule Order</strong></span>, those warnings are not created.
						</p></li><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>First Hit/Resolved Hit:</strong></span> With both <span class="strong strong"><strong>First Hit</strong></span> and <span class="strong strong"><strong>Resolved Hit</strong></span> policies, only one of the discounts can be applied.
						</p><p class="simpara">
							For <span class="strong strong"><strong>First Hit</strong></span>, the discount that is satisfied first in the list is applied and the others are ignored.
						</p><p class="simpara">
							Example: A senior citizen who is also a student and a military veteran will receive only the senior citizen discount of 10%, since that is listed first in the table.
						</p><p class="simpara">
							For <span class="strong strong"><strong>Resolved Hit</strong></span>, a modified table is required. The discount that you assign a priority exception to in the table, regardless of listed order, will be applied first. To assign this exception, include a new column that specifies the priority of one discount (row) over others.
						</p><p class="simpara">
							Example: If military discounts are prioritized higher than age or student discounts, despite the listed order, then a senior citizen who is also a student and a military veteran will receive only the military discount of 10%, regardless of age or student status.
						</p><p class="simpara">
							Consider the following modified decision table that accommodates a <span class="strong strong"><strong>Resolved Hit</strong></span> policy:
						</p><div class="table" id="idm139921812636912"><p class="title"><strong>Table 27.2. Modified decision table that accommodates a <span class="emphasis"><em>Resolved Hit</em></span> policy</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"/><col style="width: 25%; " class="col_2"/><col style="width: 25%; " class="col_3"/><col style="width: 25%; " class="col_4"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921812629712" scope="col">Row Number</th><th align="left" valign="top" id="idm139921817089168" scope="col">Discount Type</th><th align="left" valign="top" id="idm139921817088080" scope="col">Has Priority over Row</th><th align="left" valign="top" id="idm139921817086992" scope="col">Discount</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921812629712">
										<p>
											1
										</p>
										</td><td align="left" valign="top" headers="idm139921817089168">
										<p>
											Senior citizen (age 60+)
										</p>
										</td><td align="left" valign="top" headers="idm139921817088080"> </td><td align="left" valign="top" headers="idm139921817086992">
										<p>
											10%
										</p>
										</td></tr><tr><td align="left" valign="top" headers="idm139921812629712">
										<p>
											2
										</p>
										</td><td align="left" valign="top" headers="idm139921817089168">
										<p>
											Student
										</p>
										</td><td align="left" valign="top" headers="idm139921817088080"> </td><td align="left" valign="top" headers="idm139921817086992">
										<p>
											10%
										</p>
										</td></tr><tr><td align="left" valign="top" headers="idm139921812629712">
										<p>
											3
										</p>
										</td><td align="left" valign="top" headers="idm139921817089168">
										<p>
											Military
										</p>
										</td><td align="left" valign="top" headers="idm139921817088080">
										<p>
											1
										</p>
										</td><td align="left" valign="top" headers="idm139921817086992">
										<p>
											10%
										</p>
										</td></tr></tbody></table></div></div><p class="simpara">
							In this modified table, the military discount is essentially the new row 1 and therefore takes priority over both age and student discounts, and any other discounts added later. You do not need to specify priority over rows "1 and 2", only over row "1". This changes the row hit order to 3 → 1 → 2 → …​ and so on as the table grows.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The row order would be changed in the same way if you actually moved the military discount to row 1 and applied a <span class="strong strong"><strong>First Hit</strong></span> policy to the table instead. However, if you want the rules listed in a certain way and applied differently, such as in an alphabetized table, the <span class="strong strong"><strong>Resolved Hit</strong></span> policy is useful.
							</p></div></div><p class="simpara">
							Key difference: With <span class="strong strong"><strong>First Hit</strong></span>, rules are applied strictly in the listed order. With <span class="strong strong"><strong>Resolved Hit</strong></span>, rules are applied in the listed order unless priority exceptions are specified.
						</p></li><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>Unique Hit:</strong></span> A modified table is required. With a <span class="strong strong"><strong>Unique Hit</strong></span> policy, rows must be created in a way that it is impossible to satisfy multiple rules at one time. However, you can still specify row-by-row whether to apply one rule or multiple. In this way, with a <span class="strong strong"><strong>Unique Hit</strong></span> policy you can make decision tables more granular and prevent overlap warnings.
						</p><p class="simpara">
							Consider the following modified decision table that accommodates a <span class="strong strong"><strong>Unique Hit</strong></span> policy:
						</p><div class="table" id="idm139921817054640"><p class="title"><strong>Table 27.3. Modified decision table that accommodates a <span class="emphasis"><em>Unique Hit</em></span> policy</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"/><col style="width: 20%; " class="col_2"/><col style="width: 20%; " class="col_3"/><col style="width: 20%; " class="col_4"/><col style="width: 20%; " class="col_5"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921817046512" scope="col">Row Number</th><th align="left" valign="top" id="idm139921817045424" scope="col">Is Senior Citizen (age 65+)</th><th align="left" valign="top" id="idm139921816963936" scope="col">Is Student</th><th align="left" valign="top" id="idm139921816962848" scope="col">Is Military</th><th align="left" valign="top" id="idm139921816961760" scope="col">Discount</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921817046512">
										<p>
											1
										</p>
										</td><td align="left" valign="top" headers="idm139921817045424">
										<p>
											yes
										</p>
										</td><td align="left" valign="top" headers="idm139921816963936">
										<p>
											no
										</p>
										</td><td align="left" valign="top" headers="idm139921816962848">
										<p>
											no
										</p>
										</td><td align="left" valign="top" headers="idm139921816961760">
										<p>
											10%
										</p>
										</td></tr><tr><td align="left" valign="top" headers="idm139921817046512">
										<p>
											2
										</p>
										</td><td align="left" valign="top" headers="idm139921817045424">
										<p>
											no
										</p>
										</td><td align="left" valign="top" headers="idm139921816963936">
										<p>
											yes
										</p>
										</td><td align="left" valign="top" headers="idm139921816962848">
										<p>
											no
										</p>
										</td><td align="left" valign="top" headers="idm139921816961760">
										<p>
											10%
										</p>
										</td></tr><tr><td align="left" valign="top" headers="idm139921817046512">
										<p>
											3
										</p>
										</td><td align="left" valign="top" headers="idm139921817045424">
										<p>
											no
										</p>
										</td><td align="left" valign="top" headers="idm139921816963936">
										<p>
											no
										</p>
										</td><td align="left" valign="top" headers="idm139921816962848">
										<p>
											yes
										</p>
										</td><td align="left" valign="top" headers="idm139921816961760">
										<p>
											10%
										</p>
										</td></tr><tr><td align="left" valign="top" headers="idm139921817046512">
										<p>
											4
										</p>
										</td><td align="left" valign="top" headers="idm139921817045424">
										<p>
											yes
										</p>
										</td><td align="left" valign="top" headers="idm139921816963936">
										<p>
											yes
										</p>
										</td><td align="left" valign="top" headers="idm139921816962848">
										<p>
											no
										</p>
										</td><td align="left" valign="top" headers="idm139921816961760">
										<p>
											20%
										</p>
										</td></tr><tr><td align="left" valign="top" headers="idm139921817046512">
										<p>
											5
										</p>
										</td><td align="left" valign="top" headers="idm139921817045424">
										<p>
											yes
										</p>
										</td><td align="left" valign="top" headers="idm139921816963936">
										<p>
											no
										</p>
										</td><td align="left" valign="top" headers="idm139921816962848">
										<p>
											yes
										</p>
										</td><td align="left" valign="top" headers="idm139921816961760">
										<p>
											20%
										</p>
										</td></tr><tr><td align="left" valign="top" headers="idm139921817046512">
										<p>
											6
										</p>
										</td><td align="left" valign="top" headers="idm139921817045424">
										<p>
											no
										</p>
										</td><td align="left" valign="top" headers="idm139921816963936">
										<p>
											yes
										</p>
										</td><td align="left" valign="top" headers="idm139921816962848">
										<p>
											yes
										</p>
										</td><td align="left" valign="top" headers="idm139921816961760">
										<p>
											20%
										</p>
										</td></tr><tr><td align="left" valign="top" headers="idm139921817046512">
										<p>
											7
										</p>
										</td><td align="left" valign="top" headers="idm139921817045424">
										<p>
											yes
										</p>
										</td><td align="left" valign="top" headers="idm139921816963936">
										<p>
											yes
										</p>
										</td><td align="left" valign="top" headers="idm139921816962848">
										<p>
											yes
										</p>
										</td><td align="left" valign="top" headers="idm139921816961760">
										<p>
											30%
										</p>
										</td></tr></tbody></table></div></div><p class="simpara">
							In this modified table, each row is unique, with no allowance of overlap, and any single discount or any combination of discounts is accommodated.
						</p></li></ul></div><section class="section" id="guided-decision-tables-types-con"><div class="titlepage"><div><div><h3 class="title">27.1.1. Types of guided decision tables</h3></div></div></div><p>
						Two types of decision tables are supported in Red Hat Process Automation Manager: Extended entry and Limited entry tables.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Extended entry:</strong></span> An Extended Entry decision table is one for which the column definitions specify Pattern, Field, and Operator but not value. The values, or states, are themselves held in the body of the decision table.
							</p><div class="informalfigure"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/dtable-extended-entry.png" alt="Extended entry"/></div></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Limited entry:</strong></span> A Limited Entry decision table is one for which the column definitions specify value in addition to Pattern, Field, and Operator. The decision table states, held in the body of the table, are boolean where a positive value (a marked check box) has the effect of meaning the column should apply, or be matched. A negative value (a cleared check box) means the column does not apply.
							</p><div class="informalfigure"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/dtable-limited-entry.png" alt="Limited entry"/></div></div></li></ul></div></section></section></section><section class="chapter" id="guided-decision-tables-columns-create-proc"><div class="titlepage"><div><div><h2 class="title">Chapter 28. Adding columns to guided decision tables</h2></div></div></div><p>
				After you have created the guided decision table, you can define and add various types of columns within the guided decision tables designer.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Any data objects that will be used for column parameters, such as Facts and Fields, have been created within the same package where the guided decision table is found, or have been imported from another package in <span class="strong strong"><strong>Data Objects</strong></span> → <span class="strong strong"><strong>New item</strong></span> of the guided decision tables designer.
					</li></ul></div><p>
				For descriptions of these column parameters, see the "Required column parameters" segments for each column type in <a class="xref" href="#guided-decision-tables-columns-types-con" title="Chapter 29. Types of columns in guided decision tables">Chapter 29, <em>Types of columns in guided decision tables</em></a>.
			</p><p>
				For details about creating data objects, see <a class="xref" href="#data-objects-create-proc_guided-decision-tables" title="25.1. Creating data objects">Section 25.1, “Creating data objects”</a>.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the guided decision tables designer, click <span class="strong strong"><strong>Columns</strong></span> → <span class="strong strong"><strong>Insert Column</strong></span>.
					</li><li class="listitem"><p class="simpara">
						Click <span class="strong strong"><strong>Include advanced options</strong></span> to view the full list of column options.
					</p><div class="figure" id="idm139921815561984"><p class="title"><strong>Figure 28.1. Add columns</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/guided-decision-tables-columns-add_1.png" alt="View column options in the *Add a new column* window"/></div></div></div></li><li class="listitem"><p class="simpara">
						Select the column type that you want to add, click <span class="strong strong"><strong>Next</strong></span>, and follow the steps in the wizard to specify the data required to add the column.
					</p><p class="simpara">
						For descriptions of each column type and required parameters for setup, see <a class="xref" href="#guided-decision-tables-columns-types-con" title="Chapter 29. Types of columns in guided decision tables">Chapter 29, <em>Types of columns in guided decision tables</em></a>.
					</p></li><li class="listitem">
						Click <span class="strong strong"><strong>Finish</strong></span> to add the configured column.
					</li></ol></div><p>
				After all columns are added, you can begin adding rows of rules correlating to your columns to complete the decision table. For details, see <a class="xref" href="#guided-decision-tables-rows-create-proc" title="Chapter 32. Adding rows and defining rules in guided decision tables">Chapter 32, <em>Adding rows and defining rules in guided decision tables</em></a>.
			</p><p>
				The following is an example decision table for a loan application decision service:
			</p><div class="figure" id="idm139921815551120"><p class="title"><strong>Figure 28.2. Example of complete guided decision table</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/guided-decision-tables-columns-add_02.png" alt="Example of complete guided decision table"/></div></div></div></section><section class="chapter" id="guided-decision-tables-columns-types-con"><div class="titlepage"><div><div><h2 class="title">Chapter 29. Types of columns in guided decision tables</h2></div></div></div><p>
				The <span class="strong strong"><strong>Add a new column</strong></span> wizard for guided decision tables provides the following column options. (Select <span class="strong strong"><strong>Include advanced options</strong></span> to view all options.)
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#guided-decision-tables-columns-condition-con" title="29.1. &quot;Add a Condition&quot;">Add a Condition</a>
					</li><li class="listitem">
						<a class="link" href="#guided-decision-tables-columns-condition-BRL-con" title="29.2. &quot;Add a Condition BRL fragment&quot;">Add a Condition BRL fragment</a>
					</li><li class="listitem">
						<a class="link" href="#guided-decision-tables-columns-metadata-con" title="29.3. &quot;Add a Metadata column&quot;">Add a Metadata column</a>
					</li><li class="listitem">
						<a class="link" href="#guided-decision-tables-columns-action-BRL-con" title="29.4. &quot;Add an Action BRL fragment&quot;">Add an Action BRL fragment</a>
					</li><li class="listitem">
						<a class="link" href="#guided-decision-tables-columns-attribute-con" title="29.5. &quot;Add an Attribute column&quot;">Add an Attribute column</a>
					</li><li class="listitem">
						<a class="link" href="#guided-decision-tables-columns-delete-fact-con" title="29.6. &quot;Delete an existing fact&quot;">Delete an existing fact</a>
					</li><li class="listitem">
						<a class="link" href="#guided-decision-tables-columns-work-item-con" title="29.7. &quot;Execute a Work Item&quot;">Execute a Work Item</a>
					</li><li class="listitem">
						<a class="link" href="#guided-decision-tables-columns-field-con" title="29.8. &quot;Set the value of a field&quot;">Set the value of a field</a>
					</li><li class="listitem">
						<a class="link" href="#guided-decision-tables-columns-field-work-item-con" title="29.9. &quot;Set the value of a field with a Work Item result&quot;">Set the value of a field with a Work Item result</a>
					</li></ul></div><p>
				These column types and the parameters required for each in the <span class="strong strong"><strong>Add a new column</strong></span> wizard are described in the sections that follow.
			</p><div class="admonition important" id="required-data-objects"><div class="admonition_header">IMPORTANT: Required data objects for column parameters</div><div><p>
					Some of the column parameters described in this section, such as Fact Patterns and Fields, provide drop-down options consisting only of data objects already defined within the same package where the guided decision table is found. Available data objects for the package are listed in the <span class="strong strong"><strong>Data Objects</strong></span> panel of the Project Explorer and in the <span class="strong strong"><strong>Data Objects</strong></span> tab of the guided decision tables designer. You can create additional data objects within the package as needed, or import them from another package in <span class="strong strong"><strong>Data Objects</strong></span> → <span class="strong strong"><strong>New item</strong></span> of the guided decision tables designer. For details about creating data objects, see <a class="xref" href="#data-objects-create-proc_guided-decision-tables" title="25.1. Creating data objects">Section 25.1, “Creating data objects”</a>.
				</p></div></div><section class="section" id="guided-decision-tables-columns-condition-con"><div class="titlepage"><div><div><h2 class="title">29.1. "Add a Condition"</h2></div></div></div><p>
					Conditions represent fact patterns defined in the left ("WHEN") portion of a rule. With this column option, you can define one or more condition columns that check for the presence or absence of data objects with certain field values, and that affect the action ("THEN") portion of the rule. You can define a binding for the fact in the condition table, or select one that has previously been defined. You can also choose to negate the pattern.
				</p><div class="formalpara"><p class="title"><strong>Example rule conditions</strong></p><p>
						
<pre class="screen">when
  $i : IncomeSource( type == "Asset" ) // Binds the IncomeSource object to the $i variable
then
  ...
end</pre>
					</p></div><pre class="screen">when
  not IncomeSource( type == "Asset" ) // Negates matching pattern
then
  ...
end</pre><p>
					After a binding is specified, you can define field constraints. If two or more columns are defined using the same fact pattern binding, the field constraints become composite field constraints on the same pattern. If you define multiple bindings for a single model class, each binding becomes a separate model class in the condition ("WHEN") side of the rule.
				</p><div class="formalpara"><p class="title"><strong>Required column parameters</strong></p><p>
						The following parameters are required in the <span class="strong strong"><strong>Add a new column</strong></span> wizard to set up this column type:
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Pattern:</strong></span> Select from the list of fact patterns already used in conditions in your table or create a new fact pattern. A fact pattern is a combination of an available data object in the package (see the note on <a class="link" href="#required-data-objects" title="IMPORTANT: Required data objects for column parameters">Required data objects</a> for details) and a model class binding that you specify. (Examples: <code class="literal">LoanApplication [application]</code> or <code class="literal">IncomeSource [income]</code> where the bracketed portion is the binding to the given fact type)
						</li><li class="listitem">
							<span class="strong strong"><strong>Entry point:</strong></span> Define the entry point for the fact pattern, if applicable. An entry point is a gate or stream through which facts enter the decision engine, if specified. (Examples: <code class="literal">Application Stream</code>, <code class="literal">Credit Check Stream</code>)
						</li><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>Calculation type:</strong></span> Select one of the following calculation types:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									<span class="strong strong"><strong>Literal value:</strong></span> The value in the cell will be compared with the field using the operator.
								</li><li class="listitem">
									<span class="strong strong"><strong>Formula:</strong></span> The expression in the cell will be evaluated and then compared with the field.
								</li><li class="listitem">
									<span class="strong strong"><strong>Predicate:</strong></span> No field is needed; the expression will be evaluated to <code class="literal">true</code> or <code class="literal">false</code>.
								</li></ul></div></li><li class="listitem">
							<span class="strong strong"><strong>Field:</strong></span> Select a field from the previously specified fact pattern. The field options are defined in the fact file in the <span class="strong strong"><strong>Data Objects</strong></span> panel of your project. (Examples: <code class="literal">amount</code> or <code class="literal">lengthYears</code> fields within the <code class="literal">LoanApplication</code> fact type)
						</li><li class="listitem">
							<span class="strong strong"><strong>Binding (optional):</strong></span> Define a binding for the previously selected field, if needed. (Example: For pattern <code class="literal">LoanApplication [application]</code>, field <code class="literal">amount</code>, and operator <code class="literal">equal to</code>, if binding is set to <code class="literal">$amount</code>, the end condition will be <code class="literal">application : LoanAppplication($amount : amount == [value])</code>.)
						</li><li class="listitem">
							<span class="strong strong"><strong>Operator:</strong></span> Select the operator to be applied to the fact pattern and field previously specified.
						</li><li class="listitem">
							<span class="strong strong"><strong>Value list (optional):</strong></span> Enter a list of value options, delimited by a comma and space, to limit table input data for the condition ("WHEN") portion of the rule. When this value list is defined, the values will be provided in the table cells for that column as a drop-down list, from which users can select only one option. (Example list: <code class="literal">Monday, Wednesday, Friday</code> to specify only these three options)
						</li><li class="listitem">
							<span class="strong strong"><strong>Default value (optional):</strong></span> Select one of the previously defined value options as the default value that will appear in the cell automatically in a new row. If the default value is not specified, the table cell will be blank by default. You can also select a default value from any previously configured data enumerations in the project, listed in the <span class="strong strong"><strong>Enumeration Definitions</strong></span> panel of the Project Explorer. (You can create enumerations in <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> → <span class="strong strong"><strong><span class="emphasis"><em>[select project]</em></span></strong></span> → <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Enumeration</strong></span>.)
						</li><li class="listitem">
							<span class="strong strong"><strong>Header (description):</strong></span> Add header text for the column.
						</li><li class="listitem">
							<span class="strong strong"><strong>Hide column:</strong></span> Select this to hide the column, or clear this to display the column.
						</li></ul></div><section class="section" id="guided-decision-tables-any-other-add-proc"><div class="titlepage"><div><div><h3 class="title">29.1.1. Inserting an <code class="literal">any other</code> value in condition column cells</h3></div></div></div><p>
						For simple condition columns in guided decision tables, you can apply an <code class="literal">any other</code> value to table cells within the column if the following parameters are set:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>Calculation type</strong></span> for the condition column has been set to <code class="literal">Literal value</code>.
							</li><li class="listitem">
								<span class="strong strong"><strong>Operator</strong></span> has been set as equality <code class="literal">==</code> or inequality <code class="literal">!=</code>.
							</li></ul></div><p>
						The <code class="literal">any other</code> value enables a rule to be defined for any other field values not explicitly defined in the rules already in the table. In the DRL source, <code class="literal">any other</code> is notated as <code class="literal">not in</code>.
					</p><div class="formalpara"><p class="title"><strong>Example rule condition with <code class="literal">not in</code> used for <code class="literal">any other</code></strong></p><p>
							
<pre class="screen">when
  IncomeSource( type not in ("Asset", "Job") )
  ...
then
  ...
end</pre>
						</p></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Select a cell of a condition column that uses the <code class="literal">==</code> or <code class="literal">!=</code> operator.
							</li><li class="listitem">
								In the upper-right toolbar of the table designer, click <span class="strong strong"><strong>Edit</strong></span> → <span class="strong strong"><strong>Insert "any other" value</strong></span>.
							</li></ol></div></section></section><section class="section" id="guided-decision-tables-columns-condition-BRL-con"><div class="titlepage"><div><div><h2 class="title">29.2. "Add a Condition BRL fragment"</h2></div></div></div><p>
					A Business Rule Language (BRL) fragment is a section of a rule created using the guided rules designer. The condition BRL fragment is the "WHEN" portion of the rule, and the <a class="link" href="#guided-decision-tables-columns-action-BRL-con" title="29.4. &quot;Add an Action BRL fragment&quot;">action BRL fragment</a> is the "THEN" portion of the rule. With this column option, you can define a condition BRL fragment to be used in the left ("WHEN") side of a rule. Simpler column types can refer to Facts and Fact fields bound in the BRL fragment and vice-versa.
				</p><p>
					The following example is a condition BRL fragment for a loan application:
				</p><div class="figure" id="idm139921813657472"><p class="title"><strong>Figure 29.1. Add a condition BRL fragment with the embedded guided rules designer</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/guided-decision-tables-columns-condition-BRL.png" alt="Condition BRL Fragment column for guided decision tables designer"/></div></div></div><p>
					You can also select <span class="strong strong"><strong>Free form DRL</strong></span> from the list of condition options to define the condition BRL fragment without the embedded guided rules designer.
				</p><div class="figure" id="idm139921813652096"><p class="title"><strong>Figure 29.2. Add a condition BRL fragment with free form DRL</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/guided-decision-tables-columns-condition-BRL-free.png" alt="Condition BRL Fragment column for guided decision tables designer"/></div></div></div><div class="informalfigure"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/guided-decision-tables-columns-condition-BRL-free-02.png" alt="Condition BRL Fragment column for guided decision tables designer"/></div></div><div class="admonition note"><div class="admonition_header">Template keys</div><div><p>
						When you add a field for a condition BRL fragment, one of the value options is <span class="strong strong"><strong>Template key</strong></span> (as opposed to <span class="strong strong"><strong>Literal</strong></span> or <span class="strong strong"><strong>Formula</strong></span>). Template keys are placeholder variables that are interchanged with a specified value when the guided decision table is generated, and form separate columns in the table for each template key value specified. You can specify the default value of Template key in the <span class="strong strong"><strong>Value options</strong></span> page. While Literal and Formula values are static in a decision table, Template key values can be modified as needed.
					</p><p>
						In the embedded guided rules designer, you can add a template key value to a field by selecting the <span class="strong strong"><strong>Template key</strong></span> field option and entering the value in the editor in the format <code class="literal">$key</code>. For example, <code class="literal">$age</code> creates an <code class="literal">$age</code> column in the decision table.
					</p><p>
						In free form DRL, you can add a template key value to facts in the format <code class="literal">@{key}</code>. For example, <code class="literal">Person( age &gt; @{age} )</code> creates an <code class="literal">$age</code> column in the decision table.
					</p><p>
						The data type is String for new columns added using template keys.
					</p></div></div><div class="formalpara"><p class="title"><strong>Required column parameters</strong></p><p>
						The following parameters are required in the <span class="strong strong"><strong>Add a new column</strong></span> wizard to set up this column type:
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Rule Modeller:</strong></span> Define the condition BRL fragment ("WHEN" portion) for the rule.
						</li><li class="listitem">
							<span class="strong strong"><strong>Header (description):</strong></span> Add header text for the column.
						</li><li class="listitem">
							<span class="strong strong"><strong>Hide column:</strong></span> Select this to hide the column, or clear this to display the column.
						</li></ul></div></section><section class="section" id="guided-decision-tables-columns-metadata-con"><div class="titlepage"><div><div><h2 class="title">29.3. "Add a Metadata column"</h2></div></div></div><p>
					With this column option, you can define a metadata element as a column in your decision table. Each column represents the normal metadata annotation in DRL rules. By default, the metadata column is hidden. To display the column, click <span class="strong strong"><strong>Edit Columns</strong></span> in the guided decision tables designer and clear the <span class="strong strong"><strong>Hide column</strong></span> check box.
				</p><div class="formalpara"><p class="title"><strong>Required column parameter</strong></p><p>
						The following parameter is required in the <span class="strong strong"><strong>Add a new column</strong></span> wizard to set up this column type:
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Metadata:</strong></span> Enter the name of the metadata item in Java variable form (that is, it cannot start with a number or contain spaces or special characters).
						</li></ul></div></section><section class="section" id="guided-decision-tables-columns-action-BRL-con"><div class="titlepage"><div><div><h2 class="title">29.4. "Add an Action BRL fragment"</h2></div></div></div><p>
					A Business Rule Language (BRL) fragment is a section of a rule created using the guided rules designer. The <a class="link" href="#guided-decision-tables-columns-condition-BRL-con" title="29.2. &quot;Add a Condition BRL fragment&quot;">condition BRL fragment</a> is the "WHEN" portion of the rule, and the action BRL fragment is the "THEN" portion of the rule. With this column option you can define an action BRL fragment to be used in the right ("THEN") side of a rule. Simpler column types can refer to Facts and Fact fields bound in the BRL fragment and vice-versa.
				</p><p>
					The following example is an action BRL fragment for a loan application:
				</p><div class="figure" id="idm139921813041648"><p class="title"><strong>Figure 29.3. Add an action BRL fragment with the embedded guided rules designer</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/guided-decision-tables-columns-action-BRL.png" alt="Action BRL Fragment in the guided decision tables designer"/></div></div></div><p>
					You can also select <span class="strong strong"><strong>Add free form DRL</strong></span> from the list of action options to define the action BRL fragment without the embedded guided rules designer.
				</p><div class="figure" id="idm139921813036304"><p class="title"><strong>Figure 29.4. Add an action BRL fragment with free form DRL</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/guided-decision-tables-columns-action-BRL-free.png" alt="Action BRL Fragment column for guided decision tables designer"/></div></div></div><div class="informalfigure"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/guided-decision-tables-columns-action-BRL-free-02.png" alt="Action BRL Fragment column for guided decision tables designer"/></div></div><div class="admonition note"><div class="admonition_header">Template keys</div><div><p>
						When you add a field for an action BRL fragment, one of the value options is <span class="strong strong"><strong>Template key</strong></span> (as opposed to <span class="strong strong"><strong>Literal</strong></span> or <span class="strong strong"><strong>Formula</strong></span>). Template keys are placeholder variables that are interchanged with a specified value when the guided decision table is generated, and form separate columns in the table for each template key value specified. You can specify the default value of Template key in the <span class="strong strong"><strong>Value options</strong></span> page. While Literal and Formula values are static in a decision table, Template key values can be modified as needed.
					</p><p>
						In the embedded guided rules designer, you can add a template key value to a field by selecting the <span class="strong strong"><strong>Template key</strong></span> field option and entering the value in the editor in the format <code class="literal">$key</code>. For example, <code class="literal">$age</code> creates an <code class="literal">$age</code> column in the decision table.
					</p><p>
						In free form DRL, you can add a template key value to facts in the format <code class="literal">@{key}</code>. For example, <code class="literal">Person( age &gt; @{age} )</code> creates an <code class="literal">$age</code> column in the decision table.
					</p><p>
						The data type is String for new columns added using template keys.
					</p></div></div><div class="formalpara"><p class="title"><strong>Required column parameters</strong></p><p>
						The following parameters are required in the <span class="strong strong"><strong>Add a new column</strong></span> wizard to set up this column type:
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Rule Modeller:</strong></span> Define the action BRL fragment ("THEN" portion) for the rule.
						</li><li class="listitem">
							<span class="strong strong"><strong>Header (description):</strong></span> Add header text for the column.
						</li><li class="listitem">
							<span class="strong strong"><strong>Hide column:</strong></span> Select this to hide the column, or clear this to display the column.
						</li></ul></div></section><section class="section" id="guided-decision-tables-columns-attribute-con"><div class="titlepage"><div><div><h2 class="title">29.5. "Add an Attribute column"</h2></div></div></div><p>
					With this column option, you can add one or more attribute columns representing any of the DRL rule attributes, such as Saliance, Enabled, Date-Effective, and others.
				</p><p>
					For example, the following guided decision table uses the <code class="literal">salience</code> attribute to specify rule priority and the <code class="literal">enabled</code> attribute to enable or disable rules for evaluation. Rules with a higher <code class="literal">salience</code> value are evaluated first, and rules with the <code class="literal">enabled</code> attribute are evaluated only if the check box is selected.
				</p><div class="figure" id="idm139921813930064"><p class="title"><strong>Figure 29.5. Example rules with <code class="literal">salience</code> and <code class="literal">enabled</code> attributes to define evaluation behavior</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/guided-decision-tables-columns-attributes.png" alt="Guided decision table with `salience` and `enabled` attributes"/></div></div></div><div class="formalpara"><p class="title"><strong>Example rule source with the rule attributes</strong></p><p>
						
<pre class="screen">rule "Row 1 Pricing loans"
  salience 100
  enabled true
  when
    ...
  then
    ...
end
...
rule "Row 3 Pricing loans"
  enabled false
  when
    ...
  then
    ...
end</pre>
					</p></div><p>
					For descriptions of each attribute, select the attribute from the list in the wizard.
				</p><div class="admonition note"><div class="admonition_header">Hit policies and attributes</div><div><p>
						Note that depending on the hit policy that you have defined for the decision table, some attributes may be disabled because they are internally used by the hit policy. For example, if you have assigned the <span class="strong strong"><strong>Resolved Hit</strong></span> policy to this table so that rows (rules) are applied according to a priority order specified in the table, then the Salience attribute would be obsolete. The reason is that the Salience attribute escalates rule priority according to a defined salience value, and that value would be overridden by the <span class="strong strong"><strong>Resolved Hit</strong></span> policy in the table.
					</p></div></div><div class="formalpara"><p class="title"><strong>Required Column Parameter</strong></p><p>
						The following parameter is required in the <span class="strong strong"><strong>Add a new column</strong></span> wizard to set up this column type:
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Attribute:</strong></span> Select the attribute to be applied to the column.
						</li></ul></div></section><section class="section" id="guided-decision-tables-columns-delete-fact-con"><div class="titlepage"><div><div><h2 class="title">29.6. "Delete an existing fact"</h2></div></div></div><p>
					With this column option, you can implement an action to delete a fact that was added previously as a fact pattern in the table. When this column is created, the fact types are provided in the table cells for that column as a drop-down list, from which users can select only one option.
				</p><div class="formalpara"><p class="title"><strong>Required column parameters</strong></p><p>
						The following parameters are required in the <span class="strong strong"><strong>Add a new column</strong></span> wizard to set up this column type:
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Header (description):</strong></span> Add header text for the column.
						</li><li class="listitem">
							<span class="strong strong"><strong>Hide column:</strong></span> Select this to hide the column, or clear this to display the column.
						</li></ul></div></section><section class="section" id="guided-decision-tables-columns-work-item-con"><div class="titlepage"><div><div><h2 class="title">29.7. "Execute a Work Item"</h2></div></div></div><p>
					With this column option, you can execute a work item handler, based on your predefined work item definitions in Business Central. (You can create work items in <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> → <span class="strong strong"><strong><span class="emphasis"><em>[select project]</em></span></strong></span> → <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Work Item definition</strong></span>.)
				</p><div class="formalpara"><p class="title"><strong>Required column parameters</strong></p><p>
						The following parameters are required in the <span class="strong strong"><strong>Add a new column</strong></span> wizard to set up this column type:
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Work Item:</strong></span> Select from the list of your predefined work items.
						</li><li class="listitem">
							<span class="strong strong"><strong>Header (description):</strong></span> Add header text for the column.
						</li><li class="listitem">
							<span class="strong strong"><strong>Hide column:</strong></span> Select this to hide the column, or clear this to display the column.
						</li></ul></div></section><section class="section" id="guided-decision-tables-columns-field-con"><div class="titlepage"><div><div><h2 class="title">29.8. "Set the value of a field"</h2></div></div></div><p>
					With this column option, you can implement an action to set the value of a field on a previously bound fact for the "THEN" portion of the rule. You have the option to notify the decision engine of the modified values which could lead to other rules being reactivated.
				</p><div class="formalpara"><p class="title"><strong>Required column parameters</strong></p><p>
						The following parameters are required in the <span class="strong strong"><strong>Add a new column</strong></span> wizard to set up this column type:
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Pattern:</strong></span> Select from the list of fact patterns already used in conditions or condition BRL fragments in your table or create a new fact pattern. A fact pattern is a combination of an available data object in the package (see the note on <a class="link" href="#required-data-objects" title="IMPORTANT: Required data objects for column parameters">Required data objects</a> for details) and a model class binding that you specify. (Examples: <code class="literal">LoanApplication [application]</code> or <code class="literal">IncomeSource [income]</code> where the bracketed portion is the binding to the given fact type)
						</li><li class="listitem">
							<span class="strong strong"><strong>Field:</strong></span> Select a field from the previously specified fact pattern. The field options are defined in the fact file in the <span class="strong strong"><strong>Data Objects</strong></span> panel of your project. (Examples: <code class="literal">amount</code> or <code class="literal">lengthYears</code> fields within the <code class="literal">LoanApplication</code> fact type)
						</li><li class="listitem">
							<span class="strong strong"><strong>Value list (optional):</strong></span> Enter a list of value options, delimited by a comma and space, to limit table input data for the action ("THEN") portion of the rule. When this value list is defined, the values will be provided in the table cells for that column as a drop-down list, from which users can select only one option. (Example list: <code class="literal">Accepted, Declined, Pending</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Default value (optional):</strong></span> Select one of the previously defined value options as the default value that will appear in the cell automatically in a new row. If the default value is not specified, the table cell will be blank by default. You can also select a default value from any previously configured data enumerations in the project, listed in the <span class="strong strong"><strong>Enumeration Definitions</strong></span> panel of the Project Explorer. (You can create enumerations in <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> → <span class="strong strong"><strong><span class="emphasis"><em>[select project]</em></span></strong></span> → <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Enumeration</strong></span>.)
						</li><li class="listitem">
							<span class="strong strong"><strong>Header (description):</strong></span> Add header text for the column.
						</li><li class="listitem">
							<span class="strong strong"><strong>Hide column:</strong></span> Select this to hide the column, or clear this to display the column.
						</li><li class="listitem">
							<span class="strong strong"><strong>Logically insert:</strong></span> This option appears when the selected Fact Pattern is not currently used in another column in the guided decision table (see the next field description). Select this to insert the fact pattern logically into the decision engine, or clear this to insert it regularly. The decision engine is responsible for logical decisions on insertions and retractions of facts. After regular or stated insertions, facts have to be retracted explicitly. After logical insertions, facts are automatically retracted when the conditions that asserted the facts in the first place are no longer true.
						</li><li class="listitem">
							<span class="strong strong"><strong>Update engine with changes:</strong></span> This option appears when the selected Fact Pattern is already used in another column in the guided decision table. Select this to update the decision engine with the modified field values, or clear this to not update the decision engine.
						</li></ul></div></section><section class="section" id="guided-decision-tables-columns-field-work-item-con"><div class="titlepage"><div><div><h2 class="title">29.9. "Set the value of a field with a Work Item result"</h2></div></div></div><p>
					With this column option, you can implement an action to set the value of a previously defined fact field to the value of a result of a work item handler for the "THEN" portion of the rule. The work item must define a result parameter of the same data type as a field on a bound fact in order for you to set the field to the return parameter. (You can create work items in <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> → <span class="strong strong"><strong><span class="emphasis"><em>[select project]</em></span></strong></span> → <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Work Item definition</strong></span>.)
				</p><p>
					An <span class="emphasis"><em><a class="link" href="#guided-decision-tables-columns-work-item-con" title="29.7. &quot;Execute a Work Item&quot;">Execute a Work Item</a></em></span> column must already be created in the table for this column option to be created.
				</p><div class="formalpara"><p class="title"><strong>Required column parameters</strong></p><p>
						The following parameters are required in the <span class="strong strong"><strong>Add a new column</strong></span> wizard to set up this column type:
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Pattern:</strong></span> Select from the list of fact patterns already used in your table or create a new fact pattern. A fact pattern is a combination of an available data object in the package (see the note on <a class="link" href="#required-data-objects" title="IMPORTANT: Required data objects for column parameters">Required data objects</a> for details) and a model class binding that you specify. (Examples: <code class="literal">LoanApplication [application]</code> or <code class="literal">IncomeSource [income]</code> where the bracketed portion is the binding to the given fact type)
						</li><li class="listitem">
							<span class="strong strong"><strong>Field:</strong></span> Select a field from the previously specified fact pattern. The field options are defined in the fact file in the <span class="strong strong"><strong>Data Objects</strong></span> panel of your project. (Examples: <code class="literal">amount</code> or <code class="literal">lengthYears</code> fields within the <code class="literal">LoanApplication</code> fact type)
						</li><li class="listitem">
							<span class="strong strong"><strong>Work Item:</strong></span> Select from the list of your predefined work items. (The work item must define a result parameter of the same data type as a field on a bound fact in order for you to set the field to the return parameter.)
						</li><li class="listitem">
							<span class="strong strong"><strong>Header (description):</strong></span> Add header text for the column.
						</li><li class="listitem">
							<span class="strong strong"><strong>Hide column:</strong></span> Select this to hide the column, or clear this to display the column.
						</li><li class="listitem">
							<span class="strong strong"><strong>Logically insert:</strong></span> This option appears when the selected Fact Pattern is not currently used in another column in the guided decision table (see the next field description). Select this to insert the fact pattern logically into the decision engine, or clear this to insert it regularly. The decision engine is responsible for logical decisions on insertions and retractions of facts. After regular or stated insertions, facts have to be retracted explicitly. After logical insertions, facts are automatically retracted when the conditions that asserted the facts in the first place are no longer true.
						</li><li class="listitem">
							<span class="strong strong"><strong>Update engine with changes:</strong></span> This option appears when the selected Fact Pattern is already used in another column in the guided decision table. Select this to update the decision engine with the modified field values, or clear this to not update the decision engine.
						</li></ul></div></section></section><section class="chapter" id="guided-decision-tables-rulename-column-view-proc"><div class="titlepage"><div><div><h2 class="title">Chapter 30. Viewing Rule Name column in guided decision tables</h2></div></div></div><p>
				You can view the <span class="strong strong"><strong>Rule Name</strong></span> column in the guided decision table if needed.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the guided decision tables designer, click <span class="strong strong"><strong>Columns</strong></span>.
					</li><li class="listitem">
						Select the <span class="strong strong"><strong>Show rule name column</strong></span> check box.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Finish</strong></span> to save.
					</li></ol></div><p>
				The default rule name format is <code class="literal">Row (row_number)(table_name)</code>. The <span class="strong strong"><strong>Source</strong></span> contains the default value if you do not specify a rule name. In the guided decision table, you can add a rule name in the <span class="strong strong"><strong>Rule Name</strong></span> column and override the default value.
			</p></section><section class="chapter" id="guided-decision-tables-columns-edit-proc"><div class="titlepage"><div><div><h2 class="title">Chapter 31. Editing or deleting columns in guided decision tables</h2></div></div></div><p>
				You can edit or delete the columns you have created at any time in the guided decision tables designer.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the guided decision tables designer, click <span class="strong strong"><strong>Columns</strong></span>.
					</li><li class="listitem"><p class="simpara">
						Expand the appropriate section and click <span class="strong strong"><strong>Edit</strong></span> or <span class="strong strong"><strong>Delete</strong></span> next to the column name.
					</p><div class="figure" id="idm139921813099216"><p class="title"><strong>Figure 31.1. Edit or delete columns</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/guided-decision-tables-columns-edit.png" alt="Edit or delete columns in the guided decision tables designer."/></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							A condition column cannot be deleted if an existing action column uses the same pattern-matching parameters as the condition column.
						</p></div></div></li><li class="listitem">
						After any column changes, click <span class="strong strong"><strong>Finish</strong></span> in the wizard to save.
					</li></ol></div></section><section class="chapter" id="guided-decision-tables-rows-create-proc"><div class="titlepage"><div><div><h2 class="title">Chapter 32. Adding rows and defining rules in guided decision tables</h2></div></div></div><p>
				After you have created your columns in the guided decision table, you can add rows and define rules within the guided decision tables designer.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Columns for the guided decision table have been added as described in <a class="xref" href="#guided-decision-tables-columns-create-proc" title="Chapter 28. Adding columns to guided decision tables">Chapter 28, <em>Adding columns to guided decision tables</em></a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						In the guided decision tables designer, click <span class="strong strong"><strong>Insert</strong></span> → <span class="strong strong"><strong>Append row</strong></span> or one of the <span class="strong strong"><strong>Insert row</strong></span> options. (You can also click <span class="strong strong"><strong>Insert column</strong></span> to open the column wizard and define a new column.)
					</p><div class="figure" id="idm139921816677168"><p class="title"><strong>Figure 32.1. Add Rows</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/guided-decision-tables-rows-add.png" alt="Add rows in the guided decision tables designer"/></div></div></div></li><li class="listitem"><p class="simpara">
						Double-click each cell and enter data. For cells with specified values, select from the cell drop-down options.
					</p><div class="figure" id="idm139921816672192"><p class="title"><strong>Figure 32.2. Enter input data in each cell</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/guided-decision-tables-rows-add_02.png" alt="Enter data in individual cells"/></div></div></div></li><li class="listitem"><p class="simpara">
						After you define all rows of data in the guided decision table, click <span class="strong strong"><strong>Validate</strong></span> in the upper-right toolbar of the guided decision tables designer to validate the table. If the table validation fails, address any problems described in the error message, review all components in the table, and try again to validate the table until the table passes.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Although guided decision tables have real-time verification and validation, you should still manually validate the completed decision table to ensure optimal results.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Click <span class="strong strong"><strong>Save</strong></span> in the table designer to save your changes.
					</p><p class="simpara">
						After you define your guided decision table contents, in the upper-right corner of the guided decision tables designer, you can use the search bar if needed to search for text that appears in your guided decision table. The search feature is especially helpful in complex guided decision tables with many values:
					</p><div class="figure" id="idm139921816662544"><p class="title"><strong>Figure 32.3. Search guided decision table contents</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/guided-decision-tables-search.png" alt="Search guided decision table contents"/></div></div></div></li></ol></div></section><section class="chapter" id="enumerations-define-proc_guided-decision-tables"><div class="titlepage"><div><div><h2 class="title">Chapter 33. Defining enumerations for drop-down lists in rule assets</h2></div></div></div><p>
				Enumeration definitions in Business Central determine the possible values of fields for conditions or actions in guided rules, guided rule templates, and guided decision tables. An enumeration definition contains a <code class="literal">fact.field</code> mapping to a list of supported values that are displayed as a drop-down list in the relevant field of a rule asset. When a user selects a field that is based on the same fact and field as the enumeration definition, the drop-down list of defined values is displayed.
			</p><p>
				You can define enumerations in Business Central or in the DRL source for your Red Hat Process Automation Manager project.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Enumeration</strong></span>.
					</li><li class="listitem">
						Enter an informative <span class="strong strong"><strong>Enumeration</strong></span> name and select the appropriate <span class="strong strong"><strong>Package</strong></span>. The package that you specify must be the same package where the required data objects and relevant rule assets have been assigned or will be assigned.
					</li><li class="listitem"><p class="simpara">
						Click <span class="strong strong"><strong>Ok</strong></span> to create the enumeration.
					</p><p class="simpara">
						The new enumeration is now listed in the <span class="strong strong"><strong>Enumeration Definitions</strong></span> panel of the <span class="strong strong"><strong>Project Explorer</strong></span>.
					</p></li><li class="listitem"><p class="simpara">
						In the <span class="strong strong"><strong>Model</strong></span> tab of the enumerations designer, click <span class="strong strong"><strong>Add enum</strong></span> and define the following values for the enumeration:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>Fact</strong></span>: Specify an existing data object within the same package of your project with which you want to associate this enumeration. Open the <span class="strong strong"><strong>Data Objects</strong></span> panel in the <span class="strong strong"><strong>Project Explorer</strong></span> to view the available data objects, or create the relevant data object as a new asset if needed.
							</li><li class="listitem">
								<span class="strong strong"><strong>Field</strong></span>: Specify an existing field identifier that you defined as part of the data object that you selected for the <span class="strong strong"><strong>Fact</strong></span>. Open the <span class="strong strong"><strong>Data Objects</strong></span> panel in the <span class="strong strong"><strong>Project Explorer</strong></span> to select the relevant data object and view the list of available <span class="strong strong"><strong>Identifier</strong></span> options. You can create the relevant identifier for the data object if needed.
							</li><li class="listitem">
								<span class="strong strong"><strong>Context</strong></span>: Specify a list of values in the format <code class="literal">['string1','string2','string3']</code> or <code class="literal">[integer1,integer2,integer3]</code> that you want to map to the <span class="strong strong"><strong>Fact</strong></span> and <span class="strong strong"><strong>Field</strong></span> definitions. These values will be displayed as a drop-down list for the relevant field of the rule asset.
							</li></ul></div><p class="simpara">
						For example, the following enumeration defines the drop-down values for applicant credit rating in a loan application decision service:
					</p><div class="figure" id="idm139921815308880"><p class="title"><strong>Figure 33.1. Example enumeration for applicant credit rating in Business Central</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Workbench/AuthoringAssets/EnumConfig.png" alt="EnumConfig"/></div></div></div><div class="formalpara"><p class="title"><strong>Example enumeration for applicant credit rating in the DRL source</strong></p><p>
							
<pre class="screen">'Applicant.creditRating' : ['AA', 'OK', 'Sub prime']</pre>
						</p></div><p class="simpara">
						In this example, for any guided rule, guided rule template, or guided decision table that is in the same package of the project and that uses the <code class="literal">Applicant</code> data object and the <code class="literal">creditRating</code> field, the configured values are available as drop-down options:
					</p><div class="figure" id="idm139921815301056"><p class="title"><strong>Figure 33.2. Example enumeration drop-down options in a guided rule or guided rule template</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Workbench/AuthoringAssets/EnumDropDown.png" alt="EnumDropDown"/></div></div></div><div class="figure" id="idm139921815296832"><p class="title"><strong>Figure 33.3. Example enumeration drop-down options in a guided decision table</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Workbench/AuthoringAssets/EnumDropDownGDT.png" alt="EnumDropDownGDT"/></div></div></div></li></ol></div><section class="section" id="enumerations-advanced-ref_guided-decision-tables"><div class="titlepage"><div><div><h2 class="title">33.1. Advanced enumeration options for rule assets</h2></div></div></div><p>
					For advanced use cases with enumeration definitions in your Red Hat Process Automation Manager project, consider the following extended options for defining enumerations:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Mapping between DRL values and values in Business Central</span></dt><dd><p class="simpara">
								If you want the enumeration values to appear differently or more completely in the Business Central interface than they appear in the DRL source, use a mapping in the format <code class="literal">'fact.field' : ['sourceValue1=UIValue1','sourceValue2=UIValue2', …​ ]</code> for your enumeration definition values.
							</p><p class="simpara">
								For example, in the following enumeration definition for loan status, the options <code class="literal">A</code> or <code class="literal">D</code> are used in the DRL file but the options <code class="literal">Approved</code> or <code class="literal">Declined</code> are displayed in Business Central:
							</p><pre class="screen">'Loan.status' : ['A=Approved','D=Declined']</pre></dd><dt><span class="term">Enumeration value dependencies</span></dt><dd><p class="simpara">
								If you want the selected value in one drop-down list to determine the available options in a subsequent drop-down list, use the format <code class="literal">'fact.fieldB[fieldA=value1]' : ['value2', 'value3', …​ ]</code> for your enumeration definition.
							</p><p class="simpara">
								For example, in the following enumeration definition for insurance policies, the <code class="literal">policyType</code> field accepts the values <code class="literal">Home</code> or <code class="literal">Car</code>. The type of policy that the user selects determines the policy <code class="literal">coverage</code> field options that are then available:
							</p><pre class="screen">'Insurance.policyType' : ['Home', 'Car']
'Insurance.coverage[policyType=Home]' : ['property', 'liability']
'Insurance.coverage[policyType=Car]' : ['collision', 'fullCoverage']</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Enumeration dependencies are not applied across rule conditions and actions. For example, in this insurance policy use case, the selected policy in the rule condition does not determine the available coverage options in the rule actions, if applicable.
								</p></div></div></dd><dt><span class="term">External data sources in enumerations</span></dt><dd><p class="simpara">
								If you want to retrieve a list of enumeration values from an external data source instead of defining the values directly in the enumeration definition, on the class path of your project, add a helper class that returns a <code class="literal">java.util.List</code> list of strings. In the enumeration definition, instead of specifying a list of values, identify the helper class that you configured to retrieve the values externally.
							</p><p class="simpara">
								For example, in the following enumeration definition for loan applicant region, instead of defining applicant regions explicitly in the format <code class="literal">'Applicant.region' : ['country1', 'country2', …​ ]</code>, the enumeration uses a helper class that returns the list of values defined externally:
							</p><pre class="screen">'Applicant.region' : (new com.mycompany.DataHelper()).getListOfRegions()</pre><p class="simpara">
								In this example, a <code class="literal">DataHelper</code> class contains a <code class="literal">getListOfRegions()</code> method that returns a list of strings. The enumerations are loaded in the drop-down list for the relevant field in the rule asset.
							</p><p class="simpara">
								You can also load dependent enumeration definitions dynamically from a helper class by identifying the dependent field as usual and enclosing the call to the helper class within quotation marks:
							</p><pre class="screen">'Applicant.region[countryCode]' : '(new com.mycompany.DataHelper()).getListOfRegions("@{countryCode}")'</pre><p class="simpara">
								If you want to load all enumeration data entirely from an external data source, such as a relational database, you can implement a Java class that returns a <code class="literal">Map&lt;String, List&lt;String&gt;&gt;</code> map. The key of the map is the <code class="literal">fact.field</code> mapping and the value is a <code class="literal">java.util.List&lt;String&gt;</code> list of values.
							</p><p class="simpara">
								For example, the following Java class defines loan applicant regions for the related enumeration:
							</p><pre class="programlisting language-java">public class SampleDataSource {

  public Map&lt;String, List&lt;String&gt;&gt; loadData() {
    Map data = new HashMap();

    List d = new ArrayList();
    d.add("AU");
    d.add("DE");
    d.add("ES");
    d.add("UK");
    d.add("US");
    ...
    data.put("Applicant.region", d);

    return data;
  }

}</pre><p class="simpara">
								The following enumeration definition correlates to this example Java class. The enumeration contains no references to fact or field names because they are defined in the Java class:
							</p><pre class="screen">=(new SampleDataSource()).loadData()</pre><p class="simpara">
								The <code class="literal">=</code> operator enables Business Central to load all enumeration data from the helper class. The helper methods are statically evaluated when the enumeration definition is requested for use in an editor.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Defining an enumeration without a fact and field definition is currently not supported in Business Central. To define the enumeration for the associated Java class in this way, use the DRL source in your Red Hat Process Automation Manager project.
								</p></div></div></dd></dl></div></section></section><section class="chapter" id="guided-decision-tables-validation-con"><div class="titlepage"><div><div><h2 class="title">Chapter 34. Real-time verification and validation of guided decision tables</h2></div></div></div><p>
				Business Central provides a real-time verification and validation feature for guided decision tables to ensure that your tables are complete and error free. Guided decision tables are validated after each cell change. If a problem in logic is detected, an error notification appears and describes the problem.
			</p><section class="section" id="guided-decision-tables-errors-ref"><div class="titlepage"><div><div><h2 class="title">34.1. Types of problems in guided decision tables</h2></div></div></div><p>
					The validation and verification feature detects the following types of problems:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Redundancy</span></dt><dd>
								Redundancy occurs when two rows in a decision table execute the same consequences for the same set of facts. For example, two rows checking a client’s birthday and providing a birthday discount may result in double discount.
							</dd><dt><span class="term">Subsumption</span></dt><dd><p class="simpara">
								Subsumption is similar to redundancy and occurs when two rules execute the same consequences, but one executes on a subset of facts of the other. For example, consider these two rules:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<span class="emphasis"><em>when Person age &gt; 10 then Increase Counter</em></span>
									</li><li class="listitem">
										<span class="emphasis"><em>when Person age &gt; 20 then Increase Counter</em></span>
									</li></ul></div><p class="simpara">
								In this case, if a person is 15 years old, only one rule fires and if a person is 20 years old, both rules fire. Such cases cause similar trouble during runtime as redundancy.
							</p></dd><dt><span class="term">Conflicts</span></dt><dd><p class="simpara">
								A conflicting situation occurs when two similar conditions have different consequences. Conflicts can occur between two rows (rules) or two cells in a decision table.
							</p><p class="simpara">
								The following example illustrates conflict between two rows in a decision table:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<span class="emphasis"><em>when Deposit &gt; 20000 then Approve Loan</em></span>
									</li><li class="listitem">
										<span class="emphasis"><em>when Deposit &gt; 20000 then Refuse Loan</em></span>
									</li></ul></div><p class="simpara">
								In this case, there is no way to know if the loan will be approved or not.
							</p><p class="simpara">
								The following example illustrates conflict between two cells in a decision table:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<span class="emphasis"><em>when Age &gt; 25</em></span>
									</li><li class="listitem">
										<span class="emphasis"><em>when Age &lt; 25</em></span>
									</li></ul></div><p class="simpara">
								A row with conflicting cells never executes.
							</p></dd><dt><span class="term">Broken <span class="emphasis"><em>Unique Hit</em></span> Policy</span></dt><dd><p class="simpara">
								When the <span class="strong strong"><strong>Unique Hit</strong></span> policy is applied to a decision table, only one row at a time can be executed and each row must be unique, with no overlap of conditions being met. If more than one row is executed, then the verification report identifies the broken hit policy. For example, consider the following conditions in a table that determines eligibility for a price discount:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<span class="emphasis"><em>when Is Student = true</em></span>
									</li><li class="listitem">
										<span class="emphasis"><em>when Is Military = true</em></span>
									</li></ul></div><p class="simpara">
								If a customer is both a student and in the military, both conditions apply and break the <span class="strong strong"><strong>Unique Hit</strong></span> policy. Rows in this type of table must therefore be created in a way that does not allow multiple rules to fire at one time. For details about hit policies, see <a class="xref" href="#hit-policies-con" title="Chapter 27. Hit policies for guided decision tables">Chapter 27, <em>Hit policies for guided decision tables</em></a>.
							</p></dd><dt><span class="term">Deficiency</span></dt><dd><p class="simpara">
								Deficiency is similar to a conflict and occurs the logic of a rule in a decision table is incomplete. For example, consider the following two deficient rules:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<span class="emphasis"><em>when Age &gt; 20 then Approve Loan</em></span>
									</li><li class="listitem">
										<span class="emphasis"><em>when Deposit &lt; 20000 then Refuse Loan</em></span>
									</li></ul></div><p class="simpara">
								These two rules may lead to confusion for a person who is over 20 years old and has deposited less than 20000. You can add more constraints to avoid the conflict.
							</p></dd><dt><span class="term">Missing Columns</span></dt><dd>
								When deleted columns result in incomplete or incorrect logic, rules cannot fire properly. This is detected so that you can address the missing columns, or adjust the logic to not rely on intentionally deleted conditions or actions.
							</dd><dt><span class="term">Incomplete Ranges</span></dt><dd>
								Ranges of field values are incomplete if a table contains constraints against possible field values but does not define all possible values. The verification report identifies any incomplete ranges provided. For example, if your table has a check for if an application is approved, the verification report reminds you to make sure you also handle situations where the application was not approved.
							</dd></dl></div></section><section class="section" id="guided-decision-tables-messages-ref"><div class="titlepage"><div><div><h2 class="title">34.2. Types of notifications</h2></div></div></div><p>
					The verification and validation feature uses three types of notifications:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="inlinemediaobject"><img src="images/_images/Workbench/AuthoringAssets/gdtValidationVerificationIconError.png" alt="gdtValidationVerificationIconError"/></span>
							 Error: A serious problem that may lead to the guided decision table failing to work as designed at run time. Conflicts, for example, are reported as errors.
						</li><li class="listitem">
							<span class="inlinemediaobject"><img src="images/_images/Workbench/AuthoringAssets/gdtValidationVerificationIconWarning.png" alt="gdtValidationVerificationIconWarning"/></span>
							 Warning: Likely a serious problem that may not prevent the guided decision table from working but requires attention. Subsumptions, for example, are reported as warnings.
						</li><li class="listitem">
							<span class="inlinemediaobject"><img src="images/_images/Workbench/AuthoringAssets/gdtValidationVerificationIconInfo.png" alt="gdtValidationVerificationIconInfo"/></span>
							 Information: A moderate or minor problem that may not prevent the guided decision table from working but requires attention. Missing columns, for example, are reported as information.
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Business Central verification and validation does not prevent you from saving an incorrect change. The feature only reports issues while editing and you can still continue to overlook those and save your changes.
					</p></div></div></section><section class="section" id="guided-decision-tables-validation-disable-proc"><div class="titlepage"><div><div><h2 class="title">34.3. Disabling verification and validation of guided decision tables</h2></div></div></div><p>
					The decision table verification and validation feature of Business Central is enabled by default. This feature helps you validate your guided decision tables, but with complex guided decision tables, this feature can hinder decision engine performance. You can disable this feature by setting the <code class="literal">org.kie.verification.disable-dtable-realtime-verification</code> system property value to <code class="literal">true</code> in your Red Hat Process Automation Manager distribution.
				</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						Navigate to <code class="literal">~/standalone-full.xml</code> and add the following system property:
					</p></div><pre class="screen">&lt;property name="org.kie.verification.disable-dtable-realtime-verification" value="true"/&gt;</pre><p>
					For example, on Red Hat JBoss EAP, you add this system property in <code class="literal">$EAP_HOME/standalone/configuration/standalone-full.xml</code>.
				</p></section></section><section class="chapter" id="guided-decision-tables-convert-proc"><div class="titlepage"><div><div><h2 class="title">Chapter 35. Converting a guided decision table to a spreadsheet decision table</h2></div></div></div><p>
				After you define a guided decision table in Business Central, you can convert the guided decision table to an XLS spreadsheet decision table file for offline reference and file sharing. The guided decision table must be an extended entry guided decision table in order to be converted. The conversion tool does not support limited entry guided decision tables.
			</p><p>
				For more information about spreadsheet decision tables, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-decision-tables"><span class="emphasis"><em>Designing a decision service using spreadsheet decision tables</em></span></a>.
			</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					Guided decision tables and spreadsheet decision tables are different table formats that support different features. Any supported features that differ between the two decision table formats (Hit policy, for example) are modified or lost when you convert one decision table format to the other.
				</p></div></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					In Business Central, navigate to the guided decision table asset that you want to convert and in the upper-right toolbar of the decision tables designer, click <span class="strong strong"><strong>Convert to XLS</strong></span>:
				</p></div><div class="figure" id="idm139921817237488"><p class="title"><strong>Figure 35.1. Convert an uploaded decision table</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/guided-decision-tables-convert.png" alt="Decision table example"/></div></div></div><p>
				After the conversion, the converted decision table is then available as a spreadsheet decision table asset in your project that you can download for offline reference.
			</p></section><section class="chapter" id="assets-executing-proc_guided-decision-tables"><div class="titlepage"><div><div><h2 class="title">Chapter 36. Executing rules</h2></div></div></div><p>
				After you identify example rules or create your own rules in Business Central, you can build and deploy the associated project and execute rules locally or on KIE Server to test the rules.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Business Central and KIE Server are installed and running. For installation options, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/installing_and_configuring_red_hat_process_automation_manager#assembly-planning"><span class="emphasis"><em>Planning a Red Hat Process Automation Manager installation</em></span></a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
					</li><li class="listitem"><p class="simpara">
						In the upper-right corner of the project <span class="strong strong"><strong>Assets</strong></span> page, click <span class="strong strong"><strong>Deploy</strong></span> to build the project and deploy it to KIE Server. If the build fails, address any problems described in the <span class="strong strong"><strong>Alerts</strong></span> panel at the bottom of the screen.
					</p><p class="simpara">
						For more information about project deployment options, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							If the rule assets in your project are not built from an executable rule model by default, verify that the following dependency is in the <code class="literal">pom.xml</code> file of your project and rebuild the project:
						</p><pre class="programlisting language-xml">&lt;dependency&gt;
  &lt;groupId&gt;org.drools&lt;/groupId&gt;
  &lt;artifactId&gt;drools-model-compiler&lt;/artifactId&gt;
  &lt;version&gt;${rhpam.version}&lt;/version&gt;
&lt;/dependency&gt;</pre><p>
							This dependency is required for rule assets in Red Hat Process Automation Manager to be built from executable rule models by default. This dependency is included as part of the Red Hat Process Automation Manager core packaging, but depending on your Red Hat Process Automation Manager upgrade history, you may need to manually add this dependency to enable the executable rule model behavior.
						</p><p>
							For more information about executable rule models, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#executable-model-con_packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Create a Maven or Java project outside of Business Central, if not created already, that you can use for executing rules locally or that you can use as a client application for executing rules on KIE Server. The project must contain a <code class="literal">pom.xml</code> file and any other required components for executing the project resources.
					</p><p class="simpara">
						For example test projects, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#drl-rules-other-con">"Other methods for creating and executing DRL rules"</a>.
					</p></li><li class="listitem"><p class="simpara">
						Open the <code class="literal">pom.xml</code> file of your test project or client application and add the following dependencies, if not added already:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">kie-ci</code>: Enables your client application to load Business Central project data locally using <code class="literal">ReleaseId</code>
							</li><li class="listitem">
								<code class="literal">kie-server-client</code>: Enables your client application to interact remotely with assets on KIE Server
							</li><li class="listitem">
								<code class="literal">slf4j</code>: (Optional) Enables your client application to use Simple Logging Facade for Java (SLF4J) to return debug logging information after you interact with KIE Server
							</li></ul></div><p class="simpara">
						Example dependencies for Red Hat Process Automation Manager 7.10 in a client application <code class="literal">pom.xml</code> file:
					</p><pre class="programlisting language-xml">&lt;!-- For local execution --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-ci&lt;/artifactId&gt;
  &lt;version&gt;7.48.0.Final-redhat-00002&lt;/version&gt;
&lt;/dependency&gt;

&lt;!-- For remote execution on KIE Server --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie.server&lt;/groupId&gt;
  &lt;artifactId&gt;kie-server-client&lt;/artifactId&gt;
  &lt;version&gt;7.48.0.Final-redhat-00002&lt;/version&gt;
&lt;/dependency&gt;

&lt;!-- For debug logging (optional) --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
  &lt;artifactId&gt;slf4j-simple&lt;/artifactId&gt;
  &lt;version&gt;1.7.25&lt;/version&gt;
&lt;/dependency&gt;</pre><p class="simpara">
						For available versions of these artifacts, search the group ID and artifact ID in the <a class="link" href="https://repository.jboss.org/nexus/index.html#welcome">Nexus Repository Manager</a> online.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Instead of specifying a Red Hat Process Automation Manager <code class="literal">&lt;version&gt;</code> for individual dependencies, consider adding the Red Hat Business Automation bill of materials (BOM) dependency to your project <code class="literal">pom.xml</code> file. The Red Hat Business Automation BOM applies to both Red Hat Decision Manager and Red Hat Process Automation Manager. When you add the BOM files, the correct versions of transitive dependencies from the provided Maven repositories are included in the project.
						</p><p>
							Example BOM dependency:
						</p><pre class="programlisting language-xml">&lt;dependency&gt;
  &lt;groupId&gt;com.redhat.ba&lt;/groupId&gt;
  &lt;artifactId&gt;ba-platform-bom&lt;/artifactId&gt;
  &lt;version&gt;7.10.0.redhat-00002&lt;/version&gt;
  &lt;scope&gt;import&lt;/scope&gt;
  &lt;type&gt;pom&lt;/type&gt;
&lt;/dependency&gt;</pre><p>
							For more information about the Red Hat Business Automation BOM, see <a class="link" href="https://access.redhat.com/solutions/3405361">What is the mapping between Red Hat Process Automation Manager and the Maven library version?</a>.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Ensure that the dependencies for artifacts containing model classes are defined in the client application <code class="literal">pom.xml</code> file exactly as they appear in the <code class="literal">pom.xml</code> file of the deployed project. If dependencies for model classes differ between the client application and your projects, execution errors can occur.
					</p><p class="simpara">
						To access the project <code class="literal">pom.xml</code> file in Business Central, select any existing asset in the project and then in the <span class="strong strong"><strong>Project Explorer</strong></span> menu on the left side of the screen, click the <span class="strong strong"><strong>Customize View</strong></span> gear icon and select <span class="strong strong"><strong>Repository View</strong></span> → <span class="strong strong"><strong>pom.xml</strong></span>.
					</p><p class="simpara">
						For example, the following <code class="literal">Person</code> class dependency appears in both the client and deployed project <code class="literal">pom.xml</code> files:
					</p><pre class="programlisting language-xml">&lt;dependency&gt;
  &lt;groupId&gt;com.sample&lt;/groupId&gt;
  &lt;artifactId&gt;Person&lt;/artifactId&gt;
  &lt;version&gt;1.0.0&lt;/version&gt;
&lt;/dependency&gt;</pre></li><li class="listitem"><p class="simpara">
						If you added the <code class="literal">slf4j</code> dependency to the client application <code class="literal">pom.xml</code> file for debug logging, create a <code class="literal">simplelogger.properties</code> file on the relevant classpath (for example, in <code class="literal">src/main/resources/META-INF</code> in Maven) with the following content:
					</p><pre class="programlisting language-java">org.slf4j.simpleLogger.defaultLogLevel=debug</pre></li><li class="listitem"><p class="simpara">
						In your client application, create a <code class="literal">.java</code> main class containing the necessary imports and a <code class="literal">main()</code> method to load the KIE base, insert facts, and execute the rules.
					</p><p class="simpara">
						For example, a <code class="literal">Person</code> object in a project contains getter and setter methods to set and retrieve the first name, last name, hourly rate, and the wage of a person. The following <code class="literal">Wage</code> rule in a project calculates the wage and hourly rate values and displays a message based on the result:
					</p><pre class="programlisting language-java">package com.sample;

import com.sample.Person;

dialect "java"

rule "Wage"
  when
    Person(hourlyRate * wage &gt; 100)
    Person(name : firstName, surname : lastName)
  then
    System.out.println("Hello" + " " + name + " " + surname + "!");
    System.out.println("You are rich!");
end</pre><p class="simpara">
						To test this rule locally outside of KIE Server (if needed), configure the <code class="literal">.java</code> class to import KIE services, a KIE container, and a KIE session, and then use the <code class="literal">main()</code> method to fire all rules against a defined fact model:
					</p><div class="formalpara"><p class="title"><strong>Executing rules locally</strong></p><p>
							
<pre class="programlisting language-java">import org.kie.api.KieServices;
import org.kie.api.builder.ReleaseId;
import org.kie.api.runtime.KieContainer;
import org.kie.api.runtime.KieSession;
import org.drools.compiler.kproject.ReleaseIdImpl;

public class RulesTest {

  public static final void main(String[] args) {
    try {
      // Identify the project in the local repository:
      ReleaseId rid = new ReleaseIdImpl("com.myspace", "MyProject", "1.0.0");

      // Load the KIE base:
      KieServices ks = KieServices.Factory.get();
      KieContainer kContainer = ks.newKieContainer(rid);
      KieSession kSession = kContainer.newKieSession();

      // Set up the fact model:
      Person p = new Person();
      p.setWage(12);
      p.setFirstName("Tom");
      p.setLastName("Summers");
      p.setHourlyRate(10);

      // Insert the person into the session:
      kSession.insert(p);

      // Fire all rules:
      kSession.fireAllRules();
      kSession.dispose();
    }

    catch (Throwable t) {
      t.printStackTrace();
    }
  }
}</pre>
						</p></div><p class="simpara">
						To test this rule on KIE Server, configure the <code class="literal">.java</code> class with the imports and rule execution information similarly to the local example, and additionally specify KIE services configuration and KIE services client details:
					</p><div class="formalpara"><p class="title"><strong>Executing rules on KIE Server</strong></p><p>
							
<pre class="programlisting language-java">package com.sample;

import java.util.ArrayList;
import java.util.HashSet;
import java.util.List;
import java.util.Set;

import org.kie.api.command.BatchExecutionCommand;
import org.kie.api.command.Command;
import org.kie.api.KieServices;
import org.kie.api.runtime.ExecutionResults;
import org.kie.api.runtime.KieContainer;
import org.kie.api.runtime.KieSession;
import org.kie.server.api.marshalling.MarshallingFormat;
import org.kie.server.api.model.ServiceResponse;
import org.kie.server.client.KieServicesClient;
import org.kie.server.client.KieServicesConfiguration;
import org.kie.server.client.KieServicesFactory;
import org.kie.server.client.RuleServicesClient;

import com.sample.Person;

public class RulesTest {

  private static final String containerName = "testProject";
  private static final String sessionName = "myStatelessSession";

  public static final void main(String[] args) {
    try {
      // Define KIE services configuration and client:
      Set&lt;Class&lt;?&gt;&gt; allClasses = new HashSet&lt;Class&lt;?&gt;&gt;();
      allClasses.add(Person.class);
      String serverUrl = "http://$HOST:$PORT/kie-server/services/rest/server";
      String username = "$USERNAME";
      String password = "$PASSWORD";
      KieServicesConfiguration config =
        KieServicesFactory.newRestConfiguration(serverUrl,
                                                username,
                                                password);
      config.setMarshallingFormat(MarshallingFormat.JAXB);
      config.addExtraClasses(allClasses);
      KieServicesClient kieServicesClient =
        KieServicesFactory.newKieServicesClient(config);

      // Set up the fact model:
      Person p = new Person();
      p.setWage(12);
      p.setFirstName("Tom");
      p.setLastName("Summers");
      p.setHourlyRate(10);

      // Insert Person into the session:
      KieCommands kieCommands = KieServices.Factory.get().getCommands();
      List&lt;Command&gt; commandList = new ArrayList&lt;Command&gt;();
      commandList.add(kieCommands.newInsert(p, "personReturnId"));

      // Fire all rules:
      commandList.add(kieCommands.newFireAllRules("numberOfFiredRules"));
      BatchExecutionCommand batch = kieCommands.newBatchExecution(commandList, sessionName);

      // Use rule services client to send request:
      RuleServicesClient ruleClient = kieServicesClient.getServicesClient(RuleServicesClient.class);
      ServiceResponse&lt;ExecutionResults&gt; executeResponse = ruleClient.executeCommandsWithResults(containerName, batch);
      System.out.println("number of fired rules:" + executeResponse.getResult().getValue("numberOfFiredRules"));
    }

    catch (Throwable t) {
      t.printStackTrace();
    }
  }
}</pre>
						</p></div></li><li class="listitem"><p class="simpara">
						Run the configured <code class="literal">.java</code> class from your project directory. You can run the file in your development platform (such as Red Hat CodeReady Studio) or in the command line.
					</p><p class="simpara">
						Example Maven execution (within project directory):
					</p><pre class="screen">mvn clean install exec:java -Dexec.mainClass="com.sample.app.RulesTest"</pre><p class="simpara">
						Example Java execution (within project directory)
					</p><pre class="screen">javac -classpath "./$DEPENDENCIES/*:." RulesTest.java
java -classpath "./$DEPENDENCIES/*:." RulesTest</pre></li><li class="listitem">
						Review the rule execution status in the command line and in the server log. If any rules do not execute as expected, review the configured rules in the project and the main class configuration to validate the data provided.
					</li></ol></div></section><section class="chapter" id="next_steps_2"><div class="titlepage"><div><div><h2 class="title">Chapter 37. Next steps</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-test-scenarios"><span class="emphasis"><em>Testing a decision service using test scenarios</em></span></a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>
					</li></ul></div></section></div><div class="part" id="assembly-decision-tables"><div class="titlepage"><div><div><h1 class="title">Part V. Designing a decision service using spreadsheet decision tables</h1></div></div></div><div class="partintro" id="idm139921816388336"><div/><p>
				As a business analyst or business rules developer, you can define business rules in a tabular format in spreadsheet decision tables and then upload the spreadsheets to your project in Business Central. These rules are compiled into Drools Rule Language (DRL) and form the core of the decision service for your project.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					You can also design your decision service using Decision Model and Notation (DMN) models instead of rule-based or table-based assets. For information about DMN support in Red Hat Process Automation Manager 7.10, see the following resources:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/getting_started_with_red_hat_process_automation_manager#assembly-getting-started-decision-services"><span class="emphasis"><em>Getting started with decision services</em></span></a> (step-by-step tutorial with a DMN decision service example)
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-dmn-models"><span class="emphasis"><em>Designing a decision service using DMN models</em></span></a> (overview of DMN support and capabilities in Red Hat Process Automation Manager)
						</li></ul></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The space and project for the decision tables have been created in Business Central. Each asset is associated with a project assigned to a space. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/getting_started_with_red_hat_process_automation_manager#assembly-getting-started-decision-services"><span class="emphasis"><em>Getting started with decision services</em></span></a>.
					</li></ul></div><div class="toc"><p><strong>Table of Contents</strong></p><ul class="toc"><li><span class="chapter"><a href="#decision-authoring-assets-ref_decision-tables">38. Decision-authoring assets in Red Hat Process Automation Manager</a></span></li><li><span class="chapter"><a href="#decision-tables-con_decision-tables">39. Spreadsheet decision tables</a></span></li><li><span class="chapter"><a href="#data-objects-con_decision-tables">40. Data objects</a></span><ul><li><span class="section"><a href="#data-objects-create-proc_decision-tables">40.1. Creating data objects</a></span></li></ul></li><li><span class="chapter"><a href="#decision-tables-use-case-con">41. Decision table use case</a></span></li><li><span class="chapter"><a href="#decision-tables-defining-proc">42. Defining spreadsheet decision tables</a></span><ul><li><span class="section"><a href="#decision-tables-rule-set-entries-ref">42.1. RuleSet definitions</a></span></li><li><span class="section"><a href="#decision-tables-rule-table-entries-ref">42.2. RuleTable definitions</a></span></li><li><span class="section"><a href="#decision-tables-attributes-ref">42.3. Additional rule attributes for RuleSet or RuleTable definitions</a></span></li></ul></li><li><span class="chapter"><a href="#decision-tables-upload-proc">43. Uploading spreadsheet decision tables to Business Central</a></span></li><li><span class="chapter"><a href="#decision-tables-convert-proc">44. Converting an uploaded spreadsheet decision table to a guided decision table in Business Central</a></span></li><li><span class="chapter"><a href="#assets-executing-proc_decision-tables">45. Executing rules</a></span></li><li><span class="chapter"><a href="#next_steps_3">46. Next steps</a></span></li></ul></div></div><section class="chapter" id="decision-authoring-assets-ref_decision-tables"><div class="titlepage"><div><div><h2 class="title">Chapter 38. Decision-authoring assets in Red Hat Process Automation Manager</h2></div></div></div><p>
				Red Hat Process Automation Manager supports several assets that you can use to define business decisions for your decision service. Each decision-authoring asset has different advantages, and you might prefer to use one or a combination of multiple assets depending on your goals and needs.
			</p><p>
				The following table highlights the main decision-authoring assets supported in Red Hat Process Automation Manager projects to help you decide or confirm the best method for defining decisions in your decision service.
			</p><div class="table" id="idm139921816374928"><p class="title"><strong>Table 38.1. Decision-authoring assets supported in Red Hat Process Automation Manager</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"/><col style="width: 40%; " class="col_2"/><col style="width: 20%; " class="col_3"/><col style="width: 20%; " class="col_4"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921816368176" scope="col">Asset</th><th align="left" valign="top" id="idm139921816367088" scope="col">Highlights</th><th align="left" valign="top" id="idm139921816366000" scope="col">Authoring tools</th><th align="left" valign="top" id="idm139921816364912" scope="col">Documentation</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921816368176">
							<p>
								Decision Model and Notation (DMN) models
							</p>
							</td><td align="left" valign="top" headers="idm139921816367088">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are decision models based on a notation standard defined by the Object Management Group (OMG)
									</li><li class="listitem">
										Use graphical decision requirements diagrams (DRDs) that represent part or all of the overall decision requirements graph (DRG) to trace business decision flows
									</li><li class="listitem">
										Use an XML schema that allows the DMN models to be shared between DMN-compliant platforms
									</li><li class="listitem">
										Support Friendly Enough Expression Language (FEEL) to define decision logic in DMN decision tables and other DMN boxed expressions
									</li><li class="listitem">
										Can be integrated efficiently with Business Process Model and Notation (BPMN) process models
									</li><li class="listitem">
										Are optimal for creating comprehensive, illustrative, and stable decision flows
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921816366000">
							<p>
								Business Central or other DMN-compliant editor
							</p>
							</td><td align="left" valign="top" headers="idm139921816364912">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-dmn-models"><span class="emphasis"><em>Designing a decision service using DMN models</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921816368176">
							<p>
								Guided decision tables
							</p>
							</td><td align="left" valign="top" headers="idm139921816367088">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are tables of rules that you create in a UI-based table designer in Business Central
									</li><li class="listitem">
										Are a wizard-led alternative to spreadsheet decision tables
									</li><li class="listitem">
										Provide fields and options for acceptable input
									</li><li class="listitem">
										Support template keys and values for creating rule templates
									</li><li class="listitem">
										Support hit policies, real-time validation, and other additional features not supported in other assets
									</li><li class="listitem">
										Are optimal for creating rules in a controlled tabular format to minimize compilation errors
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921816366000">
							<p>
								Business Central
							</p>
							</td><td align="left" valign="top" headers="idm139921816364912">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-guided-decision-tables"><span class="emphasis"><em>Designing a decision service using guided decision tables</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921816368176">
							<p>
								Spreadsheet decision tables
							</p>
							</td><td align="left" valign="top" headers="idm139921816367088">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are XLS or XLSX spreadsheet decision tables that you can upload into Business Central
									</li><li class="listitem">
										Support template keys and values for creating rule templates
									</li><li class="listitem">
										Are optimal for creating rules in decision tables already managed outside of Business Central
									</li><li class="listitem">
										Have strict syntax requirements for rules to be compiled properly when uploaded
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921816366000">
							<p>
								Spreadsheet editor
							</p>
							</td><td align="left" valign="top" headers="idm139921816364912">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-decision-tables"><span class="emphasis"><em>Designing a decision service using spreadsheet decision tables</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921816368176">
							<p>
								Guided rules
							</p>
							</td><td align="left" valign="top" headers="idm139921816367088">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are individual rules that you create in a UI-based rule designer in Business Central
									</li><li class="listitem">
										Provide fields and options for acceptable input
									</li><li class="listitem">
										Are optimal for creating single rules in a controlled format to minimize compilation errors
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921816366000">
							<p>
								Business Central
							</p>
							</td><td align="left" valign="top" headers="idm139921816364912">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-guided-rules"><span class="emphasis"><em>Designing a decision service using guided rules</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921816368176">
							<p>
								Guided rule templates
							</p>
							</td><td align="left" valign="top" headers="idm139921816367088">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are reusable rule structures that you create in a UI-based template designer in Business Central
									</li><li class="listitem">
										Provide fields and options for acceptable input
									</li><li class="listitem">
										Support template keys and values for creating rule templates (fundamental to the purpose of this asset)
									</li><li class="listitem">
										Are optimal for creating many rules with the same rule structure but with different defined field values
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921816366000">
							<p>
								Business Central
							</p>
							</td><td align="left" valign="top" headers="idm139921816364912">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-guided-rule-templates"><span class="emphasis"><em>Designing a decision service using guided rule templates</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921816368176">
							<p>
								DRL rules
							</p>
							</td><td align="left" valign="top" headers="idm139921816367088">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are individual rules that you define directly in <code class="literal">.drl</code> text files
									</li><li class="listitem">
										Provide the most flexibility for defining rules and other technicalities of rule behavior
									</li><li class="listitem">
										Can be created in certain standalone environments and integrated with Red Hat Process Automation Manager
									</li><li class="listitem">
										Are optimal for creating rules that require advanced DRL options
									</li><li class="listitem">
										Have strict syntax requirements for rules to be compiled properly
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921816366000">
							<p>
								Business Central or integrated development environment (IDE)
							</p>
							</td><td align="left" valign="top" headers="idm139921816364912">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-drl-rules"><span class="emphasis"><em>Designing a decision service using DRL rules</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921816368176">
							<p>
								Predictive Model Markup Language (PMML) models
							</p>
							</td><td align="left" valign="top" headers="idm139921816367088">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are predictive data-analytic models based on a notation standard defined by the Data Mining Group (DMG)
									</li><li class="listitem">
										Use an XML schema that allows the PMML models to be shared between PMML-compliant platforms
									</li><li class="listitem">
										Support Regression, Scorecard, Tree, Mining, and other model types
									</li><li class="listitem">
										Can be included with a standalone Red Hat Process Automation Manager project or imported into a project in Business Central
									</li><li class="listitem">
										Are optimal for incorporating predictive data into decision services in Red Hat Process Automation Manager
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921816366000">
							<p>
								PMML or XML editor
							</p>
							</td><td align="left" valign="top" headers="idm139921816364912">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-pmml-models"><span class="emphasis"><em>Designing a decision service using PMML models</em></span></a>
							</p>
							</td></tr></tbody></table></div></div></section><section class="chapter" id="decision-tables-con_decision-tables"><div class="titlepage"><div><div><h2 class="title">Chapter 39. Spreadsheet decision tables</h2></div></div></div><p>
				Spreadsheet decision tables are XLS or XLSX spreadsheets that contain business rules defined in a tabular format. You can include spreadsheet decision tables with standalone Red Hat Process Automation Manager projects or upload them to projects in Business Central. Each row in a decision table is a rule, and each column is a condition, an action, or another rule attribute. After you create and upload your spreadsheet decision tables, the rules you defined are compiled into Drools Rule Language (DRL) rules as with all other rule assets.
			</p><p>
				All data objects related to a spreadsheet decision table must be in the same project package as the spreadsheet decision table. Assets in the same package are imported by default. Existing assets in other packages can be imported with the decision table.
			</p></section><section class="chapter" id="data-objects-con_decision-tables"><div class="titlepage"><div><div><h2 class="title">Chapter 40. Data objects</h2></div></div></div><p>
				Data objects are the building blocks for the rule assets that you create. Data objects are custom data types implemented as Java objects in specified packages of your project. For example, you might create a <code class="literal">Person</code> object with data fields <code class="literal">Name</code>, <code class="literal">Address</code>, and <code class="literal">DateOfBirth</code> to specify personal details for loan application rules. These custom data types determine what data your assets and your decision services are based on.
			</p><section class="section" id="data-objects-create-proc_decision-tables"><div class="titlepage"><div><div><h2 class="title">40.1. Creating data objects</h2></div></div></div><p>
					The following procedure is a generic overview of creating data objects. It is not specific to a particular business asset.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Data Object</strong></span>.
						</li><li class="listitem"><p class="simpara">
							Enter a unique <span class="strong strong"><strong>Data Object</strong></span> name and select the <span class="strong strong"><strong>Package</strong></span> where you want the data object to be available for other rule assets. Data objects with the same name cannot exist in the same package. In the specified DRL file, you can import a data object from any package.
						</p><div class="admonition important"><div class="admonition_header">Importing data objects from other packages</div><div><p>
								You can import an existing data object from another package directly into the asset designers like guided rules or guided decision table designers. Select the relevant rule asset within the project and in the asset designer, go to <span class="strong strong"><strong>Data Objects → New item</strong></span> to select the object to be imported.
							</p></div></div></li><li class="listitem">
							To make your data object persistable, select the <span class="strong strong"><strong>Persistable</strong></span> checkbox. Persistable data objects are able to be stored in a database according to the JPA specification. The default JPA is Hibernate.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Ok</strong></span>.
						</li><li class="listitem"><p class="simpara">
							In the data object designer, click <span class="strong strong"><strong>add field</strong></span> to add a field to the object with the attributes <span class="strong strong"><strong>Id</strong></span>, <span class="strong strong"><strong>Label</strong></span>, and <span class="strong strong"><strong>Type</strong></span>. Required attributes are marked with an asterisk (*).
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="strong strong"><strong>Id:</strong></span> Enter the unique ID of the field.
								</li><li class="listitem">
									<span class="strong strong"><strong>Label:</strong></span> (Optional) Enter a label for the field.
								</li><li class="listitem">
									<span class="strong strong"><strong>Type:</strong></span> Enter the data type of the field.
								</li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>List:</strong></span> (Optional) Select this check box to enable the field to hold multiple items for the specified type.
								</p><div class="figure" id="idm139921815042192"><p class="title"><strong>Figure 40.1. Add data fields to a data object</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/project-data/DataModelerNewField2-new.png" alt="Add data fields to a data object"/></div></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Create</strong></span> to add the new field, or click <span class="strong strong"><strong>Create and continue</strong></span> to add the new field and continue adding other fields.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								To edit a field, select the field row and use the <span class="strong strong"><strong>general properties</strong></span> on the right side of the screen.
							</p></div></div></li></ol></div></section></section><section class="chapter" id="decision-tables-use-case-con"><div class="titlepage"><div><div><h2 class="title">Chapter 41. Decision table use case</h2></div></div></div><p>
				An online shopping site lists the shipping charges for ordered items. The site provides free shipping under the following conditions:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The number of items ordered is 4 or more and the checkout total is $300 or more.
					</li><li class="listitem">
						Standard shipping is selected (4 or 5 business days from the date of purchase).
					</li></ul></div><p>
				The following are the shipping rates under these conditions:
			</p><div class="table" id="idm139921815027840"><p class="title"><strong>Table 41.1. For orders less than $300</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"/><col style="width: 33%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921815022112" scope="col">Number of items</th><th align="left" valign="top" id="idm139921815021024" scope="col">Delivery day</th><th align="left" valign="top" id="idm139921815019936" scope="col">Shipping charge in USD, N = Number of items</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921815022112">
							<p>
								3 or fewer
							</p>
							</td><td align="left" valign="top" headers="idm139921815021024">
							<p>
								Next day
							</p>
							<p>
								2nd day
							</p>
							<p>
								Standard
							</p>
							</td><td align="left" valign="top" headers="idm139921815019936">
							<p>
								35
							</p>
							<p>
								15
							</p>
							<p>
								10
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921815022112">
							<p>
								4 or more
							</p>
							</td><td align="left" valign="top" headers="idm139921815021024">
							<p>
								Next day
							</p>
							<p>
								2nd day
							</p>
							<p>
								Standard
							</p>
							</td><td align="left" valign="top" headers="idm139921815019936">
							<p>
								N*7.50
							</p>
							<p>
								N*3.50
							</p>
							<p>
								N*2.50
							</p>
							</td></tr></tbody></table></div></div><div class="table" id="idm139921815003360"><p class="title"><strong>Table 41.2. For orders more than $300</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"/><col style="width: 33%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921814997584" scope="col">Number of items</th><th align="left" valign="top" id="idm139921814996496" scope="col">Delivery day</th><th align="left" valign="top" id="idm139921814995408" scope="col">Shipping charge in USD, N = Number of items</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921814997584">
							<p>
								3 or fewer
							</p>
							</td><td align="left" valign="top" headers="idm139921814996496">
							<p>
								Next day
							</p>
							<p>
								2nd day
							</p>
							<p>
								Standard
							</p>
							</td><td align="left" valign="top" headers="idm139921814995408">
							<p>
								25
							</p>
							<p>
								10
							</p>
							<p>
								N*1.50
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921814997584">
							<p>
								4 or more
							</p>
							</td><td align="left" valign="top" headers="idm139921814996496">
							<p>
								Next day
							</p>
							<p>
								2nd day
							</p>
							<p>
								Standard
							</p>
							</td><td align="left" valign="top" headers="idm139921814995408">
							<p>
								N*5
							</p>
							<p>
								N*2
							</p>
							<p>
								FREE
							</p>
							</td></tr></tbody></table></div></div><p>
				These conditions and rates are shown in the following example spreadsheet decision table:
			</p><div class="figure" id="idm139921815492720"><p class="title"><strong>Figure 41.1. Decision table for shipping charges</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/decision-table-example-02.png" alt="Decision table example"/></div></div></div><p>
				In order for a decision table to be uploaded in Business Central, the table must comply with certain structure and syntax requirements, within an XLS or XLSX spreadsheet, as shown in this example. For more information, see <a class="xref" href="#decision-tables-defining-proc" title="Chapter 42. Defining spreadsheet decision tables">Chapter 42, <em>Defining spreadsheet decision tables</em></a>.
			</p></section><section class="chapter" id="decision-tables-defining-proc"><div class="titlepage"><div><div><h2 class="title">Chapter 42. Defining spreadsheet decision tables</h2></div></div></div><p>
				Spreadsheet decision tables (XLS or XLSX) require two key areas that define rule data: a <code class="literal">RuleSet</code> area and a <code class="literal">RuleTable</code> area. The <code class="literal">RuleSet</code> area of the spreadsheet defines elements that you want to apply globally to all rules in the same package (not only the spreadsheet), such as a rule set name or universal rule attributes. The <code class="literal">RuleTable</code> area defines the actual rules (rows) and the conditions, actions, and other rule attributes (columns) that constitute that rule table within the specified rule set. A spreadsheet of decision tables can contain multiple <code class="literal">RuleTable</code> areas, but only one <code class="literal">RuleSet</code> area.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					You should typically upload only one spreadsheet of decision tables, containing all necessary <code class="literal">RuleTable</code> definitions, per rule package in Business Central. You can upload separate decision table spreadsheets for separate packages, but uploading multiple spreadsheets in the same package can cause compilation errors from conflicting <code class="literal">RuleSet</code> or <code class="literal">RuleTable</code> attributes and is therefore not recommended.
				</p></div></div><p>
				Refer to the following sample spreadsheet as you define your decision table:
			</p><div class="figure" id="idm139921815478976"><p class="title"><strong>Figure 42.1. Sample spreadsheet decision table for shipping charges</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/decision-table-example-02.png" alt="Decision table example"/></div></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In a new XLS or XLSX spreadsheet, go to the second or third column and label a cell <code class="literal">RuleSet</code> (row 1 in example). Reserve the column or columns to the left for descriptive metadata (optional).
					</li><li class="listitem">
						In the next cell to the right, enter a name for the <code class="literal">RuleSet</code>. This named rule set will contain all <code class="literal">RuleTable</code> rules defined in the rule package.
					</li><li class="listitem">
						Under the <code class="literal">RuleSet</code> cell, define any rule attributes (one per cell) that you want to apply globally to all rule tables in the package. Specify attribute values in the cells to the right. For example, you can enter an <code class="literal">Import</code> label and in the cell to the right, specify relevant data objects from other packages that you want to import into the package for the decision table (in the format <code class="literal">package.name.object.name</code>). For supported cell labels and values, see <a class="xref" href="#decision-tables-rule-set-entries-ref" title="42.1. RuleSet definitions">Section 42.1, “RuleSet definitions”</a>.
					</li><li class="listitem">
						Below the <code class="literal">RuleSet</code> area and in the same column as the <code class="literal">RuleSet</code> cell, skip a row and label a new cell <code class="literal">RuleTable</code> (row 7 in example) and enter a table name in the same cell. The name is used as the initial part of the name for all rules derived from this rule table, with the row number appended for distinction. You can override this automatic naming by inserting a <code class="literal">NAME</code> attribute column.
					</li><li class="listitem"><p class="simpara">
						Use the next four rows to define the following elements as needed (rows 8-11 in example):
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>Rule attributes:</strong></span> Conditions, actions, or other attributes. For supported cell labels and values, see <a class="xref" href="#decision-tables-rule-table-entries-ref" title="42.2. RuleTable definitions">Section 42.2, “RuleTable definitions”</a>.
							</li><li class="listitem">
								<span class="strong strong"><strong>Object types:</strong></span> The data objects to which the rule attributes apply. If the same object type applies to multiple columns, merge the object cells into one cell across multiple columns (as shown in the sample decision table), instead of repeating the object type in multiple cells. When an object type is merged, all columns below the merged range will be combined into one set of constraints within a single pattern for matching a single fact at a time. When an object is repeated in separate columns, the separate columns can create different patterns, potentially matching different or identical facts.
							</li><li class="listitem">
								<span class="strong strong"><strong>Constraints:</strong></span> Constraints on the object types.
							</li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Column label:</strong></span> (Optional) Any descriptive label for the column, as a visual aid. Leave blank if unused.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									As an alternative to populating both the object type and constraint cells, you can leave the object type cell or cells empty and enter the full expression in the corresponding constraint cell or cells. For example, instead of <code class="literal">Order</code> as the object type and <code class="literal">itemsCount &gt; $1</code> as a constraint (separate cells), you can leave the object type cell empty and enter <code class="literal">Order( itemsCount &gt; $1 )</code> in the constraint cell, and then do the same for other constraint cells.
								</p></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
						After you have defined all necessary rule attributes (columns), enter values for each column as needed, row by row, to generate rules (rows 12-17 in example). Cells with no data are ignored (such as when a condition or action does not apply).
					</p><p class="simpara">
						If you need to add more rule tables to this decision table spreadsheet, skip a row after the last rule in the previous table, label another <code class="literal">RuleTable</code> cell in the same column as the previous <code class="literal">RuleTable</code> and <code class="literal">RuleSet</code> cells, and create the new table following the same steps in this section (rows 19-29 in example).
					</p></li><li class="listitem">
						Save your XLS or XLSX spreadsheet to finish.
					</li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					By default, only the first worksheet in a spreadsheet workbook is processed as a decision table when you upload the spreadsheet in Business Central. Each <code class="literal">RuleSet</code> name combined with the <code class="literal">RuleTable</code> name must be unique across all decision table files in the same package.
				</p><p>
					If you want to process multiple worksheet decision tables, then create a <code class="literal">.properties</code> file with the same name as the spreadsheet workbook. The <code class="literal">.properties</code> file must contain a property sheet with comma-separated values (CSV) for the names of the worksheets, for example:
				</p><pre class="screen">sheets=Sheet1,Sheet2</pre></div></div><p>
				After you upload the decision table in Business Central, the rules are rendered as DRL rules like the following example, from the sample spreadsheet:
			</p><pre class="screen">//row 12
rule "Basic_12"
salience 10
  when
    $order : Order( itemsCount &gt; 0, itemsCount &lt;= 3, deliverInDays == 1 )
  then
    insert( new Charge( 35 ) );
end</pre><div class="admonition note"><div class="admonition_header">Enabling white space used in cell values</div><div><p>
					By default, any white space before or after values in decision table cells is removed before the decision table is processed by the decision engine. To retain white space that you use intentionally before or after values in cells, set the <code class="literal">drools.trimCellsInDTable</code> system property to <code class="literal">false</code> in your Red Hat Process Automation Manager distribution.
				</p><p>
					For example, if you use Red Hat Process Automation Manager with Red Hat JBoss EAP, add the following system property to your <code class="literal">$EAP_HOME/standalone/configuration/standalone-full.xml</code> file:
				</p><pre class="screen">&lt;property name="drools.trimCellsInDTable" value="false"/&gt;</pre><p>
					If you use the decision engine embedded in your Java application, add the system property with the following command:
				</p><pre class="screen">java -jar yourApplication.jar -Ddrools.trimCellsInDTable=false</pre></div></div><section class="section" id="decision-tables-rule-set-entries-ref"><div class="titlepage"><div><div><h2 class="title">42.1. RuleSet definitions</h2></div></div></div><p>
					Entries in the <code class="literal">RuleSet</code> area of a decision table define DRL constructs and rule attributes that you want to apply to all rules in a package (not only in the spreadsheet). Entries must be in a vertically stacked sequence of cell pairs, where the first cell contains a label and the cell to the right contains the value. A decision table spreadsheet can have only one <code class="literal">RuleSet</code> area.
				</p><p>
					The following table lists the supported labels and values for <code class="literal">RuleSet</code> definitions:
				</p><div class="table" id="idm139921816141088"><p class="title"><strong>Table 42.1. Supported <code class="literal">RuleSet</code> definitions</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 40%; " class="col_2"/><col style="width: 30%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921816134848" scope="col">Label</th><th align="left" valign="top" id="idm139921816133760" scope="col">Value</th><th align="left" valign="top" id="idm139921816132672" scope="col">Usage</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921816134848">
								<p>
									<code class="literal">RuleSet</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921816133760">
								<p>
									The package name for the generated DRL file. Optional, the default is <code class="literal">rule_table</code>.
								</p>
								</td><td align="left" valign="top" headers="idm139921816132672">
								<p>
									Must be the first entry.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921816134848">
								<p>
									<code class="literal">Sequential</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921816133760">
								<p>
									<code class="literal">true</code> or <code class="literal">false</code>. If <code class="literal">true</code>, then salience is used to ensure that rules fire from the top down.
								</p>
								</td><td align="left" valign="top" headers="idm139921816132672">
								<p>
									Optional, at most once. If omitted, no firing order is imposed.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921816134848">
								<p>
									<code class="literal">SequentialMaxPriority</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921816133760">
								<p>
									Integer numeric value
								</p>
								</td><td align="left" valign="top" headers="idm139921816132672">
								<p>
									Optional, at most once. In sequential mode, this option is used to set the start value of the salience. If omitted, the default value is 65535.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921816134848">
								<p>
									<code class="literal">SequentialMinPriority</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921816133760">
								<p>
									Integer numeric value
								</p>
								</td><td align="left" valign="top" headers="idm139921816132672">
								<p>
									Optional, at most once. In sequential mode, this option is used to check if this minimum salience value is not violated. If omitted, the default value is 0.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921816134848">
								<p>
									<code class="literal">EscapeQuotes</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921816133760">
								<p>
									<code class="literal">true</code> or <code class="literal">false</code>. If <code class="literal">true</code>, then quotation marks are escaped so that they appear literally in the DRL.
								</p>
								</td><td align="left" valign="top" headers="idm139921816132672">
								<p>
									Optional, at most once. If omitted, quotation marks are escaped.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921816134848">
								<p>
									<code class="literal">Import</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921816133760">
								<p>
									A comma-separated list of Java classes to import from another package.
								</p>
								</td><td align="left" valign="top" headers="idm139921816132672">
								<p>
									Optional, may be used repeatedly.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921816134848">
								<p>
									<code class="literal">Variables</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921816133760">
								<p>
									Declarations of DRL globals (a type followed by a variable name). Multiple global definitions must be separated by commas.
								</p>
								</td><td align="left" valign="top" headers="idm139921816132672">
								<p>
									Optional, may be used repeatedly.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921816134848">
								<p>
									<code class="literal">Functions</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921816133760">
								<p>
									One or more function definitions, according to DRL syntax.
								</p>
								</td><td align="left" valign="top" headers="idm139921816132672">
								<p>
									Optional, may be used repeatedly.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921816134848">
								<p>
									<code class="literal">Queries</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921816133760">
								<p>
									One or more query definitions, according to DRL syntax.
								</p>
								</td><td align="left" valign="top" headers="idm139921816132672">
								<p>
									Optional, may be used repeatedly.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921816134848">
								<p>
									<code class="literal">Declare</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921816133760">
								<p>
									One or more declarative types, according to DRL syntax.
								</p>
								</td><td align="left" valign="top" headers="idm139921816132672">
								<p>
									Optional, may be used repeatedly.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921816134848">
								<p>
									<code class="literal">Unit</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921816133760">
								<p>
									The rule units that the rules generated from this decision table belong to.
								</p>
								</td><td align="left" valign="top" headers="idm139921816132672">
								<p>
									Optional, at most once. If omitted, the rules do not belong to any unit.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921816134848">
								<p>
									<code class="literal">Dialect</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921816133760">
								<p>
									<code class="literal">java</code> or <code class="literal">mvel</code>. The dialect used in the actions of the decision table.
								</p>
								</td><td align="left" valign="top" headers="idm139921816132672">
								<p>
									Optional, at most once. If omitted, <code class="literal">java</code> is imposed.
								</p>
								</td></tr></tbody></table></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						In some cases, Microsoft Office, LibreOffice, and OpenOffice might encode a double quotation mark differently, causing a compilation error. For example, <code class="literal">“A”</code> will fail, but <code class="literal">"A"</code> will pass.
					</p></div></div></section><section class="section" id="decision-tables-rule-table-entries-ref"><div class="titlepage"><div><div><h2 class="title">42.2. RuleTable definitions</h2></div></div></div><p>
					Entries in the <code class="literal">RuleTable</code> area of a decision table define conditions, actions, and other rule attributes for the rules in that rule table. A spreadsheet of decision tables can contain multiple <code class="literal">RuleTable</code> areas.
				</p><p>
					The following table lists the supported labels (column headers) and values for <code class="literal">RuleTable</code> definitions. For column headers, you can use either the given labels or any custom labels that begin with the letters listed in the table.
				</p><div class="table" id="idm139921814505968"><p class="title"><strong>Table 42.2. Supported <code class="literal">RuleTable</code> definitions</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"/><col style="width: 20%; " class="col_2"/><col style="width: 35%; " class="col_3"/><col style="width: 20%; " class="col_4"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921814498800" scope="col">Label</th><th align="left" valign="top" id="idm139921814497712" scope="col">Or custom label that begins with</th><th align="left" valign="top" id="idm139921814496656" scope="col">Value</th><th align="left" valign="top" id="idm139921814495568" scope="col">Usage</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921814498800">
								<p>
									<code class="literal">NAME</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921814497712">
								<p>
									N
								</p>
								</td><td align="left" valign="top" headers="idm139921814496656">
								<p>
									Provides the name for the rule generated from that row. The default is constructed from the text following the <code class="literal">RuleTable</code> tag and the row number.
								</p>
								</td><td align="left" valign="top" headers="idm139921814495568">
								<p>
									At most one column.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921814498800">
								<p>
									<code class="literal">DESCRIPTION</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921814497712">
								<p>
									I
								</p>
								</td><td align="left" valign="top" headers="idm139921814496656">
								<p>
									Results in a comment within the generated rule.
								</p>
								</td><td align="left" valign="top" headers="idm139921814495568">
								<p>
									At most one column.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921814498800">
								<p>
									<code class="literal">CONDITION</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921814497712">
								<p>
									C
								</p>
								</td><td align="left" valign="top" headers="idm139921814496656">
								<p>
									Code snippet and interpolated values for constructing a constraint within a pattern in a condition.
								</p>
								</td><td align="left" valign="top" headers="idm139921814495568">
								<p>
									At least one per rule table.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921814498800">
								<p>
									<code class="literal">ACTION</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921814497712">
								<p>
									A
								</p>
								</td><td align="left" valign="top" headers="idm139921814496656">
								<p>
									Code snippet and interpolated values for constructing an action for the consequence of the rule.
								</p>
								</td><td align="left" valign="top" headers="idm139921814495568">
								<p>
									At least one per rule table.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921814498800">
								<p>
									<code class="literal">METADATA</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921814497712">
								<p>
									@
								</p>
								</td><td align="left" valign="top" headers="idm139921814496656">
								<p>
									Code snippet and interpolated values for constructing a metadata entry for the rule.
								</p>
								</td><td align="left" valign="top" headers="idm139921814495568">
								<p>
									Optional, any number of columns.
								</p>
								</td></tr></tbody></table></div></div><p>
					The following sections provide more details about how condition, action, and metadata columns use cell data:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Conditions</span></dt><dd><p class="simpara">
								For columns headed <code class="literal">CONDITION</code>, the cells in consecutive lines result in a conditional element:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										<span class="strong strong"><strong>First cell:</strong></span> Text in the first cell below <code class="literal">CONDITION</code> develops into a pattern for the rule condition, and uses the snippet in the next line as a constraint. If the cell is merged with one or more neighboring cells, a single pattern with multiple constraints is formed. All constraints are combined into a parenthesized list and appended to the text in this cell.
									</p><p class="simpara">
										If this cell is empty, the code snippet in the cell below it must result in a valid conditional element on its own. For example, instead of <code class="literal">Order</code> as the object type and <code class="literal">itemsCount &gt; $1</code> as a constraint (separate cells), you can leave the object type cell empty and enter <code class="literal">Order( itemsCount &gt; $1 )</code> in the constraint cell, and then do the same for any other constraint cells.
									</p><p class="simpara">
										To include a pattern without constraints, you can write the pattern in front of the text of another pattern, with or without an empty pair of parentheses. You can also append a <code class="literal">from</code> clause to the pattern.
									</p><p class="simpara">
										If the pattern ends with <code class="literal">eval</code>, code snippets produce boolean expressions for inclusion into a pair of parentheses after <code class="literal">eval</code>.
									</p><p class="simpara">
										You can terminate the pattern with <code class="literal">@watch</code> annotation, which is used to customize the properties that the pattern is reactive on.
									</p></li><li class="listitem"><p class="simpara">
										<span class="strong strong"><strong>Second cell:</strong></span> Text in the second cell below <code class="literal">CONDITION</code> is processed as a constraint on the object reference in the first cell. The code snippet in this cell is modified by interpolating values from cells farther down in the column. If you want to create a constraint consisting of a comparison using <code class="literal">==</code> with the value from the cells below, then the field selector alone is sufficient. If you use the field selector alone, but you want to use the condition as it is without appending any <code class="literal">==</code> comparison, you must terminate the condition with the symbol <code class="literal">?</code>. Any other comparison operator must be specified as the last item within the snippet, and the value from the cells below is appended. For all other constraint forms, you must mark the position for including the contents of a cell with the symbol <code class="literal">$param</code>. Multiple insertions are possible if you use the symbols <code class="literal">$1</code>, <code class="literal">$2</code>, and so on, and a comma-separated list of values in the cells below. However, do not separate <code class="literal">$1</code>, <code class="literal">$2</code>, and so on, by commas, or the table will fail to process.
									</p><p class="simpara">
										To expand a text according to the pattern <code class="literal">forall($delimiter){$snippet}</code>, repeat the <code class="literal">$snippet</code> once for each of the values of the comma-separated list in each of the cells below, insert the value in place of the symbol <code class="literal">$</code>, and join these expansions by the given <code class="literal">$delimiter</code>. Note that the <code class="literal">forall</code> construct may be surrounded by other text.
									</p><p class="simpara">
										If the first cell contains an object, the completed code snippet is added to the conditional element from that cell. A pair of parentheses is provided automatically, as well as a separating comma if multiple constraints are added to a pattern in a merged cell. If the first cell is empty, the code snippet in this cell must result in a valid conditional element on its own. For example, instead of <code class="literal">Order</code> as the object type and <code class="literal">itemsCount &gt; $1</code> as a constraint (separate cells), you can leave the object type cell empty and enter <code class="literal">Order( itemsCount &gt; $1 )</code> in the constraint cell, and then do the same for any other constraint cells.
									</p></li><li class="listitem">
										<span class="strong strong"><strong>Third cell:</strong></span> Text in the third cell below <code class="literal">CONDITION</code> is a descriptive label that you define for the column, as a visual aid.
									</li><li class="listitem">
										<span class="strong strong"><strong>Fourth cell:</strong></span> From the fourth row on, non-blank entries provide data for interpolation. A blank cell omits the condition or constraint for this rule.
									</li></ul></div></dd><dt><span class="term">Actions</span></dt><dd><p class="simpara">
								For columns headed <code class="literal">ACTION</code>, the cells in consecutive lines result in an action statement:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<span class="strong strong"><strong>First cell:</strong></span> Text in the first cell below <code class="literal">ACTION</code> is optional. If present, the text is interpreted as an object reference.
									</li><li class="listitem"><p class="simpara">
										<span class="strong strong"><strong>Second cell:</strong></span> Text in the second cell below <code class="literal">ACTION</code> is a code snippet that is modified by interpolating values from cells farther down in the column. For a singular insertion, mark the position for including the contents of a cell with the symbol <code class="literal">$param</code>. Multiple insertions are possible if you use the symbols <code class="literal">$1</code>, <code class="literal">$2</code>, and so on, and a comma-separated list of values in the cells below. However, do not separate <code class="literal">$1</code>, <code class="literal">$2</code>, and so on, by commas, or the table will fail to process.
									</p><p class="simpara">
										A text without any marker symbols can execute a method call without interpolation. In this case, use any non-blank entry in a row below the cell to include the statement. The <code class="literal">forall</code> construct is supported.
									</p><p class="simpara">
										If the first cell contains an object, then the cell text (followed by a period), the text in the second cell, and a terminating semicolon are strung together, resulting in a method call that is added as an action statement for the consequence. If the first cell is empty, the code snippet in this cell must result in a valid action element on its own.
									</p></li><li class="listitem">
										<span class="strong strong"><strong>Third cell:</strong></span> Text in the third cell below <code class="literal">ACTION</code> is a descriptive label that you define for the column, as a visual aid.
									</li><li class="listitem">
										<span class="strong strong"><strong>Fourth cell:</strong></span> From the fourth row on, non-blank entries provide data for interpolation. A blank cell omits the condition or constraint for this rule.
									</li></ul></div></dd><dt><span class="term">Metadata</span></dt><dd><p class="simpara">
								For columns headed <code class="literal">METADATA</code>, the cells in consecutive lines result in a metadata annotation for the generated rules:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<span class="strong strong"><strong>First cell:</strong></span> Text in the first cell below <code class="literal">METADATA</code> is ignored.
									</li><li class="listitem">
										<span class="strong strong"><strong>Second cell:</strong></span> Text in the second cell below <code class="literal">METADATA</code> is subject to interpolation, using values from the cells in the rule rows. The metadata marker character <code class="literal">@</code> is prefixed automatically, so you do not need to include that character in the text for this cell.
									</li><li class="listitem">
										<span class="strong strong"><strong>Third cell:</strong></span> Text in the third cell below <code class="literal">METADATA</code> is a descriptive label that you define for the column, as a visual aid.
									</li><li class="listitem">
										<span class="strong strong"><strong>Fourth cell:</strong></span> From the fourth row on, non-blank entries provide data for interpolation. A blank cell results in the omission of the metadata annotation for this rule.
									</li></ul></div></dd></dl></div></section><section class="section" id="decision-tables-attributes-ref"><div class="titlepage"><div><div><h2 class="title">42.3. Additional rule attributes for RuleSet or RuleTable definitions</h2></div></div></div><p>
					The <code class="literal">RuleSet</code> and <code class="literal">RuleTable</code> areas also support labels and values for other rule attributes, such as <code class="literal">PRIORITY</code> or <code class="literal">NO-LOOP</code>. Rule attributes specified in a <code class="literal">RuleSet</code> area will affect all rule assets in the same package (not only in the spreadsheet). Rule attributes specified in a <code class="literal">RuleTable</code> area will affect only the rules in that rule table. You can use each rule attribute only once in a <code class="literal">RuleSet</code> area and once in a <code class="literal">RuleTable</code> area. If the same attribute is used in both <code class="literal">RuleSet</code> and <code class="literal">RuleTable</code> areas within the spreadsheet, then <code class="literal">RuleTable</code> takes priority and the attribute in the <code class="literal">RuleSet</code> area is overridden.
				</p><p>
					The following table lists the supported labels (column headers) and values for additional <code class="literal">RuleSet</code> or <code class="literal">RuleTable</code> definitions. For column headers, you can use either the given labels or any custom labels that begin with the letters listed in the table.
				</p><div class="table" id="idm139921812473152"><p class="title"><strong>Table 42.3. Additional rule attributes for <code class="literal">RuleSet</code> or <code class="literal">RuleTable</code> definitions</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"/><col style="width: 20%; " class="col_2"/><col style="width: 55%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921812466416" scope="col">Label</th><th align="left" valign="top" id="idm139921812465328" scope="col">Or custom label that begins with</th><th align="left" valign="top" id="idm139921812464224" scope="col">Value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921812466416">
								<p>
									<code class="literal">PRIORITY</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921812465328">
								<p>
									P
								</p>
								</td><td align="left" valign="top" headers="idm139921812464224">
								<p>
									An integer defining the <code class="literal">salience</code> value of the rule. Rules with a higher salience value are given higher priority when ordered in the activation queue. Overridden by the <code class="literal">Sequential</code> flag.
								</p>
								<p>
									Example: <code class="literal">PRIORITY 10</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921812466416">
								<p>
									<code class="literal">DATE-EFFECTIVE</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921812465328">
								<p>
									V
								</p>
								</td><td align="left" valign="top" headers="idm139921812464224">
								<p>
									A string containing a date and time definition. The rule can be activated only if the current date and time is after a <code class="literal">DATE-EFFECTIVE</code> attribute.
								</p>
								<p>
									Example: <code class="literal">DATE-EFFECTIVE "4-Sep-2018"</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921812466416">
								<p>
									<code class="literal">DATE-EXPIRES</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921812465328">
								<p>
									Z
								</p>
								</td><td align="left" valign="top" headers="idm139921812464224">
								<p>
									A string containing a date and time definition. The rule cannot be activated if the current date and time is after the <code class="literal">DATE-EXPIRES</code> attribute.
								</p>
								<p>
									Example: <code class="literal">DATE-EXPIRES "4-Oct-2018"</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921812466416">
								<p>
									<code class="literal">NO-LOOP</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921812465328">
								<p>
									U
								</p>
								</td><td align="left" valign="top" headers="idm139921812464224">
								<p>
									A Boolean value. When this option is set to <code class="literal">true</code>, the rule cannot be reactivated (looped) if a consequence of the rule re-triggers a previously met condition.
								</p>
								<p>
									Example: <code class="literal">NO-LOOP true</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921812466416">
								<p>
									<code class="literal">AGENDA-GROUP</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921812465328">
								<p>
									G
								</p>
								</td><td align="left" valign="top" headers="idm139921812464224">
								<p>
									A string identifying an agenda group to which you want to assign the rule. Agenda groups allow you to partition the agenda to provide more execution control over groups of rules. Only rules in an agenda group that has acquired a focus are able to be activated.
								</p>
								<p>
									Example: <code class="literal">AGENDA-GROUP "GroupName"</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921812466416">
								<p>
									<code class="literal">ACTIVATION-GROUP</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921812465328">
								<p>
									X
								</p>
								</td><td align="left" valign="top" headers="idm139921812464224">
								<p>
									A string identifying an activation (or XOR) group to which you want to assign the rule. In activation groups, only one rule can be activated. The first rule to fire will cancel all pending activations of all rules in the activation group.
								</p>
								<p>
									Example: <code class="literal">ACTIVATION-GROUP "GroupName"</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921812466416">
								<p>
									<code class="literal">DURATION</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921812465328">
								<p>
									D
								</p>
								</td><td align="left" valign="top" headers="idm139921812464224">
								<p>
									A long integer value defining the duration of time in milliseconds after which the rule can be activated, if the rule conditions are still met.
								</p>
								<p>
									Example: <code class="literal">DURATION 10000</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921812466416">
								<p>
									<code class="literal">TIMER</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921812465328">
								<p>
									T
								</p>
								</td><td align="left" valign="top" headers="idm139921812464224">
								<p>
									A string identifying either <code class="literal">int</code> (interval) or <code class="literal">cron</code> timer definitions for scheduling the rule.
								</p>
								<p>
									Example: <code class="literal">TIMER "*/5 * * * *"</code> (every 5 minutes)
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921812466416">
								<p>
									<code class="literal">CALENDAR</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921812465328">
								<p>
									E
								</p>
								</td><td align="left" valign="top" headers="idm139921812464224">
								<p>
									A Quartz calendar definition for scheduling the rule.
								</p>
								<p>
									Example: <code class="literal">CALENDAR "* * 0-7,18-23 ? * *"</code> (exclude non-business hours)
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921812466416">
								<p>
									<code class="literal">AUTO-FOCUS</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921812465328">
								<p>
									F
								</p>
								</td><td align="left" valign="top" headers="idm139921812464224">
								<p>
									A Boolean value, applicable only to rules within agenda groups. When this option is set to <code class="literal">true</code>, the next time the rule is activated, a focus is automatically given to the agenda group to which the rule is assigned.
								</p>
								<p>
									Example: <code class="literal">AUTO-FOCUS true</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921812466416">
								<p>
									<code class="literal">LOCK-ON-ACTIVE</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921812465328">
								<p>
									L
								</p>
								</td><td align="left" valign="top" headers="idm139921812464224">
								<p>
									A Boolean value, applicable only to rules within rule flow groups or agenda groups. When this option is set to <code class="literal">true</code>, the next time the ruleflow group for the rule becomes active or the agenda group for the rule receives a focus, the rule cannot be activated again until the ruleflow group is no longer active or the agenda group loses the focus. This is a stronger version of the <code class="literal">no-loop</code> attribute, because the activation of a matching rule is discarded regardless of the origin of the update (not only by the rule itself). This attribute is ideal for calculation rules where you have a number of rules that modify a fact and you do not want any rule re-matching and firing again.
								</p>
								<p>
									Example: <code class="literal">LOCK-ON-ACTIVE true</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921812466416">
								<p>
									<code class="literal">RULEFLOW-GROUP</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921812465328">
								<p>
									R
								</p>
								</td><td align="left" valign="top" headers="idm139921812464224">
								<p>
									A string identifying a rule flow group. In rule flow groups, rules can fire only when the group is activated by the associated rule flow.
								</p>
								<p>
									Example: <code class="literal">RULEFLOW-GROUP "GroupName"</code>
								</p>
								</td></tr></tbody></table></div></div><div class="figure" id="idm139921814229104"><p class="title"><strong>Figure 42.2. Sample decision table spreadsheet with attribute columns</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/decision-table-example-03.png" alt="Example decision table with definitions used"/></div></div></div></section></section><section class="chapter" id="decision-tables-upload-proc"><div class="titlepage"><div><div><h2 class="title">Chapter 43. Uploading spreadsheet decision tables to Business Central</h2></div></div></div><p>
				After you define your rules in an external XLS or XLSX spreadsheet of decision tables, you can upload the spreadsheet file to your project in Business Central.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					You should typically upload only one spreadsheet of decision tables, containing all necessary <code class="literal">RuleTable</code> definitions, per rule package in Business Central. You can upload separate decision table spreadsheets for separate packages, but uploading multiple spreadsheets in the same package can cause compilation errors from conflicting <code class="literal">RuleSet</code> or <code class="literal">RuleTable</code> attributes and is therefore not recommended.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Decision Table (Spreadsheet)</strong></span>.
					</li><li class="listitem">
						Enter an informative <span class="strong strong"><strong>Decision Table</strong></span> name and select the appropriate <span class="strong strong"><strong>Package</strong></span>.
					</li><li class="listitem">
						Click the <span class="strong strong"><strong>Choose File</strong></span> icon, and select the spreadsheet. Click <span class="strong strong"><strong>Ok</strong></span> to upload.
					</li><li class="listitem"><p class="simpara">
						In the decision tables designer, click <span class="strong strong"><strong>Validate</strong></span> in the upper-right toolbar to validate the table. If the table validation fails, open the XLS or XLSX file and address any syntax errors. For syntax help, see <a class="xref" href="#decision-tables-defining-proc" title="Chapter 42. Defining spreadsheet decision tables">Chapter 42, <em>Defining spreadsheet decision tables</em></a>.
					</p><p class="simpara">
						You can upload a new version of the decision table or download the current version:
					</p><div class="figure" id="idm139921814205088"><p class="title"><strong>Figure 43.1. Uploaded decision table options</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/decision-table-uploaded.png" alt="Decision table example"/></div></div></div></li></ol></div></section><section class="chapter" id="decision-tables-convert-proc"><div class="titlepage"><div><div><h2 class="title">Chapter 44. Converting an uploaded spreadsheet decision table to a guided decision table in Business Central</h2></div></div></div><p>
				After you upload an XLS or XLSX spreadsheet decision table file to your project in Business Central, you can convert the decision table to a guided decision table that you can modify directly in Business Central.
			</p><p>
				For more information about guided decision tables, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-guided-decision-tables"><span class="emphasis"><em>Designing a decision service using guided decision tables</em></span></a>.
			</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					Guided decision tables and spreadsheet decision tables are different decision table formats that support different features. Any supported features that differ between the two decision table formats are modified or lost when you convert one decision table format to the other.
				</p></div></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					In Business Central, navigate to the uploaded decision table asset that you want to convert and in the upper-right toolbar of the decision tables designer, click <span class="strong strong"><strong>Convert</strong></span>:
				</p></div><div class="figure" id="idm139921814193264"><p class="title"><strong>Figure 44.1. Convert an uploaded decision table</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/decision-table-uploaded-convert.png" alt="Decision table example"/></div></div></div><p>
				After the conversion, the converted decision table is then available as a guided decision table asset in your project that you can modify directly in Business Central.
			</p></section><section class="chapter" id="assets-executing-proc_decision-tables"><div class="titlepage"><div><div><h2 class="title">Chapter 45. Executing rules</h2></div></div></div><p>
				After you identify example rules or create your own rules in Business Central, you can build and deploy the associated project and execute rules locally or on KIE Server to test the rules.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Business Central and KIE Server are installed and running. For installation options, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/installing_and_configuring_red_hat_process_automation_manager#assembly-planning"><span class="emphasis"><em>Planning a Red Hat Process Automation Manager installation</em></span></a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
					</li><li class="listitem"><p class="simpara">
						In the upper-right corner of the project <span class="strong strong"><strong>Assets</strong></span> page, click <span class="strong strong"><strong>Deploy</strong></span> to build the project and deploy it to KIE Server. If the build fails, address any problems described in the <span class="strong strong"><strong>Alerts</strong></span> panel at the bottom of the screen.
					</p><p class="simpara">
						For more information about project deployment options, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							If the rule assets in your project are not built from an executable rule model by default, verify that the following dependency is in the <code class="literal">pom.xml</code> file of your project and rebuild the project:
						</p><pre class="programlisting language-xml">&lt;dependency&gt;
  &lt;groupId&gt;org.drools&lt;/groupId&gt;
  &lt;artifactId&gt;drools-model-compiler&lt;/artifactId&gt;
  &lt;version&gt;${rhpam.version}&lt;/version&gt;
&lt;/dependency&gt;</pre><p>
							This dependency is required for rule assets in Red Hat Process Automation Manager to be built from executable rule models by default. This dependency is included as part of the Red Hat Process Automation Manager core packaging, but depending on your Red Hat Process Automation Manager upgrade history, you may need to manually add this dependency to enable the executable rule model behavior.
						</p><p>
							For more information about executable rule models, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#executable-model-con_packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Create a Maven or Java project outside of Business Central, if not created already, that you can use for executing rules locally or that you can use as a client application for executing rules on KIE Server. The project must contain a <code class="literal">pom.xml</code> file and any other required components for executing the project resources.
					</p><p class="simpara">
						For example test projects, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#drl-rules-other-con">"Other methods for creating and executing DRL rules"</a>.
					</p></li><li class="listitem"><p class="simpara">
						Open the <code class="literal">pom.xml</code> file of your test project or client application and add the following dependencies, if not added already:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">kie-ci</code>: Enables your client application to load Business Central project data locally using <code class="literal">ReleaseId</code>
							</li><li class="listitem">
								<code class="literal">kie-server-client</code>: Enables your client application to interact remotely with assets on KIE Server
							</li><li class="listitem">
								<code class="literal">slf4j</code>: (Optional) Enables your client application to use Simple Logging Facade for Java (SLF4J) to return debug logging information after you interact with KIE Server
							</li></ul></div><p class="simpara">
						Example dependencies for Red Hat Process Automation Manager 7.10 in a client application <code class="literal">pom.xml</code> file:
					</p><pre class="programlisting language-xml">&lt;!-- For local execution --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-ci&lt;/artifactId&gt;
  &lt;version&gt;7.48.0.Final-redhat-00002&lt;/version&gt;
&lt;/dependency&gt;

&lt;!-- For remote execution on KIE Server --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie.server&lt;/groupId&gt;
  &lt;artifactId&gt;kie-server-client&lt;/artifactId&gt;
  &lt;version&gt;7.48.0.Final-redhat-00002&lt;/version&gt;
&lt;/dependency&gt;

&lt;!-- For debug logging (optional) --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
  &lt;artifactId&gt;slf4j-simple&lt;/artifactId&gt;
  &lt;version&gt;1.7.25&lt;/version&gt;
&lt;/dependency&gt;</pre><p class="simpara">
						For available versions of these artifacts, search the group ID and artifact ID in the <a class="link" href="https://repository.jboss.org/nexus/index.html#welcome">Nexus Repository Manager</a> online.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Instead of specifying a Red Hat Process Automation Manager <code class="literal">&lt;version&gt;</code> for individual dependencies, consider adding the Red Hat Business Automation bill of materials (BOM) dependency to your project <code class="literal">pom.xml</code> file. The Red Hat Business Automation BOM applies to both Red Hat Decision Manager and Red Hat Process Automation Manager. When you add the BOM files, the correct versions of transitive dependencies from the provided Maven repositories are included in the project.
						</p><p>
							Example BOM dependency:
						</p><pre class="programlisting language-xml">&lt;dependency&gt;
  &lt;groupId&gt;com.redhat.ba&lt;/groupId&gt;
  &lt;artifactId&gt;ba-platform-bom&lt;/artifactId&gt;
  &lt;version&gt;7.10.0.redhat-00002&lt;/version&gt;
  &lt;scope&gt;import&lt;/scope&gt;
  &lt;type&gt;pom&lt;/type&gt;
&lt;/dependency&gt;</pre><p>
							For more information about the Red Hat Business Automation BOM, see <a class="link" href="https://access.redhat.com/solutions/3405361">What is the mapping between Red Hat Process Automation Manager and the Maven library version?</a>.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Ensure that the dependencies for artifacts containing model classes are defined in the client application <code class="literal">pom.xml</code> file exactly as they appear in the <code class="literal">pom.xml</code> file of the deployed project. If dependencies for model classes differ between the client application and your projects, execution errors can occur.
					</p><p class="simpara">
						To access the project <code class="literal">pom.xml</code> file in Business Central, select any existing asset in the project and then in the <span class="strong strong"><strong>Project Explorer</strong></span> menu on the left side of the screen, click the <span class="strong strong"><strong>Customize View</strong></span> gear icon and select <span class="strong strong"><strong>Repository View</strong></span> → <span class="strong strong"><strong>pom.xml</strong></span>.
					</p><p class="simpara">
						For example, the following <code class="literal">Person</code> class dependency appears in both the client and deployed project <code class="literal">pom.xml</code> files:
					</p><pre class="programlisting language-xml">&lt;dependency&gt;
  &lt;groupId&gt;com.sample&lt;/groupId&gt;
  &lt;artifactId&gt;Person&lt;/artifactId&gt;
  &lt;version&gt;1.0.0&lt;/version&gt;
&lt;/dependency&gt;</pre></li><li class="listitem"><p class="simpara">
						If you added the <code class="literal">slf4j</code> dependency to the client application <code class="literal">pom.xml</code> file for debug logging, create a <code class="literal">simplelogger.properties</code> file on the relevant classpath (for example, in <code class="literal">src/main/resources/META-INF</code> in Maven) with the following content:
					</p><pre class="programlisting language-java">org.slf4j.simpleLogger.defaultLogLevel=debug</pre></li><li class="listitem"><p class="simpara">
						In your client application, create a <code class="literal">.java</code> main class containing the necessary imports and a <code class="literal">main()</code> method to load the KIE base, insert facts, and execute the rules.
					</p><p class="simpara">
						For example, a <code class="literal">Person</code> object in a project contains getter and setter methods to set and retrieve the first name, last name, hourly rate, and the wage of a person. The following <code class="literal">Wage</code> rule in a project calculates the wage and hourly rate values and displays a message based on the result:
					</p><pre class="programlisting language-java">package com.sample;

import com.sample.Person;

dialect "java"

rule "Wage"
  when
    Person(hourlyRate * wage &gt; 100)
    Person(name : firstName, surname : lastName)
  then
    System.out.println("Hello" + " " + name + " " + surname + "!");
    System.out.println("You are rich!");
end</pre><p class="simpara">
						To test this rule locally outside of KIE Server (if needed), configure the <code class="literal">.java</code> class to import KIE services, a KIE container, and a KIE session, and then use the <code class="literal">main()</code> method to fire all rules against a defined fact model:
					</p><div class="formalpara"><p class="title"><strong>Executing rules locally</strong></p><p>
							
<pre class="programlisting language-java">import org.kie.api.KieServices;
import org.kie.api.builder.ReleaseId;
import org.kie.api.runtime.KieContainer;
import org.kie.api.runtime.KieSession;
import org.drools.compiler.kproject.ReleaseIdImpl;

public class RulesTest {

  public static final void main(String[] args) {
    try {
      // Identify the project in the local repository:
      ReleaseId rid = new ReleaseIdImpl("com.myspace", "MyProject", "1.0.0");

      // Load the KIE base:
      KieServices ks = KieServices.Factory.get();
      KieContainer kContainer = ks.newKieContainer(rid);
      KieSession kSession = kContainer.newKieSession();

      // Set up the fact model:
      Person p = new Person();
      p.setWage(12);
      p.setFirstName("Tom");
      p.setLastName("Summers");
      p.setHourlyRate(10);

      // Insert the person into the session:
      kSession.insert(p);

      // Fire all rules:
      kSession.fireAllRules();
      kSession.dispose();
    }

    catch (Throwable t) {
      t.printStackTrace();
    }
  }
}</pre>
						</p></div><p class="simpara">
						To test this rule on KIE Server, configure the <code class="literal">.java</code> class with the imports and rule execution information similarly to the local example, and additionally specify KIE services configuration and KIE services client details:
					</p><div class="formalpara"><p class="title"><strong>Executing rules on KIE Server</strong></p><p>
							
<pre class="programlisting language-java">package com.sample;

import java.util.ArrayList;
import java.util.HashSet;
import java.util.List;
import java.util.Set;

import org.kie.api.command.BatchExecutionCommand;
import org.kie.api.command.Command;
import org.kie.api.KieServices;
import org.kie.api.runtime.ExecutionResults;
import org.kie.api.runtime.KieContainer;
import org.kie.api.runtime.KieSession;
import org.kie.server.api.marshalling.MarshallingFormat;
import org.kie.server.api.model.ServiceResponse;
import org.kie.server.client.KieServicesClient;
import org.kie.server.client.KieServicesConfiguration;
import org.kie.server.client.KieServicesFactory;
import org.kie.server.client.RuleServicesClient;

import com.sample.Person;

public class RulesTest {

  private static final String containerName = "testProject";
  private static final String sessionName = "myStatelessSession";

  public static final void main(String[] args) {
    try {
      // Define KIE services configuration and client:
      Set&lt;Class&lt;?&gt;&gt; allClasses = new HashSet&lt;Class&lt;?&gt;&gt;();
      allClasses.add(Person.class);
      String serverUrl = "http://$HOST:$PORT/kie-server/services/rest/server";
      String username = "$USERNAME";
      String password = "$PASSWORD";
      KieServicesConfiguration config =
        KieServicesFactory.newRestConfiguration(serverUrl,
                                                username,
                                                password);
      config.setMarshallingFormat(MarshallingFormat.JAXB);
      config.addExtraClasses(allClasses);
      KieServicesClient kieServicesClient =
        KieServicesFactory.newKieServicesClient(config);

      // Set up the fact model:
      Person p = new Person();
      p.setWage(12);
      p.setFirstName("Tom");
      p.setLastName("Summers");
      p.setHourlyRate(10);

      // Insert Person into the session:
      KieCommands kieCommands = KieServices.Factory.get().getCommands();
      List&lt;Command&gt; commandList = new ArrayList&lt;Command&gt;();
      commandList.add(kieCommands.newInsert(p, "personReturnId"));

      // Fire all rules:
      commandList.add(kieCommands.newFireAllRules("numberOfFiredRules"));
      BatchExecutionCommand batch = kieCommands.newBatchExecution(commandList, sessionName);

      // Use rule services client to send request:
      RuleServicesClient ruleClient = kieServicesClient.getServicesClient(RuleServicesClient.class);
      ServiceResponse&lt;ExecutionResults&gt; executeResponse = ruleClient.executeCommandsWithResults(containerName, batch);
      System.out.println("number of fired rules:" + executeResponse.getResult().getValue("numberOfFiredRules"));
    }

    catch (Throwable t) {
      t.printStackTrace();
    }
  }
}</pre>
						</p></div></li><li class="listitem"><p class="simpara">
						Run the configured <code class="literal">.java</code> class from your project directory. You can run the file in your development platform (such as Red Hat CodeReady Studio) or in the command line.
					</p><p class="simpara">
						Example Maven execution (within project directory):
					</p><pre class="screen">mvn clean install exec:java -Dexec.mainClass="com.sample.app.RulesTest"</pre><p class="simpara">
						Example Java execution (within project directory)
					</p><pre class="screen">javac -classpath "./$DEPENDENCIES/*:." RulesTest.java
java -classpath "./$DEPENDENCIES/*:." RulesTest</pre></li><li class="listitem">
						Review the rule execution status in the command line and in the server log. If any rules do not execute as expected, review the configured rules in the project and the main class configuration to validate the data provided.
					</li></ol></div></section><section class="chapter" id="next_steps_3"><div class="titlepage"><div><div><h2 class="title">Chapter 46. Next steps</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-test-scenarios"><span class="emphasis"><em>Testing a decision service using test scenarios</em></span></a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>
					</li></ul></div></section></div><div class="part" id="assembly-guided-rules"><div class="titlepage"><div><div><h1 class="title">Part VI. Designing a decision service using guided rules</h1></div></div></div><div class="partintro" id="idm139921812529072"><div/><p>
				As a business analyst or business rules developer, you can define business rules using the guided rules designer in Business Central. These guided rules are compiled into Drools Rule Language (DRL) and form the core of the decision service for your project.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					You can also design your decision service using Decision Model and Notation (DMN) models instead of rule-based or table-based assets. For information about DMN support in Red Hat Process Automation Manager 7.10, see the following resources:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/getting_started_with_red_hat_process_automation_manager#assembly-getting-started-decision-services"><span class="emphasis"><em>Getting started with decision services</em></span></a> (step-by-step tutorial with a DMN decision service example)
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-dmn-models"><span class="emphasis"><em>Designing a decision service using DMN models</em></span></a> (overview of DMN support and capabilities in Red Hat Process Automation Manager)
						</li></ul></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The space and project for the guided rules have been created in Business Central. Each asset is associated with a project assigned to a space. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/getting_started_with_red_hat_process_automation_manager#assembly-getting-started-decision-services"><span class="emphasis"><em>Getting started with decision services</em></span></a>.
					</li></ul></div><div class="toc"><p><strong>Table of Contents</strong></p><ul class="toc"><li><span class="chapter"><a href="#decision-authoring-assets-ref_guided-rules">47. Decision-authoring assets in Red Hat Process Automation Manager</a></span></li><li><span class="chapter"><a href="#guided-rules-con_guided-rules">48. Guided rules</a></span></li><li><span class="chapter"><a href="#data-objects-con_guided-rules">49. Data objects</a></span><ul><li><span class="section"><a href="#data-objects-create-proc_guided-rules">49.1. Creating data objects</a></span></li></ul></li><li><span class="chapter"><a href="#guided-rules-create-proc_guided-rules">50. Creating guided rules</a></span><ul><li><span class="section"><a href="#guided-rules-WHEN-proc_guided-rules">50.1. Adding WHEN conditions in guided rules</a></span></li><li><span class="section"><a href="#guided-rules-THEN-proc_guided-rules">50.2. Adding THEN actions in guided rules</a></span></li><li><span class="section"><a href="#enumerations-define-proc_guided-rules">50.3. Defining enumerations for drop-down lists in rule assets</a></span><ul><li><span class="section"><a href="#enumerations-advanced-ref_guided-rules">50.3.1. Advanced enumeration options for rule assets</a></span></li></ul></li><li><span class="section"><a href="#guided-rules-options-proc_guided-rules">50.4. Adding other rule options</a></span><ul><li><span class="section"><a href="#rules-attributes-ref_guided-rules">50.4.1. Rule attributes</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#assets-executing-proc_guided-rules">51. Executing rules</a></span></li><li><span class="chapter"><a href="#next_steps_4">52. Next steps</a></span></li></ul></div></div><section class="chapter" id="decision-authoring-assets-ref_guided-rules"><div class="titlepage"><div><div><h2 class="title">Chapter 47. Decision-authoring assets in Red Hat Process Automation Manager</h2></div></div></div><p>
				Red Hat Process Automation Manager supports several assets that you can use to define business decisions for your decision service. Each decision-authoring asset has different advantages, and you might prefer to use one or a combination of multiple assets depending on your goals and needs.
			</p><p>
				The following table highlights the main decision-authoring assets supported in Red Hat Process Automation Manager projects to help you decide or confirm the best method for defining decisions in your decision service.
			</p><div class="table" id="idm139921813384240"><p class="title"><strong>Table 47.1. Decision-authoring assets supported in Red Hat Process Automation Manager</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"/><col style="width: 40%; " class="col_2"/><col style="width: 20%; " class="col_3"/><col style="width: 20%; " class="col_4"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921813377488" scope="col">Asset</th><th align="left" valign="top" id="idm139921813376400" scope="col">Highlights</th><th align="left" valign="top" id="idm139921813375312" scope="col">Authoring tools</th><th align="left" valign="top" id="idm139921813374224" scope="col">Documentation</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921813377488">
							<p>
								Decision Model and Notation (DMN) models
							</p>
							</td><td align="left" valign="top" headers="idm139921813376400">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are decision models based on a notation standard defined by the Object Management Group (OMG)
									</li><li class="listitem">
										Use graphical decision requirements diagrams (DRDs) that represent part or all of the overall decision requirements graph (DRG) to trace business decision flows
									</li><li class="listitem">
										Use an XML schema that allows the DMN models to be shared between DMN-compliant platforms
									</li><li class="listitem">
										Support Friendly Enough Expression Language (FEEL) to define decision logic in DMN decision tables and other DMN boxed expressions
									</li><li class="listitem">
										Can be integrated efficiently with Business Process Model and Notation (BPMN) process models
									</li><li class="listitem">
										Are optimal for creating comprehensive, illustrative, and stable decision flows
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921813375312">
							<p>
								Business Central or other DMN-compliant editor
							</p>
							</td><td align="left" valign="top" headers="idm139921813374224">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-dmn-models"><span class="emphasis"><em>Designing a decision service using DMN models</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921813377488">
							<p>
								Guided decision tables
							</p>
							</td><td align="left" valign="top" headers="idm139921813376400">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are tables of rules that you create in a UI-based table designer in Business Central
									</li><li class="listitem">
										Are a wizard-led alternative to spreadsheet decision tables
									</li><li class="listitem">
										Provide fields and options for acceptable input
									</li><li class="listitem">
										Support template keys and values for creating rule templates
									</li><li class="listitem">
										Support hit policies, real-time validation, and other additional features not supported in other assets
									</li><li class="listitem">
										Are optimal for creating rules in a controlled tabular format to minimize compilation errors
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921813375312">
							<p>
								Business Central
							</p>
							</td><td align="left" valign="top" headers="idm139921813374224">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-guided-decision-tables"><span class="emphasis"><em>Designing a decision service using guided decision tables</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921813377488">
							<p>
								Spreadsheet decision tables
							</p>
							</td><td align="left" valign="top" headers="idm139921813376400">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are XLS or XLSX spreadsheet decision tables that you can upload into Business Central
									</li><li class="listitem">
										Support template keys and values for creating rule templates
									</li><li class="listitem">
										Are optimal for creating rules in decision tables already managed outside of Business Central
									</li><li class="listitem">
										Have strict syntax requirements for rules to be compiled properly when uploaded
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921813375312">
							<p>
								Spreadsheet editor
							</p>
							</td><td align="left" valign="top" headers="idm139921813374224">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-decision-tables"><span class="emphasis"><em>Designing a decision service using spreadsheet decision tables</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921813377488">
							<p>
								Guided rules
							</p>
							</td><td align="left" valign="top" headers="idm139921813376400">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are individual rules that you create in a UI-based rule designer in Business Central
									</li><li class="listitem">
										Provide fields and options for acceptable input
									</li><li class="listitem">
										Are optimal for creating single rules in a controlled format to minimize compilation errors
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921813375312">
							<p>
								Business Central
							</p>
							</td><td align="left" valign="top" headers="idm139921813374224">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-guided-rules"><span class="emphasis"><em>Designing a decision service using guided rules</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921813377488">
							<p>
								Guided rule templates
							</p>
							</td><td align="left" valign="top" headers="idm139921813376400">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are reusable rule structures that you create in a UI-based template designer in Business Central
									</li><li class="listitem">
										Provide fields and options for acceptable input
									</li><li class="listitem">
										Support template keys and values for creating rule templates (fundamental to the purpose of this asset)
									</li><li class="listitem">
										Are optimal for creating many rules with the same rule structure but with different defined field values
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921813375312">
							<p>
								Business Central
							</p>
							</td><td align="left" valign="top" headers="idm139921813374224">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-guided-rule-templates"><span class="emphasis"><em>Designing a decision service using guided rule templates</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921813377488">
							<p>
								DRL rules
							</p>
							</td><td align="left" valign="top" headers="idm139921813376400">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are individual rules that you define directly in <code class="literal">.drl</code> text files
									</li><li class="listitem">
										Provide the most flexibility for defining rules and other technicalities of rule behavior
									</li><li class="listitem">
										Can be created in certain standalone environments and integrated with Red Hat Process Automation Manager
									</li><li class="listitem">
										Are optimal for creating rules that require advanced DRL options
									</li><li class="listitem">
										Have strict syntax requirements for rules to be compiled properly
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921813375312">
							<p>
								Business Central or integrated development environment (IDE)
							</p>
							</td><td align="left" valign="top" headers="idm139921813374224">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-drl-rules"><span class="emphasis"><em>Designing a decision service using DRL rules</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921813377488">
							<p>
								Predictive Model Markup Language (PMML) models
							</p>
							</td><td align="left" valign="top" headers="idm139921813376400">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are predictive data-analytic models based on a notation standard defined by the Data Mining Group (DMG)
									</li><li class="listitem">
										Use an XML schema that allows the PMML models to be shared between PMML-compliant platforms
									</li><li class="listitem">
										Support Regression, Scorecard, Tree, Mining, and other model types
									</li><li class="listitem">
										Can be included with a standalone Red Hat Process Automation Manager project or imported into a project in Business Central
									</li><li class="listitem">
										Are optimal for incorporating predictive data into decision services in Red Hat Process Automation Manager
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921813375312">
							<p>
								PMML or XML editor
							</p>
							</td><td align="left" valign="top" headers="idm139921813374224">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-pmml-models"><span class="emphasis"><em>Designing a decision service using PMML models</em></span></a>
							</p>
							</td></tr></tbody></table></div></div></section><section class="chapter" id="guided-rules-con_guided-rules"><div class="titlepage"><div><div><h2 class="title">Chapter 48. Guided rules</h2></div></div></div><p>
				Guided rules are business rules that you create in a UI-based guided rules designer in Business Central that leads you through the rule-creation process. The guided rules designer provides fields and options for acceptable input based on the data objects for the rule being defined. The guided rules that you define are compiled into Drools Rule Language (DRL) rules as with all other rule assets.
			</p><p>
				All data objects related to a guided rule must be in the same project package as the guided rule. Assets in the same package are imported by default. After you create the necessary data objects and the guided rule, you can use the <span class="strong strong"><strong>Data Objects</strong></span> tab of the guided rules designer to verify that all required data objects are listed or to import other existing data objects by adding a <span class="strong strong"><strong>New item</strong></span>.
			</p></section><section class="chapter" id="data-objects-con_guided-rules"><div class="titlepage"><div><div><h2 class="title">Chapter 49. Data objects</h2></div></div></div><p>
				Data objects are the building blocks for the rule assets that you create. Data objects are custom data types implemented as Java objects in specified packages of your project. For example, you might create a <code class="literal">Person</code> object with data fields <code class="literal">Name</code>, <code class="literal">Address</code>, and <code class="literal">DateOfBirth</code> to specify personal details for loan application rules. These custom data types determine what data your assets and your decision services are based on.
			</p><section class="section" id="data-objects-create-proc_guided-rules"><div class="titlepage"><div><div><h2 class="title">49.1. Creating data objects</h2></div></div></div><p>
					The following procedure is a generic overview of creating data objects. It is not specific to a particular business asset.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Data Object</strong></span>.
						</li><li class="listitem"><p class="simpara">
							Enter a unique <span class="strong strong"><strong>Data Object</strong></span> name and select the <span class="strong strong"><strong>Package</strong></span> where you want the data object to be available for other rule assets. Data objects with the same name cannot exist in the same package. In the specified DRL file, you can import a data object from any package.
						</p><div class="admonition important"><div class="admonition_header">Importing data objects from other packages</div><div><p>
								You can import an existing data object from another package directly into the asset designers like guided rules or guided decision table designers. Select the relevant rule asset within the project and in the asset designer, go to <span class="strong strong"><strong>Data Objects → New item</strong></span> to select the object to be imported.
							</p></div></div></li><li class="listitem">
							To make your data object persistable, select the <span class="strong strong"><strong>Persistable</strong></span> checkbox. Persistable data objects are able to be stored in a database according to the JPA specification. The default JPA is Hibernate.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Ok</strong></span>.
						</li><li class="listitem"><p class="simpara">
							In the data object designer, click <span class="strong strong"><strong>add field</strong></span> to add a field to the object with the attributes <span class="strong strong"><strong>Id</strong></span>, <span class="strong strong"><strong>Label</strong></span>, and <span class="strong strong"><strong>Type</strong></span>. Required attributes are marked with an asterisk (*).
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="strong strong"><strong>Id:</strong></span> Enter the unique ID of the field.
								</li><li class="listitem">
									<span class="strong strong"><strong>Label:</strong></span> (Optional) Enter a label for the field.
								</li><li class="listitem">
									<span class="strong strong"><strong>Type:</strong></span> Enter the data type of the field.
								</li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>List:</strong></span> (Optional) Select this check box to enable the field to hold multiple items for the specified type.
								</p><div class="figure" id="idm139921814312544"><p class="title"><strong>Figure 49.1. Add data fields to a data object</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/project-data/DataModelerNewField2-new.png" alt="Add data fields to a data object"/></div></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Create</strong></span> to add the new field, or click <span class="strong strong"><strong>Create and continue</strong></span> to add the new field and continue adding other fields.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								To edit a field, select the field row and use the <span class="strong strong"><strong>general properties</strong></span> on the right side of the screen.
							</p></div></div></li></ol></div></section></section><section class="chapter" id="guided-rules-create-proc_guided-rules"><div class="titlepage"><div><div><h2 class="title">Chapter 50. Creating guided rules</h2></div></div></div><p>
				Guided rules enable you to define business rules in a structured format, based on the data objects associated with the rules. You can create and define guided rules individually for your project.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Guided Rule</strong></span>.
					</li><li class="listitem"><p class="simpara">
						Enter an informative <span class="strong strong"><strong>Guided Rule</strong></span> name and select the appropriate <span class="strong strong"><strong>Package</strong></span>. The package that you specify must be the same package where the required data objects have been assigned or will be assigned.
					</p><p class="simpara">
						You can also select <span class="strong strong"><strong>Show declared DSL sentences</strong></span> if any domain specific language (DSL) assets have been defined in your project. These DSL assets will then become usable objects for conditions and actions that you define in the guided rules designer.
					</p></li><li class="listitem"><p class="simpara">
						Click <span class="strong strong"><strong>Ok</strong></span> to create the rule asset.
					</p><p class="simpara">
						The new guided rule is now listed in the <span class="strong strong"><strong>Guided Rules</strong></span> panel of the <span class="strong strong"><strong>Project Explorer</strong></span>, or in the <span class="strong strong"><strong>Guided Rules (with DSL)</strong></span> panel if you selected the <span class="strong strong"><strong>Show declared DSL sentences</strong></span> option.
					</p></li><li class="listitem">
						Click the <span class="strong strong"><strong>Data Objects</strong></span> tab and confirm that all data objects required for your rules are listed. If not, click <span class="strong strong"><strong>New item</strong></span> to import data objects from other packages, or <a class="link" href="#data-objects-create-proc_guided-rules" title="49.1. Creating data objects">create data objects</a> within your package.
					</li><li class="listitem"><p class="simpara">
						After all data objects are in place, return to the <span class="strong strong"><strong>Model</strong></span> tab of the guided rules designer and use the buttons on the right side of the window to add and define the <span class="strong strong"><strong>WHEN</strong></span> (condition) and <span class="strong strong"><strong>THEN</strong></span> (action) sections of the rule, based on the available data objects.
					</p><div class="figure" id="idm139921814277936"><p class="title"><strong>Figure 50.1. The guided rules designer</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/1140_01.png" alt="The guided rules designer"/></div></div></div><p class="simpara">
						The <span class="strong strong"><strong>WHEN</strong></span> part of the rule contains the conditions that must be met to execute an action. For example, if a bank requires loan applicants to have over 21 years of age, then the <span class="strong strong"><strong>WHEN</strong></span> condition of an <code class="literal">Underage</code> rule would be <code class="literal">Age | less than | 21</code>.
					</p><p class="simpara">
						The <span class="strong strong"><strong>THEN</strong></span> part of the rule contains the actions to be performed when the conditional part of the rule has been met. For example, when the loan applicant is under 21 years old, the <span class="strong strong"><strong>THEN</strong></span> action would set <code class="literal">approved</code> to <code class="literal">false</code>, declining the loan because the applicant is under age.
					</p><p class="simpara">
						You can also specify exceptions for more complex rules, such as if a bank may approve of an under-aged applicant when a guarantor is involved. In that case, you would create or import a <span class="strong strong"><strong>guarantor</strong></span> data object and then add the field to the guided rule.
					</p></li><li class="listitem">
						After you define all components of the rule, click <span class="strong strong"><strong>Validate</strong></span> in the upper-right toolbar of the guided rules designer to validate the guided rule. If the rule validation fails, address any problems described in the error message, review all components in the rule, and try again to validate the rule until the rule passes.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Save</strong></span> in the guided rules designer to save your work.
					</li></ol></div><section class="section" id="guided-rules-WHEN-proc_guided-rules"><div class="titlepage"><div><div><h2 class="title">50.1. Adding WHEN conditions in guided rules</h2></div></div></div><p>
					The <span class="strong strong"><strong>WHEN</strong></span> part of the rule contains the conditions that must be met to execute an action. For example, if a bank requires loan applicants to have over 21 years of age, then the <span class="strong strong"><strong>WHEN</strong></span> condition of an <code class="literal">Underage</code> rule would be <code class="literal">Age | less than | 21</code>. You can set simple or complex conditions to determine how and when your rules are applied.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							All data objects required for your rules have been created or imported and are listed in the <span class="strong strong"><strong>Data Objects</strong></span> tab of the guided rules designer.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							In the guided rules designer, click the plus icon (
							<span class="inlinemediaobject"><img src="images/_images/Workbench/AuthoringAssets/5686.png" alt="5686"/></span>
							) on the right side of the <code class="literal">WHEN</code> section.
						</p><p class="simpara">
							The <span class="strong strong"><strong>Add a condition to the rule</strong></span> window with the available condition elements opens.
						</p><div class="figure" id="idm139921814248032"><p class="title"><strong>Figure 50.2. Add a condition to the rule</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/5687.png" alt="Add a condition to the rule"/></div></div></div><p class="simpara">
							The list includes the data objects from the <span class="strong strong"><strong>Data Objects</strong></span> tab of the guided rules designer, any DSL objects defined for the package (if you selected <span class="strong strong"><strong>Show declared DSL sentences</strong></span> when you created this guided rule), and the following standard options:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="strong strong"><strong>The following does not exist:</strong></span> Use this to specify facts and constraints that must not exist.
								</li><li class="listitem">
									<span class="strong strong"><strong>The following exists:</strong></span> Use this to specify facts and constraints that must exist. This option is triggered on only the first match, not subsequent matches.
								</li><li class="listitem">
									<span class="strong strong"><strong>Any of the following are true:</strong></span> Use this to list any facts or constraints that must be true.
								</li><li class="listitem">
									<span class="strong strong"><strong>From:</strong></span> Use this to define a <code class="literal">From</code> conditional element for the rule.
								</li><li class="listitem">
									<span class="strong strong"><strong>From Accumulate:</strong></span> Use this to define an <code class="literal">Accumulate</code> conditional element for the rule.
								</li><li class="listitem">
									<span class="strong strong"><strong>From Collect:</strong></span> Use this to define a <code class="literal">Collect</code> conditional element for the rule.
								</li><li class="listitem">
									<span class="strong strong"><strong>From Entry Point:</strong></span> Use this to define an <code class="literal">Entry Point</code> for the pattern.
								</li><li class="listitem">
									<span class="strong strong"><strong>Free form DRL:</strong></span> Use this to insert a free-form DRL field where you can define condition elements freely, without the guided rules designer.
								</li></ul></div></li><li class="listitem">
							Choose a condition element (for example, <span class="strong strong"><strong>LoanApplication</strong></span>) and click <span class="strong strong"><strong>Ok</strong></span>.
						</li><li class="listitem"><p class="simpara">
							Click the condition element in the guided rules designer and use the <span class="strong strong"><strong>Modify constraints for LoanApplication</strong></span> window to add a restriction on a field, apply multiple field constraints, add a new formula style expression, apply an expression editor, or set a variable name.
						</p><div class="figure" id="idm139921816337888"><p class="title"><strong>Figure 50.3. Modify a condition</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/5689.png" alt="Modifying a condition"/></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								A variable name enables you to identify a fact or field in other constructs within the guided rule. For example, you could set the variable of <code class="literal">LoanApplication</code> to <code class="literal">a</code> and then reference <code class="literal">a</code> in a separate <code class="literal">Bankruptcy</code> constraint that specifies which application the bankruptcy is based on.
							</p><pre class="screen">a : LoanApplication()
Bankruptcy( application == a ).</pre></div></div><p class="simpara">
							After you select a constraint, the window closes automatically.
						</p></li><li class="listitem">
							Choose an operator for the restriction (for example, <code class="literal">greater than</code>) from the drop-down menu next to the added restriction.
						</li><li class="listitem">
							Click the edit icon (
							<span class="inlinemediaobject"><img src="images/_images/Workbench/AuthoringAssets/6191.png" alt="6191"/></span>
							) to define the field value. The field value can be a literal value, a formula, or a full MVEL expression.
						</li><li class="listitem"><p class="simpara">
							To apply multiple field constraints, click the condition and in the <span class="strong strong"><strong>Modify constraints for LoanApplication</strong></span> window, select <span class="strong strong"><strong>All of(And)</strong></span> or <span class="strong strong"><strong>Any of(Or)</strong></span> from the <span class="strong strong"><strong>Multiple field constraint</strong></span> drop-down menu.
						</p><div class="figure" id="idm139921816320208"><p class="title"><strong>Figure 50.4. Add multiple field constraints</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/5688.png" alt="Modifying a condition"/></div></div></div></li><li class="listitem">
							Click the constraint in the guided rules designer and further define the field value.
						</li><li class="listitem">
							After you define all condition components of the rule, click <span class="strong strong"><strong>Validate</strong></span> in the upper-right toolbar of the guided rules designer to validate the guided rule conditions. If the rule validation fails, address any problems described in the error message, review all components in the rule, and try again to validate the rule until the rule passes.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Save</strong></span> in the guided rules designer to save your work.
						</li></ol></div></section><section class="section" id="guided-rules-THEN-proc_guided-rules"><div class="titlepage"><div><div><h2 class="title">50.2. Adding THEN actions in guided rules</h2></div></div></div><p>
					The <span class="strong strong"><strong>THEN</strong></span> part of the rule contains the actions to be performed when the <span class="strong strong"><strong>WHEN</strong></span> condition of the rule has been met. For example, when a loan applicant is under 21 years old, the <span class="strong strong"><strong>THEN</strong></span> action might set <code class="literal">approved</code> to <code class="literal">false</code>, declining the loan because the applicant is under age. You can set simple or complex actions to determine how and when your rules are applied.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							All data objects required for your rules have been created or imported and are listed in the <span class="strong strong"><strong>Data Objects</strong></span> tab of the guided rules designer.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							In the guided rules designer, click the plus icon (
							<span class="inlinemediaobject"><img src="images/_images/Workbench/AuthoringAssets/5686.png" alt="5686"/></span>
							) on the right side of the <code class="literal">THEN</code> section.
						</p><p class="simpara">
							The <span class="strong strong"><strong>Add a new action</strong></span> window with the available action elements opens.
						</p><div class="figure" id="idm139921816296144"><p class="title"><strong>Figure 50.5. Add a new action to the rule</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/5695.png" alt="Add a new action to the rule"/></div></div></div><p class="simpara">
							The list includes insertion and modification options based on the data objects in the <span class="strong strong"><strong>Data Objects</strong></span> tab of the guided rules designer, and on any DSL objects defined for the package (if you selected <span class="strong strong"><strong>Show declared DSL sentences</strong></span> when you created this guided rule):
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="strong strong"><strong>Change field values of:</strong></span> Use this to set the value of fields on a fact (such as <code class="literal">LoanApplication</code>) without notifying the decision engine of the change.
								</li><li class="listitem">
									<span class="strong strong"><strong>Delete:</strong></span> Use this to delete a fact.
								</li><li class="listitem">
									<span class="strong strong"><strong>Modify:</strong></span> Use this to specify fields to be modified for a fact and to notify the decision engine of the change.
								</li><li class="listitem">
									<span class="strong strong"><strong>Insert fact:</strong></span> Use this to insert a fact and define resulting fields and values for the fact.
								</li><li class="listitem">
									<span class="strong strong"><strong>Logically Insert fact:</strong></span> Use this to insert a fact logically into the decision engine and define resulting fields and values for the fact. The decision engine is responsible for logical decisions on insertions and retractions of facts. After regular or stated insertions, facts have to be retracted explicitly. After logical insertions, facts are automatically retracted when the conditions that originally asserted the facts are no longer true.
								</li><li class="listitem">
									<span class="strong strong"><strong>Add free form DRL:</strong></span> Use this to insert a free-form DRL field where you can define condition elements freely, without the guided rules designer.
								</li><li class="listitem">
									<span class="strong strong"><strong>Call method on:</strong></span> Use this to invoke a method from another fact.
								</li></ul></div></li><li class="listitem">
							Choose an action element (for example, <span class="strong strong"><strong>Modify</strong></span>) and click <span class="strong strong"><strong>Ok</strong></span>.
						</li><li class="listitem"><p class="simpara">
							Click the action element in the guided rules designer and use the <span class="strong strong"><strong>Add a field</strong></span> window to select a field.
						</p><div class="figure" id="idm139921812952400"><p class="title"><strong>Figure 50.6. Add a field</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/5696.png" alt="Add a field"/></div></div></div><p class="simpara">
							After you select a field, the window closes automatically.
						</p></li><li class="listitem">
							Click the edit icon (
							<span class="inlinemediaobject"><img src="images/_images/Workbench/AuthoringAssets/6191.png" alt="6191"/></span>
							) to define the field value. The field value can be a literal value or a formula.
						</li><li class="listitem">
							After you define all action components of the rule, click <span class="strong strong"><strong>Validate</strong></span> in the upper-right toolbar of the guided rules designer to validate the guided rule actions. If the rule validation fails, address any problems described in the error message, review all components in the rule, and try again to validate the rule until the rule passes.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Save</strong></span> in the guided rules designer to save your work.
						</li></ol></div></section><section class="section" id="enumerations-define-proc_guided-rules"><div class="titlepage"><div><div><h2 class="title">50.3. Defining enumerations for drop-down lists in rule assets</h2></div></div></div><p>
					Enumeration definitions in Business Central determine the possible values of fields for conditions or actions in guided rules, guided rule templates, and guided decision tables. An enumeration definition contains a <code class="literal">fact.field</code> mapping to a list of supported values that are displayed as a drop-down list in the relevant field of a rule asset. When a user selects a field that is based on the same fact and field as the enumeration definition, the drop-down list of defined values is displayed.
				</p><p>
					You can define enumerations in Business Central or in the DRL source for your Red Hat Process Automation Manager project.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Enumeration</strong></span>.
						</li><li class="listitem">
							Enter an informative <span class="strong strong"><strong>Enumeration</strong></span> name and select the appropriate <span class="strong strong"><strong>Package</strong></span>. The package that you specify must be the same package where the required data objects and relevant rule assets have been assigned or will be assigned.
						</li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Ok</strong></span> to create the enumeration.
						</p><p class="simpara">
							The new enumeration is now listed in the <span class="strong strong"><strong>Enumeration Definitions</strong></span> panel of the <span class="strong strong"><strong>Project Explorer</strong></span>.
						</p></li><li class="listitem"><p class="simpara">
							In the <span class="strong strong"><strong>Model</strong></span> tab of the enumerations designer, click <span class="strong strong"><strong>Add enum</strong></span> and define the following values for the enumeration:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="strong strong"><strong>Fact</strong></span>: Specify an existing data object within the same package of your project with which you want to associate this enumeration. Open the <span class="strong strong"><strong>Data Objects</strong></span> panel in the <span class="strong strong"><strong>Project Explorer</strong></span> to view the available data objects, or create the relevant data object as a new asset if needed.
								</li><li class="listitem">
									<span class="strong strong"><strong>Field</strong></span>: Specify an existing field identifier that you defined as part of the data object that you selected for the <span class="strong strong"><strong>Fact</strong></span>. Open the <span class="strong strong"><strong>Data Objects</strong></span> panel in the <span class="strong strong"><strong>Project Explorer</strong></span> to select the relevant data object and view the list of available <span class="strong strong"><strong>Identifier</strong></span> options. You can create the relevant identifier for the data object if needed.
								</li><li class="listitem">
									<span class="strong strong"><strong>Context</strong></span>: Specify a list of values in the format <code class="literal">['string1','string2','string3']</code> or <code class="literal">[integer1,integer2,integer3]</code> that you want to map to the <span class="strong strong"><strong>Fact</strong></span> and <span class="strong strong"><strong>Field</strong></span> definitions. These values will be displayed as a drop-down list for the relevant field of the rule asset.
								</li></ul></div><p class="simpara">
							For example, the following enumeration defines the drop-down values for applicant credit rating in a loan application decision service:
						</p><div class="figure" id="idm139921812906368"><p class="title"><strong>Figure 50.7. Example enumeration for applicant credit rating in Business Central</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Workbench/AuthoringAssets/EnumConfig.png" alt="EnumConfig"/></div></div></div><div class="formalpara"><p class="title"><strong>Example enumeration for applicant credit rating in the DRL source</strong></p><p>
								
<pre class="screen">'Applicant.creditRating' : ['AA', 'OK', 'Sub prime']</pre>
							</p></div><p class="simpara">
							In this example, for any guided rule, guided rule template, or guided decision table that is in the same package of the project and that uses the <code class="literal">Applicant</code> data object and the <code class="literal">creditRating</code> field, the configured values are available as drop-down options:
						</p><div class="figure" id="idm139921812898528"><p class="title"><strong>Figure 50.8. Example enumeration drop-down options in a guided rule or guided rule template</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Workbench/AuthoringAssets/EnumDropDown.png" alt="EnumDropDown"/></div></div></div><div class="figure" id="idm139921812894304"><p class="title"><strong>Figure 50.9. Example enumeration drop-down options in a guided decision table</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Workbench/AuthoringAssets/EnumDropDownGDT.png" alt="EnumDropDownGDT"/></div></div></div></li></ol></div><section class="section" id="enumerations-advanced-ref_guided-rules"><div class="titlepage"><div><div><h3 class="title">50.3.1. Advanced enumeration options for rule assets</h3></div></div></div><p>
						For advanced use cases with enumeration definitions in your Red Hat Process Automation Manager project, consider the following extended options for defining enumerations:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Mapping between DRL values and values in Business Central</span></dt><dd><p class="simpara">
									If you want the enumeration values to appear differently or more completely in the Business Central interface than they appear in the DRL source, use a mapping in the format <code class="literal">'fact.field' : ['sourceValue1=UIValue1','sourceValue2=UIValue2', …​ ]</code> for your enumeration definition values.
								</p><p class="simpara">
									For example, in the following enumeration definition for loan status, the options <code class="literal">A</code> or <code class="literal">D</code> are used in the DRL file but the options <code class="literal">Approved</code> or <code class="literal">Declined</code> are displayed in Business Central:
								</p><pre class="screen">'Loan.status' : ['A=Approved','D=Declined']</pre></dd><dt><span class="term">Enumeration value dependencies</span></dt><dd><p class="simpara">
									If you want the selected value in one drop-down list to determine the available options in a subsequent drop-down list, use the format <code class="literal">'fact.fieldB[fieldA=value1]' : ['value2', 'value3', …​ ]</code> for your enumeration definition.
								</p><p class="simpara">
									For example, in the following enumeration definition for insurance policies, the <code class="literal">policyType</code> field accepts the values <code class="literal">Home</code> or <code class="literal">Car</code>. The type of policy that the user selects determines the policy <code class="literal">coverage</code> field options that are then available:
								</p><pre class="screen">'Insurance.policyType' : ['Home', 'Car']
'Insurance.coverage[policyType=Home]' : ['property', 'liability']
'Insurance.coverage[policyType=Car]' : ['collision', 'fullCoverage']</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										Enumeration dependencies are not applied across rule conditions and actions. For example, in this insurance policy use case, the selected policy in the rule condition does not determine the available coverage options in the rule actions, if applicable.
									</p></div></div></dd><dt><span class="term">External data sources in enumerations</span></dt><dd><p class="simpara">
									If you want to retrieve a list of enumeration values from an external data source instead of defining the values directly in the enumeration definition, on the class path of your project, add a helper class that returns a <code class="literal">java.util.List</code> list of strings. In the enumeration definition, instead of specifying a list of values, identify the helper class that you configured to retrieve the values externally.
								</p><p class="simpara">
									For example, in the following enumeration definition for loan applicant region, instead of defining applicant regions explicitly in the format <code class="literal">'Applicant.region' : ['country1', 'country2', …​ ]</code>, the enumeration uses a helper class that returns the list of values defined externally:
								</p><pre class="screen">'Applicant.region' : (new com.mycompany.DataHelper()).getListOfRegions()</pre><p class="simpara">
									In this example, a <code class="literal">DataHelper</code> class contains a <code class="literal">getListOfRegions()</code> method that returns a list of strings. The enumerations are loaded in the drop-down list for the relevant field in the rule asset.
								</p><p class="simpara">
									You can also load dependent enumeration definitions dynamically from a helper class by identifying the dependent field as usual and enclosing the call to the helper class within quotation marks:
								</p><pre class="screen">'Applicant.region[countryCode]' : '(new com.mycompany.DataHelper()).getListOfRegions("@{countryCode}")'</pre><p class="simpara">
									If you want to load all enumeration data entirely from an external data source, such as a relational database, you can implement a Java class that returns a <code class="literal">Map&lt;String, List&lt;String&gt;&gt;</code> map. The key of the map is the <code class="literal">fact.field</code> mapping and the value is a <code class="literal">java.util.List&lt;String&gt;</code> list of values.
								</p><p class="simpara">
									For example, the following Java class defines loan applicant regions for the related enumeration:
								</p><pre class="programlisting language-java">public class SampleDataSource {

  public Map&lt;String, List&lt;String&gt;&gt; loadData() {
    Map data = new HashMap();

    List d = new ArrayList();
    d.add("AU");
    d.add("DE");
    d.add("ES");
    d.add("UK");
    d.add("US");
    ...
    data.put("Applicant.region", d);

    return data;
  }

}</pre><p class="simpara">
									The following enumeration definition correlates to this example Java class. The enumeration contains no references to fact or field names because they are defined in the Java class:
								</p><pre class="screen">=(new SampleDataSource()).loadData()</pre><p class="simpara">
									The <code class="literal">=</code> operator enables Business Central to load all enumeration data from the helper class. The helper methods are statically evaluated when the enumeration definition is requested for use in an editor.
								</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										Defining an enumeration without a fact and field definition is currently not supported in Business Central. To define the enumeration for the associated Java class in this way, use the DRL source in your Red Hat Process Automation Manager project.
									</p></div></div></dd></dl></div></section></section><section class="section" id="guided-rules-options-proc_guided-rules"><div class="titlepage"><div><div><h2 class="title">50.4. Adding other rule options</h2></div></div></div><p>
					You can also use the rule designer to add metadata within a rule, define additional rule attributes (such as <code class="literal">salience</code> and <code class="literal">no-loop</code>), and freeze areas of the rule to restrict modifications to conditions or actions.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the rule designer, click <span class="strong strong"><strong>(show options…​)</strong></span> under the <span class="strong strong"><strong>THEN</strong></span> section.
						</li><li class="listitem">
							Click the plus icon (
							<span class="inlinemediaobject"><img src="images/_images/Workbench/AuthoringAssets/5686.png" alt="5686"/></span>
							) on the right side of the window to add options.
						</li><li class="listitem"><p class="simpara">
							Select an option to be added to the rule:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="strong strong"><strong>Metadata:</strong></span> Enter a metadata label and click the plus icon (
									<span class="inlinemediaobject"><img src="images/_images/Workbench/AuthoringAssets/5686.png" alt="5686"/></span>
									). Then enter any needed data in the field provided in the rule designer.
								</li><li class="listitem">
									<span class="strong strong"><strong>Attribute:</strong></span> Select from the list of rule attributes. Then further define the value in the field or option displayed in the rule designer.
								</li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>Freeze areas for editing:</strong></span> Select <span class="strong strong"><strong>Conditions</strong></span> or <span class="strong strong"><strong>Actions</strong></span> to restrict the area from being modified in the rule designer.
								</p><div class="figure" id="idm139921813759184"><p class="title"><strong>Figure 50.10. Rule options</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/1141.png" alt="Additional rule options"/></div></div></div></li></ul></div></li><li class="listitem">
							Click <span class="strong strong"><strong>Save</strong></span> in the rule designer to save your work.
						</li></ol></div><section class="section" id="rules-attributes-ref_guided-rules"><div class="titlepage"><div><div><h3 class="title">50.4.1. Rule attributes</h3></div></div></div><p>
						Rule attributes are additional specifications that you can add to business rules to modify rule behavior.
					</p><p>
						The following table lists the names and supported values of the attributes that you can assign to rules:
					</p><div class="table" id="idm139921813750384"><p class="title"><strong>Table 50.1. Rule attributes</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921813745552" scope="col">Attribute</th><th align="left" valign="top" id="idm139921813744464" scope="col">Value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921813745552">
									<p>
										<code class="literal">salience</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921813744464">
									<p>
										An integer defining the priority of the rule. Rules with a higher salience value are given higher priority when ordered in the activation queue.
									</p>
									<p>
										Example: <code class="literal">salience 10</code>
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921813745552">
									<p>
										<code class="literal">enabled</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921813744464">
									<p>
										A Boolean value. When the option is selected, the rule is enabled. When the option is not selected, the rule is disabled.
									</p>
									<p>
										Example: <code class="literal">enabled true</code>
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921813745552">
									<p>
										<code class="literal">date-effective</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921813744464">
									<p>
										A string containing a date and time definition. The rule can be activated only if the current date and time is after a <code class="literal">date-effective</code> attribute.
									</p>
									<p>
										Example: <code class="literal">date-effective "4-Sep-2018"</code>
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921813745552">
									<p>
										<code class="literal">date-expires</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921813744464">
									<p>
										A string containing a date and time definition. The rule cannot be activated if the current date and time is after the <code class="literal">date-expires</code> attribute.
									</p>
									<p>
										Example: <code class="literal">date-expires "4-Oct-2018"</code>
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921813745552">
									<p>
										<code class="literal">no-loop</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921813744464">
									<p>
										A Boolean value. When the option is selected, the rule cannot be reactivated (looped) if a consequence of the rule re-triggers a previously met condition. When the condition is not selected, the rule can be looped in these circumstances.
									</p>
									<p>
										Example: <code class="literal">no-loop true</code>
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921813745552">
									<p>
										<code class="literal">agenda-group</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921813744464">
									<p>
										A string identifying an agenda group to which you want to assign the rule. Agenda groups allow you to partition the agenda to provide more execution control over groups of rules. Only rules in an agenda group that has acquired a focus are able to be activated.
									</p>
									<p>
										Example: <code class="literal">agenda-group "GroupName"</code>
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921813745552">
									<p>
										<code class="literal">activation-group</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921813744464">
									<p>
										A string identifying an activation (or XOR) group to which you want to assign the rule. In activation groups, only one rule can be activated. The first rule to fire will cancel all pending activations of all rules in the activation group.
									</p>
									<p>
										Example: <code class="literal">activation-group "GroupName"</code>
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921813745552">
									<p>
										<code class="literal">duration</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921813744464">
									<p>
										A long integer value defining the duration of time in milliseconds after which the rule can be activated, if the rule conditions are still met.
									</p>
									<p>
										Example: <code class="literal">duration 10000</code>
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921813745552">
									<p>
										<code class="literal">timer</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921813744464">
									<p>
										A string identifying either <code class="literal">int</code> (interval) or <code class="literal">cron</code> timer definitions for scheduling the rule.
									</p>
									<p>
										Example: <code class="literal">timer ( cron:* 0/15 * * * ? )</code> (every 15 minutes)
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921813745552">
									<p>
										<code class="literal">calendar</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921813744464">
									<p>
										A <a class="link" href="http://www.quartz-scheduler.org/">Quartz</a> calendar definition for scheduling the rule.
									</p>
									<p>
										Example: <code class="literal">calendars "* * 0-7,18-23 ? * *"</code> (exclude non-business hours)
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921813745552">
									<p>
										<code class="literal">auto-focus</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921813744464">
									<p>
										A Boolean value, applicable only to rules within agenda groups. When the option is selected, the next time the rule is activated, a focus is automatically given to the agenda group to which the rule is assigned.
									</p>
									<p>
										Example: <code class="literal">auto-focus true</code>
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921813745552">
									<p>
										<code class="literal">lock-on-active</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921813744464">
									<p>
										A Boolean value, applicable only to rules within rule flow groups or agenda groups. When the option is selected, the next time the ruleflow group for the rule becomes active or the agenda group for the rule receives a focus, the rule cannot be activated again until the ruleflow group is no longer active or the agenda group loses the focus. This is a stronger version of the <code class="literal">no-loop</code> attribute, because the activation of a matching rule is discarded regardless of the origin of the update (not only by the rule itself). This attribute is ideal for calculation rules where you have a number of rules that modify a fact and you do not want any rule re-matching and firing again.
									</p>
									<p>
										Example: <code class="literal">lock-on-active true</code>
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921813745552">
									<p>
										<code class="literal">ruleflow-group</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921813744464">
									<p>
										A string identifying a rule flow group. In rule flow groups, rules can fire only when the group is activated by the associated rule flow.
									</p>
									<p>
										Example: <code class="literal">ruleflow-group "GroupName"</code>
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921813745552">
									<p>
										<code class="literal">dialect</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921813744464">
									<p>
										A string identifying either <code class="literal">JAVA</code> or <code class="literal">MVEL</code> as the language to be used for code expressions in the rule. By default, the rule uses the dialect specified at the package level. Any dialect specified here overrides the package dialect setting for the rule.
									</p>
									<p>
										Example: <code class="literal">dialect "JAVA"</code>
									</p>
									<div class="admonition note"><div class="admonition_header">Note</div><div><p>
											When you use Red Hat Process Automation Manager without the executable model, the <code class="literal">dialect "JAVA"</code> rule consequences support only Java 5 syntax. For more information about executable models, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#executable-model-con_packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>.
										</p></div></div>
									</td></tr></tbody></table></div></div></section></section></section><section class="chapter" id="assets-executing-proc_guided-rules"><div class="titlepage"><div><div><h2 class="title">Chapter 51. Executing rules</h2></div></div></div><p>
				After you identify example rules or create your own rules in Business Central, you can build and deploy the associated project and execute rules locally or on KIE Server to test the rules.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Business Central and KIE Server are installed and running. For installation options, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/installing_and_configuring_red_hat_process_automation_manager#assembly-planning"><span class="emphasis"><em>Planning a Red Hat Process Automation Manager installation</em></span></a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
					</li><li class="listitem"><p class="simpara">
						In the upper-right corner of the project <span class="strong strong"><strong>Assets</strong></span> page, click <span class="strong strong"><strong>Deploy</strong></span> to build the project and deploy it to KIE Server. If the build fails, address any problems described in the <span class="strong strong"><strong>Alerts</strong></span> panel at the bottom of the screen.
					</p><p class="simpara">
						For more information about project deployment options, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							If the rule assets in your project are not built from an executable rule model by default, verify that the following dependency is in the <code class="literal">pom.xml</code> file of your project and rebuild the project:
						</p><pre class="programlisting language-xml">&lt;dependency&gt;
  &lt;groupId&gt;org.drools&lt;/groupId&gt;
  &lt;artifactId&gt;drools-model-compiler&lt;/artifactId&gt;
  &lt;version&gt;${rhpam.version}&lt;/version&gt;
&lt;/dependency&gt;</pre><p>
							This dependency is required for rule assets in Red Hat Process Automation Manager to be built from executable rule models by default. This dependency is included as part of the Red Hat Process Automation Manager core packaging, but depending on your Red Hat Process Automation Manager upgrade history, you may need to manually add this dependency to enable the executable rule model behavior.
						</p><p>
							For more information about executable rule models, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#executable-model-con_packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Create a Maven or Java project outside of Business Central, if not created already, that you can use for executing rules locally or that you can use as a client application for executing rules on KIE Server. The project must contain a <code class="literal">pom.xml</code> file and any other required components for executing the project resources.
					</p><p class="simpara">
						For example test projects, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#drl-rules-other-con">"Other methods for creating and executing DRL rules"</a>.
					</p></li><li class="listitem"><p class="simpara">
						Open the <code class="literal">pom.xml</code> file of your test project or client application and add the following dependencies, if not added already:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">kie-ci</code>: Enables your client application to load Business Central project data locally using <code class="literal">ReleaseId</code>
							</li><li class="listitem">
								<code class="literal">kie-server-client</code>: Enables your client application to interact remotely with assets on KIE Server
							</li><li class="listitem">
								<code class="literal">slf4j</code>: (Optional) Enables your client application to use Simple Logging Facade for Java (SLF4J) to return debug logging information after you interact with KIE Server
							</li></ul></div><p class="simpara">
						Example dependencies for Red Hat Process Automation Manager 7.10 in a client application <code class="literal">pom.xml</code> file:
					</p><pre class="programlisting language-xml">&lt;!-- For local execution --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-ci&lt;/artifactId&gt;
  &lt;version&gt;7.48.0.Final-redhat-00002&lt;/version&gt;
&lt;/dependency&gt;

&lt;!-- For remote execution on KIE Server --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie.server&lt;/groupId&gt;
  &lt;artifactId&gt;kie-server-client&lt;/artifactId&gt;
  &lt;version&gt;7.48.0.Final-redhat-00002&lt;/version&gt;
&lt;/dependency&gt;

&lt;!-- For debug logging (optional) --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
  &lt;artifactId&gt;slf4j-simple&lt;/artifactId&gt;
  &lt;version&gt;1.7.25&lt;/version&gt;
&lt;/dependency&gt;</pre><p class="simpara">
						For available versions of these artifacts, search the group ID and artifact ID in the <a class="link" href="https://repository.jboss.org/nexus/index.html#welcome">Nexus Repository Manager</a> online.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Instead of specifying a Red Hat Process Automation Manager <code class="literal">&lt;version&gt;</code> for individual dependencies, consider adding the Red Hat Business Automation bill of materials (BOM) dependency to your project <code class="literal">pom.xml</code> file. The Red Hat Business Automation BOM applies to both Red Hat Decision Manager and Red Hat Process Automation Manager. When you add the BOM files, the correct versions of transitive dependencies from the provided Maven repositories are included in the project.
						</p><p>
							Example BOM dependency:
						</p><pre class="programlisting language-xml">&lt;dependency&gt;
  &lt;groupId&gt;com.redhat.ba&lt;/groupId&gt;
  &lt;artifactId&gt;ba-platform-bom&lt;/artifactId&gt;
  &lt;version&gt;7.10.0.redhat-00002&lt;/version&gt;
  &lt;scope&gt;import&lt;/scope&gt;
  &lt;type&gt;pom&lt;/type&gt;
&lt;/dependency&gt;</pre><p>
							For more information about the Red Hat Business Automation BOM, see <a class="link" href="https://access.redhat.com/solutions/3405361">What is the mapping between Red Hat Process Automation Manager and the Maven library version?</a>.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Ensure that the dependencies for artifacts containing model classes are defined in the client application <code class="literal">pom.xml</code> file exactly as they appear in the <code class="literal">pom.xml</code> file of the deployed project. If dependencies for model classes differ between the client application and your projects, execution errors can occur.
					</p><p class="simpara">
						To access the project <code class="literal">pom.xml</code> file in Business Central, select any existing asset in the project and then in the <span class="strong strong"><strong>Project Explorer</strong></span> menu on the left side of the screen, click the <span class="strong strong"><strong>Customize View</strong></span> gear icon and select <span class="strong strong"><strong>Repository View</strong></span> → <span class="strong strong"><strong>pom.xml</strong></span>.
					</p><p class="simpara">
						For example, the following <code class="literal">Person</code> class dependency appears in both the client and deployed project <code class="literal">pom.xml</code> files:
					</p><pre class="programlisting language-xml">&lt;dependency&gt;
  &lt;groupId&gt;com.sample&lt;/groupId&gt;
  &lt;artifactId&gt;Person&lt;/artifactId&gt;
  &lt;version&gt;1.0.0&lt;/version&gt;
&lt;/dependency&gt;</pre></li><li class="listitem"><p class="simpara">
						If you added the <code class="literal">slf4j</code> dependency to the client application <code class="literal">pom.xml</code> file for debug logging, create a <code class="literal">simplelogger.properties</code> file on the relevant classpath (for example, in <code class="literal">src/main/resources/META-INF</code> in Maven) with the following content:
					</p><pre class="programlisting language-java">org.slf4j.simpleLogger.defaultLogLevel=debug</pre></li><li class="listitem"><p class="simpara">
						In your client application, create a <code class="literal">.java</code> main class containing the necessary imports and a <code class="literal">main()</code> method to load the KIE base, insert facts, and execute the rules.
					</p><p class="simpara">
						For example, a <code class="literal">Person</code> object in a project contains getter and setter methods to set and retrieve the first name, last name, hourly rate, and the wage of a person. The following <code class="literal">Wage</code> rule in a project calculates the wage and hourly rate values and displays a message based on the result:
					</p><pre class="programlisting language-java">package com.sample;

import com.sample.Person;

dialect "java"

rule "Wage"
  when
    Person(hourlyRate * wage &gt; 100)
    Person(name : firstName, surname : lastName)
  then
    System.out.println("Hello" + " " + name + " " + surname + "!");
    System.out.println("You are rich!");
end</pre><p class="simpara">
						To test this rule locally outside of KIE Server (if needed), configure the <code class="literal">.java</code> class to import KIE services, a KIE container, and a KIE session, and then use the <code class="literal">main()</code> method to fire all rules against a defined fact model:
					</p><div class="formalpara"><p class="title"><strong>Executing rules locally</strong></p><p>
							
<pre class="programlisting language-java">import org.kie.api.KieServices;
import org.kie.api.builder.ReleaseId;
import org.kie.api.runtime.KieContainer;
import org.kie.api.runtime.KieSession;
import org.drools.compiler.kproject.ReleaseIdImpl;

public class RulesTest {

  public static final void main(String[] args) {
    try {
      // Identify the project in the local repository:
      ReleaseId rid = new ReleaseIdImpl("com.myspace", "MyProject", "1.0.0");

      // Load the KIE base:
      KieServices ks = KieServices.Factory.get();
      KieContainer kContainer = ks.newKieContainer(rid);
      KieSession kSession = kContainer.newKieSession();

      // Set up the fact model:
      Person p = new Person();
      p.setWage(12);
      p.setFirstName("Tom");
      p.setLastName("Summers");
      p.setHourlyRate(10);

      // Insert the person into the session:
      kSession.insert(p);

      // Fire all rules:
      kSession.fireAllRules();
      kSession.dispose();
    }

    catch (Throwable t) {
      t.printStackTrace();
    }
  }
}</pre>
						</p></div><p class="simpara">
						To test this rule on KIE Server, configure the <code class="literal">.java</code> class with the imports and rule execution information similarly to the local example, and additionally specify KIE services configuration and KIE services client details:
					</p><div class="formalpara"><p class="title"><strong>Executing rules on KIE Server</strong></p><p>
							
<pre class="programlisting language-java">package com.sample;

import java.util.ArrayList;
import java.util.HashSet;
import java.util.List;
import java.util.Set;

import org.kie.api.command.BatchExecutionCommand;
import org.kie.api.command.Command;
import org.kie.api.KieServices;
import org.kie.api.runtime.ExecutionResults;
import org.kie.api.runtime.KieContainer;
import org.kie.api.runtime.KieSession;
import org.kie.server.api.marshalling.MarshallingFormat;
import org.kie.server.api.model.ServiceResponse;
import org.kie.server.client.KieServicesClient;
import org.kie.server.client.KieServicesConfiguration;
import org.kie.server.client.KieServicesFactory;
import org.kie.server.client.RuleServicesClient;

import com.sample.Person;

public class RulesTest {

  private static final String containerName = "testProject";
  private static final String sessionName = "myStatelessSession";

  public static final void main(String[] args) {
    try {
      // Define KIE services configuration and client:
      Set&lt;Class&lt;?&gt;&gt; allClasses = new HashSet&lt;Class&lt;?&gt;&gt;();
      allClasses.add(Person.class);
      String serverUrl = "http://$HOST:$PORT/kie-server/services/rest/server";
      String username = "$USERNAME";
      String password = "$PASSWORD";
      KieServicesConfiguration config =
        KieServicesFactory.newRestConfiguration(serverUrl,
                                                username,
                                                password);
      config.setMarshallingFormat(MarshallingFormat.JAXB);
      config.addExtraClasses(allClasses);
      KieServicesClient kieServicesClient =
        KieServicesFactory.newKieServicesClient(config);

      // Set up the fact model:
      Person p = new Person();
      p.setWage(12);
      p.setFirstName("Tom");
      p.setLastName("Summers");
      p.setHourlyRate(10);

      // Insert Person into the session:
      KieCommands kieCommands = KieServices.Factory.get().getCommands();
      List&lt;Command&gt; commandList = new ArrayList&lt;Command&gt;();
      commandList.add(kieCommands.newInsert(p, "personReturnId"));

      // Fire all rules:
      commandList.add(kieCommands.newFireAllRules("numberOfFiredRules"));
      BatchExecutionCommand batch = kieCommands.newBatchExecution(commandList, sessionName);

      // Use rule services client to send request:
      RuleServicesClient ruleClient = kieServicesClient.getServicesClient(RuleServicesClient.class);
      ServiceResponse&lt;ExecutionResults&gt; executeResponse = ruleClient.executeCommandsWithResults(containerName, batch);
      System.out.println("number of fired rules:" + executeResponse.getResult().getValue("numberOfFiredRules"));
    }

    catch (Throwable t) {
      t.printStackTrace();
    }
  }
}</pre>
						</p></div></li><li class="listitem"><p class="simpara">
						Run the configured <code class="literal">.java</code> class from your project directory. You can run the file in your development platform (such as Red Hat CodeReady Studio) or in the command line.
					</p><p class="simpara">
						Example Maven execution (within project directory):
					</p><pre class="screen">mvn clean install exec:java -Dexec.mainClass="com.sample.app.RulesTest"</pre><p class="simpara">
						Example Java execution (within project directory)
					</p><pre class="screen">javac -classpath "./$DEPENDENCIES/*:." RulesTest.java
java -classpath "./$DEPENDENCIES/*:." RulesTest</pre></li><li class="listitem">
						Review the rule execution status in the command line and in the server log. If any rules do not execute as expected, review the configured rules in the project and the main class configuration to validate the data provided.
					</li></ol></div></section><section class="chapter" id="next_steps_4"><div class="titlepage"><div><div><h2 class="title">Chapter 52. Next steps</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-test-scenarios"><span class="emphasis"><em>Testing a decision service using test scenarios</em></span></a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>
					</li></ul></div></section></div><div class="part" id="assembly-guided-rule-templates"><div class="titlepage"><div><div><h1 class="title">Part VII. Designing a decision service using guided rule templates</h1></div></div></div><div class="partintro" id="idm139921814809792"><div/><p>
				As a business analyst or business rules developer, you can define business rule templates using the guided rule templates designer in Business Central. These guided rule templates provide a reusable rule structure for multiple rules that are compiled into Drools Rule Language (DRL) and form the core of the decision service for your project.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					You can also design your decision service using Decision Model and Notation (DMN) models instead of rule-based or table-based assets. For information about DMN support in Red Hat Process Automation Manager 7.10, see the following resources:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/getting_started_with_red_hat_process_automation_manager#assembly-getting-started-decision-services"><span class="emphasis"><em>Getting started with decision services</em></span></a> (step-by-step tutorial with a DMN decision service example)
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-dmn-models"><span class="emphasis"><em>Designing a decision service using DMN models</em></span></a> (overview of DMN support and capabilities in Red Hat Process Automation Manager)
						</li></ul></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The space and project for the guided rule templates have been created in Business Central. Each asset is associated with a project assigned to a space. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/getting_started_with_red_hat_process_automation_manager#assembly-getting-started-decision-services"><span class="emphasis"><em>Getting started with decision services</em></span></a>.
					</li></ul></div><div class="toc"><p><strong>Table of Contents</strong></p><ul class="toc"><li><span class="chapter"><a href="#decision-authoring-assets-ref_guided-rule-templates">53. Decision-authoring assets in Red Hat Process Automation Manager</a></span></li><li><span class="chapter"><a href="#guided-rule-templates-con">54. Guided rule templates</a></span></li><li><span class="chapter"><a href="#data-objects-con_guided-rule-templates">55. Data objects</a></span><ul><li><span class="section"><a href="#data-objects-create-proc_guided-rule-templates">55.1. Creating data objects</a></span></li></ul></li><li><span class="chapter"><a href="#guided-rule-templates-create-proc">56. Creating guided rule templates</a></span><ul><li><span class="section"><a href="#guided-rule-templates-WHEN-proc">56.1. Adding WHEN conditions in guided rule templates</a></span></li><li><span class="section"><a href="#guided-rule-templates-THEN-proc">56.2. Adding THEN actions in guided rule templates</a></span></li><li><span class="section"><a href="#enumerations-define-proc_guided-rule-templates">56.3. Defining enumerations for drop-down lists in rule assets</a></span><ul><li><span class="section"><a href="#enumerations-advanced-ref_guided-rule-templates">56.3.1. Advanced enumeration options for rule assets</a></span></li></ul></li><li><span class="section"><a href="#guided-rules-options-proc_guided-rule-templates">56.4. Adding other rule options</a></span><ul><li><span class="section"><a href="#rules-attributes-ref_guided-rule-templates">56.4.1. Rule attributes</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#guided-rule-templates-tables-proc">57. Defining data tables for guided rule templates</a></span></li><li><span class="chapter"><a href="#assets-executing-proc_guided-rule-templates">58. Executing rules</a></span></li><li><span class="chapter"><a href="#next_steps_5">59. Next steps</a></span></li></ul></div></div><section class="chapter" id="decision-authoring-assets-ref_guided-rule-templates"><div class="titlepage"><div><div><h2 class="title">Chapter 53. Decision-authoring assets in Red Hat Process Automation Manager</h2></div></div></div><p>
				Red Hat Process Automation Manager supports several assets that you can use to define business decisions for your decision service. Each decision-authoring asset has different advantages, and you might prefer to use one or a combination of multiple assets depending on your goals and needs.
			</p><p>
				The following table highlights the main decision-authoring assets supported in Red Hat Process Automation Manager projects to help you decide or confirm the best method for defining decisions in your decision service.
			</p><div class="table" id="idm139921814796352"><p class="title"><strong>Table 53.1. Decision-authoring assets supported in Red Hat Process Automation Manager</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"/><col style="width: 40%; " class="col_2"/><col style="width: 20%; " class="col_3"/><col style="width: 20%; " class="col_4"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921814789600" scope="col">Asset</th><th align="left" valign="top" id="idm139921814788512" scope="col">Highlights</th><th align="left" valign="top" id="idm139921814787424" scope="col">Authoring tools</th><th align="left" valign="top" id="idm139921814786336" scope="col">Documentation</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921814789600">
							<p>
								Decision Model and Notation (DMN) models
							</p>
							</td><td align="left" valign="top" headers="idm139921814788512">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are decision models based on a notation standard defined by the Object Management Group (OMG)
									</li><li class="listitem">
										Use graphical decision requirements diagrams (DRDs) that represent part or all of the overall decision requirements graph (DRG) to trace business decision flows
									</li><li class="listitem">
										Use an XML schema that allows the DMN models to be shared between DMN-compliant platforms
									</li><li class="listitem">
										Support Friendly Enough Expression Language (FEEL) to define decision logic in DMN decision tables and other DMN boxed expressions
									</li><li class="listitem">
										Can be integrated efficiently with Business Process Model and Notation (BPMN) process models
									</li><li class="listitem">
										Are optimal for creating comprehensive, illustrative, and stable decision flows
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921814787424">
							<p>
								Business Central or other DMN-compliant editor
							</p>
							</td><td align="left" valign="top" headers="idm139921814786336">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-dmn-models"><span class="emphasis"><em>Designing a decision service using DMN models</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921814789600">
							<p>
								Guided decision tables
							</p>
							</td><td align="left" valign="top" headers="idm139921814788512">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are tables of rules that you create in a UI-based table designer in Business Central
									</li><li class="listitem">
										Are a wizard-led alternative to spreadsheet decision tables
									</li><li class="listitem">
										Provide fields and options for acceptable input
									</li><li class="listitem">
										Support template keys and values for creating rule templates
									</li><li class="listitem">
										Support hit policies, real-time validation, and other additional features not supported in other assets
									</li><li class="listitem">
										Are optimal for creating rules in a controlled tabular format to minimize compilation errors
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921814787424">
							<p>
								Business Central
							</p>
							</td><td align="left" valign="top" headers="idm139921814786336">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-guided-decision-tables"><span class="emphasis"><em>Designing a decision service using guided decision tables</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921814789600">
							<p>
								Spreadsheet decision tables
							</p>
							</td><td align="left" valign="top" headers="idm139921814788512">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are XLS or XLSX spreadsheet decision tables that you can upload into Business Central
									</li><li class="listitem">
										Support template keys and values for creating rule templates
									</li><li class="listitem">
										Are optimal for creating rules in decision tables already managed outside of Business Central
									</li><li class="listitem">
										Have strict syntax requirements for rules to be compiled properly when uploaded
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921814787424">
							<p>
								Spreadsheet editor
							</p>
							</td><td align="left" valign="top" headers="idm139921814786336">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-decision-tables"><span class="emphasis"><em>Designing a decision service using spreadsheet decision tables</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921814789600">
							<p>
								Guided rules
							</p>
							</td><td align="left" valign="top" headers="idm139921814788512">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are individual rules that you create in a UI-based rule designer in Business Central
									</li><li class="listitem">
										Provide fields and options for acceptable input
									</li><li class="listitem">
										Are optimal for creating single rules in a controlled format to minimize compilation errors
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921814787424">
							<p>
								Business Central
							</p>
							</td><td align="left" valign="top" headers="idm139921814786336">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-guided-rules"><span class="emphasis"><em>Designing a decision service using guided rules</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921814789600">
							<p>
								Guided rule templates
							</p>
							</td><td align="left" valign="top" headers="idm139921814788512">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are reusable rule structures that you create in a UI-based template designer in Business Central
									</li><li class="listitem">
										Provide fields and options for acceptable input
									</li><li class="listitem">
										Support template keys and values for creating rule templates (fundamental to the purpose of this asset)
									</li><li class="listitem">
										Are optimal for creating many rules with the same rule structure but with different defined field values
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921814787424">
							<p>
								Business Central
							</p>
							</td><td align="left" valign="top" headers="idm139921814786336">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-guided-rule-templates"><span class="emphasis"><em>Designing a decision service using guided rule templates</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921814789600">
							<p>
								DRL rules
							</p>
							</td><td align="left" valign="top" headers="idm139921814788512">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are individual rules that you define directly in <code class="literal">.drl</code> text files
									</li><li class="listitem">
										Provide the most flexibility for defining rules and other technicalities of rule behavior
									</li><li class="listitem">
										Can be created in certain standalone environments and integrated with Red Hat Process Automation Manager
									</li><li class="listitem">
										Are optimal for creating rules that require advanced DRL options
									</li><li class="listitem">
										Have strict syntax requirements for rules to be compiled properly
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921814787424">
							<p>
								Business Central or integrated development environment (IDE)
							</p>
							</td><td align="left" valign="top" headers="idm139921814786336">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-drl-rules"><span class="emphasis"><em>Designing a decision service using DRL rules</em></span></a>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921814789600">
							<p>
								Predictive Model Markup Language (PMML) models
							</p>
							</td><td align="left" valign="top" headers="idm139921814788512">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Are predictive data-analytic models based on a notation standard defined by the Data Mining Group (DMG)
									</li><li class="listitem">
										Use an XML schema that allows the PMML models to be shared between PMML-compliant platforms
									</li><li class="listitem">
										Support Regression, Scorecard, Tree, Mining, and other model types
									</li><li class="listitem">
										Can be included with a standalone Red Hat Process Automation Manager project or imported into a project in Business Central
									</li><li class="listitem">
										Are optimal for incorporating predictive data into decision services in Red Hat Process Automation Manager
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921814787424">
							<p>
								PMML or XML editor
							</p>
							</td><td align="left" valign="top" headers="idm139921814786336">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-pmml-models"><span class="emphasis"><em>Designing a decision service using PMML models</em></span></a>
							</p>
							</td></tr></tbody></table></div></div></section><section class="chapter" id="guided-rule-templates-con"><div class="titlepage"><div><div><h2 class="title">Chapter 54. Guided rule templates</h2></div></div></div><p>
				Guided rule templates are business rule structures with placeholder values (template keys) that are interchanged with actual values defined in separate data tables. Each row of values defined in the corresponding data table for that template results in a rule. Guided rule templates are ideal when many rules have the same conditions, actions, and other attributes but differ in values of facts or constraints. In such cases, instead of creating many similar guided rules and defining values in each rule, you can create a guided rule template with the rule structure that applies to each rule and then define only the differing values in the data table.
			</p><p>
				The guided rule templates designer provides fields and options for acceptable template input based on the data objects for the rule template being defined, and a corresponding data table where you add template key values. After you create your guided rule template and add values in the corresponding data table, the rules you defined are compiled into Drools Rule Language (DRL) rules as with all other rule assets.
			</p><p>
				All data objects related to a guided rule template must be in the same project package as the guided rule template. Assets in the same package are imported by default. After you create the necessary data objects and the guided rule template, you can use the <span class="strong strong"><strong>Data Objects</strong></span> tab of the guided rule templates designer to verify that all required data objects are listed or to import other existing data objects by adding a <span class="strong strong"><strong>New item</strong></span>.
			</p></section><section class="chapter" id="data-objects-con_guided-rule-templates"><div class="titlepage"><div><div><h2 class="title">Chapter 55. Data objects</h2></div></div></div><p>
				Data objects are the building blocks for the rule assets that you create. Data objects are custom data types implemented as Java objects in specified packages of your project. For example, you might create a <code class="literal">Person</code> object with data fields <code class="literal">Name</code>, <code class="literal">Address</code>, and <code class="literal">DateOfBirth</code> to specify personal details for loan application rules. These custom data types determine what data your assets and your decision services are based on.
			</p><section class="section" id="data-objects-create-proc_guided-rule-templates"><div class="titlepage"><div><div><h2 class="title">55.1. Creating data objects</h2></div></div></div><p>
					The following procedure is a generic overview of creating data objects. It is not specific to a particular business asset.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Data Object</strong></span>.
						</li><li class="listitem"><p class="simpara">
							Enter a unique <span class="strong strong"><strong>Data Object</strong></span> name and select the <span class="strong strong"><strong>Package</strong></span> where you want the data object to be available for other rule assets. Data objects with the same name cannot exist in the same package. In the specified DRL file, you can import a data object from any package.
						</p><div class="admonition important"><div class="admonition_header">Importing data objects from other packages</div><div><p>
								You can import an existing data object from another package directly into the asset designers like guided rules or guided decision table designers. Select the relevant rule asset within the project and in the asset designer, go to <span class="strong strong"><strong>Data Objects → New item</strong></span> to select the object to be imported.
							</p></div></div></li><li class="listitem">
							To make your data object persistable, select the <span class="strong strong"><strong>Persistable</strong></span> checkbox. Persistable data objects are able to be stored in a database according to the JPA specification. The default JPA is Hibernate.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Ok</strong></span>.
						</li><li class="listitem"><p class="simpara">
							In the data object designer, click <span class="strong strong"><strong>add field</strong></span> to add a field to the object with the attributes <span class="strong strong"><strong>Id</strong></span>, <span class="strong strong"><strong>Label</strong></span>, and <span class="strong strong"><strong>Type</strong></span>. Required attributes are marked with an asterisk (*).
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="strong strong"><strong>Id:</strong></span> Enter the unique ID of the field.
								</li><li class="listitem">
									<span class="strong strong"><strong>Label:</strong></span> (Optional) Enter a label for the field.
								</li><li class="listitem">
									<span class="strong strong"><strong>Type:</strong></span> Enter the data type of the field.
								</li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>List:</strong></span> (Optional) Select this check box to enable the field to hold multiple items for the specified type.
								</p><div class="figure" id="idm139921812364400"><p class="title"><strong>Figure 55.1. Add data fields to a data object</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/project-data/DataModelerNewField2-new.png" alt="Add data fields to a data object"/></div></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Create</strong></span> to add the new field, or click <span class="strong strong"><strong>Create and continue</strong></span> to add the new field and continue adding other fields.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								To edit a field, select the field row and use the <span class="strong strong"><strong>general properties</strong></span> on the right side of the screen.
							</p></div></div></li></ol></div></section></section><section class="chapter" id="guided-rule-templates-create-proc"><div class="titlepage"><div><div><h2 class="title">Chapter 56. Creating guided rule templates</h2></div></div></div><p>
				You can use guided rule templates to define rule structures with placeholder values (template keys) that correspond to actual values defined in a data table. Guided rule templates are an efficient alternative to defining sets of many guided rules individually that use the same structure.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Guided Rule Template</strong></span>.
					</li><li class="listitem">
						Enter an informative <span class="strong strong"><strong>Guided Rule Template</strong></span> name and select the appropriate <span class="strong strong"><strong>Package</strong></span>. The package that you specify must be the same package where the required data objects have been assigned or will be assigned.
					</li><li class="listitem"><p class="simpara">
						Click <span class="strong strong"><strong>Ok</strong></span> to create the rule template.
					</p><p class="simpara">
						The new guided rule template is now listed in the <span class="strong strong"><strong>Guided Rule Templates</strong></span> panel of the <span class="strong strong"><strong>Project Explorer</strong></span>.
					</p></li><li class="listitem">
						Click the <span class="strong strong"><strong>Data Objects</strong></span> tab and confirm that all data objects required for your rules are listed. If not, click <span class="strong strong"><strong>New item</strong></span> to import data objects from other packages, or <a class="link" href="#data-objects-create-proc_guided-rule-templates" title="55.1. Creating data objects">create data objects</a> within your package.
					</li><li class="listitem"><p class="simpara">
						After all data objects are in place, return to the <span class="strong strong"><strong>Model</strong></span> tab and use the buttons on the right side of the window to add and define the <span class="strong strong"><strong>WHEN</strong></span> (condition) and <span class="strong strong"><strong>THEN</strong></span> (action) sections of the rule template, based on the available data objects. For the field values that vary per rule, use template keys in the format <code class="literal">$key</code> in the rule designer or in the format <code class="literal">@{key}</code> in free form DRL (if used).
					</p><div class="figure" id="idm139921813309968"><p class="title"><strong>Figure 56.1. Sample guided rule template</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/guided-rule-template.png" alt="Sample guided rule template"/></div></div></div><div class="admonition note"><div class="admonition_header">Note on template keys</div><div><p>
							Template keys are fundamental in guided rule templates. Template keys are what enable field values in the templates to be interchanged with actual values that you define in the corresponding data table to generate different rules from the same template. You can use other value types, such as <span class="strong strong"><strong>Literal</strong></span> or <span class="strong strong"><strong>Formula</strong></span>, for values that are part of the rule structure of all rules based on that template. However, for any values that differ among the rules, use the <span class="strong strong"><strong>Template key</strong></span> field type with a specified key. Without template keys in a guided rule template, the corresponding data table is not generated in the template designer and the template essentially functions as an individual guided rule.
						</p></div></div><p class="simpara">
						The <span class="strong strong"><strong>WHEN</strong></span> part of the rule template is the condition that must be met to execute an action. For example, if a telecommunications company charges customers based on the services they subscribe to (Internet, phone, and TV), then one of the <span class="strong strong"><strong>WHEN</strong></span> conditions would be <code class="literal">internetService | equal to | $hasInternetService</code>. The template key <code class="literal">$hasInternetService</code> is interchanged with an actual Boolean value (<code class="literal">true</code> or <code class="literal">false</code>) defined in the data table for the template.
					</p><p class="simpara">
						The <span class="strong strong"><strong>THEN</strong></span> part of the rule template is the action to be performed when the conditional part of the rule has been met. For example, if a customer subscribes to only Internet service, a <span class="strong strong"><strong>THEN</strong></span> action for <code class="literal">RecurringPayment</code> with a template key <code class="literal">$amount</code> would set the actual monthly amount to the integer value defined for Internet service charges in the data table.
					</p></li><li class="listitem">
						After you define all components of the rule, click <span class="strong strong"><strong>Save</strong></span> in the guided rule templates designer to save your work.
					</li></ol></div><section class="section" id="guided-rule-templates-WHEN-proc"><div class="titlepage"><div><div><h2 class="title">56.1. Adding WHEN conditions in guided rule templates</h2></div></div></div><p>
					The <span class="strong strong"><strong>WHEN</strong></span> part of the rule contains the conditions that must be met to execute an action. For example, if a telecommunications company charges customers based on the services they subscribe to (Internet, phone, and TV), then one of the <span class="strong strong"><strong>WHEN</strong></span> conditions would be <code class="literal">internetService | equal to | $hasInternetService</code>. The template key <code class="literal">$hasInternetService</code> is interchanged with an actual Boolean value (<code class="literal">true</code> or <code class="literal">false</code>) defined in the data table for the template.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							All data objects required for your rules have been created or imported and are listed in the <span class="strong strong"><strong>Data Objects</strong></span> tab of the guided rule templates designer.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							In the guided rule templates designer, click the plus icon (
							<span class="inlinemediaobject"><img src="images/_images/Workbench/AuthoringAssets/5686.png" alt="5686"/></span>
							) on the right side of the <code class="literal">WHEN</code> section.
						</p><p class="simpara">
							The <span class="strong strong"><strong>Add a condition to the rule</strong></span> window with the available condition elements opens.
						</p><div class="figure" id="idm139921813276832"><p class="title"><strong>Figure 56.2. Add a condition to the rule</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/guided-rule-templates-add-condition.png" alt="Add a condition to the rule"/></div></div></div><p class="simpara">
							The list includes the data objects from the <span class="strong strong"><strong>Data Objects</strong></span> tab of the guided rule templates designer, any DSL objects defined for the package, and the following standard options:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="strong strong"><strong>The following does not exist:</strong></span> Use this to specify facts and constraints that must not exist.
								</li><li class="listitem">
									<span class="strong strong"><strong>The following exists:</strong></span> Use this to specify facts and constraints that must exist. This option is triggered on only the first match, not subsequent matches.
								</li><li class="listitem">
									<span class="strong strong"><strong>Any of the following are true:</strong></span> Use this to list any facts or constraints that must be true.
								</li><li class="listitem">
									<span class="strong strong"><strong>From:</strong></span> Use this to define a <code class="literal">From</code> conditional element for the rule.
								</li><li class="listitem">
									<span class="strong strong"><strong>From Accumulate:</strong></span> Use this to define an <code class="literal">Accumulate</code> conditional element for the rule.
								</li><li class="listitem">
									<span class="strong strong"><strong>From Collect:</strong></span> Use this to define a <code class="literal">Collect</code> conditional element for the rule.
								</li><li class="listitem">
									<span class="strong strong"><strong>From Entry Point:</strong></span> Use this to define an <code class="literal">Entry Point</code> for the pattern.
								</li><li class="listitem">
									<span class="strong strong"><strong>Free form DRL:</strong></span> Use this to insert a free-form DRL field where you can define condition elements freely, without the guided rules designer. For template keys in free form DRL, use the format <code class="literal">@{key}</code>.
								</li></ul></div></li><li class="listitem">
							Choose a condition element (for example, <span class="strong strong"><strong>Customer</strong></span>) and click <span class="strong strong"><strong>Ok</strong></span>.
						</li><li class="listitem"><p class="simpara">
							Click the condition element in the guided rule templates designer and use the <span class="strong strong"><strong>Modify constraints for Customer</strong></span> window to add a restriction on a field, apply multiple field constraints, add a new formula style expression, apply an expression editor, or set a variable name.
						</p><div class="figure" id="idm139921813249600"><p class="title"><strong>Figure 56.3. Modify a condition</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/guided-rule-templates-modify-condition.png" alt="Modifying a condition"/></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								A variable name enables you to identify a fact or field in other constructs within the guided rule. For example, you could set the variable of <code class="literal">Customer</code> to <code class="literal">c</code> and then reference <code class="literal">c</code> in a separate <code class="literal">Applicant</code> constraint that specifies that the <code class="literal">Customer</code> is the <code class="literal">Applicant</code>.
							</p><pre class="programlisting language-java">c : Customer()
Applicant( this == c )</pre></div></div><p class="simpara">
							After you select a constraint, the window closes automatically.
						</p></li><li class="listitem">
							Choose an operator for the restriction (for example, <code class="literal">equal to</code>) from the drop-down menu next to the added restriction.
						</li><li class="listitem">
							Click the edit icon (
							<span class="inlinemediaobject"><img src="images/_images/Workbench/AuthoringAssets/6191.png" alt="6191"/></span>
							) to define the field value.
						</li><li class="listitem">
							Select <span class="strong strong"><strong>Template key</strong></span> and add a template key in the format <code class="literal">$key</code> if this value varies among the rules that are based on this template. This allows the field value to be interchanged with actual values that you define in the corresponding data table to generate different rules from the same template. For field values that do not vary among the rules and are part of the rule template, you can use any other value type.
						</li><li class="listitem"><p class="simpara">
							To apply multiple field constraints, click the condition and in the <span class="strong strong"><strong>Modify constraints for Customer</strong></span> window, select <span class="strong strong"><strong>All of(And)</strong></span> or <span class="strong strong"><strong>Any of(Or)</strong></span> from the <span class="strong strong"><strong>Multiple field constraint</strong></span> drop-down menu.
						</p><div class="figure" id="idm139921813227872"><p class="title"><strong>Figure 56.4. Add multiple field constraints</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/guided-rule-templates-multiple-constraints.png" alt="Add multiple field constraints"/></div></div></div></li><li class="listitem">
							Click the constraint in the guided rule templates designer and further define the field values.
						</li><li class="listitem">
							After you define all condition elements, click <span class="strong strong"><strong>Save</strong></span> in the guided rule templates designer to save your work.
						</li></ol></div></section><section class="section" id="guided-rule-templates-THEN-proc"><div class="titlepage"><div><div><h2 class="title">56.2. Adding THEN actions in guided rule templates</h2></div></div></div><p>
					The <span class="strong strong"><strong>THEN</strong></span> part of the rule template is the action to be performed when the conditional part of the rule has been met. For example, if a customer subscribes to only Internet service, a <span class="strong strong"><strong>THEN</strong></span> action for <code class="literal">RecurringPayment</code> with a template key <code class="literal">$amount</code> would set the actual monthly amount to the integer value defined for Internet service charges in the data table.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							All data objects required for your rules have been created or imported and are listed in the <span class="strong strong"><strong>Data Objects</strong></span> tab of the guided rule templates designer.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							In the guided rule templates designer, click the plus icon (
							<span class="inlinemediaobject"><img src="images/_images/Workbench/AuthoringAssets/5686.png" alt="5686"/></span>
							) on the right side of the <code class="literal">THEN</code> section.
						</p><p class="simpara">
							The <span class="strong strong"><strong>Add a new action</strong></span> window with the available action elements opens.
						</p><div class="figure" id="idm139921813206496"><p class="title"><strong>Figure 56.5. Add a new action to the rule</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/guided-rule-templates-add-action.png" alt="Add a new action to the rule"/></div></div></div><p class="simpara">
							The list includes insertion and modification options based on the data objects in the <span class="strong strong"><strong>Data Objects</strong></span> tab of the guided rule templates designer, and on any DSL objects defined for the package:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="strong strong"><strong>Insert fact:</strong></span> Use this to insert a fact and define resulting fields and values for the fact.
								</li><li class="listitem">
									<span class="strong strong"><strong>Logically Insert fact:</strong></span> Use this to insert a fact logically into the decision engine and define resulting fields and values for the fact. The decision engine is responsible for logical decisions on insertions and retractions of facts. After regular or stated insertions, facts have to be retracted explicitly. After logical insertions, facts are automatically retracted when the conditions that originally asserted the facts are no longer true.
								</li><li class="listitem">
									<span class="strong strong"><strong>Add free form DRL:</strong></span> Use this to insert a free-form DRL field where you can define condition elements freely, without the guided rules designer. For template keys in free form DRL, use the format <code class="literal">@{key}</code>.
								</li></ul></div></li><li class="listitem">
							Choose an action element (for example, <span class="strong strong"><strong>Logically Insert fact RecurringPayment</strong></span>) and click <span class="strong strong"><strong>Ok</strong></span>.
						</li><li class="listitem"><p class="simpara">
							Click the action element in the guided rule templates designer and use the <span class="strong strong"><strong>Add a field</strong></span> window to select a field.
						</p><div class="figure" id="idm139921814142896"><p class="title"><strong>Figure 56.6. Add a field</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/guided-rule-templates-add-field.png" alt="Add a field"/></div></div></div><p class="simpara">
							After you select a field, the window closes automatically.
						</p></li><li class="listitem">
							Click the edit icon (
							<span class="inlinemediaobject"><img src="images/_images/Workbench/AuthoringAssets/6191.png" alt="6191"/></span>
							) to define the field value.
						</li><li class="listitem">
							Select <span class="strong strong"><strong>Template key</strong></span> and add a template key in the format <code class="literal">$key</code> if this value varies among the rules that are based on this template. This allows the field value to be interchanged with actual values that you define in the corresponding data table to generate different rules from the same template. For field values that do not vary among the rules and are part of the rule template, you can use any other value type.
						</li><li class="listitem">
							After you define all action elements, click <span class="strong strong"><strong>Save</strong></span> in the guided rule templates designer to save your work.
						</li></ol></div></section><section class="section" id="enumerations-define-proc_guided-rule-templates"><div class="titlepage"><div><div><h2 class="title">56.3. Defining enumerations for drop-down lists in rule assets</h2></div></div></div><p>
					Enumeration definitions in Business Central determine the possible values of fields for conditions or actions in guided rules, guided rule templates, and guided decision tables. An enumeration definition contains a <code class="literal">fact.field</code> mapping to a list of supported values that are displayed as a drop-down list in the relevant field of a rule asset. When a user selects a field that is based on the same fact and field as the enumeration definition, the drop-down list of defined values is displayed.
				</p><p>
					You can define enumerations in Business Central or in the DRL source for your Red Hat Process Automation Manager project.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Enumeration</strong></span>.
						</li><li class="listitem">
							Enter an informative <span class="strong strong"><strong>Enumeration</strong></span> name and select the appropriate <span class="strong strong"><strong>Package</strong></span>. The package that you specify must be the same package where the required data objects and relevant rule assets have been assigned or will be assigned.
						</li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Ok</strong></span> to create the enumeration.
						</p><p class="simpara">
							The new enumeration is now listed in the <span class="strong strong"><strong>Enumeration Definitions</strong></span> panel of the <span class="strong strong"><strong>Project Explorer</strong></span>.
						</p></li><li class="listitem"><p class="simpara">
							In the <span class="strong strong"><strong>Model</strong></span> tab of the enumerations designer, click <span class="strong strong"><strong>Add enum</strong></span> and define the following values for the enumeration:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="strong strong"><strong>Fact</strong></span>: Specify an existing data object within the same package of your project with which you want to associate this enumeration. Open the <span class="strong strong"><strong>Data Objects</strong></span> panel in the <span class="strong strong"><strong>Project Explorer</strong></span> to view the available data objects, or create the relevant data object as a new asset if needed.
								</li><li class="listitem">
									<span class="strong strong"><strong>Field</strong></span>: Specify an existing field identifier that you defined as part of the data object that you selected for the <span class="strong strong"><strong>Fact</strong></span>. Open the <span class="strong strong"><strong>Data Objects</strong></span> panel in the <span class="strong strong"><strong>Project Explorer</strong></span> to select the relevant data object and view the list of available <span class="strong strong"><strong>Identifier</strong></span> options. You can create the relevant identifier for the data object if needed.
								</li><li class="listitem">
									<span class="strong strong"><strong>Context</strong></span>: Specify a list of values in the format <code class="literal">['string1','string2','string3']</code> or <code class="literal">[integer1,integer2,integer3]</code> that you want to map to the <span class="strong strong"><strong>Fact</strong></span> and <span class="strong strong"><strong>Field</strong></span> definitions. These values will be displayed as a drop-down list for the relevant field of the rule asset.
								</li></ul></div><p class="simpara">
							For example, the following enumeration defines the drop-down values for applicant credit rating in a loan application decision service:
						</p><div class="figure" id="idm139921814096112"><p class="title"><strong>Figure 56.7. Example enumeration for applicant credit rating in Business Central</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Workbench/AuthoringAssets/EnumConfig.png" alt="EnumConfig"/></div></div></div><div class="formalpara"><p class="title"><strong>Example enumeration for applicant credit rating in the DRL source</strong></p><p>
								
<pre class="screen">'Applicant.creditRating' : ['AA', 'OK', 'Sub prime']</pre>
							</p></div><p class="simpara">
							In this example, for any guided rule, guided rule template, or guided decision table that is in the same package of the project and that uses the <code class="literal">Applicant</code> data object and the <code class="literal">creditRating</code> field, the configured values are available as drop-down options:
						</p><div class="figure" id="idm139921814088272"><p class="title"><strong>Figure 56.8. Example enumeration drop-down options in a guided rule or guided rule template</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Workbench/AuthoringAssets/EnumDropDown.png" alt="EnumDropDown"/></div></div></div><div class="figure" id="idm139921814084048"><p class="title"><strong>Figure 56.9. Example enumeration drop-down options in a guided decision table</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Workbench/AuthoringAssets/EnumDropDownGDT.png" alt="EnumDropDownGDT"/></div></div></div></li></ol></div><section class="section" id="enumerations-advanced-ref_guided-rule-templates"><div class="titlepage"><div><div><h3 class="title">56.3.1. Advanced enumeration options for rule assets</h3></div></div></div><p>
						For advanced use cases with enumeration definitions in your Red Hat Process Automation Manager project, consider the following extended options for defining enumerations:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Mapping between DRL values and values in Business Central</span></dt><dd><p class="simpara">
									If you want the enumeration values to appear differently or more completely in the Business Central interface than they appear in the DRL source, use a mapping in the format <code class="literal">'fact.field' : ['sourceValue1=UIValue1','sourceValue2=UIValue2', …​ ]</code> for your enumeration definition values.
								</p><p class="simpara">
									For example, in the following enumeration definition for loan status, the options <code class="literal">A</code> or <code class="literal">D</code> are used in the DRL file but the options <code class="literal">Approved</code> or <code class="literal">Declined</code> are displayed in Business Central:
								</p><pre class="screen">'Loan.status' : ['A=Approved','D=Declined']</pre></dd><dt><span class="term">Enumeration value dependencies</span></dt><dd><p class="simpara">
									If you want the selected value in one drop-down list to determine the available options in a subsequent drop-down list, use the format <code class="literal">'fact.fieldB[fieldA=value1]' : ['value2', 'value3', …​ ]</code> for your enumeration definition.
								</p><p class="simpara">
									For example, in the following enumeration definition for insurance policies, the <code class="literal">policyType</code> field accepts the values <code class="literal">Home</code> or <code class="literal">Car</code>. The type of policy that the user selects determines the policy <code class="literal">coverage</code> field options that are then available:
								</p><pre class="screen">'Insurance.policyType' : ['Home', 'Car']
'Insurance.coverage[policyType=Home]' : ['property', 'liability']
'Insurance.coverage[policyType=Car]' : ['collision', 'fullCoverage']</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										Enumeration dependencies are not applied across rule conditions and actions. For example, in this insurance policy use case, the selected policy in the rule condition does not determine the available coverage options in the rule actions, if applicable.
									</p></div></div></dd><dt><span class="term">External data sources in enumerations</span></dt><dd><p class="simpara">
									If you want to retrieve a list of enumeration values from an external data source instead of defining the values directly in the enumeration definition, on the class path of your project, add a helper class that returns a <code class="literal">java.util.List</code> list of strings. In the enumeration definition, instead of specifying a list of values, identify the helper class that you configured to retrieve the values externally.
								</p><p class="simpara">
									For example, in the following enumeration definition for loan applicant region, instead of defining applicant regions explicitly in the format <code class="literal">'Applicant.region' : ['country1', 'country2', …​ ]</code>, the enumeration uses a helper class that returns the list of values defined externally:
								</p><pre class="screen">'Applicant.region' : (new com.mycompany.DataHelper()).getListOfRegions()</pre><p class="simpara">
									In this example, a <code class="literal">DataHelper</code> class contains a <code class="literal">getListOfRegions()</code> method that returns a list of strings. The enumerations are loaded in the drop-down list for the relevant field in the rule asset.
								</p><p class="simpara">
									You can also load dependent enumeration definitions dynamically from a helper class by identifying the dependent field as usual and enclosing the call to the helper class within quotation marks:
								</p><pre class="screen">'Applicant.region[countryCode]' : '(new com.mycompany.DataHelper()).getListOfRegions("@{countryCode}")'</pre><p class="simpara">
									If you want to load all enumeration data entirely from an external data source, such as a relational database, you can implement a Java class that returns a <code class="literal">Map&lt;String, List&lt;String&gt;&gt;</code> map. The key of the map is the <code class="literal">fact.field</code> mapping and the value is a <code class="literal">java.util.List&lt;String&gt;</code> list of values.
								</p><p class="simpara">
									For example, the following Java class defines loan applicant regions for the related enumeration:
								</p><pre class="programlisting language-java">public class SampleDataSource {

  public Map&lt;String, List&lt;String&gt;&gt; loadData() {
    Map data = new HashMap();

    List d = new ArrayList();
    d.add("AU");
    d.add("DE");
    d.add("ES");
    d.add("UK");
    d.add("US");
    ...
    data.put("Applicant.region", d);

    return data;
  }

}</pre><p class="simpara">
									The following enumeration definition correlates to this example Java class. The enumeration contains no references to fact or field names because they are defined in the Java class:
								</p><pre class="screen">=(new SampleDataSource()).loadData()</pre><p class="simpara">
									The <code class="literal">=</code> operator enables Business Central to load all enumeration data from the helper class. The helper methods are statically evaluated when the enumeration definition is requested for use in an editor.
								</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										Defining an enumeration without a fact and field definition is currently not supported in Business Central. To define the enumeration for the associated Java class in this way, use the DRL source in your Red Hat Process Automation Manager project.
									</p></div></div></dd></dl></div></section></section><section class="section" id="guided-rules-options-proc_guided-rule-templates"><div class="titlepage"><div><div><h2 class="title">56.4. Adding other rule options</h2></div></div></div><p>
					You can also use the rule designer to add metadata within a rule, define additional rule attributes (such as <code class="literal">salience</code> and <code class="literal">no-loop</code>), and freeze areas of the rule to restrict modifications to conditions or actions.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the rule designer, click <span class="strong strong"><strong>(show options…​)</strong></span> under the <span class="strong strong"><strong>THEN</strong></span> section.
						</li><li class="listitem">
							Click the plus icon (
							<span class="inlinemediaobject"><img src="images/_images/Workbench/AuthoringAssets/5686.png" alt="5686"/></span>
							) on the right side of the window to add options.
						</li><li class="listitem"><p class="simpara">
							Select an option to be added to the rule:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="strong strong"><strong>Metadata:</strong></span> Enter a metadata label and click the plus icon (
									<span class="inlinemediaobject"><img src="images/_images/Workbench/AuthoringAssets/5686.png" alt="5686"/></span>
									). Then enter any needed data in the field provided in the rule designer.
								</li><li class="listitem">
									<span class="strong strong"><strong>Attribute:</strong></span> Select from the list of rule attributes. Then further define the value in the field or option displayed in the rule designer.
								</li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>Freeze areas for editing:</strong></span> Select <span class="strong strong"><strong>Conditions</strong></span> or <span class="strong strong"><strong>Actions</strong></span> to restrict the area from being modified in the rule designer.
								</p><div class="figure" id="idm139921815746384"><p class="title"><strong>Figure 56.10. Rule options</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/1141.png" alt="Additional rule options"/></div></div></div></li></ul></div></li><li class="listitem">
							Click <span class="strong strong"><strong>Save</strong></span> in the rule designer to save your work.
						</li></ol></div><section class="section" id="rules-attributes-ref_guided-rule-templates"><div class="titlepage"><div><div><h3 class="title">56.4.1. Rule attributes</h3></div></div></div><p>
						Rule attributes are additional specifications that you can add to business rules to modify rule behavior.
					</p><p>
						The following table lists the names and supported values of the attributes that you can assign to rules:
					</p><div class="table" id="idm139921815737648"><p class="title"><strong>Table 56.1. Rule attributes</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921815732816" scope="col">Attribute</th><th align="left" valign="top" id="idm139921815731728" scope="col">Value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921815732816">
									<p>
										<code class="literal">salience</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921815731728">
									<p>
										An integer defining the priority of the rule. Rules with a higher salience value are given higher priority when ordered in the activation queue.
									</p>
									<p>
										Example: <code class="literal">salience 10</code>
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921815732816">
									<p>
										<code class="literal">enabled</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921815731728">
									<p>
										A Boolean value. When the option is selected, the rule is enabled. When the option is not selected, the rule is disabled.
									</p>
									<p>
										Example: <code class="literal">enabled true</code>
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921815732816">
									<p>
										<code class="literal">date-effective</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921815731728">
									<p>
										A string containing a date and time definition. The rule can be activated only if the current date and time is after a <code class="literal">date-effective</code> attribute.
									</p>
									<p>
										Example: <code class="literal">date-effective "4-Sep-2018"</code>
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921815732816">
									<p>
										<code class="literal">date-expires</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921815731728">
									<p>
										A string containing a date and time definition. The rule cannot be activated if the current date and time is after the <code class="literal">date-expires</code> attribute.
									</p>
									<p>
										Example: <code class="literal">date-expires "4-Oct-2018"</code>
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921815732816">
									<p>
										<code class="literal">no-loop</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921815731728">
									<p>
										A Boolean value. When the option is selected, the rule cannot be reactivated (looped) if a consequence of the rule re-triggers a previously met condition. When the condition is not selected, the rule can be looped in these circumstances.
									</p>
									<p>
										Example: <code class="literal">no-loop true</code>
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921815732816">
									<p>
										<code class="literal">agenda-group</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921815731728">
									<p>
										A string identifying an agenda group to which you want to assign the rule. Agenda groups allow you to partition the agenda to provide more execution control over groups of rules. Only rules in an agenda group that has acquired a focus are able to be activated.
									</p>
									<p>
										Example: <code class="literal">agenda-group "GroupName"</code>
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921815732816">
									<p>
										<code class="literal">activation-group</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921815731728">
									<p>
										A string identifying an activation (or XOR) group to which you want to assign the rule. In activation groups, only one rule can be activated. The first rule to fire will cancel all pending activations of all rules in the activation group.
									</p>
									<p>
										Example: <code class="literal">activation-group "GroupName"</code>
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921815732816">
									<p>
										<code class="literal">duration</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921815731728">
									<p>
										A long integer value defining the duration of time in milliseconds after which the rule can be activated, if the rule conditions are still met.
									</p>
									<p>
										Example: <code class="literal">duration 10000</code>
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921815732816">
									<p>
										<code class="literal">timer</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921815731728">
									<p>
										A string identifying either <code class="literal">int</code> (interval) or <code class="literal">cron</code> timer definitions for scheduling the rule.
									</p>
									<p>
										Example: <code class="literal">timer ( cron:* 0/15 * * * ? )</code> (every 15 minutes)
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921815732816">
									<p>
										<code class="literal">calendar</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921815731728">
									<p>
										A <a class="link" href="http://www.quartz-scheduler.org/">Quartz</a> calendar definition for scheduling the rule.
									</p>
									<p>
										Example: <code class="literal">calendars "* * 0-7,18-23 ? * *"</code> (exclude non-business hours)
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921815732816">
									<p>
										<code class="literal">auto-focus</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921815731728">
									<p>
										A Boolean value, applicable only to rules within agenda groups. When the option is selected, the next time the rule is activated, a focus is automatically given to the agenda group to which the rule is assigned.
									</p>
									<p>
										Example: <code class="literal">auto-focus true</code>
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921815732816">
									<p>
										<code class="literal">lock-on-active</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921815731728">
									<p>
										A Boolean value, applicable only to rules within rule flow groups or agenda groups. When the option is selected, the next time the ruleflow group for the rule becomes active or the agenda group for the rule receives a focus, the rule cannot be activated again until the ruleflow group is no longer active or the agenda group loses the focus. This is a stronger version of the <code class="literal">no-loop</code> attribute, because the activation of a matching rule is discarded regardless of the origin of the update (not only by the rule itself). This attribute is ideal for calculation rules where you have a number of rules that modify a fact and you do not want any rule re-matching and firing again.
									</p>
									<p>
										Example: <code class="literal">lock-on-active true</code>
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921815732816">
									<p>
										<code class="literal">ruleflow-group</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921815731728">
									<p>
										A string identifying a rule flow group. In rule flow groups, rules can fire only when the group is activated by the associated rule flow.
									</p>
									<p>
										Example: <code class="literal">ruleflow-group "GroupName"</code>
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm139921815732816">
									<p>
										<code class="literal">dialect</code>
									</p>
									</td><td align="left" valign="top" headers="idm139921815731728">
									<p>
										A string identifying either <code class="literal">JAVA</code> or <code class="literal">MVEL</code> as the language to be used for code expressions in the rule. By default, the rule uses the dialect specified at the package level. Any dialect specified here overrides the package dialect setting for the rule.
									</p>
									<p>
										Example: <code class="literal">dialect "JAVA"</code>
									</p>
									<div class="admonition note"><div class="admonition_header">Note</div><div><p>
											When you use Red Hat Process Automation Manager without the executable model, the <code class="literal">dialect "JAVA"</code> rule consequences support only Java 5 syntax. For more information about executable models, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#executable-model-con_packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>.
										</p></div></div>
									</td></tr></tbody></table></div></div></section></section></section><section class="chapter" id="guided-rule-templates-tables-proc"><div class="titlepage"><div><div><h2 class="title">Chapter 57. Defining data tables for guided rule templates</h2></div></div></div><p>
				After you create a guided rule template and add template keys for field values, a data table is displayed in the <span class="strong strong"><strong>Data</strong></span> table of the guided rule templates designer. Each column in the data table corresponds to a template key that you added in the guided rule template. Use this table to define values for each template key row by row. Each row of values that you define in the data table for that template results in a rule.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						In the guided rule templates designer, click the <span class="strong strong"><strong>Data</strong></span> tab to view the data table. Each column in the data table corresponds to a template key that you added in the guided rule template.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							If you did not add any template keys to the rule template, then this data table does not appear and the template does not function as a genuine template but essentially as an individual guided rule. For this reason, template keys are fundamental in creating guided rule templates.
						</p></div></div></li><li class="listitem">
						Click <span class="strong strong"><strong>Add row</strong></span> and define the data values for each template key column to generate that rule (row).
					</li><li class="listitem"><p class="simpara">
						Continue adding rows and defining data values for each rule that will be generated. You can click <span class="strong strong"><strong>Add row</strong></span> for each new row, or click the plus icon (
						<span class="inlinemediaobject"><img src="images/_images/Workbench/AuthoringAssets/5686.png" alt="5686"/></span>
						) or minus icon to add or remove rows.
					</p><div class="figure" id="idm139921815634736"><p class="title"><strong>Figure 57.1. Sample data table for a guided rule template</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/guided-rule-templates-data-table.png" alt="Sample data table for a guided rule template"/></div></div></div><p class="simpara">
						To view the DRL code, click the <span class="strong strong"><strong>Source</strong></span> tab in the guided rule templates designer.
					</p><p class="simpara">
						Example:
					</p><pre class="screen">rule "PaymentRules_6"
	when
		Customer( internetService == false ,
			phoneService == false ,
			TVService == true )
	then
		RecurringPayment fact0 = new RecurringPayment();
		fact0.setAmount( 5 );
		insertLogical( fact0 );
end

rule "PaymentRules_5"
	when
		Customer( internetService == false ,
			phoneService == true ,
			TVService == false )
	then
		RecurringPayment fact0 = new RecurringPayment();
		fact0.setAmount( 5 );
		insertLogical( fact0 );
end
...
//Other rules omitted for brevity.</pre></li><li class="listitem"><p class="simpara">
						As a visual aid, click the grid icon in the upper-left corner of the data table to toggle cell merging on and off, if needed. Cells in the same column with identical values are merged into a single cell.
					</p><div class="figure" id="idm139921815626928"><p class="title"><strong>Figure 57.2. Merge cells in a data table</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/guided-rule-templates-cell-merging.png" alt="Merge cells in a data table"/></div></div></div><p class="simpara">
						You can then use the expand/collapse icon [+/-] in the upper-left corner of each newly merged cell to collapse the rows corresponding to the merged cell, or to re-expand the collapsed rows.
					</p><div class="figure" id="idm139921815622352"><p class="title"><strong>Figure 57.3. Collapse merged cells</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/Workbench/AuthoringAssets/guided-rule-templates-cell-merging-02.png" alt="Collapse merged cells"/></div></div></div></li><li class="listitem">
						After you define the template key data for all rules and adjust the table display as needed, click <span class="strong strong"><strong>Validate</strong></span> in the upper-right toolbar of the guided rule templates designer to validate the guided rule template. If the rule template validation fails, address any problems described in the error message, review all components in the rule template and data defined in the data table, and try again to validate the rule template until the rule template passes.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Save</strong></span> in the guided rule templates designer to save your work.
					</li></ol></div></section><section class="chapter" id="assets-executing-proc_guided-rule-templates"><div class="titlepage"><div><div><h2 class="title">Chapter 58. Executing rules</h2></div></div></div><p>
				After you identify example rules or create your own rules in Business Central, you can build and deploy the associated project and execute rules locally or on KIE Server to test the rules.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Business Central and KIE Server are installed and running. For installation options, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/installing_and_configuring_red_hat_process_automation_manager#assembly-planning"><span class="emphasis"><em>Planning a Red Hat Process Automation Manager installation</em></span></a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
					</li><li class="listitem"><p class="simpara">
						In the upper-right corner of the project <span class="strong strong"><strong>Assets</strong></span> page, click <span class="strong strong"><strong>Deploy</strong></span> to build the project and deploy it to KIE Server. If the build fails, address any problems described in the <span class="strong strong"><strong>Alerts</strong></span> panel at the bottom of the screen.
					</p><p class="simpara">
						For more information about project deployment options, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							If the rule assets in your project are not built from an executable rule model by default, verify that the following dependency is in the <code class="literal">pom.xml</code> file of your project and rebuild the project:
						</p><pre class="programlisting language-xml">&lt;dependency&gt;
  &lt;groupId&gt;org.drools&lt;/groupId&gt;
  &lt;artifactId&gt;drools-model-compiler&lt;/artifactId&gt;
  &lt;version&gt;${rhpam.version}&lt;/version&gt;
&lt;/dependency&gt;</pre><p>
							This dependency is required for rule assets in Red Hat Process Automation Manager to be built from executable rule models by default. This dependency is included as part of the Red Hat Process Automation Manager core packaging, but depending on your Red Hat Process Automation Manager upgrade history, you may need to manually add this dependency to enable the executable rule model behavior.
						</p><p>
							For more information about executable rule models, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#executable-model-con_packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Create a Maven or Java project outside of Business Central, if not created already, that you can use for executing rules locally or that you can use as a client application for executing rules on KIE Server. The project must contain a <code class="literal">pom.xml</code> file and any other required components for executing the project resources.
					</p><p class="simpara">
						For example test projects, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#drl-rules-other-con">"Other methods for creating and executing DRL rules"</a>.
					</p></li><li class="listitem"><p class="simpara">
						Open the <code class="literal">pom.xml</code> file of your test project or client application and add the following dependencies, if not added already:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">kie-ci</code>: Enables your client application to load Business Central project data locally using <code class="literal">ReleaseId</code>
							</li><li class="listitem">
								<code class="literal">kie-server-client</code>: Enables your client application to interact remotely with assets on KIE Server
							</li><li class="listitem">
								<code class="literal">slf4j</code>: (Optional) Enables your client application to use Simple Logging Facade for Java (SLF4J) to return debug logging information after you interact with KIE Server
							</li></ul></div><p class="simpara">
						Example dependencies for Red Hat Process Automation Manager 7.10 in a client application <code class="literal">pom.xml</code> file:
					</p><pre class="programlisting language-xml">&lt;!-- For local execution --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-ci&lt;/artifactId&gt;
  &lt;version&gt;7.48.0.Final-redhat-00002&lt;/version&gt;
&lt;/dependency&gt;

&lt;!-- For remote execution on KIE Server --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie.server&lt;/groupId&gt;
  &lt;artifactId&gt;kie-server-client&lt;/artifactId&gt;
  &lt;version&gt;7.48.0.Final-redhat-00002&lt;/version&gt;
&lt;/dependency&gt;

&lt;!-- For debug logging (optional) --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
  &lt;artifactId&gt;slf4j-simple&lt;/artifactId&gt;
  &lt;version&gt;1.7.25&lt;/version&gt;
&lt;/dependency&gt;</pre><p class="simpara">
						For available versions of these artifacts, search the group ID and artifact ID in the <a class="link" href="https://repository.jboss.org/nexus/index.html#welcome">Nexus Repository Manager</a> online.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Instead of specifying a Red Hat Process Automation Manager <code class="literal">&lt;version&gt;</code> for individual dependencies, consider adding the Red Hat Business Automation bill of materials (BOM) dependency to your project <code class="literal">pom.xml</code> file. The Red Hat Business Automation BOM applies to both Red Hat Decision Manager and Red Hat Process Automation Manager. When you add the BOM files, the correct versions of transitive dependencies from the provided Maven repositories are included in the project.
						</p><p>
							Example BOM dependency:
						</p><pre class="programlisting language-xml">&lt;dependency&gt;
  &lt;groupId&gt;com.redhat.ba&lt;/groupId&gt;
  &lt;artifactId&gt;ba-platform-bom&lt;/artifactId&gt;
  &lt;version&gt;7.10.0.redhat-00002&lt;/version&gt;
  &lt;scope&gt;import&lt;/scope&gt;
  &lt;type&gt;pom&lt;/type&gt;
&lt;/dependency&gt;</pre><p>
							For more information about the Red Hat Business Automation BOM, see <a class="link" href="https://access.redhat.com/solutions/3405361">What is the mapping between Red Hat Process Automation Manager and the Maven library version?</a>.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Ensure that the dependencies for artifacts containing model classes are defined in the client application <code class="literal">pom.xml</code> file exactly as they appear in the <code class="literal">pom.xml</code> file of the deployed project. If dependencies for model classes differ between the client application and your projects, execution errors can occur.
					</p><p class="simpara">
						To access the project <code class="literal">pom.xml</code> file in Business Central, select any existing asset in the project and then in the <span class="strong strong"><strong>Project Explorer</strong></span> menu on the left side of the screen, click the <span class="strong strong"><strong>Customize View</strong></span> gear icon and select <span class="strong strong"><strong>Repository View</strong></span> → <span class="strong strong"><strong>pom.xml</strong></span>.
					</p><p class="simpara">
						For example, the following <code class="literal">Person</code> class dependency appears in both the client and deployed project <code class="literal">pom.xml</code> files:
					</p><pre class="programlisting language-xml">&lt;dependency&gt;
  &lt;groupId&gt;com.sample&lt;/groupId&gt;
  &lt;artifactId&gt;Person&lt;/artifactId&gt;
  &lt;version&gt;1.0.0&lt;/version&gt;
&lt;/dependency&gt;</pre></li><li class="listitem"><p class="simpara">
						If you added the <code class="literal">slf4j</code> dependency to the client application <code class="literal">pom.xml</code> file for debug logging, create a <code class="literal">simplelogger.properties</code> file on the relevant classpath (for example, in <code class="literal">src/main/resources/META-INF</code> in Maven) with the following content:
					</p><pre class="programlisting language-java">org.slf4j.simpleLogger.defaultLogLevel=debug</pre></li><li class="listitem"><p class="simpara">
						In your client application, create a <code class="literal">.java</code> main class containing the necessary imports and a <code class="literal">main()</code> method to load the KIE base, insert facts, and execute the rules.
					</p><p class="simpara">
						For example, a <code class="literal">Person</code> object in a project contains getter and setter methods to set and retrieve the first name, last name, hourly rate, and the wage of a person. The following <code class="literal">Wage</code> rule in a project calculates the wage and hourly rate values and displays a message based on the result:
					</p><pre class="programlisting language-java">package com.sample;

import com.sample.Person;

dialect "java"

rule "Wage"
  when
    Person(hourlyRate * wage &gt; 100)
    Person(name : firstName, surname : lastName)
  then
    System.out.println("Hello" + " " + name + " " + surname + "!");
    System.out.println("You are rich!");
end</pre><p class="simpara">
						To test this rule locally outside of KIE Server (if needed), configure the <code class="literal">.java</code> class to import KIE services, a KIE container, and a KIE session, and then use the <code class="literal">main()</code> method to fire all rules against a defined fact model:
					</p><div class="formalpara"><p class="title"><strong>Executing rules locally</strong></p><p>
							
<pre class="programlisting language-java">import org.kie.api.KieServices;
import org.kie.api.builder.ReleaseId;
import org.kie.api.runtime.KieContainer;
import org.kie.api.runtime.KieSession;
import org.drools.compiler.kproject.ReleaseIdImpl;

public class RulesTest {

  public static final void main(String[] args) {
    try {
      // Identify the project in the local repository:
      ReleaseId rid = new ReleaseIdImpl("com.myspace", "MyProject", "1.0.0");

      // Load the KIE base:
      KieServices ks = KieServices.Factory.get();
      KieContainer kContainer = ks.newKieContainer(rid);
      KieSession kSession = kContainer.newKieSession();

      // Set up the fact model:
      Person p = new Person();
      p.setWage(12);
      p.setFirstName("Tom");
      p.setLastName("Summers");
      p.setHourlyRate(10);

      // Insert the person into the session:
      kSession.insert(p);

      // Fire all rules:
      kSession.fireAllRules();
      kSession.dispose();
    }

    catch (Throwable t) {
      t.printStackTrace();
    }
  }
}</pre>
						</p></div><p class="simpara">
						To test this rule on KIE Server, configure the <code class="literal">.java</code> class with the imports and rule execution information similarly to the local example, and additionally specify KIE services configuration and KIE services client details:
					</p><div class="formalpara"><p class="title"><strong>Executing rules on KIE Server</strong></p><p>
							
<pre class="programlisting language-java">package com.sample;

import java.util.ArrayList;
import java.util.HashSet;
import java.util.List;
import java.util.Set;

import org.kie.api.command.BatchExecutionCommand;
import org.kie.api.command.Command;
import org.kie.api.KieServices;
import org.kie.api.runtime.ExecutionResults;
import org.kie.api.runtime.KieContainer;
import org.kie.api.runtime.KieSession;
import org.kie.server.api.marshalling.MarshallingFormat;
import org.kie.server.api.model.ServiceResponse;
import org.kie.server.client.KieServicesClient;
import org.kie.server.client.KieServicesConfiguration;
import org.kie.server.client.KieServicesFactory;
import org.kie.server.client.RuleServicesClient;

import com.sample.Person;

public class RulesTest {

  private static final String containerName = "testProject";
  private static final String sessionName = "myStatelessSession";

  public static final void main(String[] args) {
    try {
      // Define KIE services configuration and client:
      Set&lt;Class&lt;?&gt;&gt; allClasses = new HashSet&lt;Class&lt;?&gt;&gt;();
      allClasses.add(Person.class);
      String serverUrl = "http://$HOST:$PORT/kie-server/services/rest/server";
      String username = "$USERNAME";
      String password = "$PASSWORD";
      KieServicesConfiguration config =
        KieServicesFactory.newRestConfiguration(serverUrl,
                                                username,
                                                password);
      config.setMarshallingFormat(MarshallingFormat.JAXB);
      config.addExtraClasses(allClasses);
      KieServicesClient kieServicesClient =
        KieServicesFactory.newKieServicesClient(config);

      // Set up the fact model:
      Person p = new Person();
      p.setWage(12);
      p.setFirstName("Tom");
      p.setLastName("Summers");
      p.setHourlyRate(10);

      // Insert Person into the session:
      KieCommands kieCommands = KieServices.Factory.get().getCommands();
      List&lt;Command&gt; commandList = new ArrayList&lt;Command&gt;();
      commandList.add(kieCommands.newInsert(p, "personReturnId"));

      // Fire all rules:
      commandList.add(kieCommands.newFireAllRules("numberOfFiredRules"));
      BatchExecutionCommand batch = kieCommands.newBatchExecution(commandList, sessionName);

      // Use rule services client to send request:
      RuleServicesClient ruleClient = kieServicesClient.getServicesClient(RuleServicesClient.class);
      ServiceResponse&lt;ExecutionResults&gt; executeResponse = ruleClient.executeCommandsWithResults(containerName, batch);
      System.out.println("number of fired rules:" + executeResponse.getResult().getValue("numberOfFiredRules"));
    }

    catch (Throwable t) {
      t.printStackTrace();
    }
  }
}</pre>
						</p></div></li><li class="listitem"><p class="simpara">
						Run the configured <code class="literal">.java</code> class from your project directory. You can run the file in your development platform (such as Red Hat CodeReady Studio) or in the command line.
					</p><p class="simpara">
						Example Maven execution (within project directory):
					</p><pre class="screen">mvn clean install exec:java -Dexec.mainClass="com.sample.app.RulesTest"</pre><p class="simpara">
						Example Java execution (within project directory)
					</p><pre class="screen">javac -classpath "./$DEPENDENCIES/*:." RulesTest.java
java -classpath "./$DEPENDENCIES/*:." RulesTest</pre></li><li class="listitem">
						Review the rule execution status in the command line and in the server log. If any rules do not execute as expected, review the configured rules in the project and the main class configuration to validate the data provided.
					</li></ol></div></section><section class="chapter" id="next_steps_5"><div class="titlepage"><div><div><h2 class="title">Chapter 59. Next steps</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-test-scenarios"><span class="emphasis"><em>Testing a decision service using test scenarios</em></span></a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>
					</li></ul></div></section></div><div class="part" id="assembly-test-scenarios"><div class="titlepage"><div><div><h1 class="title">Part VIII. Testing a decision service using test scenarios</h1></div></div></div><div class="partintro" id="idm139921885949136"><div/><p>
				As a business analyst or business rules developer, you can use test scenarios in Business Central to test a decision service before a project is deployed. You can test DMN-based and rules-based decision services to ensure these are functioning properly and as expected. Also, you can test a decision service at any time during project development.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The space and project for the decision service have been created in Business Central. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/getting_started_with_red_hat_process_automation_manager#assembly-getting-started-decision-services"><span class="emphasis"><em>Getting started with decision services</em></span></a>.
					</li><li class="listitem">
						Business rules and their associated data objects have been defined for the rules-based decision service. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-guided-decision-tables"><span class="emphasis"><em>Designing a decision service using guided decision tables</em></span></a>.
					</li><li class="listitem">
						DMN decision logic and its associated custom data types have been defined for the DMN-based decision service. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-dmn-models"><span class="emphasis"><em>Designing a decision service using DMN models</em></span></a>.
					</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Having defined business rules is not a technical prerequisite for test scenarios, because the scenarios can test the defined data that constitutes the business rules. However, creating the rules first is helpful so that you can also test entire rules in test scenarios and so that the scenarios more closely match the intended decision service. For DMN-based test scenarios ensure that the DMN decision logic and its associated custom data types are defined for the decision service.
				</p></div></div><div class="toc"><p><strong>Table of Contents</strong></p><ul class="toc"><li><span class="chapter"><a href="#test-scenarios-intro-con_test-scenarios">60. Test scenarios</a></span></li><li><span class="chapter"><a href="#data-objects-con_test-scenarios">61. Data objects</a></span><ul><li><span class="section"><a href="#data-objects-create-proc_test-scenarios">61.1. Creating data objects</a></span></li></ul></li><li><span class="chapter"><a href="#test-designer-con">62. Test scenarios designer in Business Central</a></span><ul><li><span class="section"><a href="#test-designer-data-objects-import-proc">62.1. Importing data objects</a></span></li><li><span class="section"><a href="#test-designer-test-scenario-import-proc">62.2. Importing a test scenario</a></span></li><li><span class="section"><a href="#test-designer-save-test-proc">62.3. Saving a test scenario</a></span></li><li><span class="section"><a href="#test-designer-copy-test-proc">62.4. Copying a test scenario</a></span></li><li><span class="section"><a href="#test-designer-download-test-proc">62.5. Downloading a test scenario</a></span></li><li><span class="section"><a href="#test-designer-latest-version-test-proc">62.6. Switching between versions of a test scenario</a></span></li><li><span class="section"><a href="#test-designer-view-hide-alerts-con">62.7. View or hide the alerts panel</a></span></li><li><span class="section"><a href="#test-designer-contextual-menu-ref">62.8. Contextual menu options</a></span></li><li><span class="section"><a href="#test-designer-global-settings-panel-con">62.9. Global settings for test scenarios</a></span><ul><li><span class="section"><a href="#test-designer-global-settings-panel-rule-based-proc">62.9.1. Configuring global settings for rule-based test scenarios</a></span></li><li><span class="section"><a href="#test-designer-global-settings-panel-dmn-based-proc">62.9.2. Configuring global settings for DMN-based test scenarios</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#test-designer-create-test-scenario-template-con">63. Test scenario template</a></span><ul><li><span class="section"><a href="#test-designer-create-test-template-rule-based-proc">63.1. Creating a test scenario template for rule-based test scenarios</a></span></li><li><span class="section"><a href="#test-designer-alias-proc">63.2. Using aliases in rule-based test scenarios</a></span></li></ul></li><li><span class="chapter"><a href="#test-designer-test-template-dmn-based-con">64. Test template for DMN-based test scenarios</a></span><ul><li><span class="section"><a href="#test-designer-create-test-template-dmn-based-proc">64.1. Creating a test scenario template for DMN-based test scenarios</a></span></li></ul></li><li><span class="chapter"><a href="#test-designer-test-scenario-definition-proc">65. Defining a test scenario</a></span></li><li><span class="chapter"><a href="#test-scenarios-background-instance-con">66. Background instance in test scenarios</a></span><ul><li><span class="section"><a href="#test-scenarios-background-rule-based-proc">66.1. Adding a background data in rule-based test scenarios</a></span></li><li><span class="section"><a href="#test-scenarios-background-dmn-based-proc">66.2. Adding a background data in DMN-based test scenarios</a></span></li></ul></li><li><span class="chapter"><a href="#test-designer-list-map-add-remove-item-proc">67. Using list and map collections in test scenarios</a></span></li><li><span class="chapter"><a href="#test-designer-expressions-syntax-intro-ref">68. Expression syntax in test scenarios</a></span><ul><li><span class="section"><a href="#test-designer-expressions-syntax-rule-based-ref">68.1. Expression syntax in rule-based test scenarios</a></span></li><li><span class="section"><a href="#test-designer-expressions-syntax-dmn-based-ref">68.2. Expression syntax in DMN-based scenarios</a></span></li></ul></li><li><span class="chapter"><a href="#test-designer-run-test-proc">69. Running the test scenarios</a></span></li><li><span class="chapter"><a href="#test-scenarios-running-locally-proc">70. Running a test scenario locally</a></span></li><li><span class="chapter"><a href="#test-designer-test-scenario-export-import-spreadsheet-con">71. Exporting and importing test scenario spreadsheets</a></span><ul><li><span class="section"><a href="#test-designer-test-scenario-export-spreadsheet-proc">71.1. Exporting a test scenario spreadsheet</a></span></li><li><span class="section"><a href="#test-designer-test-scenario-import-spreadsheet-proc">71.2. Importing a test scenario spreadsheet</a></span></li></ul></li><li><span class="chapter"><a href="#test-scenarios-coverage-report-con">72. Coverage reports for test scenarios</a></span><ul><li><span class="section"><a href="#test-scenarios-coverage-report-rule-based-proc">72.1. Generating coverage reports for rule-based test scenarios</a></span></li><li><span class="section"><a href="#test-scenarios-coverage-report-dmn-based-proc">72.2. Generating coverage reports for DMN-based test scenarios</a></span></li></ul></li><li><span class="chapter"><a href="#test-scenarios-execution-rest-api-proc">73. Executing a test scenario using the KIE Server REST API</a></span></li><li><span class="chapter"><a href="#test-designer-create-mortgages-example-proc">74. Creating test scenario using the sample Mortgages project</a></span></li><li><span class="chapter"><a href="#test-scenarios-legacy-designer-con">75. Test scenarios (legacy) designer in Business Central</a></span><ul><li><span class="section"><a href="#test-scenarios-legacy-create-proc">75.1. Creating and running a test scenario (legacy)</a></span><ul><li><span class="section"><a href="#test-scenarios-legacy-GIVEN-proc">75.1.1. Adding GIVEN facts in test scenarios (legacy)</a></span></li><li><span class="section"><a href="#test-scenarios-legacy-EXPECT-proc">75.1.2. Adding EXPECT results in test scenarios (legacy)</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#test-scenarios-comparison-legacy-new-ref">76. Feature comparison of legacy and new test scenario designer</a></span></li><li><span class="chapter"><a href="#next_steps_6">77. Next steps</a></span></li></ul></div></div><section class="chapter" id="test-scenarios-intro-con_test-scenarios"><div class="titlepage"><div><div><h2 class="title">Chapter 60. Test scenarios</h2></div></div></div><p>
				Test scenarios in Red Hat Process Automation Manager enable you to validate the functionality of business rules and business rule data (for rules-based test scenarios) or of DMN models (for DMN-based test scenarios) before deploying them into a production environment. With a test scenario, you use data from your project to set given conditions and expected results based on one or more defined business rules. When you run the scenario, the expected results and actual results of the rule instance are compared. If the expected results match the actual results, the test is successful. If the expected results do not match the actual results, then the test fails.
			</p><p>
				Red Hat Process Automation Manager currently supports both the new <span class="strong strong"><strong>Test Scenarios</strong></span> designer and the former <span class="strong strong"><strong>Test Scenarios (Legacy)</strong></span> designer. The default designer is the new test scenarios designer, which supports testing of both rules and DMN models and provides an enhanced overall user experience with test scenarios. If required, you can continue to use the legacy test scenarios designer, which supports rule-based test scenarios only.
			</p><p>
				You can run the defined test scenarios in a number of ways, for example, you can run available test scenarios at the project level or inside a specific test scenario asset. Test scenarios are independent and cannot affect or modify other test scenarios. You can run test scenarios at any time during project development in Business Central. You do not have to compile or deploy your decision service to run test scenarios.
			</p><p>
				You can import data objects from different packages to the same project package as the test scenario. Assets in the same package are imported by default. After you create the necessary data objects and the test scenario, you can use the <span class="strong strong"><strong>Data Objects</strong></span> tab of the test scenarios designer to verify that all required data objects are listed or to import other existing data objects by adding a <span class="strong strong"><strong>New item</strong></span>.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Throughout the test scenarios documentation, all references to <span class="emphasis"><em>test scenarios</em></span> and the <span class="emphasis"><em>test scenarios designer</em></span> are for the new version, unless explicitly noted as the legacy version.
				</p></div></div></section><section class="chapter" id="data-objects-con_test-scenarios"><div class="titlepage"><div><div><h2 class="title">Chapter 61. Data objects</h2></div></div></div><p>
				Data objects are the building blocks for the rule assets that you create. Data objects are custom data types implemented as Java objects in specified packages of your project. For example, you might create a <code class="literal">Person</code> object with data fields <code class="literal">Name</code>, <code class="literal">Address</code>, and <code class="literal">DateOfBirth</code> to specify personal details for loan application rules. These custom data types determine what data your assets and your decision services are based on.
			</p><section class="section" id="data-objects-create-proc_test-scenarios"><div class="titlepage"><div><div><h2 class="title">61.1. Creating data objects</h2></div></div></div><p>
					The following procedure is a generic overview of creating data objects. It is not specific to a particular business asset.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Data Object</strong></span>.
						</li><li class="listitem"><p class="simpara">
							Enter a unique <span class="strong strong"><strong>Data Object</strong></span> name and select the <span class="strong strong"><strong>Package</strong></span> where you want the data object to be available for other rule assets. Data objects with the same name cannot exist in the same package. In the specified DRL file, you can import a data object from any package.
						</p><div class="admonition important"><div class="admonition_header">Importing data objects from other packages</div><div><p>
								You can import an existing data object from another package directly into the asset designers like guided rules or guided decision table designers. Select the relevant rule asset within the project and in the asset designer, go to <span class="strong strong"><strong>Data Objects → New item</strong></span> to select the object to be imported.
							</p></div></div></li><li class="listitem">
							To make your data object persistable, select the <span class="strong strong"><strong>Persistable</strong></span> checkbox. Persistable data objects are able to be stored in a database according to the JPA specification. The default JPA is Hibernate.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Ok</strong></span>.
						</li><li class="listitem"><p class="simpara">
							In the data object designer, click <span class="strong strong"><strong>add field</strong></span> to add a field to the object with the attributes <span class="strong strong"><strong>Id</strong></span>, <span class="strong strong"><strong>Label</strong></span>, and <span class="strong strong"><strong>Type</strong></span>. Required attributes are marked with an asterisk (*).
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="strong strong"><strong>Id:</strong></span> Enter the unique ID of the field.
								</li><li class="listitem">
									<span class="strong strong"><strong>Label:</strong></span> (Optional) Enter a label for the field.
								</li><li class="listitem">
									<span class="strong strong"><strong>Type:</strong></span> Enter the data type of the field.
								</li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>List:</strong></span> (Optional) Select this check box to enable the field to hold multiple items for the specified type.
								</p><div class="figure" id="idm139921812126032"><p class="title"><strong>Figure 61.1. Add data fields to a data object</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/project-data/DataModelerNewField2-new.png" alt="Add data fields to a data object"/></div></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Create</strong></span> to add the new field, or click <span class="strong strong"><strong>Create and continue</strong></span> to add the new field and continue adding other fields.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								To edit a field, select the field row and use the <span class="strong strong"><strong>general properties</strong></span> on the right side of the screen.
							</p></div></div></li></ol></div></section></section><section class="chapter" id="test-designer-con"><div class="titlepage"><div><div><h2 class="title">Chapter 62. Test scenarios designer in Business Central</h2></div></div></div><p>
				The test scenarios designer provides a tabular layout that helps you in defining a scenario template and all the associated test cases. The designer layout consists of a table which has a header and the individual rows. The header consists of three parts, the <span class="strong strong"><strong>GIVEN</strong></span> and <span class="strong strong"><strong>EXPECT</strong></span> row, a row with instances, and a row with corresponding fields. The header is also known as test scenario template and the individual rows are called test scenarios definitions.
			</p><p>
				The test scenario template or header has the following two parts:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="strong strong"><strong>GIVEN</strong></span> data objects and their fields - represents the input information
					</li><li class="listitem">
						<span class="strong strong"><strong>EXPECT</strong></span> data objects and their fields - represents the objects and their fields whose exact values are checked based on the given information and which also constitutes the expected result.
					</li></ul></div><p>
				The test scenarios definitions represent the separate test cases of a template.
			</p><p>
				You can access the <span class="strong strong"><strong>Project Explorer</strong></span> from the left panel of the designer whereas from the right panel you can access the <span class="strong strong"><strong>Settings</strong></span>, <span class="strong strong"><strong>Test Tools</strong></span>, <span class="strong strong"><strong>Scenario Cheatsheet</strong></span>, <span class="strong strong"><strong>Test Report</strong></span> and the <span class="strong strong"><strong>Coverage Report</strong></span> tabs. You can access the <span class="strong strong"><strong>Settings</strong></span> tab to view and edit the global settings of rule-based and DMN-based test scenarios. You can use the <span class="strong strong"><strong>Test Tools</strong></span> to configure the data object mappings. <span class="strong strong"><strong>Scenario Cheatsheet</strong></span> tab contains notes and the cheat sheet which you can use as reference. The <span class="strong strong"><strong>Test Report</strong></span> tab displays the overview of the tests and the scenario status. To view the test coverage statistics, you can use the <span class="strong strong"><strong>Coverage Report</strong></span> tab from the right side of the test scenario designer.
			</p><section class="section" id="test-designer-data-objects-import-proc"><div class="titlepage"><div><div><h2 class="title">62.1. Importing data objects</h2></div></div></div><p>
					The test scenarios designer loads all data objects that are located in the same package as the test scenario. You can view all the data objects from the <span class="strong strong"><strong>Data Objects</strong></span> tab in the designer. The loaded data objects are also displayed in the <span class="strong strong"><strong>Test Tools</strong></span> panel.
				</p><p>
					You need to close and reopen the designer in case the data objects change (for example, when a new data object is created or when an existing one is deleted). Select a data object from the list to display its fields and the field types.
				</p><p>
					In case you want to use a data object located in a different package than the test scenario, you need to import the data object first. Follow the procedure below to import a data object for rules-based test scenarios.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						You cannot import any data objects while creating DMN-based test scenarios. DMN-based test scenarios do not use any data objects from the project but uses the custom data types defined in the DMN file.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Go to <span class="strong strong"><strong>Project Explorer</strong></span> panel in the test scenarios designer.
						</li><li class="listitem">
							From <span class="strong strong"><strong>Test Scenario</strong></span>, select a test scenario.
						</li><li class="listitem">
							Select <span class="strong strong"><strong>Data Objects</strong></span> tab and click <span class="strong strong"><strong>New Item</strong></span>.
						</li><li class="listitem">
							In the <span class="strong strong"><strong>Add import</strong></span> window, choose the data object from the drop-down list.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Ok</strong></span> and then <span class="strong strong"><strong>Save</strong></span>.
						</li><li class="listitem">
							Close and reopen the test scenarios designer to view the new data object from the data objects list.
						</li></ol></div></section><section class="section" id="test-designer-test-scenario-import-proc"><div class="titlepage"><div><div><h2 class="title">62.2. Importing a test scenario</h2></div></div></div><p>
					You can import an existing test scenario using the <span class="strong strong"><strong>Import Asset</strong></span> button in the <span class="strong strong"><strong>Asset</strong></span> tab from the project view.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
						</li><li class="listitem">
							From the project’s <span class="strong strong"><strong>Asset</strong></span> tab, click <span class="strong strong"><strong>Import Asset</strong></span>.
						</li><li class="listitem"><p class="simpara">
							In the <span class="strong strong"><strong>Create new Import Asset</strong></span> window,
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Enter the name of the import asset.
								</li><li class="listitem">
									Select the package from the <span class="strong strong"><strong>Package</strong></span> drop-down list.
								</li><li class="listitem">
									From <span class="strong strong"><strong>Please select a file to upload</strong></span>, click <span class="strong strong"><strong>Choose File…​</strong></span> to browse to test scenario file.
								</li></ul></div></li><li class="listitem">
							Select the file and click <span class="strong strong"><strong>Open</strong></span>.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Ok</strong></span> and the test scenario opens in the test scenario designer.
						</li></ol></div></section><section class="section" id="test-designer-save-test-proc"><div class="titlepage"><div><div><h2 class="title">62.3. Saving a test scenario</h2></div></div></div><p>
					You can save a test scenario at any time while creating a test scenario template or defining the test scenarios.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							From the test scenarios designer toolbar on the upper-right, click <span class="strong strong"><strong>Save</strong></span>.
						</li><li class="listitem"><p class="simpara">
							On the <span class="strong strong"><strong>Confirm Save</strong></span> window,
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									If you wish to add a comment regarding the test scenario, click <span class="strong strong"><strong>add a comment</strong></span>.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Save</strong></span> again.
								</li></ol></div></li></ol></div><p>
					A message stating that the test scenario was saved successfully appears on the screen.
				</p></section><section class="section" id="test-designer-copy-test-proc"><div class="titlepage"><div><div><h2 class="title">62.4. Copying a test scenario</h2></div></div></div><p>
					You can copy an existing test scenario to the same package or to some other package by using the <span class="strong strong"><strong>Copy</strong></span> button from the upper-right toolbar.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							From the test scenarios designer toolbar on the upper-right, click <span class="strong strong"><strong>Copy</strong></span>.
						</li><li class="listitem"><p class="simpara">
							In the <span class="strong strong"><strong>Make a Copy</strong></span> window,
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Enter a name in the <span class="strong strong"><strong>New Name</strong></span> field.
								</li><li class="listitem">
									Select the package you want to copy the test scenario to.
								</li><li class="listitem">
									Optional: To add a comment, click <span class="strong strong"><strong>add a comment</strong></span>.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Make a Copy</strong></span>.
								</li></ol></div></li></ol></div><p>
					A message stating that the test scenario was copied successfully appears on the screen.
				</p></section><section class="section" id="test-designer-download-test-proc"><div class="titlepage"><div><div><h2 class="title">62.5. Downloading a test scenario</h2></div></div></div><p>
					You can download a copy of the test scenario to your local machine for future reference or as backup.
				</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						In the test scenarios designer toolbar on the upper-right, click the <span class="strong strong"><strong>Download</strong></span> icon.
					</p></div><p>
					The <code class="literal">.scesim</code> file is downloaded to your local machine.
				</p></section><section class="section" id="test-designer-latest-version-test-proc"><div class="titlepage"><div><div><h2 class="title">62.6. Switching between versions of a test scenario</h2></div></div></div><p>
					Business Central provides you the ability to switch between the various versions of a test scenario. Every time you save the scenario, a new version of the scenario is listed under <span class="strong strong"><strong>Latest Versions</strong></span>. To use this feature, you must save the test scenario file at least once.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							From the test scenarios designer toolbar on the upper-right, click <span class="strong strong"><strong>Latest Version</strong></span>. All the versions of the file are listed under <span class="strong strong"><strong>Latest Version</strong></span>, if they exist.
						</li><li class="listitem"><p class="simpara">
							Click the version you want to work on.
						</p><p class="simpara">
							The selected version of the test scenario opens in the test scenarios designer.
						</p></li><li class="listitem">
							From the designer toolbar, click <span class="strong strong"><strong>Restore</strong></span>.
						</li><li class="listitem"><p class="simpara">
							In the <span class="strong strong"><strong>Confirm Restore</strong></span>,
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									To add a comment, click <span class="strong strong"><strong>add a comment</strong></span>.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Restore</strong></span> to confirm.
								</li></ol></div></li></ol></div><p>
					A message stating that the selected version has been reloaded successfully in the designer appears on the screen.
				</p></section><section class="section" id="test-designer-view-hide-alerts-con"><div class="titlepage"><div><div><h2 class="title">62.7. View or hide the alerts panel</h2></div></div></div><p>
					The <span class="strong strong"><strong>Alerts</strong></span> panel appears at the bottom of the test scenarios designer or the project view. It contains the build information and error messages in case the executed tests are failed.
				</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						From the designer toolbar on the upper-right, click <span class="strong strong"><strong>Hide Alerts</strong></span>/<span class="strong strong"><strong>View Alerts</strong></span> to enable or disable the reporting panel.
					</p></div></section><section class="section" id="test-designer-contextual-menu-ref"><div class="titlepage"><div><div><h2 class="title">62.8. Contextual menu options</h2></div></div></div><p>
					The test scenarios designer provides contextual menu options, which enables you to perform basic operations on the table such as adding, deleting, and, duplicating rows and columns. To use the contextual menus, you need to right-click a table element. Menu options differ based on the table element you select.
				</p><div class="table" id="idm139921811999776"><p class="title"><strong>Table 62.1. Contextual menu options</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"/><col style="width: 30%; " class="col_2"/><col style="width: 50%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921811993280" scope="col">Table element</th><th align="left" valign="top" id="idm139921811992192" scope="col">Cell label</th><th align="left" valign="top" id="idm139921811991104" scope="col">Available context menu options</th></tr></thead><tbody><tr><td rowspan="3" align="left" valign="top" headers="idm139921811993280">
								<p>
									Header
								</p>
								</td><td align="left" valign="top" headers="idm139921811992192">
								<p>
									#, Scenario description
								</p>
								</td><td align="left" valign="top" headers="idm139921811991104">
								<p>
									Insert row below
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921811992192">
								<p>
									GIVEN, EXPECT
								</p>
								</td><td align="left" valign="top" headers="idm139921811991104">
								<p>
									Insert leftmost column, Insert rightmost column, Insert row below
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921811992192">
								<p>
									INSTANCE 1, INSTANCE 2, PROPERTY 1, PROPERTY 2
								</p>
								</td><td align="left" valign="top" headers="idm139921811991104">
								<p>
									Insert column left, Insert column right, Delete column, Duplicate Instance, Insert row below
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921811993280">
								<p>
									Rows
								</p>
								</td><td align="left" valign="top" headers="idm139921811992192">
								<p>
									All the cells with row numbers, test scenarios description or test scenarios definition
								</p>
								</td><td align="left" valign="top" headers="idm139921811991104">
								<p>
									Insert row above, Insert row below, Duplicate row, Delete row, Run scenario
								</p>
								</td></tr></tbody></table></div></div><div class="table" id="idm139921811970512"><p class="title"><strong>Table 62.2. Description of table interactions</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"/><col style="width: 75%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921811964928" scope="col">Table interaction</th><th align="left" valign="middle" id="idm139921811963840" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921811964928">
								<p>
									Insert leftmost column
								</p>
								</td><td align="left" valign="top" headers="idm139921811963840">
								<p>
									Inserts a new leftmost column (in either the GIVEN or EXPECT section of the table based on user selection).
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921811964928">
								<p>
									Insert rightmost column
								</p>
								</td><td align="left" valign="top" headers="idm139921811963840">
								<p>
									Inserts a new rightmost column (in either the GIVEN or EXPECT section of the table based on user selection).
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921811964928">
								<p>
									Insert column left
								</p>
								</td><td align="left" valign="top" headers="idm139921811963840">
								<p>
									Inserts a new column to the left of the selected column. The new column is of the same type as the selected column (in either the GIVEN or EXPECT section of the table based on user selection).
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921811964928">
								<p>
									Insert column right
								</p>
								</td><td align="left" valign="top" headers="idm139921811963840">
								<p>
									Inserts a new column to the right of the selected column. The new column is of the same type as the selected column (in either the GIVEN or EXPECT section of the table based on user selection).
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921811964928">
								<p>
									Delete column
								</p>
								</td><td align="left" valign="top" headers="idm139921811963840">
								<p>
									Deletes the selected column.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921811964928">
								<p>
									Insert row above
								</p>
								</td><td align="left" valign="top" headers="idm139921811963840">
								<p>
									Inserts a new row above the selected row.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921811964928">
								<p>
									Insert row below
								</p>
								</td><td align="left" valign="top" headers="idm139921811963840">
								<p>
									Inserts a new row below the selected row. If invoked from a header cell, inserts a new row with index 1.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921811964928">
								<p>
									Duplicate row
								</p>
								</td><td align="left" valign="top" headers="idm139921811963840">
								<p>
									Duplicates the selected row.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921811964928">
								<p>
									Duplicate Instance
								</p>
								</td><td align="left" valign="top" headers="idm139921811963840">
								<p>
									Duplicates the selected instance.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921811964928">
								<p>
									Delete row
								</p>
								</td><td align="left" valign="top" headers="idm139921811963840">
								<p>
									Deletes the selected row.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921811964928">
								<p>
									Run scenario
								</p>
								</td><td align="left" valign="top" headers="idm139921811963840">
								<p>
									Runs a single test scenario.
								</p>
								</td></tr></tbody></table></div></div><p>
					The <span class="strong strong"><strong>Insert column right</strong></span> or <span class="strong strong"><strong>Insert column left</strong></span> context menu options behave differently.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							If the selected column does not have a type defined, a new column without a type is added.
						</li><li class="listitem"><p class="simpara">
							If the selected column has a type defined, either a new empty column or a column with the parent instance type is created.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									If the action is performed from an instance header, a new column without a type is created.
								</li><li class="listitem">
									If the action is performed from a property header, a new column with the parent instance type is created.
								</li></ul></div></li></ul></div></section><section class="section" id="test-designer-global-settings-panel-con"><div class="titlepage"><div><div><h2 class="title">62.9. Global settings for test scenarios</h2></div></div></div><p>
					You can use the global <span class="strong strong"><strong>Settings</strong></span> tab on the right side of the test scenarios designer to set and modify the additional properties of assets.
				</p><section class="section" id="test-designer-global-settings-panel-rule-based-proc"><div class="titlepage"><div><div><h3 class="title">62.9.1. Configuring global settings for rule-based test scenarios</h3></div></div></div><p>
						Follow the procedure below to view and edit the global settings of rule-based test scenarios.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Click <span class="strong strong"><strong>Settings</strong></span> tab on the right side of the test scenario designer to display the attributes.
							</li><li class="listitem"><p class="simpara">
								Configure the following attributes in the <span class="strong strong"><strong>Settings</strong></span> panel:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<span class="strong strong"><strong>Name</strong></span>: You can change the name of the existing test scenarios by using the <span class="strong strong"><strong>Rename</strong></span> option from the upper-right toolbar in the designer.
									</li><li class="listitem">
										<span class="strong strong"><strong>Type</strong></span>: This attribute specifies it is a rule-based test scenario and it is read-only.
									</li><li class="listitem"><p class="simpara">
										<span class="strong strong"><strong>Stateless Session</strong></span>: Select or clear this check box to specify if the KieSession is stateless or not.
									</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											If the current KieSession is stateless and the check box is not selected, the tests will fail.
										</p></div></div></li><li class="listitem">
										<span class="strong strong"><strong>KieSession</strong></span>: (Optional) Enter the KieSession for the test scenario.
									</li><li class="listitem">
										<span class="strong strong"><strong>RuleFlowGroup/AgendaGroup</strong></span>: (Optional) Enter the RuleFlowGroup or AgendaGroup for the test scenario.
									</li></ul></div></li><li class="listitem">
								Optional: To skip the entire simulation from project level after test execution, select the check box.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Save</strong></span>.
							</li></ol></div></section><section class="section" id="test-designer-global-settings-panel-dmn-based-proc"><div class="titlepage"><div><div><h3 class="title">62.9.2. Configuring global settings for DMN-based test scenarios</h3></div></div></div><p>
						Follow the procedure below to view and edit the global settings of DMN-based test scenarios.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Click <span class="strong strong"><strong>Settings</strong></span> tab on the right side of the test scenario designer to display the attributes.
							</li><li class="listitem"><p class="simpara">
								Configure the following attributes in the <span class="strong strong"><strong>Settings</strong></span> panel:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<span class="strong strong"><strong>Name</strong></span>: You can change the name of the existing test scenarios by using the <span class="strong strong"><strong>Rename</strong></span> option from the upper-right toolbar in the designer.
									</li><li class="listitem">
										<span class="strong strong"><strong>Type</strong></span>: This attribute specifies it is a DMN-based test scenario and it is read-only.
									</li><li class="listitem">
										<span class="strong strong"><strong>DMN model</strong></span>: (Optional) Enter the DMN model for the test scenario.
									</li><li class="listitem">
										<span class="strong strong"><strong>DMN name</strong></span>: This is the name of the DMN model and it is read-only.
									</li><li class="listitem">
										<span class="strong strong"><strong>DMN namespace</strong></span>: This is the default namespace for DMN model and it is read-only.
									</li></ul></div></li><li class="listitem">
								Optional: To skip the entire simulation from project level after test execution, select the check box.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Save</strong></span>.
							</li></ol></div></section></section></section><section class="chapter" id="test-designer-create-test-scenario-template-con"><div class="titlepage"><div><div><h2 class="title">Chapter 63. Test scenario template</h2></div></div></div><p>
				Before specifying test scenario definitions, you need to create a test scenario template. The header of the test scenario table defines the template for each scenario. You need to set the types of the instance and property headers for both the GIVEN and EXPECT sections. Instance headers map to a particular data object (a fact), whereas the property headers map to a particular field of the corresponding data object.
			</p><p>
				Using the test scenarios designer, you can create test scenario templates for both rule-based and DMN-based test scenarios.
			</p><section class="section" id="test-designer-create-test-template-rule-based-proc"><div class="titlepage"><div><div><h2 class="title">63.1. Creating a test scenario template for rule-based test scenarios</h2></div></div></div><p>
					Create a test scenario template for rule-based test scenarios by following the procedure below to validate your rules and data.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project for which you want to create the test scenario.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Test Scenario</strong></span>.
						</li><li class="listitem">
							Enter a <span class="strong strong"><strong>Test Scenario</strong></span> name and select the appropriate <span class="strong strong"><strong>Package</strong></span>. The package you select must contain all the required data objects and rule assets have been assigned or will be assigned.
						</li><li class="listitem">
							Select <span class="strong strong"><strong>RULE</strong></span> as the <span class="strong strong"><strong>Source type</strong></span>.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Ok</strong></span> to create and open the test scenario in the test scenarios designer.
						</li><li class="listitem"><p class="simpara">
							To map the <span class="strong strong"><strong>GIVEN</strong></span> column header to a data object:
						</p><div class="figure" id="idm139921811848256"><p class="title"><strong>Figure 63.1. Test scenario GIVEN header cells</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/project-data/test_scenario_GIVEN_header_cells.png" alt="test scenario GIVEN header cells"/></div></div></div><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Select an instance header cell in the <span class="strong strong"><strong>GIVEN</strong></span> section.
								</li><li class="listitem">
									Select the data object from the <span class="strong strong"><strong>Test Tools</strong></span> tab.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Insert Data Object</strong></span>.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							To map the <span class="strong strong"><strong>EXPECT</strong></span> column header to a data object:
						</p><div class="figure" id="idm139921811836592"><p class="title"><strong>Figure 63.2. Test scenario EXPECT header cells</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/project-data/test_scenario_EXPECT_header_cells.png" alt="test scenario EXPECT header cells"/></div></div></div><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Select an instance header cell in the <span class="strong strong"><strong>EXPECT</strong></span> section.
								</li><li class="listitem">
									Select the data object from the <span class="strong strong"><strong>Test Tools</strong></span> tab.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Insert Data Object</strong></span>.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							To map a data object field to a property cell:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Select an instance header cell or property header cell.
								</li><li class="listitem">
									Select the data object field from the <span class="strong strong"><strong>Test Tools</strong></span> tab.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Insert Data Object</strong></span>.
								</li></ol></div></li><li class="listitem">
							To insert more properties of the data object, right-click the property header and select <span class="strong strong"><strong>Insert column right</strong></span> or <span class="strong strong"><strong>Insert column left</strong></span> as required.
						</li><li class="listitem"><p class="simpara">
							To define a java method to a property cell during test scenarios execution:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Select an instance header cell or property header cell.
								</li><li class="listitem">
									Select the data object field from the <span class="strong strong"><strong>Test Tools</strong></span> tab.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Insert Data Object</strong></span>.
								</li><li class="listitem">
									Use the MVEL expression with the prefix <span class="strong strong"><strong>#</strong></span> to define a java method for test scenario execution.
								</li><li class="listitem">
									To insert more properties of the data object, right-click the property header cell and select <span class="strong strong"><strong>Insert column right</strong></span> or <span class="strong strong"><strong>Insert column left</strong></span> as required.
								</li></ol></div></li><li class="listitem">
							Use the contextual menu to add or remove columns and rows as needed.
						</li></ol></div><p>
					For more details about the expression syntax in rule-based scenarios, see <a class="xref" href="#test-designer-expressions-syntax-rule-based-ref" title="68.1. Expression syntax in rule-based test scenarios">Section 68.1, “Expression syntax in rule-based test scenarios”</a>.
				</p></section><section class="section" id="test-designer-alias-proc"><div class="titlepage"><div><div><h2 class="title">63.2. Using aliases in rule-based test scenarios</h2></div></div></div><p>
					In the test scenarios designer, once you map a header cell with a data object, the data object is removed from the <span class="strong strong"><strong>Test Tools</strong></span> tab. You can re-map a data object to another header cell by using an alias. Aliases enable you to specify multiple instances of the same data object in a test scenario. You can also create property aliases to rename the used properties directly in the table.
				</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						In the test scenarios designer in Business Central, double-click a header cell and manually change the name. Ensure that the aliases are uniquely named.
					</p></div><p>
					The instance now appears in the list of data objects in the <span class="strong strong"><strong>Test Tools</strong></span> tab.
				</p></section></section><section class="chapter" id="test-designer-test-template-dmn-based-con"><div class="titlepage"><div><div><h2 class="title">Chapter 64. Test template for DMN-based test scenarios</h2></div></div></div><p>
				Business Central automatically generates the template for every DMN-based test scenario asset and it contains all the specified inputs and decisions of the related DMN model. For each input node in the DMN model, a <span class="strong strong"><strong>GIVEN</strong></span> column is added, whereas each decision node is represented by an <span class="strong strong"><strong>EXPECT</strong></span> column. You can modify the default template at any time as per your needs. Also, to test only a specific part of the whole DMN model, its possible to remove the generated columns as well as move decision nodes from the EXPECT to the GIVEN section.
			</p><section class="section" id="test-designer-create-test-template-dmn-based-proc"><div class="titlepage"><div><div><h2 class="title">64.1. Creating a test scenario template for DMN-based test scenarios</h2></div></div></div><p>
					Create a test scenario template for DMN-based scenarios by following the procedure below to validate your DMN models.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project that you want to create the test scenario for.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Test Scenario</strong></span>.
						</li><li class="listitem">
							Enter a <span class="strong strong"><strong>Test Scenario</strong></span> name and select the appropriate <span class="strong strong"><strong>Package</strong></span>.
						</li><li class="listitem">
							Select <span class="strong strong"><strong>DMN</strong></span> as the <span class="strong strong"><strong>Source type</strong></span>.
						</li><li class="listitem">
							Select an existing DMN asset using the <span class="strong strong"><strong>Choose DMN asset</strong></span> option.
						</li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Ok</strong></span> to create and open the test scenario in the test scenarios designer.
						</p><p class="simpara">
							The template is automatically generated and you can modify it as per your needs.
						</p></li><li class="listitem"><p class="simpara">
							To define a java method to a property cell during test scenario execution:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Click an instance header cell or property header cell.
								</li><li class="listitem">
									Select the data object field from the <span class="strong strong"><strong>Test Tools</strong></span> tab.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Insert Data Object</strong></span>.
								</li><li class="listitem">
									Use an expression to define a java method for test scenario execution.
								</li><li class="listitem">
									To add more properties to the data object, right-click the property header cell and select <span class="strong strong"><strong>Insert column right</strong></span> or <span class="strong strong"><strong>Insert column left</strong></span> as required.
								</li></ol></div></li><li class="listitem">
							Use the contextual menu to add or remove columns and rows as needed.
						</li></ol></div><p>
					For more details about the expression syntax in DMN-based scenarios, see <a class="xref" href="#test-designer-expressions-syntax-dmn-based-ref" title="68.2. Expression syntax in DMN-based scenarios">Section 68.2, “Expression syntax in DMN-based scenarios”</a>.
				</p></section></section><section class="chapter" id="test-designer-test-scenario-definition-proc"><div class="titlepage"><div><div><h2 class="title">Chapter 65. Defining a test scenario</h2></div></div></div><p>
				After creating a test scenario template you have to define the test scenario next. The rows of the test scenario table define the individual test scenarios. A test scenario has a unique index number, description, set of input values (the <span class="strong strong"><strong>Given</strong></span> values), and a set of output values (the <span class="strong strong"><strong>Expect</strong></span> values).
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The test scenario template has been created for the selected test scenario.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Open the test scenario in the test scenarios designer.
					</li><li class="listitem">
						Enter a description of the test scenario and fill in required values in each cell of the row.
					</li><li class="listitem"><p class="simpara">
						Use the contextual menu to add or remove rows as required.
					</p><p class="simpara">
						Double click a cell to start inline editing. To skip a particular cell from test evaluation, leave it empty.
					</p></li></ol></div><p>
				After defining the test scenario, you can run the test next.
			</p></section><section class="chapter" id="test-scenarios-background-instance-con"><div class="titlepage"><div><div><h2 class="title">Chapter 66. Background instance in test scenarios</h2></div></div></div><p>
				In test scenario designer, you can use the <span class="strong strong"><strong>Background</strong></span> tab to add and set background data for rules-based and DMN-based test scenarios. You can add and define the GIVEN data which is common for the entire test scenario simulation, based on the available data objects. <span class="strong strong"><strong>Background</strong></span> tab has the ability to add and share the data among every test scenario. Data added using the <span class="strong strong"><strong>Background</strong></span> tab can not be overridden by <span class="strong strong"><strong>Model</strong></span> tab data.
			</p><p>
				For example, if the test scenario example requires the same value for the person <code class="literal">Age</code> in all test scenarios, you can define the <code class="literal">Age</code> value in the <span class="strong strong"><strong>Background</strong></span> page and exclude that column from the test scenario table template. In this case, the <code class="literal">Age</code> is set to <code class="literal">25</code> for all test scenarios.
			</p><div class="figure" id="idm139921833198272"><p class="title"><strong>Figure 66.1. Example test scenarios with repeated value for Age</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/project-data/test_scenarios_with_repeated_value_for_Age.png" alt="test scenarios with repeated value for Age"/></div></div></div><div class="figure" id="idm139921833194336"><p class="title"><strong>Figure 66.2. Example background definition of repeated value for Age</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/project-data/background_definition_of_repeated_value_for_Age.png" alt="background definition of repeated value for Age"/></div></div></div><div class="figure" id="idm139921833190400"><p class="title"><strong>Figure 66.3. Modified test scenario template with excluded Age column</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/project-data/Modified_test_scenario_template_with_excluded_Age_column.png" alt="Modified test scenario template with excluded Age column"/></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The GIVEN data which is defined in the <span class="strong strong"><strong>Background</strong></span> tab can only be shared between the test scenarios of the same <span class="strong strong"><strong>*.scesim</strong></span> file and will not be shared among different test scenarios.
				</p></div></div><section class="section" id="test-scenarios-background-rule-based-proc"><div class="titlepage"><div><div><h2 class="title">66.1. Adding a background data in rule-based test scenarios</h2></div></div></div><p>
					Follow the procedure below to add and set a background data in rule-based test scenarios.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The rule-based test scenario template are created for the selected test scenario. For more information about creating rule-based test scenarios, see <a class="xref" href="#test-designer-create-test-template-rule-based-proc" title="63.1. Creating a test scenario template for rule-based test scenarios">Section 63.1, “Creating a test scenario template for rule-based test scenarios”</a>.
						</li><li class="listitem">
							The individual test scenarios are defined. For more information about defining a test scenario, see <a class="xref" href="#test-designer-test-scenario-definition-proc" title="Chapter 65. Defining a test scenario">Chapter 65, <em>Defining a test scenario</em></a>.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Open the rule-based test scenarios in the test scenario designer.
						</li><li class="listitem">
							Click the <span class="strong strong"><strong>Background</strong></span> tab of the test scenarios designer.
						</li><li class="listitem">
							Select an instance header cell in the <span class="strong strong"><strong>GIVEN</strong></span> section to add a background data object field.
						</li><li class="listitem">
							From the <span class="strong strong"><strong>Test Tools</strong></span> panel, select the data object.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Insert Data Object</strong></span>.
						</li><li class="listitem">
							Select a property header cell to add a background data object field.
						</li><li class="listitem">
							From the <span class="strong strong"><strong>Test Tools</strong></span> panel, select the data object.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Insert Data Object</strong></span>.
						</li><li class="listitem">
							To add more properties to the data object, right-click the property header cell and select <span class="strong strong"><strong>Insert column right</strong></span> or <span class="strong strong"><strong>Insert column left</strong></span> as required.
						</li><li class="listitem">
							Use the contextual menu to add or remove columns and rows as needed.
						</li><li class="listitem">
							Run the defined test scenarios.
						</li></ol></div></section><section class="section" id="test-scenarios-background-dmn-based-proc"><div class="titlepage"><div><div><h2 class="title">66.2. Adding a background data in DMN-based test scenarios</h2></div></div></div><p>
					Follow the procedure below to add and set a background data in DMN-based test scenarios.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The DMN-based test scenario template is created for the selected test scenario. For more information about creating DMN-based test scenarios, see <a class="xref" href="#test-designer-create-test-template-dmn-based-proc" title="64.1. Creating a test scenario template for DMN-based test scenarios">Section 64.1, “Creating a test scenario template for DMN-based test scenarios”</a>.
						</li><li class="listitem">
							The individual test scenarios are defined. For more information about defining a test scenario, see <a class="xref" href="#test-designer-test-scenario-definition-proc" title="Chapter 65. Defining a test scenario">Chapter 65, <em>Defining a test scenario</em></a>.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Open the DMN-based test scenarios in the test scenario designer.
						</li><li class="listitem">
							Click the <span class="strong strong"><strong>Background</strong></span> tab of the test scenarios designer.
						</li><li class="listitem">
							Select an instance header cell in the <span class="strong strong"><strong>GIVEN</strong></span> section to add a background data object field.
						</li><li class="listitem">
							From the <span class="strong strong"><strong>Test Tools</strong></span> panel, select the data object.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Insert Data Object</strong></span>.
						</li><li class="listitem">
							Select a property header cell to add a background data object field.
						</li><li class="listitem">
							From the <span class="strong strong"><strong>Test Tools</strong></span> panel, select the data object.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Insert Data Object</strong></span>.
						</li><li class="listitem">
							To add more properties to the data object, right-click the property header cell and select <span class="strong strong"><strong>Insert column right</strong></span> or <span class="strong strong"><strong>Insert column left</strong></span> as required.
						</li><li class="listitem">
							Use the contextual menu to add or remove columns and rows as needed.
						</li><li class="listitem">
							Run the defined test scenarios.
						</li></ol></div></section></section><section class="chapter" id="test-designer-list-map-add-remove-item-proc"><div class="titlepage"><div><div><h2 class="title">Chapter 67. Using list and map collections in test scenarios</h2></div></div></div><p>
				The test scenarios designer supports list and map collections for both DMN-based as well as rules-based test scenarios. You can create and define a collection like a list or a map ​as the value of a particular cell in both <span class="strong strong"><strong>GIVEN</strong></span> and <span class="strong strong"><strong>EXPECT</strong></span> columns.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					For map entries, an entry key must be a <code class="literal">String</code> data type.
				</p></div></div><p>
				To pass the parameter in the <span class="strong strong"><strong>EXPECT</strong></span> column of Rule-based collection editor use the <code class="literal">actualValue</code> keyword whereas use the <code class="literal">?</code> keyword in DMN-based test scenario.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Set the column type first (use a field whose type is a list or a map).
					</li><li class="listitem">
						Double click a cell in the column to input a value.
					</li><li class="listitem"><p class="simpara">
						To create the list values for the data objects in the collection editor popup:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Select <span class="strong strong"><strong>Create List</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Add new item</strong></span>.
							</li><li class="listitem">
								Enter the required value and click the check icon 
								<span class="inlinemediaobject"><img src="images/_images/dmn/dmn-datatype-constraints-tickmark.png" alt="dmn datatype constraints tickmark"/></span>
								 to save each collection item that you add.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Save</strong></span>.
							</li><li class="listitem">
								To edit an item from the collection, click the pencil icon in the collection popup editor.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Save changes</strong></span>.
							</li><li class="listitem">
								To delete an item from the collection, click the bin icon in the collection popup editor.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						To define the list values for the data objects in the collection editor popup:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Select <span class="strong strong"><strong>Define List</strong></span>.
							</li><li class="listitem"><p class="simpara">
								Use the MVEL or FEEL expression to define a list value in the text field.
							</p><p class="simpara">
								Rule-based test scenario uses MVEL expression language and DMN-based test scenario uses FEEL expression language.
							</p></li><li class="listitem">
								Click <span class="strong strong"><strong>Save</strong></span>.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						To create the map values for the data objects in the collection editor popup:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Select <span class="strong strong"><strong>Create Map</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Add new item</strong></span>.
							</li><li class="listitem">
								Enter the required value and click the check icon 
								<span class="inlinemediaobject"><img src="images/_images/dmn/dmn-datatype-constraints-tickmark.png" alt="dmn datatype constraints tickmark"/></span>
								 to save each collection item that you add.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Save</strong></span>.
							</li><li class="listitem">
								To edit an item from the collection, click the pencil icon in the collection popup editor.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Save changes</strong></span>.
							</li><li class="listitem">
								To delete an item from the collection, click the bin icon in the collection popup editor.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						To define the map values for the data objects in the collection editor popup:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Select <span class="strong strong"><strong>Define Map</strong></span>.
							</li><li class="listitem"><p class="simpara">
								Use the MVEL or FEEL expression to define a map value in the text field.
							</p><p class="simpara">
								Rule-based test scenario uses MVEL expression language and DMN-based test scenario uses FEEL expression language.
							</p></li><li class="listitem"><p class="simpara">
								Click <span class="strong strong"><strong>Save</strong></span>.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									To define the map values for DMN-based test scenario, you can add a fact and use the FEEL expression, instead of using the collection editor.
								</p></div></div></li></ol></div></li><li class="listitem">
						Click <span class="strong strong"><strong>Remove</strong></span> to delete the entire collection.
					</li></ol></div></section><section class="chapter" id="test-designer-expressions-syntax-intro-ref"><div class="titlepage"><div><div><h2 class="title">Chapter 68. Expression syntax in test scenarios</h2></div></div></div><p>
				The test scenarios designer supports different expression languages for both rule-based and DMN-based test scenarios. While rule-based test scenarios support the MVFLEX Expression Language (MVEL) and DMN-based test scenarios support the Friendly Enough Expression Language (FEEL).
			</p><section class="section" id="test-designer-expressions-syntax-rule-based-ref"><div class="titlepage"><div><div><h2 class="title">68.1. Expression syntax in rule-based test scenarios</h2></div></div></div><p>
					Rule-based test scenario supports the following built-in data types:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							String
						</li><li class="listitem">
							Boolean
						</li><li class="listitem">
							Integer
						</li><li class="listitem">
							Long
						</li><li class="listitem">
							Double
						</li><li class="listitem">
							Float
						</li><li class="listitem">
							Character
						</li><li class="listitem">
							Byte
						</li><li class="listitem">
							Short
						</li><li class="listitem">
							LocalDate
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						For any other data types, use the MVEL expression with the prefix <code class="literal">#</code>.
					</p></div></div><p>
					Follow the BigDecimal example in the test scenario designer to use the <code class="literal">#</code> prefix to set the java expression:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Enter <code class="literal"># java.math.BigDecimal.valueOf(10)</code> for the <span class="strong strong"><strong>GIVEN</strong></span> column value.
						</li><li class="listitem">
							Enter <code class="literal"># actualValue.intValue() == 10</code> for the <span class="strong strong"><strong>EXPECT</strong></span> column value.
						</li></ul></div><p>
					You can refer to the actual value of the <span class="strong strong"><strong>EXPECT</strong></span> column in the java expression to execute a condition.
				</p><p>
					The following rule-based test scenario definition expressions are supported by the test scenarios designer:
				</p><div class="table" id="idm139921833052032"><p class="title"><strong>Table 68.1. Description of expressions syntax</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"/><col style="width: 67%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921833046448" scope="col">Operator</th><th align="left" valign="top" id="idm139921833045360" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921833046448">
								<p>
									=
								</p>
								</td><td align="left" valign="top" headers="idm139921833045360">
								<p>
									Specifies equal to a value. This is default for all columns and is the only operator supported by the GIVEN column.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921833046448">
								<p>
									=, =!, &lt;&gt;
								</p>
								</td><td align="left" valign="top" headers="idm139921833045360">
								<p>
									Specifies inequality of a value. This operator can be combined with other operators.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921833046448">
								<p>
									&lt;, &gt;, &lt;=, &gt;=
								</p>
								</td><td align="left" valign="top" headers="idm139921833045360">
								<p>
									Specifies a comparison: less than, greater than, less or equals than, and greater or equals than.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921833046448">
								<p>
									#
								</p>
								</td><td align="left" valign="top" headers="idm139921833045360">
								<p>
									This operator is used to set the java expression value to a property header cell which can be executed as a java method.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921833046448">
								<p>
									[value1, value2, value3]
								</p>
								</td><td align="left" valign="top" headers="idm139921833045360">
								<p>
									Specifies a list of values. If one or more values are valid, the scenario definition is evaluated as true.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921833046448">
								<p>
									expression1; expression2; expression3
								</p>
								</td><td align="left" valign="top" headers="idm139921833045360">
								<p>
									Specifies a list of expressions. If all expressions are valid, the scenario definition is evaluated as true.
								</p>
								</td></tr></tbody></table></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						An empty cell is skipped from evaluation. To define an empty string, use <code class="literal">=</code>,<code class="literal">[]</code>, or <code class="literal">;</code>. To define a null value, use <code class="literal">null</code>.
					</p></div></div><div class="table" id="idm139921833017712"><p class="title"><strong>Table 68.2. Example expressions</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 18%; " class="col_1"/><col style="width: 82%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921833012144" scope="col">Expression</th><th align="left" valign="top" id="idm139921833011056" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921833012144">
								<p>
									-1
								</p>
								</td><td align="left" valign="top" headers="idm139921833011056">
								<p>
									The actual value is equal to -1.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921833012144">
								<p>
									&lt; 0
								</p>
								</td><td align="left" valign="top" headers="idm139921833011056">
								<p>
									The actual value is less than 0.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921833012144">
								<p>
									! &gt; 0
								</p>
								</td><td align="left" valign="top" headers="idm139921833011056">
								<p>
									The actual value is not greater than 0.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921833012144">
								<p>
									[-1, 0, 1]
								</p>
								</td><td align="left" valign="top" headers="idm139921833011056">
								<p>
									The actual value is equal to either -1 or 0 or 1.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921833012144">
								<p>
									&lt;&gt; [1, -1]
								</p>
								</td><td align="left" valign="top" headers="idm139921833011056">
								<p>
									The actual value is neither equal to 1 nor -1.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921833012144">
								<p>
									! 100; 0
								</p>
								</td><td align="left" valign="top" headers="idm139921833011056">
								<p>
									The actual value is not equal to 100 but is equal to 0.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921833012144">
								<p>
									!= &lt; 0; &lt;&gt; &gt; 1
								</p>
								</td><td align="left" valign="top" headers="idm139921833011056">
								<p>
									The actual value is neither less than 0 nor greater than 1.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921833012144">
								<p>
									&lt;&gt; &lt;= 0; &gt;= 1
								</p>
								</td><td align="left" valign="top" headers="idm139921833011056">
								<p>
									The actual value is neither less than 0 nor equal to 0 but is greater than or equal to 1.
								</p>
								</td></tr></tbody></table></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						You can refer to the supported commands and syntax in the <span class="strong strong"><strong>Scenario Cheatsheet</strong></span> tab on the right of the rule-based test scenarios designer.
					</p></div></div></section><section class="section" id="test-designer-expressions-syntax-dmn-based-ref"><div class="titlepage"><div><div><h2 class="title">68.2. Expression syntax in DMN-based scenarios</h2></div></div></div><p>
					The following data types are supported by the DMN-based test scenarios in the test scenarios designer:
				</p><div class="table" id="idm139921832975264"><p class="title"><strong>Table 68.3. Data types supported by DMN-based scenarios</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"/><col style="width: 67%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921832969664" scope="col">Supported data types</th><th align="left" valign="top" id="idm139921832968576" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921832969664">
								<p>
									numbers &amp; strings
								</p>
								</td><td align="left" valign="top" headers="idm139921832968576">
								<p>
									Strings must be delimited by quotation marks, for example, <code class="literal">"John Doe"</code>, <code class="literal">"Brno"</code> or <code class="literal">""</code>.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921832969664">
								<p>
									boolean values
								</p>
								</td><td align="left" valign="top" headers="idm139921832968576">
								<p>
									<code class="literal">true</code>, <code class="literal">false</code>, and <code class="literal">null</code>.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921832969664">
								<p>
									dates and time
								</p>
								</td><td align="left" valign="top" headers="idm139921832968576">
								<p>
									For example, <code class="literal">date("2019-05-13")</code> or <code class="literal">time("14:10:00+02:00")</code>.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921832969664">
								<p>
									functions
								</p>
								</td><td align="left" valign="top" headers="idm139921832968576">
								<p>
									Supports built-in math functions, for example, <code class="literal">avg</code>, <code class="literal">max</code>.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921832969664">
								<p>
									contexts
								</p>
								</td><td align="left" valign="top" headers="idm139921832968576">
								<p>
									For example, <code class="literal">{x : 5, y : 3}</code>.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921832969664">
								<p>
									ranges and lists
								</p>
								</td><td align="left" valign="top" headers="idm139921832968576">
								<p>
									For example, <code class="literal">[1 .. 10]</code> or <code class="literal">[2, 3, 4, 5]</code>.
								</p>
								</td></tr></tbody></table></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						You can refer to the supported commands and syntax in the <span class="strong strong"><strong>Scenario Cheatsheet</strong></span> tab on the right of the DMN-based test scenarios designer.
					</p></div></div></section></section><section class="chapter" id="test-designer-run-test-proc"><div class="titlepage"><div><div><h2 class="title">Chapter 69. Running the test scenarios</h2></div></div></div><p>
				After creating a test scenario template and defining the test scenarios, you can run the tests to validate your business rules and data.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To run defined test scenarios, do any of the following tasks:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To execute all the available test scenarios in your project inside multiple assets, in the upper-right corner of your project page, click <span class="strong strong"><strong>Test</strong></span>.
							</p><div class="figure" id="idm139921832930176"><p class="title"><strong>Figure 69.1. Run all the test scenarios from the project view</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/AuthoringAssets/test-scenarios-run-all-tests-button.png" alt="Run all the test scenarios from the project view"/></div></div></div></li><li class="listitem">
								To execute all available test scenarios defined in a <code class="literal">.scesim</code> file, at the top of the Test Scenario designer, click the <span class="strong strong"><strong>Run Test</strong></span> <span class="inlinemediaobject"><img src="images/_images/AuthoringAssets/test-scenarios-run-test-icon.png" alt="Run Test icon"/></span>
								 icon.
							</li><li class="listitem">
								To run a single test scenario defined in a single <code class="literal">.scesim</code> file, right-click the row of the test scenario you want to run and select <span class="strong strong"><strong>Run scenario</strong></span>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						The <span class="strong strong"><strong>Test Report</strong></span> panel displays the overview of the tests and the scenario status.
					</p><p class="simpara">
						After the tests execute, if the values entered in the test scenario table do not match with the expected values, then the corresponding cells are highlighted.
					</p></li><li class="listitem"><p class="simpara">
						If tests fail, you can do the following tasks to troubleshoot the failure:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								To review the error message in the pop-up window, hover your mouse cursor over the highlighted cell.
							</li><li class="listitem">
								To open the <span class="strong strong"><strong>Alerts</strong></span> panel at the bottom of the designer or the project view for the error messages, click <span class="strong strong"><strong>View Alerts</strong></span>.
							</li><li class="listitem">
								Make the necessary changes and run the test again until the scenario passes.
							</li></ul></div></li></ol></div></section><section class="chapter" id="test-scenarios-running-locally-proc"><div class="titlepage"><div><div><h2 class="title">Chapter 70. Running a test scenario locally</h2></div></div></div><p>
				In Red Hat Process Automation Manager, you can either run the test scenarios directly in Business Central or locally using the command line.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
					</li><li class="listitem">
						On the Project’s home page, select the <span class="strong strong"><strong>Settings</strong></span> tab.
					</li><li class="listitem">
						Select <span class="strong strong"><strong>git</strong></span> <span class="strong strong"><strong>URL</strong></span> and click the <span class="strong strong"><strong>Clipboard</strong></span> <span class="inlinemediaobject"><img src="images/_images/AuthoringAssets/test-scenarios-clipboard-icon.png" alt="Copy to clipboard icon"/></span>
						 to copy the git url.
					</li><li class="listitem">
						Open a command terminal and navigate to the directory where you want to clone the git project.
					</li><li class="listitem"><p class="simpara">
						Run the following command:
					</p><pre class="screen">git clone your_git_project_url</pre><p class="simpara">
						Replace <code class="literal">your_git_project_url</code> with relevant data like <code class="literal">git://localhost:9418/MySpace/ProjectTestScenarios</code>.
					</p></li><li class="listitem"><p class="simpara">
						Once the project is successfully cloned, navigate to the git project directory and execute the following command:
					</p><pre class="screen">mvn clean test</pre><p class="simpara">
						Your project’s build information and the test results (such as, the number of tests run and whether the test run was a success or not) are displayed in the command terminal. In case of failures, make the necessary changes in Business Central, pull the changes and run the command again.
					</p></li></ol></div></section><section class="chapter" id="test-designer-test-scenario-export-import-spreadsheet-con"><div class="titlepage"><div><div><h2 class="title">Chapter 71. Exporting and importing test scenario spreadsheets</h2></div></div></div><p>
				These sections show how to export and import test scenario spreadsheets in the test scenario designer. You can analyze and manage test scenario spreadsheets with software such as Microsoft Excel or LibreOffice Calc. Test scenario designer supports the <code class="literal">.CSV</code> file format. For more information about the RFC specification for the Comma-Separated Values (CSV) format, see <a class="link" href="https://tools.ietf.org/html/rfc4180">Common Format and MIME Type for Comma-Separated Values (CSV) Files</a>.
			</p><section class="section" id="test-designer-test-scenario-export-spreadsheet-proc"><div class="titlepage"><div><div><h2 class="title">71.1. Exporting a test scenario spreadsheet</h2></div></div></div><p>
					Follow the procedure below to export a test scenario spreadsheet using the Test Scenario designer.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the Test Scenario designer toolbar on the upper-right, click <span class="strong strong"><strong>Export</strong></span> <span class="inlinemediaobject"><img src="images/_images/AuthoringAssets/test-scenarios-export-button.png" alt="test scenarios export button"/></span>
							 button.
						</li><li class="listitem">
							Select a destination in your local file directory and confirm to save the <code class="literal">.CSV</code> file.
						</li></ol></div><p>
					The <code class="literal">.CSV</code> file is exported to your local machine.
				</p></section><section class="section" id="test-designer-test-scenario-import-spreadsheet-proc"><div class="titlepage"><div><div><h2 class="title">71.2. Importing a test scenario spreadsheet</h2></div></div></div><p>
					Follow the procedure below to import a test scenario spreadsheet using the Test Scenario designer.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the Test Scenario designer toolbar on the upper-right, click <span class="strong strong"><strong>Import</strong></span> <span class="inlinemediaobject"><img src="images/_images/AuthoringAssets/test-scenarios-import-button.png" alt="test scenarios import button"/></span>
							 button.
						</li><li class="listitem">
							In the <span class="strong strong"><strong>Select file to Import</strong></span> prompt, click <span class="strong strong"><strong>Choose File…​</strong></span> and select the <code class="literal">.CSV</code> file you would like to import from your local file directory.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Import</strong></span>.
						</li></ol></div><p>
					The <code class="literal">.CSV</code> file is imported to the Test Scenario designer.
				</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						You must not modify the headers in the selected <code class="literal">.CSV</code> file. Otherwise, the spreadsheet may not be successfully imported.
					</p></div></div></section></section><section class="chapter" id="test-scenarios-coverage-report-con"><div class="titlepage"><div><div><h2 class="title">Chapter 72. Coverage reports for test scenarios</h2></div></div></div><p>
				The test scenario designer provides a clear and coherent way of displaying the test coverage statistics using the <span class="strong strong"><strong>Coverage Report</strong></span> tab on the right side of the test scenario designer. You can also download the coverage report to view and analyze the test coverage statistics. Downloaded test scenario coverage report supports the <code class="literal">.CSV</code> file format. For more information about the RFC specification for the Comma-Separated Values (CSV) format, see <a class="link" href="https://tools.ietf.org/html/rfc4180">Common Format and MIME Type for Comma-Separated Values (CSV) Files</a>.
			</p><p>
				You can view the coverage report for rule-based and DMN-based test scenarios.
			</p><section class="section" id="test-scenarios-coverage-report-rule-based-proc"><div class="titlepage"><div><div><h2 class="title">72.1. Generating coverage reports for rule-based test scenarios</h2></div></div></div><p>
					In rule-based test scenarios, the <span class="strong strong"><strong>Coverage Report</strong></span> tab contains the detailed information about the following:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Number of available rules
						</li><li class="listitem">
							Number of fired rules
						</li><li class="listitem">
							Percentage of fired rules
						</li><li class="listitem">
							Percentage of executed rules represented as a pie chart
						</li><li class="listitem">
							Number of times each rule has executed
						</li><li class="listitem">
							The rules that are executed for each defined test scenario
						</li></ul></div><p>
					Follow the procedure to generate a coverage report for rule-based test scenarios:
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The rule-based test scenario template are created for the selected test scenario. For more information about creating rule-based test scenarios, see <a class="xref" href="#test-designer-create-test-template-rule-based-proc" title="63.1. Creating a test scenario template for rule-based test scenarios">Section 63.1, “Creating a test scenario template for rule-based test scenarios”</a>.
						</li><li class="listitem"><p class="simpara">
							The individual test scenarios are defined. For more information about defining a test scenario, see <a class="xref" href="#test-designer-test-scenario-definition-proc" title="Chapter 65. Defining a test scenario">Chapter 65, <em>Defining a test scenario</em></a>.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								To generate the coverage report for rule-based test scenario, you must create at least one rule.
							</p></div></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Open the rule-based test scenarios in the test scenario designer.
						</li><li class="listitem">
							Run the defined test scenarios.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Coverage Report</strong></span> on the right of the test scenario designer to display the test coverage statistics.
						</li><li class="listitem">
							Optional: To download the test scenario coverage report, Click <span class="strong strong"><strong>Download report</strong></span>.
						</li></ol></div></section><section class="section" id="test-scenarios-coverage-report-dmn-based-proc"><div class="titlepage"><div><div><h2 class="title">72.2. Generating coverage reports for DMN-based test scenarios</h2></div></div></div><p>
					In DMN-based test scenarios, the <span class="strong strong"><strong>Coverage Report</strong></span> tab contains the detailed information about the following:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Number of available decisions
						</li><li class="listitem">
							Number of executed decisions
						</li><li class="listitem">
							Percentage of executed decisions
						</li><li class="listitem">
							Percentage of executed decisions represented as a pie chart
						</li><li class="listitem">
							Number of times each decision has executed
						</li><li class="listitem">
							Decisions that are executed for each defined test scenario
						</li></ul></div><p>
					Follow the procedure to generate a coverage report for DMN-based test scenarios:
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The DMN-based test scenario template is created for the selected test scenario. For more information about creating DMN-based test scenarios, see <a class="xref" href="#test-designer-create-test-template-dmn-based-proc" title="64.1. Creating a test scenario template for DMN-based test scenarios">Section 64.1, “Creating a test scenario template for DMN-based test scenarios”</a>.
						</li><li class="listitem">
							The individual test scenarios are defined. For more information about defining a test scenario, see <a class="xref" href="#test-designer-test-scenario-definition-proc" title="Chapter 65. Defining a test scenario">Chapter 65, <em>Defining a test scenario</em></a>.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Open the DMN-based test scenarios in the test scenario designer.
						</li><li class="listitem">
							Run the defined test scenarios.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Coverage Report</strong></span> on the right of the test scenario designer to display the test coverage statistics.
						</li><li class="listitem">
							Optional: To download the test scenario coverage report, Click <span class="strong strong"><strong>Download report</strong></span>.
						</li></ol></div></section></section><section class="chapter" id="test-scenarios-execution-rest-api-proc"><div class="titlepage"><div><div><h2 class="title">Chapter 73. Executing a test scenario using the KIE Server REST API</h2></div></div></div><p>
				Directly interacting with the REST endpoints of KIE Server provides the most separation between the calling code and the decision logic definition. You can use the KIE Server REST API to execute the test scenarios externally. It executes the test scenarios against the deployed project.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					This functionality is disabled by default, use <code class="literal">org.kie.scenariosimulation.server.ext.disabled</code> system property to enable it.
				</p></div></div><p>
				For more information about the KIE Server REST API, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-kie-apis"><span class="emphasis"><em>Interacting with Red Hat Process Automation Manager using KIE APIs</em></span></a>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						KIE Server is installed and configured, including a known user name and credentials for a user with the <code class="literal">kie-server</code> role. For installation options, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/installing_and_configuring_red_hat_process_automation_manager#assembly-planning"><span class="emphasis"><em>Planning a Red Hat Process Automation Manager installation</em></span></a>.
					</li><li class="listitem">
						You have built the project as a KJAR artifact and deployed it to KIE Server.
					</li><li class="listitem">
						You have the ID of the KIE container.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Determine the base URL for accessing the KIE Server REST API endpoints. This requires knowing the following values (with the default local deployment values as an example):
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Host (<code class="literal">localhost</code>)
							</li><li class="listitem">
								Port (<code class="literal">8080</code>)
							</li><li class="listitem">
								Root context (<code class="literal">kie-server</code>)
							</li><li class="listitem">
								Base REST path (<code class="literal">services/rest/</code>)
							</li></ul></div><p class="simpara">
						Example base URL in local deployment for the traffic violations project:
					</p><p class="simpara">
						<code class="literal">http://localhost:8080/kie-server/services/rest/server/containers/traffic_1.0.0-SNAPSHOT</code>
					</p></li><li class="listitem"><p class="simpara">
						Determine user authentication requirements.
					</p><p class="simpara">
						When users are defined directly in the KIE Server configuration, HTTP Basic authentication is used and requires the user name and password. Successful requests require that the user have the <code class="literal">kie-server</code> role.
					</p><p class="simpara">
						The following example demonstrates how to add credentials to a curl request:
					</p><pre class="screen">curl -u username:password &lt;request&gt;</pre><p class="simpara">
						If KIE Server is configured with Red Hat Single Sign-On, the request must include a bearer token:
					</p><pre class="programlisting language-java">curl -H "Authorization: bearer $TOKEN" &lt;request&gt;</pre></li><li class="listitem"><p class="simpara">
						Specify the format of the request and response. The REST API endpoints work with XML format and are set using request headers:
					</p><div class="formalpara"><p class="title"><strong>XML</strong></p><p>
							
<pre class="screen">curl -H "accept: application/xml" -H "content-type: application/xml"</pre>
						</p></div></li><li class="listitem"><p class="simpara">
						Execute the test scenario:
					</p><p class="simpara">
						<span class="strong strong"><strong>[POST]</strong></span> <code class="literal">server/containers/{containerId}/scesim</code>
					</p><p class="simpara">
						Example curl request:
					</p><pre class="screen">curl -X POST "http://localhost:8080/kie-server/services/rest/server/containers/traffic_1.0.0-SNAPSHOT/scesim"\ -u 'wbadmin:wbadmin;' \ -H "accept: application/xml" -H "content-type: application/xml"\ -d @Violation.scesim</pre><p class="simpara">
						Example XML request:
					</p><pre class="programlisting language-xml">&lt;ScenarioSimulationModel version="1.8"&gt;
  &lt;simulation&gt;
    &lt;scesimModelDescriptor&gt;
      &lt;factMappings&gt;
        &lt;FactMapping&gt;
          &lt;expressionElements/&gt;
          &lt;expressionIdentifier&gt;
            &lt;name&gt;Index&lt;/name&gt;
            &lt;type&gt;OTHER&lt;/type&gt;
          &lt;/expressionIdentifier&gt;
          &lt;factIdentifier&gt;
            &lt;name&gt;#&lt;/name&gt;
            &lt;className&gt;java.lang.Integer&lt;/className&gt;
          &lt;/factIdentifier&gt;
          &lt;className&gt;java.lang.Integer&lt;/className&gt;
          &lt;factAlias&gt;#&lt;/factAlias&gt;
          &lt;factMappingValueType&gt;NOT_EXPRESSION&lt;/factMappingValueType&gt;
          &lt;columnWidth&gt;70.0&lt;/columnWidth&gt;
        &lt;/FactMapping&gt;
        &lt;FactMapping&gt;
          &lt;expressionElements/&gt;
          &lt;expressionIdentifier&gt;
            &lt;name&gt;Description&lt;/name&gt;
            &lt;type&gt;OTHER&lt;/type&gt;
          &lt;/expressionIdentifier&gt;
          &lt;factIdentifier&gt;
            &lt;name&gt;Scenario description&lt;/name&gt;
            &lt;className&gt;java.lang.String&lt;/className&gt;
          &lt;/factIdentifier&gt;
          &lt;className&gt;java.lang.String&lt;/className&gt;
          &lt;factAlias&gt;Scenario description&lt;/factAlias&gt;
          &lt;factMappingValueType&gt;NOT_EXPRESSION&lt;/factMappingValueType&gt;
          &lt;columnWidth&gt;300.0&lt;/columnWidth&gt;
        &lt;/FactMapping&gt;
        &lt;FactMapping&gt;
          &lt;expressionElements&gt;
            &lt;ExpressionElement&gt;
              &lt;step&gt;Driver&lt;/step&gt;
            &lt;/ExpressionElement&gt;
            &lt;ExpressionElement&gt;
              &lt;step&gt;Points&lt;/step&gt;
            &lt;/ExpressionElement&gt;
          &lt;/expressionElements&gt;
          &lt;expressionIdentifier&gt;
            &lt;name&gt;0|1&lt;/name&gt;
            &lt;type&gt;GIVEN&lt;/type&gt;
          &lt;/expressionIdentifier&gt;
          &lt;factIdentifier&gt;
            &lt;name&gt;Driver&lt;/name&gt;
            &lt;className&gt;Driver&lt;/className&gt;
          &lt;/factIdentifier&gt;
          &lt;className&gt;number&lt;/className&gt;
          &lt;factAlias&gt;Driver&lt;/factAlias&gt;
          &lt;expressionAlias&gt;Points&lt;/expressionAlias&gt;
          &lt;factMappingValueType&gt;NOT_EXPRESSION&lt;/factMappingValueType&gt;
          &lt;columnWidth&gt;114.0&lt;/columnWidth&gt;
        &lt;/FactMapping&gt;
        &lt;FactMapping&gt;
          &lt;expressionElements&gt;
            &lt;ExpressionElement&gt;
              &lt;step&gt;Violation&lt;/step&gt;
            &lt;/ExpressionElement&gt;
            &lt;ExpressionElement&gt;
              &lt;step&gt;Type&lt;/step&gt;
            &lt;/ExpressionElement&gt;
          &lt;/expressionElements&gt;
          &lt;expressionIdentifier&gt;
            &lt;name&gt;0|6&lt;/name&gt;
            &lt;type&gt;GIVEN&lt;/type&gt;
          &lt;/expressionIdentifier&gt;
          &lt;factIdentifier&gt;
            &lt;name&gt;Violation&lt;/name&gt;
            &lt;className&gt;Violation&lt;/className&gt;
          &lt;/factIdentifier&gt;
          &lt;className&gt;Type&lt;/className&gt;
          &lt;factAlias&gt;Violation&lt;/factAlias&gt;
          &lt;expressionAlias&gt;Type&lt;/expressionAlias&gt;
          &lt;factMappingValueType&gt;NOT_EXPRESSION&lt;/factMappingValueType&gt;
          &lt;columnWidth&gt;114.0&lt;/columnWidth&gt;
        &lt;/FactMapping&gt;
        &lt;FactMapping&gt;
          &lt;expressionElements&gt;
            &lt;ExpressionElement&gt;
              &lt;step&gt;Violation&lt;/step&gt;
            &lt;/ExpressionElement&gt;
            &lt;ExpressionElement&gt;
              &lt;step&gt;Speed Limit&lt;/step&gt;
            &lt;/ExpressionElement&gt;
          &lt;/expressionElements&gt;
          &lt;expressionIdentifier&gt;
            &lt;name&gt;0|7&lt;/name&gt;
            &lt;type&gt;GIVEN&lt;/type&gt;
          &lt;/expressionIdentifier&gt;
          &lt;factIdentifier&gt;
            &lt;name&gt;Violation&lt;/name&gt;
            &lt;className&gt;Violation&lt;/className&gt;
          &lt;/factIdentifier&gt;
          &lt;className&gt;number&lt;/className&gt;
          &lt;factAlias&gt;Violation&lt;/factAlias&gt;
          &lt;expressionAlias&gt;Speed Limit&lt;/expressionAlias&gt;
          &lt;factMappingValueType&gt;NOT_EXPRESSION&lt;/factMappingValueType&gt;
          &lt;columnWidth&gt;114.0&lt;/columnWidth&gt;
        &lt;/FactMapping&gt;
        &lt;FactMapping&gt;
          &lt;expressionElements&gt;
            &lt;ExpressionElement&gt;
              &lt;step&gt;Violation&lt;/step&gt;
            &lt;/ExpressionElement&gt;
            &lt;ExpressionElement&gt;
              &lt;step&gt;Actual Speed&lt;/step&gt;
            &lt;/ExpressionElement&gt;
          &lt;/expressionElements&gt;
          &lt;expressionIdentifier&gt;
            &lt;name&gt;0|8&lt;/name&gt;
            &lt;type&gt;GIVEN&lt;/type&gt;
          &lt;/expressionIdentifier&gt;
          &lt;factIdentifier&gt;
            &lt;name&gt;Violation&lt;/name&gt;
            &lt;className&gt;Violation&lt;/className&gt;
          &lt;/factIdentifier&gt;
          &lt;className&gt;number&lt;/className&gt;
          &lt;factAlias&gt;Violation&lt;/factAlias&gt;
          &lt;expressionAlias&gt;Actual Speed&lt;/expressionAlias&gt;
          &lt;factMappingValueType&gt;NOT_EXPRESSION&lt;/factMappingValueType&gt;
          &lt;columnWidth&gt;114.0&lt;/columnWidth&gt;
        &lt;/FactMapping&gt;
        &lt;FactMapping&gt;
          &lt;expressionElements&gt;
            &lt;ExpressionElement&gt;
              &lt;step&gt;Fine&lt;/step&gt;
            &lt;/ExpressionElement&gt;
            &lt;ExpressionElement&gt;
              &lt;step&gt;Points&lt;/step&gt;
            &lt;/ExpressionElement&gt;
          &lt;/expressionElements&gt;
          &lt;expressionIdentifier&gt;
            &lt;name&gt;0|11&lt;/name&gt;
            &lt;type&gt;EXPECT&lt;/type&gt;
          &lt;/expressionIdentifier&gt;
          &lt;factIdentifier&gt;
            &lt;name&gt;Fine&lt;/name&gt;
            &lt;className&gt;Fine&lt;/className&gt;
          &lt;/factIdentifier&gt;
          &lt;className&gt;number&lt;/className&gt;
          &lt;factAlias&gt;Fine&lt;/factAlias&gt;
          &lt;expressionAlias&gt;Points&lt;/expressionAlias&gt;
          &lt;factMappingValueType&gt;NOT_EXPRESSION&lt;/factMappingValueType&gt;
          &lt;columnWidth&gt;114.0&lt;/columnWidth&gt;
        &lt;/FactMapping&gt;
        &lt;FactMapping&gt;
          &lt;expressionElements&gt;
            &lt;ExpressionElement&gt;
              &lt;step&gt;Fine&lt;/step&gt;
            &lt;/ExpressionElement&gt;
            &lt;ExpressionElement&gt;
              &lt;step&gt;Amount&lt;/step&gt;
            &lt;/ExpressionElement&gt;
          &lt;/expressionElements&gt;
          &lt;expressionIdentifier&gt;
            &lt;name&gt;0|12&lt;/name&gt;
            &lt;type&gt;EXPECT&lt;/type&gt;
          &lt;/expressionIdentifier&gt;
          &lt;factIdentifier&gt;
            &lt;name&gt;Fine&lt;/name&gt;
            &lt;className&gt;Fine&lt;/className&gt;
          &lt;/factIdentifier&gt;
          &lt;className&gt;number&lt;/className&gt;
          &lt;factAlias&gt;Fine&lt;/factAlias&gt;
          &lt;expressionAlias&gt;Amount&lt;/expressionAlias&gt;
          &lt;factMappingValueType&gt;NOT_EXPRESSION&lt;/factMappingValueType&gt;
          &lt;columnWidth&gt;114.0&lt;/columnWidth&gt;
        &lt;/FactMapping&gt;
        &lt;FactMapping&gt;
          &lt;expressionElements&gt;
            &lt;ExpressionElement&gt;
              &lt;step&gt;Should the driver be suspended?&lt;/step&gt;
            &lt;/ExpressionElement&gt;
          &lt;/expressionElements&gt;
          &lt;expressionIdentifier&gt;
            &lt;name&gt;0|13&lt;/name&gt;
            &lt;type&gt;EXPECT&lt;/type&gt;
          &lt;/expressionIdentifier&gt;
          &lt;factIdentifier&gt;
            &lt;name&gt;Should the driver be suspended?&lt;/name&gt;
            &lt;className&gt;Should the driver be suspended?&lt;/className&gt;
          &lt;/factIdentifier&gt;
          &lt;className&gt;string&lt;/className&gt;
          &lt;factAlias&gt;Should the driver be suspended?&lt;/factAlias&gt;
          &lt;expressionAlias&gt;value&lt;/expressionAlias&gt;
          &lt;factMappingValueType&gt;NOT_EXPRESSION&lt;/factMappingValueType&gt;
          &lt;columnWidth&gt;114.0&lt;/columnWidth&gt;
        &lt;/FactMapping&gt;
      &lt;/factMappings&gt;
    &lt;/scesimModelDescriptor&gt;
    &lt;scesimData&gt;
      &lt;Scenario&gt;
        &lt;factMappingValues&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;Scenario description&lt;/name&gt;
              &lt;className&gt;java.lang.String&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;Description&lt;/name&gt;
              &lt;type&gt;OTHER&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;Above speed limit: 10km/h and 30 km/h&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;Driver&lt;/name&gt;
              &lt;className&gt;Driver&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;0|1&lt;/name&gt;
              &lt;type&gt;GIVEN&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;10&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;Violation&lt;/name&gt;
              &lt;className&gt;Violation&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;0|6&lt;/name&gt;
              &lt;type&gt;GIVEN&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;&amp;quot;speed&amp;quot;&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;Violation&lt;/name&gt;
              &lt;className&gt;Violation&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;0|7&lt;/name&gt;
              &lt;type&gt;GIVEN&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;100&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;Violation&lt;/name&gt;
              &lt;className&gt;Violation&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;0|8&lt;/name&gt;
              &lt;type&gt;GIVEN&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;120&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;Fine&lt;/name&gt;
              &lt;className&gt;Fine&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;0|11&lt;/name&gt;
              &lt;type&gt;EXPECT&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;3&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;Fine&lt;/name&gt;
              &lt;className&gt;Fine&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;0|12&lt;/name&gt;
              &lt;type&gt;EXPECT&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;500&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;Should the driver be suspended?&lt;/name&gt;
              &lt;className&gt;Should the driver be suspended?&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;0|13&lt;/name&gt;
              &lt;type&gt;EXPECT&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;&amp;quot;No&amp;quot;&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;#&lt;/name&gt;
              &lt;className&gt;java.lang.Integer&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;Index&lt;/name&gt;
              &lt;type&gt;OTHER&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;1&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
        &lt;/factMappingValues&gt;
      &lt;/Scenario&gt;
    &lt;/scesimData&gt;
  &lt;/simulation&gt;
  &lt;background&gt;
    &lt;scesimModelDescriptor&gt;
      &lt;factMappings&gt;
        &lt;FactMapping&gt;
          &lt;expressionElements/&gt;
          &lt;expressionIdentifier&gt;
            &lt;name&gt;1|1&lt;/name&gt;
            &lt;type&gt;GIVEN&lt;/type&gt;
          &lt;/expressionIdentifier&gt;
          &lt;factIdentifier&gt;
            &lt;name&gt;Empty&lt;/name&gt;
            &lt;className&gt;java.lang.Void&lt;/className&gt;
          &lt;/factIdentifier&gt;
          &lt;className&gt;java.lang.Void&lt;/className&gt;
          &lt;factAlias&gt;Instance 1&lt;/factAlias&gt;
          &lt;expressionAlias&gt;PROPERTY 1&lt;/expressionAlias&gt;
          &lt;factMappingValueType&gt;NOT_EXPRESSION&lt;/factMappingValueType&gt;
          &lt;columnWidth&gt;114.0&lt;/columnWidth&gt;
        &lt;/FactMapping&gt;
      &lt;/factMappings&gt;
    &lt;/scesimModelDescriptor&gt;
    &lt;scesimData&gt;
      &lt;BackgroundData&gt;
        &lt;factMappingValues&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;Empty&lt;/name&gt;
              &lt;className&gt;java.lang.Void&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;1|1&lt;/name&gt;
              &lt;type&gt;GIVEN&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
          &lt;/FactMappingValue&gt;
        &lt;/factMappingValues&gt;
      &lt;/BackgroundData&gt;
    &lt;/scesimData&gt;
  &lt;/background&gt;
  &lt;settings&gt;
    &lt;dmnFilePath&gt;src/main/resources/org/kie/example/traffic/traffic_violation/Traffic Violation.dmn&lt;/dmnFilePath&gt;
    &lt;type&gt;DMN&lt;/type&gt;
    &lt;fileName&gt;&lt;/fileName&gt;
    &lt;dmnNamespace&gt;https://github.com/kiegroup/drools/kie-dmn/_A4BCA8B8-CF08-433F-93B2-A2598F19ECFF&lt;/dmnNamespace&gt;
    &lt;dmnName&gt;Traffic Violation&lt;/dmnName&gt;
    &lt;skipFromBuild&gt;false&lt;/skipFromBuild&gt;
    &lt;stateless&gt;false&lt;/stateless&gt;
  &lt;/settings&gt;
  &lt;imports&gt;
    &lt;imports/&gt;
  &lt;/imports&gt;
&lt;/ScenarioSimulationModel&gt;</pre><p class="simpara">
						Example XML response:
					</p><pre class="programlisting language-xml">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;
&lt;response type="SUCCESS" msg="Test Scenario successfully executed"&gt;
      &lt;scenario-simulation-result&gt;
            &lt;run-count&gt;5&lt;/run-count&gt;
            &lt;ignore-count&gt;0&lt;/ignore-count&gt;
            &lt;run-time&gt;31&lt;/run-time&gt;
      &lt;/scenario-simulation-result&gt;
&lt;/response&gt;</pre></li></ol></div></section><section class="chapter" id="test-designer-create-mortgages-example-proc"><div class="titlepage"><div><div><h2 class="title">Chapter 74. Creating test scenario using the sample Mortgages project</h2></div></div></div><p>
				This chapter illustrates creating and executing a test scenario from the sample <span class="strong strong"><strong>Mortgages</strong></span> project shipped with Business Central using the test scenario designer. The test scenario example in this chapter is based on the <span class="strong strong"><strong>Pricing loans</strong></span> guided decision table from the <span class="strong strong"><strong>Mortgages</strong></span> project.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click <span class="strong strong"><strong>Mortgages</strong></span>.
					</li><li class="listitem"><p class="simpara">
						If the project is not listed under <span class="strong strong"><strong>Projects</strong></span>, from <span class="strong strong"><strong>MySpace</strong></span>, click <span class="strong strong"><strong>Try Samples</strong></span> → <span class="strong strong"><strong>Mortgages</strong></span> → <span class="strong strong"><strong>OK</strong></span>.
					</p><p class="simpara">
						The Assets window appears.
					</p></li><li class="listitem">
						Click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Test Scenario</strong></span>.
					</li><li class="listitem"><p class="simpara">
						Enter <code class="literal">scenario_pricing_loans</code> as the <span class="strong strong"><strong>Test Scenario</strong></span> name and select the default <code class="literal">mortgages.mortgages</code> package from the <span class="strong strong"><strong>Package</strong></span> drop-down list.
					</p><p class="simpara">
						The package you select must contain all the required rule assets.
					</p></li><li class="listitem">
						Select <span class="strong strong"><strong>RULE</strong></span> as the <span class="strong strong"><strong>Source type</strong></span>.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Ok</strong></span> to create and open the test scenario in the test scenario designer.
					</li><li class="listitem"><p class="simpara">
						Expand <span class="strong strong"><strong>Project Explorer</strong></span> and verify the following:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">Applicant</code>, <code class="literal">Bankruptcy</code>, <code class="literal">IncomeSource</code>, and <code class="literal">LoanApplication</code> data objects exist.
							</li><li class="listitem">
								<code class="literal">Pricing loans</code> guided decision table exists.
							</li><li class="listitem">
								Verify that the new test scenario is listed under <span class="strong strong"><strong>Test Scenario</strong></span>
							</li></ul></div></li><li class="listitem"><p class="simpara">
						After verifying that everything is in place, return to the <span class="strong strong"><strong>Model</strong></span> tab of the test scenario designer and define the <span class="strong strong"><strong>GIVEN</strong></span> and <span class="strong strong"><strong>EXPECT</strong></span> data for the scenario, based on the available data objects.
					</p><div class="figure" id="idm139921818938064"><p class="title"><strong>Figure 74.1. A blank test scenario designer</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/project-data/test-scenarios-blank-preview-editor.png" alt="test scenarios blank preview editor"/></div></div></div></li><li class="listitem"><p class="simpara">
						Define the <span class="strong strong"><strong>GIVEN</strong></span> column details:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Click the cell named <span class="strong strong"><strong>INSTANCE 1</strong></span> under the <span class="strong strong"><strong>GIVEN</strong></span> column header.
							</li><li class="listitem">
								From the <span class="strong strong"><strong>Test Tools</strong></span> panel, select the <span class="strong strong"><strong>LoanApplication</strong></span> data object.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Insert Data Object</strong></span>.
							</li></ol></div></li><li class="listitem">
						To create properties for the data object, right-click the property header cell and select <span class="strong strong"><strong>Insert column right</strong></span> or <span class="strong strong"><strong>Insert column left</strong></span> as required. For this example, you need to create two more property cells under the <span class="strong strong"><strong>GIVEN</strong></span> column.
					</li><li class="listitem"><p class="simpara">
						Select the first property header cell:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								From the <span class="strong strong"><strong>Test Tools</strong></span> panel, select and expand the <span class="strong strong"><strong>LoanApplication</strong></span> data object.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>amount</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Insert Data Object</strong></span> to map the data object field to the property header cell.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Select the second property header cell:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								From the <span class="strong strong"><strong>Test Tools</strong></span> panel, select and expand the <span class="strong strong"><strong>LoanApplication</strong></span> data object.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>deposit</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Insert Data Object</strong></span>.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Select the third property header cell:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								From the <span class="strong strong"><strong>Test Tools</strong></span> panel, select and expand the <span class="strong strong"><strong>LoanApplication</strong></span> data object.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>lengthYears</strong></span>
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Insert Data Object</strong></span>.
							</li></ol></div></li><li class="listitem">
						Right-click the <span class="strong strong"><strong>LoanApplication</strong></span> header cell and select <span class="strong strong"><strong>Insert column right</strong></span>. A new <span class="strong strong"><strong>GIVEN</strong></span> column to the right is created.
					</li><li class="listitem"><p class="simpara">
						Select the new header cell:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								From the <span class="strong strong"><strong>Test Tools</strong></span> panel, select the <span class="strong strong"><strong>IncomeSource</strong></span> data object.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Insert Data Object</strong></span> to map the data object to the header cell.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Select the property header cell below <span class="strong strong"><strong>IncomeSource</strong></span>:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								From the <span class="strong strong"><strong>Test Tools</strong></span> panel, select and expand the <span class="strong strong"><strong>IncomeSource</strong></span> data object.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>type</strong></span>.
							</li><li class="listitem"><p class="simpara">
								Click <span class="strong strong"><strong>Insert Data Object</strong></span> to map the data object field to the property header cell.
							</p><p class="simpara">
								You have now defined all the <span class="strong strong"><strong>GIVEN</strong></span> column cells.
							</p></li></ol></div></li><li class="listitem"><p class="simpara">
						Next, define the <span class="strong strong"><strong>EXPECT</strong></span> column details:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Click the cell named <span class="strong strong"><strong>INSTANCE 2</strong></span> under the <span class="strong strong"><strong>EXPECT</strong></span> column header.
							</li><li class="listitem">
								From the <span class="strong strong"><strong>Test Tools</strong></span> panel, select <span class="strong strong"><strong>LoanApplication</strong></span> data object.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Insert Data Object</strong></span>.
							</li></ol></div></li><li class="listitem">
						To create properties for the data object, right-click the property header cell and select <span class="strong strong"><strong>Insert column right</strong></span> or <span class="strong strong"><strong>Insert column left</strong></span> as required. Create two more property cells under the <span class="strong strong"><strong>EXPECT</strong></span> column.
					</li><li class="listitem"><p class="simpara">
						Select the first property header cell:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								From the <span class="strong strong"><strong>Test Tools</strong></span> panel, select and expand the <span class="strong strong"><strong>LoanApplication</strong></span> data object.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>approved</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Insert Data Object</strong></span> to map the data object field to the property header cell.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Select the second property header cell:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								From the <span class="strong strong"><strong>Test Tools</strong></span> panel, select and expand the <span class="strong strong"><strong>LoanApplication</strong></span> data object.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>insuranceCost</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Insert Data Object</strong></span> to map the data object field to the property header cell.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Select the third property header cell:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								From the <span class="strong strong"><strong>Test Tools</strong></span> panel, select and expand the <span class="strong strong"><strong>LoanApplication</strong></span> data object.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>approvedRate</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Insert Data Object</strong></span> to map the data object field to the property header cell.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						To define the test scenario, enter the following data in the first row:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Enter <code class="literal">Row 1 test scenario</code> as the <span class="strong strong"><strong>Scenario Description</strong></span>, <code class="literal">150000</code> as the <span class="strong strong"><strong>amount</strong></span>, <code class="literal">19000</code> as the <span class="strong strong"><strong>deposit</strong></span>, <code class="literal">30</code> as the <span class="strong strong"><strong>lengthYears</strong></span>, and <code class="literal">Asset</code> as the <span class="strong strong"><strong>type</strong></span> for the <span class="strong strong"><strong>GIVEN</strong></span> column values.
							</li><li class="listitem">
								Enter <code class="literal">true</code> as <span class="strong strong"><strong>approved</strong></span>, <code class="literal">0</code> as the <span class="strong strong"><strong>insuranceCost</strong></span> and <code class="literal">2</code> as the <span class="strong strong"><strong>approvedRate</strong></span> for the <span class="strong strong"><strong>EXPECT</strong></span> column values.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Next enter the following data in the second row:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Enter <code class="literal">Row 2 test scenario</code> as the <span class="strong strong"><strong>Scenario Description</strong></span>, <code class="literal">100002</code> as the <span class="strong strong"><strong>amount</strong></span>, <code class="literal">2999</code> as the <span class="strong strong"><strong>deposit</strong></span>, <code class="literal">20</code> as the <span class="strong strong"><strong>lengthYears</strong></span>, and <code class="literal">Job</code> as the <span class="strong strong"><strong>type</strong></span> for the <span class="strong strong"><strong>GIVEN</strong></span> column values.
							</li><li class="listitem">
								Enter <code class="literal">true</code> as <span class="strong strong"><strong>approved</strong></span>, <code class="literal">10</code> as the <span class="strong strong"><strong>insuranceCost</strong></span> and <code class="literal">6</code> as the <span class="strong strong"><strong>approvedRate</strong></span> for the <span class="strong strong"><strong>EXPECT</strong></span> column values.
							</li></ul></div></li><li class="listitem">
						After you have defined all <span class="strong strong"><strong>GIVEN</strong></span>, <span class="strong strong"><strong>EXPECT</strong></span>, and other data for the scenario, click <span class="strong strong"><strong>Save</strong></span> in the test scenario designer to save your work.
					</li><li class="listitem"><p class="simpara">
						Click <span class="strong strong"><strong>Run Test</strong></span> in the upper-right corner to run the <code class="literal">.scesim</code> file.
					</p><p class="simpara">
						The test result is displayed in the <span class="strong strong"><strong>Test Report</strong></span> panel. Click <span class="strong strong"><strong>View Alerts</strong></span> to display messages from the <span class="strong strong"><strong>Alerts</strong></span> section. If a test fails, refer to the messages in the <span class="strong strong"><strong>Alerts</strong></span> section at the bottom of the window, review and correct all components in the scenario, and try again to validate the scenario until the scenario passes.
					</p></li><li class="listitem">
						Click <span class="strong strong"><strong>Save</strong></span> in the test scenario designer to save your work after you have made all necessary changes.
					</li></ol></div></section><section class="chapter" id="test-scenarios-legacy-designer-con"><div class="titlepage"><div><div><h2 class="title">Chapter 75. Test scenarios (legacy) designer in Business Central</h2></div></div></div><p>
				Red Hat Process Automation Manager currently supports both the new <span class="strong strong"><strong>Test Scenarios</strong></span> designer and the former <span class="strong strong"><strong>Test Scenarios (Legacy)</strong></span> designer. The default designer is the new test scenarios designer, which supports testing of both rules and DMN models and provides an enhanced overall user experience with test scenarios. If required, you can continue to use the legacy test scenarios designer, which supports rule-based test scenarios only.
			</p><section class="section" id="test-scenarios-legacy-create-proc"><div class="titlepage"><div><div><h2 class="title">75.1. Creating and running a test scenario (legacy)</h2></div></div></div><p>
					You can create test scenarios in Business Central to test the functionality of business rule data before deployment. A basic test scenario must have at least the following data:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Related data objects
						</li><li class="listitem">
							<span class="strong strong"><strong>GIVEN</strong></span> facts
						</li><li class="listitem">
							<span class="strong strong"><strong>EXPECT</strong></span> results
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The legacy test scenarios designer supports the <code class="literal">LocalDate</code> java built-in data type. You can use the <code class="literal">LocalDate</code> java built-in data type in the <code class="literal">dd-mmm-yyyy</code> date format. For example, you can set this in the <code class="literal">17-Oct-2020</code> date format.
					</p></div></div><p>
					With this data, the test scenario can validate the expected and actual results for that rule instance based on the defined facts. You can also add a <span class="strong strong"><strong>CALL METHOD</strong></span> and any available <span class="strong strong"><strong>globals</strong></span> to a test scenario, but these scenario settings are optional.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Test Scenarios (Legacy)</strong></span>.
						</li><li class="listitem">
							Enter an informative <span class="strong strong"><strong>Test Scenario</strong></span> name and select the appropriate <span class="strong strong"><strong>Package</strong></span>. The package that you specify must be the same package where the required rule assets have been assigned or will be assigned. You can import data objects from any package into the asset’s designer.
						</li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Ok</strong></span> to create the test scenario.
						</p><p class="simpara">
							The new test scenario is now listed in the <span class="strong strong"><strong>Test Scenarios</strong></span> panel of the <span class="strong strong"><strong>Project Explorer</strong></span>,
						</p></li><li class="listitem">
							Click the <span class="strong strong"><strong>Data Objects</strong></span> tab to verify that all data objects required for the rules that you want to test are listed. If not, click <span class="strong strong"><strong>New item</strong></span> to import the needed data objects from other packages, or <a class="link" href="#data-objects-create-proc_test-scenarios" title="61.1. Creating data objects">create data objects</a> within your package.
						</li><li class="listitem"><p class="simpara">
							After all data objects are in place, return to the <span class="strong strong"><strong>Model</strong></span> tab of the test scenarios designer and define the <span class="strong strong"><strong>GIVEN</strong></span> and <span class="strong strong"><strong>EXPECT</strong></span> data for the scenario, based on the available data objects.
						</p><div class="figure" id="idm139921818763664"><p class="title"><strong>Figure 75.1. The test scenarios designer</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/project-data/test-scenario-edit.png" alt="test scenario edit"/></div></div></div><p class="simpara">
							The <span class="strong strong"><strong>GIVEN</strong></span> section defines the input facts for the test. For example, if an <code class="literal">Underage</code> rule in the project declines loan applications for applicants under the age of 21, then the <span class="strong strong"><strong>GIVEN</strong></span> facts in the test scenario could be <code class="literal">Applicant</code> with <code class="literal">age</code> set to some integer less than 21.
						</p><p class="simpara">
							The <span class="strong strong"><strong>EXPECT</strong></span> section defines the expected results based on the <span class="strong strong"><strong>GIVEN</strong></span> input facts. That is, <span class="strong strong"><strong>GIVEN</strong></span> the input facts, <span class="strong strong"><strong>EXPECT</strong></span> these other facts to be valid or entire rules to be activated. For example, with the given facts of an applicant under the age of 21 in the scenario, the <span class="strong strong"><strong>EXPECT</strong></span> results could be <code class="literal">LoanApplication</code> with <code class="literal">approved</code> set to <code class="literal">false</code> (as a result of the underage applicant), or could be the activation of the <code class="literal">Underage</code> rule as a whole.
						</p></li><li class="listitem"><p class="simpara">
							Optional: Add a <span class="strong strong"><strong>CALL METHOD</strong></span> and any <span class="strong strong"><strong>globals</strong></span> to the test scenario:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="strong strong"><strong>CALL METHOD:</strong></span> Use this to invoke a method from another fact when the rule execution is initiated. Click <span class="strong strong"><strong>CALL METHOD</strong></span>, select a fact, and click 
									<span class="inlinemediaobject"><img src="images/_images/project-data/6187.png" alt="6187"/></span>
									 to select the method to invoke. You can invoke any Java class methods (such as methods from an ArrayList) from the Java library or from a JAR that was imported for the project (if applicable).
								</li><li class="listitem">
									<span class="strong strong"><strong>globals:</strong></span> Use this to add any global variables in the project that you want to validate in the test scenario. Click <span class="strong strong"><strong>globals</strong></span> to select the variable to be validated, and then in the test scenarios designer, click the global name and define field values to be applied to the global variable. If no global variables are available, then they must be created as new assets in Business Central. Global variables are named objects that are visible to the decision engine but are different from the objects for facts. Changes in the object of a global do not trigger the re-evaluation of rules.
								</li></ul></div></li><li class="listitem">
							Click <span class="strong strong"><strong>More</strong></span> at the bottom of the test scenarios designer to add other data blocks to the same scenario file as needed.
						</li><li class="listitem">
							After you have defined all <span class="strong strong"><strong>GIVEN</strong></span>, <span class="strong strong"><strong>EXPECT</strong></span>, and other data for the scenario, click <span class="strong strong"><strong>Save</strong></span> in the test scenarios designer to save your work.
						</li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Run scenario</strong></span> in the upper-right corner to run this <code class="literal">.scenario</code> file, or click <span class="strong strong"><strong>Run all scenarios</strong></span> to run all saved <code class="literal">.scenario</code> files in the project package (if there are multiple). Although the <span class="strong strong"><strong>Run scenario</strong></span> option does not require the individual <code class="literal">.scenario</code> file to be saved, the <span class="strong strong"><strong>Run all scenarios</strong></span> option does require all <code class="literal">.scenario</code> files to be saved.
						</p><p class="simpara">
							If the test fails, address any problems described in the <span class="strong strong"><strong>Alerts</strong></span> message at the bottom of the window, review all components in the scenario, and try again to validate the scenario until the scenario passes.
						</p></li><li class="listitem">
							Click <span class="strong strong"><strong>Save</strong></span> in the test scenarios designer to save your work after all changes are complete.
						</li></ol></div><section class="section" id="test-scenarios-legacy-GIVEN-proc"><div class="titlepage"><div><div><h3 class="title">75.1.1. Adding GIVEN facts in test scenarios (legacy)</h3></div></div></div><p>
						The <span class="strong strong"><strong>GIVEN</strong></span> section defines input facts for the test. For example, if an <code class="literal">Underage</code> rule in the project declines loan applications for applicants under the age of 21, then the <span class="strong strong"><strong>GIVEN</strong></span> facts in the test scenario could be <code class="literal">Applicant</code> with <code class="literal">age</code> set to some integer less than 21.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								All data objects required for your test scenario have been created or imported and are listed in the <span class="strong strong"><strong>Data Objects</strong></span> tab of the <span class="strong strong"><strong>Test Scenarios (Legacy)</strong></span> designer.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								In the <span class="strong strong"><strong>Test Scenarios (Legacy)</strong></span> designer, click <span class="strong strong"><strong>GIVEN</strong></span> to open the <span class="strong strong"><strong>New input</strong></span> window with the available facts.
							</p><div class="figure" id="idm139921818709888"><p class="title"><strong>Figure 75.2. Add GIVEN input to the test scenario</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/project-data/test-scenario-facts.png" alt="Add GIVEN input to the test scenario"/></div></div></div><p class="simpara">
								The list includes the following options, depending on the data objects available in the <span class="strong strong"><strong>Data Objects</strong></span> tab of the test scenarios designer:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<span class="strong strong"><strong>Insert a new fact:</strong></span> Use this to add a fact and modify its field values. Enter a variable for the fact as the <span class="strong strong"><strong>Fact name</strong></span>.
									</li><li class="listitem">
										<span class="strong strong"><strong>Modify an existing fact:</strong></span> (Appears only after another fact has been added.) Use this to specify a previously inserted fact to be modified in the decision engine between executions of the scenario.
									</li><li class="listitem">
										<span class="strong strong"><strong>Delete an existing fact:</strong></span> (Appears only after another fact has been added.) Use this to specify a previously inserted fact to be deleted from the decision engine between executions of the scenario.
									</li><li class="listitem">
										<span class="strong strong"><strong>Activate rule flow group:</strong></span> Use this to specify a rule flow group to be activated so that all rules within that group can be tested.
									</li></ul></div></li><li class="listitem">
								Choose a fact for the desired input option and click <span class="strong strong"><strong>Add</strong></span>. For example, set <span class="strong strong"><strong>Insert a new fact:</strong></span> to <span class="strong strong"><strong>Applicant</strong></span> and enter <code class="literal">a</code> or <code class="literal">app</code> or any other variable for the <span class="strong strong"><strong>Fact name</strong></span>.
							</li><li class="listitem"><p class="simpara">
								Click the fact in the test scenarios designer and select the field to be modified.
							</p><div class="figure" id="idm139921818689696"><p class="title"><strong>Figure 75.3. Modify a fact field</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/project-data/test-scenario-field.png" alt="Modifying a condition"/></div></div></div></li><li class="listitem"><p class="simpara">
								Click the edit icon (
								<span class="inlinemediaobject"><img src="images/_images/project-data/6191.png" alt="6191"/></span>
								) and select from the following field values:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<span class="strong strong"><strong>Literal value:</strong></span> Creates an open field in which you enter a specific literal value.
									</li><li class="listitem">
										<span class="strong strong"><strong>Bound variable:</strong></span> Sets the value of the field to the fact bound to a selected variable. The field type must match the bound variable type.
									</li><li class="listitem">
										<span class="strong strong"><strong>Create new fact:</strong></span> Enables you to create a new fact and assign it as a field value of the parent fact. Then you can click the child fact in the test scenarios designer and likewise assign field values or nest other facts similarly.
									</li></ul></div></li><li class="listitem">
								Continue adding any other <span class="strong strong"><strong>GIVEN</strong></span> input data for the scenario and click <span class="strong strong"><strong>Save</strong></span> in the test scenarios designer to save your work.
							</li></ol></div></section><section class="section" id="test-scenarios-legacy-EXPECT-proc"><div class="titlepage"><div><div><h3 class="title">75.1.2. Adding EXPECT results in test scenarios (legacy)</h3></div></div></div><p>
						The <span class="strong strong"><strong>EXPECT</strong></span> section defines the expected results based on the <span class="strong strong"><strong>GIVEN</strong></span> input facts. That is, <span class="strong strong"><strong>GIVEN</strong></span> the input facts, <span class="strong strong"><strong>EXPECT</strong></span> other specified facts to be valid or entire rules to be activated. For example, with the given facts of an applicant under the age of 21 in the scenario, the <span class="strong strong"><strong>EXPECT</strong></span> results could be <code class="literal">LoanApplication</code> with <code class="literal">approved</code> set to <code class="literal">false</code> (as a result of the underage applicant), or could be the activation of the <code class="literal">Underage</code> rule as a whole.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								All data objects required for your test scenario have been created or imported and are listed in the <span class="strong strong"><strong>Data Objects</strong></span> tab of the <span class="strong strong"><strong>Test Scenarios (Legacy)</strong></span> designer.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								In the <span class="strong strong"><strong>Test Scenarios (Legacy)</strong></span> designer, click <span class="strong strong"><strong>EXPECT</strong></span> to open the <span class="strong strong"><strong>New expectation</strong></span> window with the available facts.
							</p><div class="figure" id="idm139921818656928"><p class="title"><strong>Figure 75.4. Add EXPECT results to the test scenario</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/project-data/test-scenario-expected-rules.png" alt="Add EXPECT results to the test scenario"/></div></div></div><p class="simpara">
								The list includes the following options, depending on the data in the <span class="strong strong"><strong>GIVEN</strong></span> section and the data objects available in the <span class="strong strong"><strong>Data Objects</strong></span> tab of the test scenarios designer:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<span class="strong strong"><strong>Rule:</strong></span> Use this to specify a particular rule in the project that is expected to be activated as a result of the <span class="strong strong"><strong>GIVEN</strong></span> input. Type the name of a rule that is expected to be activated or select it from the list of rules, and then in the test scenarios designer, specify the number of times the rule should be activated.
									</li><li class="listitem">
										<span class="strong strong"><strong>Fact value:</strong></span> Use this to select a fact and define values for it that are expected to be valid as a result of the facts defined in the <span class="strong strong"><strong>GIVEN</strong></span> section. The facts are listed by the <span class="strong strong"><strong>Fact name</strong></span> previously defined for the <span class="strong strong"><strong>GIVEN</strong></span> input.
									</li><li class="listitem">
										<span class="strong strong"><strong>Any fact that matches:</strong></span> Use this to validate that at least one fact with the specified values exists as a result of the <span class="strong strong"><strong>GIVEN</strong></span> input.
									</li></ul></div></li><li class="listitem">
								Choose a fact for the desired expectation (such as <span class="strong strong"><strong>Fact value:</strong></span> <code class="literal">application</code>) and click <span class="strong strong"><strong>Add</strong></span> or <span class="strong strong"><strong>OK</strong></span>.
							</li><li class="listitem"><p class="simpara">
								Click the fact in the test scenarios designer and select the field to be added and modified.
							</p><div class="figure" id="idm139921818635872"><p class="title"><strong>Figure 75.5. Modify a fact field</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/project-data/test-scenario-field-value.png" alt="Modify a fact field"/></div></div></div></li><li class="listitem"><p class="simpara">
								Set the field values to what is expected to be valid as a result of the <span class="strong strong"><strong>GIVEN</strong></span> input (such as <code class="literal">approved</code> | <code class="literal">equals</code> | <code class="literal">false</code>).
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									In the legacy test scenarios designer, you can use <code class="literal">["value1", "value2"]</code> string format in the <span class="strong strong"><strong>EXPECT</strong></span> field to validate the list of strings.
								</p></div></div></li><li class="listitem">
								Continue adding any other <span class="strong strong"><strong>EXPECT</strong></span> input data for the scenario and click <span class="strong strong"><strong>Save</strong></span> in the test scenarios designer to save your work.
							</li><li class="listitem"><p class="simpara">
								After you have defined and saved all <span class="strong strong"><strong>GIVEN</strong></span>, <span class="strong strong"><strong>EXPECT</strong></span>, and other data for the scenario, click <span class="strong strong"><strong>Run scenario</strong></span> in the upper-right corner to run this <code class="literal">.scenario</code> file, or click <span class="strong strong"><strong>Run all scenarios</strong></span> to run all saved <code class="literal">.scenario</code> files in the project package (if there are multiple). Although the <span class="strong strong"><strong>Run scenario</strong></span> option does not require the individual <code class="literal">.scenario</code> file to be saved, the <span class="strong strong"><strong>Run all scenarios</strong></span> option does require all <code class="literal">.scenario</code> files to be saved.
							</p><p class="simpara">
								If the test fails, address any problems described in the <span class="strong strong"><strong>Alerts</strong></span> message at the bottom of the window, review all components in the scenario, and try again to validate the scenario until the scenario passes.
							</p></li><li class="listitem">
								Click <span class="strong strong"><strong>Save</strong></span> in the test scenarios designer to save your work after all changes are complete.
							</li></ol></div></section></section></section><section class="chapter" id="test-scenarios-comparison-legacy-new-ref"><div class="titlepage"><div><div><h2 class="title">Chapter 76. Feature comparison of legacy and new test scenario designer</h2></div></div></div><p>
				Red Hat Process Automation Manager supports both the new test scenario designer and the former test scenario (Legacy) designer.
			</p><p>
				The default designer is the new test scenario designer, which supports testing of both rules and DMN models, and provides an enhanced overall user experience with test scenarios. You can continue to use the legacy test scenario designer, which only supports rule-based test scenarios.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The new test scenario designer has an improved layout and feature set and continues to be developed. However, the legacy test scenario designer is deprecated with Red Hat Process Automation Manager 7.3.0 and will be removed in a future Red Hat Process Automation Manager release.
				</p></div></div><p>
				The following table highlights the main features of legacy and new test scenario designer, which are supported in Red Hat Process Automation Manager to help you decide a suitable test scenario designer in your project.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">+</code> indicates that the feature is present in the test scenario designer.
					</li><li class="listitem">
						<code class="literal">-</code> indicates that the feature is not present in the test scenario designer.
					</li></ul></div><div class="table" id="idm139921818603808"><p class="title"><strong>Table 76.1. Main features of legacy and new test scenario designer</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 17%; " class="col_3"/><col style="width: 33%; " class="col_4"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921818597152" scope="col">Feature &amp; highlights</th><th align="left" valign="top" id="idm139921818596016" scope="col">New designer</th><th align="left" valign="top" id="idm139921818594928" scope="col">Legacy designer</th><th align="left" valign="top" id="idm139921818593840" scope="col">Documentation</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921818597152">
							<p>
								<span class="strong strong"><strong>Creating and running a test scenario</strong></span>
							</p>
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										You can create test scenarios in Business Central to test the functionality of business rule data before deployment.
									</li><li class="listitem">
										A basic test scenario must have at least a related data objects, <span class="strong strong"><strong>GIVEN</strong></span> facts, and <span class="strong strong"><strong>EXPECT</strong></span> results.
									</li><li class="listitem">
										You can run the tests to validate your business rules and data.
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921818596016">
							<p>
								<code class="literal">+</code>
							</p>
							</td><td align="left" valign="top" headers="idm139921818594928">
							<p>
								<code class="literal">+</code>
							</p>
							</td><td align="left" valign="top" headers="idm139921818593840">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										For more information about creating rule and DMN-based test scenarios, see <a class="xref" href="#test-designer-create-test-scenario-template-con" title="Chapter 63. Test scenario template">Chapter 63, <em>Test scenario template</em></a>.
									</li><li class="listitem">
										For more information about running the test scenarios, see <a class="xref" href="#test-designer-run-test-proc" title="Chapter 69. Running the test scenarios">Chapter 69, <em>Running the test scenarios</em></a>.
									</li><li class="listitem">
										For more information about creating and running test scenarios (legacy), see <a class="xref" href="#test-scenarios-legacy-create-proc" title="75.1. Creating and running a test scenario (legacy)">Section 75.1, “Creating and running a test scenario (legacy)”</a>.
									</li></ul></div>
							</td></tr><tr><td align="left" valign="top" headers="idm139921818597152">
							<p>
								<span class="strong strong"><strong>Adding GIVEN facts in test scenarios</strong></span>
							</p>
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										You can insert and verify the <span class="strong strong"><strong>GIVEN</strong></span> facts for the test.
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921818596016">
							<p>
								<code class="literal">+</code>
							</p>
							</td><td align="left" valign="top" headers="idm139921818594928">
							<p>
								<code class="literal">+</code>
							</p>
							</td><td align="left" valign="top" headers="idm139921818593840">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										For more information about adding <span class="strong strong"><strong>GIVEN</strong></span> facts in new test scenario designer, see <a class="xref" href="#test-designer-create-test-scenario-template-con" title="Chapter 63. Test scenario template">Chapter 63, <em>Test scenario template</em></a>.
									</li><li class="listitem">
										For more information about adding <span class="strong strong"><strong>GIVEN</strong></span> facts in test scenarios (legacy), see <a class="xref" href="#test-scenarios-legacy-GIVEN-proc" title="75.1.1. Adding GIVEN facts in test scenarios (legacy)">Section 75.1.1, “Adding GIVEN facts in test scenarios (legacy)”</a>.
									</li></ul></div>
							</td></tr><tr><td align="left" valign="top" headers="idm139921818597152">
							<p>
								<span class="strong strong"><strong>Adding EXPECT results in test scenarios</strong></span>
							</p>
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										The <span class="strong strong"><strong>EXPECT</strong></span> section defines the expected results based on the <span class="strong strong"><strong>GIVEN</strong></span> input facts.
									</li><li class="listitem">
										It represents the objects and their fields whose exact values are checked based on the provided information.
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921818596016">
							<p>
								<code class="literal">+</code>
							</p>
							</td><td align="left" valign="top" headers="idm139921818594928">
							<p>
								<code class="literal">+</code>
							</p>
							</td><td align="left" valign="top" headers="idm139921818593840">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										For more information about adding <span class="strong strong"><strong>EXPECT</strong></span> results in new test scenario designer, see <a class="xref" href="#test-designer-create-test-scenario-template-con" title="Chapter 63. Test scenario template">Chapter 63, <em>Test scenario template</em></a>.
									</li><li class="listitem">
										For more information about adding <span class="strong strong"><strong>EXPECT</strong></span> results in test scenarios (legacy), see <a class="xref" href="#test-scenarios-legacy-EXPECT-proc" title="75.1.2. Adding EXPECT results in test scenarios (legacy)">Section 75.1.2, “Adding EXPECT results in test scenarios (legacy)”</a>.
									</li></ul></div>
							</td></tr><tr><td align="left" valign="top" headers="idm139921818597152">
							<p>
								<span class="strong strong"><strong>KIE session</strong></span>
							</p>
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										You can set KIE session on test scenario level settings.
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921818596016">
							<p>
								<code class="literal">+</code>
							</p>
							</td><td align="left" valign="top" headers="idm139921818594928">
							<p>
								<code class="literal">+</code>
							</p>
							</td><td align="left" valign="top" headers="idm139921818593840">
							<p>
								NA
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921818597152">
							<p>
								<span class="strong strong"><strong>KIE base on test scenario level</strong></span>
							</p>
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										You can set KIE base on test scenario level settings.
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921818596016">
							<p>
								<code class="literal">-</code>
							</p>
							</td><td align="left" valign="top" headers="idm139921818594928">
							<p>
								<code class="literal">+</code>
							</p>
							</td><td align="left" valign="top" headers="idm139921818593840">
							<p>
								NA
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921818597152">
							<p>
								<span class="strong strong"><strong>KIE base on project level</strong></span>
							</p>
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										You can set KIE base on project level settings.
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921818596016">
							<p>
								<code class="literal">+</code>
							</p>
							</td><td align="left" valign="top" headers="idm139921818594928">
							<p>
								<code class="literal">+</code>
							</p>
							</td><td align="left" valign="top" headers="idm139921818593840">
							<p>
								NA
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921818597152">
							<p>
								<span class="strong strong"><strong>Simulated date and time</strong></span>
							</p>
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										You can set a simulated date and time for the legacy test scenario designer.
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921818596016">
							<p>
								<code class="literal">-</code>
							</p>
							</td><td align="left" valign="top" headers="idm139921818594928">
							<p>
								<code class="literal">+</code>
							</p>
							</td><td align="left" valign="top" headers="idm139921818593840">
							<p>
								NA
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921818597152">
							<p>
								<span class="strong strong"><strong>Rule flow group</strong></span>
							</p>
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										You can specify a rule flow group to be activated to test all the rules within that group.
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921818596016">
							<p>
								<code class="literal">+</code>
							</p>
							</td><td align="left" valign="top" headers="idm139921818594928">
							<p>
								<code class="literal">+</code>
							</p>
							</td><td align="left" valign="top" headers="idm139921818593840">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										For more information about setting rule flow group in new test scenarios, see <a class="xref" href="#test-designer-global-settings-panel-rule-based-proc" title="62.9.1. Configuring global settings for rule-based test scenarios">Section 62.9.1, “Configuring global settings for rule-based test scenarios”</a>.
									</li><li class="listitem">
										For more information about setting rule flow group in test scenarios (legacy), <a class="xref" href="#test-scenarios-legacy-GIVEN-proc" title="75.1.1. Adding GIVEN facts in test scenarios (legacy)">Section 75.1.1, “Adding GIVEN facts in test scenarios (legacy)”</a>.
									</li></ul></div>
							</td></tr><tr><td align="left" valign="top" headers="idm139921818597152">
							<p>
								<span class="strong strong"><strong>Global variables</strong></span>
							</p>
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Global variables are named objects that are visible to the decision engine but are different from the objects for facts.
									</li><li class="listitem">
										Setting global variables for new test scenario is deprecated .
									</li><li class="listitem">
										In case you want to reuse data sets for different scenarios, you can use the <span class="strong strong"><strong>Background</strong></span> instance.
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921818596016">
							<p>
								<code class="literal">-</code>
							</p>
							</td><td align="left" valign="top" headers="idm139921818594928">
							<p>
								<code class="literal">+</code>
							</p>
							</td><td align="left" valign="top" headers="idm139921818593840">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										For more information about <span class="strong strong"><strong>Background</strong></span> instance in new test scenarios, see <a class="xref" href="#test-scenarios-background-instance-con" title="Chapter 66. Background instance in test scenarios">Chapter 66, <em>Background instance in test scenarios</em></a>.
									</li><li class="listitem">
										For more information about global variables in test scenarios (legacy), see <a class="xref" href="#test-scenarios-legacy-create-proc" title="75.1. Creating and running a test scenario (legacy)">Section 75.1, “Creating and running a test scenario (legacy)”</a>.
									</li></ul></div>
							</td></tr><tr><td align="left" valign="top" headers="idm139921818597152">
							<p>
								<span class="strong strong"><strong>Call method</strong></span>
							</p>
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										You can use this to invoke a method from another fact when the rule execution is initiated.
									</li><li class="listitem">
										You can invoke any Java class methods from the Java library or from a JAR that was imported for the project.
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921818596016">
							<p>
								<code class="literal">+</code>
							</p>
							</td><td align="left" valign="top" headers="idm139921818594928">
							<p>
								<code class="literal">+</code>
							</p>
							</td><td align="left" valign="top" headers="idm139921818593840">
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										For more information about calling a method in new test scenarios, see <a class="xref" href="#test-designer-expressions-syntax-intro-ref" title="Chapter 68. Expression syntax in test scenarios">Chapter 68, <em>Expression syntax in test scenarios</em></a>.
									</li><li class="listitem">
										For more information about calling a method in test scenarios (legacy), see <a class="xref" href="#test-scenarios-legacy-create-proc" title="75.1. Creating and running a test scenario (legacy)">Section 75.1, “Creating and running a test scenario (legacy)”</a>.
									</li></ul></div>
							</td></tr><tr><td align="left" valign="top" headers="idm139921818597152">
							<p>
								<span class="strong strong"><strong>Modify an existing fact</strong></span>
							</p>
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										You can modify a previously inserted fact in the decision engine between executions of the scenario.
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921818596016">
							<p>
								<code class="literal">-</code>
							</p>
							</td><td align="left" valign="top" headers="idm139921818594928">
							<p>
								<code class="literal">+</code>
							</p>
							</td><td align="left" valign="top" headers="idm139921818593840">
							<p>
								For more information about modifying an existing fact in test scenarios (legacy), see <a class="xref" href="#test-scenarios-legacy-GIVEN-proc" title="75.1.1. Adding GIVEN facts in test scenarios (legacy)">Section 75.1.1, “Adding GIVEN facts in test scenarios (legacy)”</a>.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm139921818597152">
							<p>
								<span class="strong strong"><strong>Bound variable</strong></span>
							</p>
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										You can set the value of a field to the fact bound to a selected variable.
									</li><li class="listitem">
										In the new test scenario designer, you can not define a variable inside a test scenario grid and reuse it inside <span class="strong strong"><strong>GIVEN</strong></span> or <span class="strong strong"><strong>EXPECTED</strong></span> cells.
									</li></ul></div>
							</td><td align="left" valign="top" headers="idm139921818596016">
							<p>
								<code class="literal">-</code>
							</p>
							</td><td align="left" valign="top" headers="idm139921818594928">
							<p>
								<code class="literal">+</code>
							</p>
							</td><td align="left" valign="top" headers="idm139921818593840">
							<p>
								For more information about how to set bound variables in test scenarios (legacy), see <a class="xref" href="#test-scenarios-legacy-GIVEN-proc" title="75.1.1. Adding GIVEN facts in test scenarios (legacy)">Section 75.1.1, “Adding GIVEN facts in test scenarios (legacy)”</a>.
							</p>
							</td></tr></tbody></table></div></div></section><section class="chapter" id="next_steps_6"><div class="titlepage"><div><div><h2 class="title">Chapter 77. Next steps</h2></div></div></div><p>
				<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>
			</p></section></div><div class="part" id="assembly-decision-engine"><div class="titlepage"><div><div><h1 class="title">Part IX. Decision engine in Red Hat Process Automation Manager</h1></div></div></div><div class="partintro" id="idm139921818425664"><div/><p>
				As a business rules developer, your understanding of the decision engine in Red Hat Process Automation Manager can help you design more effective business assets and a more scalable decision management architecture. The decision engine is the Red Hat Process Automation Manager component that stores, processes, and evaluates data to execute business rules and to reach the decisions that you define. This document describes basic concepts and functions of the decision engine to consider as you create your business rule system and decision services in Red Hat Process Automation Manager.
			</p><div class="toc"><p><strong>Table of Contents</strong></p><ul class="toc"><li><span class="chapter"><a href="#decision-engine-con_decision-engine">78. Decision engine in Red Hat Process Automation Manager</a></span></li><li><span class="chapter"><a href="#kie-sessions-con_decision-engine">79. KIE sessions</a></span><ul><li><span class="section"><a href="#kie-sessions-stateless-con_decision-engine">79.1. Stateless KIE sessions</a></span><ul><li><span class="section"><a href="#kie-sessions-stateless-globals-con_decision-engine">79.1.1. Global variables in stateless KIE sessions</a></span></li></ul></li><li><span class="section"><a href="#kie-sessions-stateful-con_decision-engine">79.2. Stateful KIE sessions</a></span></li><li><span class="section"><a href="#kie-sessions-pools-con_decision-engine">79.3. KIE session pools</a></span></li></ul></li><li><span class="chapter"><a href="#inference-and-truth-maintenance_decision-engine">80. Inference and truth maintenance in the decision engine</a></span><ul><li><span class="section"><a href="#fact-equality-modes-con_decision-engine">80.1. Fact equality modes in the decision engine</a></span></li></ul></li><li><span class="chapter"><a href="#execution-control-con_decision-engine">81. Execution control in the decision engine</a></span><ul><li><span class="section"><a href="#salience_for_rules">81.1. Salience for rules</a></span></li><li><span class="section"><a href="#agenda_groups_for_rules">81.2. Agenda groups for rules</a></span></li><li><span class="section"><a href="#activation_groups_for_rules">81.3. Activation groups for rules</a></span></li><li><span class="section"><a href="#rule-execution-modes-con_decision-engine">81.4. Rule execution modes and thread safety in the decision engine</a></span></li><li><span class="section"><a href="#fact-propagation-modes-con_decision-engine">81.5. Fact propagation modes in the decision engine</a></span></li><li><span class="section"><a href="#agenda-filters-con_decision-engine">81.6. Agenda evaluation filters</a></span></li><li><span class="section"><a href="#drl-rule-units-con_decision-engine">81.7. Rule units in DRL rule sets</a></span><ul><li><span class="section"><a href="#data_sources_for_rule_units_2">81.7.1. Data sources for rule units</a></span></li><li><span class="section"><a href="#rule_unit_execution_control_2">81.7.2. Rule unit execution control</a></span></li><li><span class="section"><a href="#rule_unit_identity_conflicts_2">81.7.3. Rule unit identity conflicts</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#phreak-algorithm-con_decision-engine">82. Phreak rule algorithm in the decision engine</a></span><ul><li><span class="section"><a href="#phreak-rule-evaluation-con_decision-engine">82.1. Rule evaluation in Phreak</a></span><ul><li><span class="section"><a href="#forward-and-backward-chaining-con_decision-engine">82.1.1. Rule evaluation with forward and backward chaining</a></span></li></ul></li><li><span class="section"><a href="#rule-base-configuration-con_decision-engine">82.2. Rule base configuration</a></span></li><li><span class="section"><a href="#phreak-sequential-mode-con_decision-engine">82.3. Sequential mode in Phreak</a></span></li></ul></li><li><span class="chapter"><a href="#cep-con_decision-engine">83. Complex event processing (CEP)</a></span><ul><li><span class="section"><a href="#cep-events-con_decision-engine">83.1. Events in complex event processing</a></span></li><li><span class="section"><a href="#cep-events-proc_decision-engine">83.2. Declaring facts as events</a></span></li><li><span class="section"><a href="#drl-declarations-metadata-tags-ref_decision-engine">83.3. Metadata tags for events</a></span></li><li><span class="section"><a href="#cep-modes-con_decision-engine">83.4. Event processing modes in the decision engine</a></span><ul><li><span class="section"><a href="#cep-negative-patterns_decision-engine">83.4.1. Negative patterns in decision engine stream mode</a></span></li></ul></li><li><span class="section"><a href="#property-change-listeners-con_decision-engine">83.5. Property-change settings and listeners for fact types</a></span></li><li><span class="section"><a href="#cep-temporal-operators_decision-engine">83.6. Temporal operators for events</a></span></li><li><span class="section"><a href="#cep-clock-ref_decision-engine">83.7. Session clock implementations in the decision engine</a></span></li><li><span class="section"><a href="#cep-event-streams-con_decision-engine">83.8. Event streams and entry points</a></span><ul><li><span class="section"><a href="#cep-event-streams-proc_decision-engine">83.8.1. Declaring entry points for rule data</a></span></li></ul></li><li><span class="section"><a href="#cep-sliding-windows-con_decision-engine">83.9. Sliding windows of time or length</a></span><ul><li><span class="section"><a href="#cep-sliding-windows-proc_decision-engine">83.9.1. Declaring sliding windows for rule data</a></span></li></ul></li><li><span class="section"><a href="#cep-memory-management-con_decision-engine">83.10. Memory management for events</a></span></li></ul></li><li><span class="chapter"><a href="#engine-queries-con_decision-engine">84. Decision engine queries and live queries</a></span></li><li><span class="chapter"><a href="#engine-event-listeners-con_decision-engine">85. Decision engine event listeners and debug logging</a></span><ul><li><span class="section"><a href="#logging-proc_decision-engine">85.1. Configuring a logging utility in the decision engine</a></span></li></ul></li><li><span class="chapter"><a href="#decision-examples-IDE-con_decision-engine">86. Example decisions in Red Hat Process Automation Manager for an IDE</a></span><ul><li><span class="section"><a href="#decision-examples-IDE-proc_decision-engine">86.1. Importing and executing Red Hat Process Automation Manager example decisions in an IDE</a></span></li><li><span class="section"><a href="#decision-examples-helloworld-ref_decision-engine">86.2. Hello World example decisions (basic rules and debugging)</a></span></li><li><span class="section"><a href="#decision-examples-state-ref_decision-engine">86.3. State example decisions (forward chaining and conflict resolution)</a></span></li><li><span class="section"><a href="#decision-examples-fibonacci-ref_decision-engine">86.4. Fibonacci example decisions (recursion and conflict resolution)</a></span></li><li><span class="section"><a href="#decision-examples-pricing-ref_decision-engine">86.5. Pricing example decisions (decision tables)</a></span></li><li><span class="section"><a href="#decision-examples-petstore-ref_decision-engine">86.6. Pet Store example decisions (agenda groups, global variables, callbacks, and GUI integration)</a></span></li><li><span class="section"><a href="#decision-examples-politician-ref_decision-engine">86.7. Honest Politician example decisions (truth maintenance and salience)</a></span></li><li><span class="section"><a href="#decision-examples-sudoku-ref_decision-engine">86.8. Sudoku example decisions (complex pattern matching, callbacks, and GUI integration)</a></span></li><li><span class="section"><a href="#decision-examples-conway-ref_decision-engine">86.9. Conway’s Game of Life example decisions (ruleflow groups and GUI integration)</a></span></li><li><span class="section"><a href="#decision-examples-doom-ref_decision-engine">86.10. House of Doom example decisions (backward chaining and recursion)</a></span></li></ul></li><li><span class="chapter"><a href="#performance-tuning-decision-engine-ref_decision-engine">87. Performance tuning considerations with the decision engine</a></span></li><li><span class="chapter"><a href="#additional_resources_3">88. Additional resources</a></span></li></ul></div></div><section class="chapter" id="decision-engine-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">Chapter 78. Decision engine in Red Hat Process Automation Manager</h2></div></div></div><p>
				The decision engine is the rules engine in Red Hat Process Automation Manager. The decision engine stores, processes, and evaluates data to execute the business rules or decision models that you define. The basic function of the decision engine is to match incoming data, or <span class="emphasis"><em>facts</em></span>, to the conditions of rules and determine whether and how to execute the rules.
			</p><p>
				The decision engine operates using the following basic components:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="strong strong"><strong>Rules:</strong></span> Business rules or DMN decisions that you define. All rules must contain at a minimum the conditions that trigger the rule and the actions that the rule dictates.
					</li><li class="listitem">
						<span class="strong strong"><strong>Facts:</strong></span> Data that enters or changes in the decision engine that the decision engine matches to rule conditions to execute applicable rules.
					</li><li class="listitem">
						<span class="strong strong"><strong>Production memory:</strong></span> Location where rules are stored in the decision engine.
					</li><li class="listitem">
						<span class="strong strong"><strong>Working memory:</strong></span> Location where facts are stored in the decision engine.
					</li><li class="listitem">
						<span class="strong strong"><strong>Agenda:</strong></span> Location where activated rules are registered and sorted (if applicable) in preparation for execution.
					</li></ul></div><p>
				When a business user or an automated system adds or updates rule-related information in Red Hat Process Automation Manager, that information is inserted into the working memory of the decision engine in the form of one or more facts. The decision engine matches those facts to the conditions of the rules that are stored in the production memory to determine eligible rule executions. (This process of matching facts to rules is often referred to as <span class="emphasis"><em>pattern matching</em></span>.) When rule conditions are met, the decision engine activates and registers rules in the agenda, where the decision engine then sorts prioritized or conflicting rules in preparation for execution.
			</p><p>
				The following diagram illustrates these basic components of the decision engine:
			</p><div class="figure" id="idm139921818409152"><p class="title"><strong>Figure 78.1. Overview of basic decision engine components</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/HybridReasoning/rule-engine-inkscape_enterprise.png" alt="rule engine inkscape enterprise"/></div></div></div><p>
				For more details and examples of rule and fact behavior in the decision engine, see <a class="xref" href="#inference-and-truth-maintenance_decision-engine" title="Chapter 80. Inference and truth maintenance in the decision engine">Chapter 80, <em>Inference and truth maintenance in the decision engine</em></a>.
			</p><p>
				These core concepts can help you to better understand other more advanced components, processes, and sub-processes of the decision engine, and as a result, to design more effective business assets in Red Hat Process Automation Manager.
			</p></section><section class="chapter" id="kie-sessions-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">Chapter 79. KIE sessions</h2></div></div></div><p>
				In Red Hat Process Automation Manager, a KIE session stores and executes runtime data. The KIE session is created from a KIE base or directly from a KIE container if you have defined the KIE session in the KIE module descriptor file (<code class="literal">kmodule.xml</code>) for your project.
			</p><div class="formalpara"><p class="title"><strong>Example KIE session configuration in a <code class="literal">kmodule.xml</code> file</strong></p><p>
					
<pre class="programlisting language-xml">&lt;kmodule&gt;
  ...
  &lt;kbase&gt;
    ...
    &lt;ksession name="KSession2_1" type="stateless" default="true" clockType="realtime"&gt;
    ...
  &lt;/kbase&gt;
  ...
&lt;/kmodule&gt;</pre>
				</p></div><p>
				A KIE base is a repository that you define in the KIE module descriptor file (<code class="literal">kmodule.xml</code>) for your project and contains all rules, processes, and other business assets in Red Hat Process Automation Manager, but does not contain any runtime data.
			</p><div class="formalpara"><p class="title"><strong>Example KIE base configuration in a <code class="literal">kmodule.xml</code> file</strong></p><p>
					
<pre class="programlisting language-xml">&lt;kmodule&gt;
  ...
  &lt;kbase name="KBase2" default="false" eventProcessingMode="stream" equalsBehavior="equality" declarativeAgenda="enabled" packages="org.domain.pkg2, org.domain.pkg3" includes="KBase1"&gt;
    ...
  &lt;/kbase&gt;
  ...
&lt;/kmodule&gt;</pre>
				</p></div><p>
				A KIE session can be stateless or stateful. In a stateless KIE session, data from a previous invocation of the KIE session (the previous session state) is discarded between session invocations. In a stateful KIE session, that data is retained. The type of KIE session you use depends on your project requirements and how you want data from different asset invocations to be persisted.
			</p><section class="section" id="kie-sessions-stateless-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">79.1. Stateless KIE sessions</h2></div></div></div><p>
					A stateless KIE session is a session that does not use inference to make iterative changes to facts over time. In a stateless KIE session, data from a previous invocation of the KIE session (the previous session state) is discarded between session invocations, whereas in a stateful KIE session, that data is retained. A stateless KIE session behaves similarly to a function in that the results that it produces are determined by the contents of the KIE base and by the data that is passed into the KIE session for execution at a specific point in time. The KIE session has no memory of any data that was passed into the KIE session previously.
				</p><p>
					Stateless KIE sessions are commonly used for the following use cases:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Validation</strong></span>, such as validating that a person is eligible for a mortgage
						</li><li class="listitem">
							<span class="strong strong"><strong>Calculation</strong></span>, such as computing a mortgage premium
						</li><li class="listitem">
							<span class="strong strong"><strong>Routing and filtering</strong></span>, such as sorting incoming emails into folders or sending incoming emails to a destination
						</li></ul></div><p>
					For example, consider the following driver’s license data model and sample DRL rule:
				</p><div class="formalpara"><p class="title"><strong>Data model for driver’s license application</strong></p><p>
						
<pre class="programlisting language-java">public class Applicant {
  private String name;
  private int age;
  private boolean valid;
  // Getter and setter methods
}</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Sample DRL rule for driver’s license application</strong></p><p>
						
<pre class="screen">package com.company.license

rule "Is of valid age"
when
  $a : Applicant(age &lt; 18)
then
  $a.setValid(false);
end</pre>
					</p></div><p>
					The <code class="literal">Is of valid age</code> rule disqualifies any applicant younger than 18 years old. When the <code class="literal">Applicant</code> object is inserted into the decision engine, the decision engine evaluates the constraints for each rule and searches for a match. The <code class="literal">"objectType"</code> constraint is always implied, after which any number of explicit field constraints are evaluated. The variable <code class="literal">$a</code> is a binding variable that references the matched object in the rule consequence.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The dollar sign (<code class="literal">$</code>) is optional and helps to differentiate between variable names and field names.
					</p></div></div><p>
					In this example, the sample rule and all other files in the <code class="literal">~/resources</code> folder of the Red Hat Process Automation Manager project are built with the following code:
				</p><div class="formalpara"><p class="title"><strong>Create the KIE container</strong></p><p>
						
<pre class="programlisting language-java">KieServices kieServices = KieServices.Factory.get();

KieContainer kContainer = kieServices.getKieClasspathContainer();</pre>
					</p></div><p>
					This code compiles all the rule files found on the class path and adds the result of this compilation, a <code class="literal">KieModule</code> object, in the <code class="literal">KieContainer</code>.
				</p><p>
					Finally, the <code class="literal">StatelessKieSession</code> object is instantiated from the <code class="literal">KieContainer</code> and is executed against specified data:
				</p><div class="formalpara"><p class="title"><strong>Instantiate the stateless KIE session and enter data</strong></p><p>
						
<pre class="programlisting language-java">StatelessKieSession kSession = kContainer.newStatelessKieSession();

Applicant applicant = new Applicant("Mr John Smith", 16);

assertTrue(applicant.isValid());

ksession.execute(applicant);

assertFalse(applicant.isValid());</pre>
					</p></div><p>
					In a stateless KIE session configuration, the <code class="literal">execute()</code> call acts as a combination method that instantiates the <code class="literal">KieSession</code> object, adds all the user data and executes user commands, calls <code class="literal">fireAllRules()</code>, and then calls <code class="literal">dispose()</code>. Therefore, with a stateless KIE session, you do not need to call <code class="literal">fireAllRules()</code> or call <code class="literal">dispose()</code> after session invocation as you do with a stateful KIE session.
				</p><p>
					In this case, the specified applicant is under the age of 18, so the application is declined.
				</p><p>
					For a more complex use case, see the following example. This example uses a stateless KIE session and executes rules against an iterable list of objects, such as a collection.
				</p><div class="formalpara"><p class="title"><strong>Expanded data model for driver’s license application</strong></p><p>
						
<pre class="programlisting language-java">public class Applicant {
  private String name;
  private int age;
  // Getter and setter methods
}

public class Application {
  private Date dateApplied;
  private boolean valid;
  // Getter and setter methods
}</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Expanded DRL rule set for driver’s license application</strong></p><p>
						
<pre class="screen">package com.company.license

rule "Is of valid age"
when
  Applicant(age &lt; 18)
  $a : Application()
then
  $a.setValid(false);
end

rule "Application was made this year"
when
  $a : Application(dateApplied &gt; "01-jan-2009")
then
  $a.setValid(false);
end</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Expanded Java source with iterable execution in a stateless KIE session</strong></p><p>
						
<pre class="programlisting language-java">StatelessKieSession ksession = kbase.newStatelessKnowledgeSession();
Applicant applicant = new Applicant("Mr John Smith", 16);
Application application = new Application();

assertTrue(application.isValid());
ksession.execute(Arrays.asList(new Object[] { application, applicant }));  <span id="CO13-1"/><span class="callout">1</span>
assertFalse(application.isValid());

ksession.execute
  (CommandFactory.newInsertIterable(new Object[] { application, applicant }));  <span id="CO13-2"/><span class="callout">2</span>

List&lt;Command&gt; cmds = new ArrayList&lt;Command&gt;();  <span id="CO13-3"/><span class="callout">3</span>
cmds.add(CommandFactory.newInsert(new Person("Mr John Smith"), "mrSmith"));
cmds.add(CommandFactory.newInsert(new Person("Mr John Doe"), "mrDoe"));

BatchExecutionResults results = ksession.execute(CommandFactory.newBatchExecution(cmds));
assertEquals(new Person("Mr John Smith"), results.getValue("mrSmith"));</pre>
					</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO13-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							Method for executing rules against an iterable collection of objects produced by the <code class="literal">Arrays.asList()</code> method. Every collection element is inserted before any matched rules are executed. The <code class="literal">execute(Object object)</code> and <code class="literal">execute(Iterable objects)</code> methods are wrappers around the <code class="literal">execute(Command command)</code> method that comes from the <code class="literal">BatchExecutor</code> interface.
						</div></dd><dt><a href="#CO13-2"><span class="callout">2</span></a> </dt><dd><div class="para">
							Execution of the iterable collection of objects using the <code class="literal">CommandFactory</code> interface.
						</div></dd><dt><a href="#CO13-3"><span class="callout">3</span></a> </dt><dd><div class="para">
							<code class="literal">BatchExecutor</code> and <code class="literal">CommandFactory</code> configurations for working with many different commands or result output identifiers. The <code class="literal">CommandFactory</code> interface supports other commands that you can use in the <code class="literal">BatchExecutor</code>, such as <code class="literal">StartProcess</code>, <code class="literal">Query</code>, and <code class="literal">SetGlobal</code>.
						</div></dd></dl></div><section class="section" id="kie-sessions-stateless-globals-con_decision-engine"><div class="titlepage"><div><div><h3 class="title">79.1.1. Global variables in stateless KIE sessions</h3></div></div></div><p>
						The <code class="literal">StatelessKieSession</code> object supports global variables (globals) that you can configure to be resolved as session-scoped globals, delegate globals, or execution-scoped globals.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Session-scoped globals:</strong></span> For session-scoped globals, you can use the method <code class="literal">getGlobals()</code> to return a <code class="literal">Globals</code> instance that provides access to the KIE session globals. These globals are used for all execution calls. Use caution with mutable globals because execution calls can be executing simultaneously in different threads.
							</p><div class="formalpara"><p class="title"><strong>Session-scoped global</strong></p><p>
									
<pre class="programlisting language-java">import org.kie.api.runtime.StatelessKieSession;

StatelessKieSession ksession = kbase.newStatelessKieSession();

// Set a global `myGlobal` that can be used in the rules.
ksession.setGlobal("myGlobal", "I am a global");

// Execute while resolving the `myGlobal` identifier.
ksession.execute(collection);</pre>
								</p></div></li><li class="listitem">
								<span class="strong strong"><strong>Delegate globals:</strong></span> For delegate globals, you can assign a value to a global (with <code class="literal">setGlobal(String, Object)</code>) so that the value is stored in an internal collection that maps identifiers to values. Identifiers in this internal collection have priority over any supplied delegate. If an identifier cannot be found in this internal collection, the delegate global (if any) is used.
							</li><li class="listitem">
								<span class="strong strong"><strong>Execution-scoped globals:</strong></span> For execution-scoped globals, you can use the <code class="literal">Command</code> object to set a global that is passed to the <code class="literal">CommandExecutor</code> interface for execution-specific global resolution.
							</li></ul></div><p>
						The <code class="literal">CommandExecutor</code> interface also enables you to export data using out identifiers for globals, inserted facts, and query results:
					</p><div class="formalpara"><p class="title"><strong>Out identifiers for globals, inserted facts, and query results</strong></p><p>
							
<pre class="programlisting language-java">import org.kie.api.runtime.ExecutionResults;

// Set up a list of commands.
List cmds = new ArrayList();
cmds.add(CommandFactory.newSetGlobal("list1", new ArrayList(), true));
cmds.add(CommandFactory.newInsert(new Person("jon", 102), "person"));
cmds.add(CommandFactory.newQuery("Get People" "getPeople"));

// Execute the list.
ExecutionResults results = ksession.execute(CommandFactory.newBatchExecution(cmds));

// Retrieve the `ArrayList`.
results.getValue("list1");
// Retrieve the inserted `Person` fact.
results.getValue("person");
// Retrieve the query as a `QueryResults` instance.
results.getValue("Get People");</pre>
						</p></div></section></section><section class="section" id="kie-sessions-stateful-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">79.2. Stateful KIE sessions</h2></div></div></div><p>
					A stateful KIE session is a session that uses inference to make iterative changes to facts over time. In a stateful KIE session, data from a previous invocation of the KIE session (the previous session state) is retained between session invocations, whereas in a stateless KIE session, that data is discarded.
				</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						Ensure that you call the <code class="literal">dispose()</code> method after running a stateful KIE session so that no memory leaks occur between session invocations.
					</p></div></div><p>
					Stateful KIE sessions are commonly used for the following use cases:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Monitoring</strong></span>, such as monitoring a stock market and automating the buying process
						</li><li class="listitem">
							<span class="strong strong"><strong>Diagnostics</strong></span>, such as running fault-finding processes or medical diagnostic processes
						</li><li class="listitem">
							<span class="strong strong"><strong>Logistics</strong></span>, such as parcel tracking and delivery provisioning
						</li><li class="listitem">
							<span class="strong strong"><strong>Ensuring compliance</strong></span>, such as verifying the legality of market trades
						</li></ul></div><p>
					For example, consider the following fire alarm data model and sample DRL rules:
				</p><div class="formalpara"><p class="title"><strong>Data model for sprinklers and fire alarm</strong></p><p>
						
<pre class="programlisting language-java">public class Room {
  private String name;
  // Getter and setter methods
}

public class Sprinkler {
  private Room room;
  private boolean on;
  // Getter and setter methods
}

public class Fire {
  private Room room;
  // Getter and setter methods
}

public class Alarm { }</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Sample DRL rule set for activating sprinklers and alarm</strong></p><p>
						
<pre class="screen">rule "When there is a fire turn on the sprinkler"
when
  Fire($room : room)
  $sprinkler : Sprinkler(room == $room, on == false)
then
  modify($sprinkler) { setOn(true) };
  System.out.println("Turn on the sprinkler for room "+$room.getName());
end

rule "Raise the alarm when we have one or more fires"
when
    exists Fire()
then
    insert( new Alarm() );
    System.out.println( "Raise the alarm" );
end

rule "Cancel the alarm when all the fires have gone"
when
    not Fire()
    $alarm : Alarm()
then
    delete( $alarm );
    System.out.println( "Cancel the alarm" );
end


rule "Status output when things are ok"
when
    not Alarm()
    not Sprinkler( on == true )
then
    System.out.println( "Everything is ok" );
end</pre>
					</p></div><p>
					For the <code class="literal">When there is a fire turn on the sprinkler</code> rule, when a fire occurs, the instances of the <code class="literal">Fire</code> class are created for that room and inserted into the KIE session. The rule adds a constraint for the specific <code class="literal">room</code> matched in the <code class="literal">Fire</code> instance so that only the sprinkler for that room is checked. When this rule is executed, the sprinkler activates. The other sample rules determine when the alarm is activated or deactivated accordingly.
				</p><p>
					Whereas a stateless KIE session relies on standard Java syntax to modify a field, a stateful KIE session relies on the <code class="literal">modify</code> statement in rules to notify the decision engine of changes. The decision engine then reasons over the changes and assesses impact on subsequent rule executions. This process is part of the decision engine ability to use <span class="emphasis"><em>inference</em></span> and <span class="emphasis"><em>truth maintenance</em></span> and is essential in stateful KIE sessions.
				</p><p>
					In this example, the sample rules and all other files in the <code class="literal">~/resources</code> folder of the Red Hat Process Automation Manager project are built with the following code:
				</p><div class="formalpara"><p class="title"><strong>Create the KIE container</strong></p><p>
						
<pre class="programlisting language-java">KieServices kieServices = KieServices.Factory.get();
KieContainer kContainer = kieServices.getKieClasspathContainer();</pre>
					</p></div><p>
					This code compiles all the rule files found on the class path and adds the result of this compilation, a <code class="literal">KieModule</code> object, in the <code class="literal">KieContainer</code>.
				</p><p>
					Finally, the <code class="literal">KieSession</code> object is instantiated from the <code class="literal">KieContainer</code> and is executed against specified data:
				</p><div class="formalpara"><p class="title"><strong>Instantiate the stateful KIE session and enter data</strong></p><p>
						
<pre class="programlisting language-java">KieSession ksession = kContainer.newKieSession();

String[] names = new String[]{"kitchen", "bedroom", "office", "livingroom"};
Map&lt;String,Room&gt; name2room = new HashMap&lt;String,Room&gt;();
for( String name: names ){
    Room room = new Room( name );
    name2room.put( name, room );
    ksession.insert( room );
    Sprinkler sprinkler = new Sprinkler( room );
    ksession.insert( sprinkler );
}

ksession.fireAllRules();</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Console output</strong></p><p>
						
<pre class="screen">&gt; Everything is ok</pre>
					</p></div><p>
					With the data added, the decision engine completes all pattern matching but no rules have been executed, so the configured verification message appears. As new data triggers rule conditions, the decision engine executes rules to activate the alarm and later to cancel the alarm that has been activated:
				</p><div class="formalpara"><p class="title"><strong>Enter new data to trigger rules</strong></p><p>
						
<pre class="programlisting language-java">Fire kitchenFire = new Fire( name2room.get( "kitchen" ) );
Fire officeFire = new Fire( name2room.get( "office" ) );

FactHandle kitchenFireHandle = ksession.insert( kitchenFire );
FactHandle officeFireHandle = ksession.insert( officeFire );

ksession.fireAllRules();</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Console output</strong></p><p>
						
<pre class="screen">&gt; Raise the alarm
&gt; Turn on the sprinkler for room kitchen
&gt; Turn on the sprinkler for room office</pre>
					</p></div><pre class="programlisting language-java">ksession.delete( kitchenFireHandle );
ksession.delete( officeFireHandle );

ksession.fireAllRules();</pre><div class="formalpara"><p class="title"><strong>Console output</strong></p><p>
						
<pre class="screen">&gt; Cancel the alarm
&gt; Turn off the sprinkler for room office
&gt; Turn off the sprinkler for room kitchen
&gt; Everything is ok</pre>
					</p></div><p>
					In this case, a reference is kept for the returned <code class="literal">FactHandle</code> object. A fact handle is an internal engine reference to the inserted instance and enables instances to be retracted or modified later.
				</p><p>
					As this example illustrates, the data and results from previous stateful KIE sessions (the activated alarm) affect the invocation of subsequent sessions (alarm cancellation).
				</p></section><section class="section" id="kie-sessions-pools-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">79.3. KIE session pools</h2></div></div></div><p>
					In use cases with large amounts of KIE runtime data and high system activity, KIE sessions might be created and disposed very frequently. A high turnover of KIE sessions is not always time consuming, but when the turnover is repeated millions of times, the process can become a bottleneck and require substantial clean-up effort.
				</p><p>
					For these high-volume cases, you can use KIE session pools instead of many individual KIE sessions. To use a KIE session pool, you obtain a KIE session pool from a KIE container, define the initial number of KIE sessions in the pool, and create the KIE sessions from that pool as usual:
				</p><div class="formalpara"><p class="title"><strong>Example KIE session pool</strong></p><p>
						
<pre class="programlisting language-java">// Obtain a KIE session pool from the KIE container
KieContainerSessionsPool pool = kContainer.newKieSessionsPool(10);

// Create KIE sessions from the KIE session pool
KieSession kSession = pool.newKieSession();</pre>
					</p></div><p>
					In this example, the KIE session pool starts with 10 KIE sessions in it, but you can specify the number of KIE sessions that you need. This integer value is the number of KIE sessions that are only initially created in the pool. If required by the running application, the number of KIE sessions in the pool can dynamically grow beyond that value.
				</p><p>
					After you define a KIE session pool, the next time you use the KIE session as usual and call <code class="literal">dispose()</code> on it, the KIE session is reset and pushed back into the pool instead of being destroyed.
				</p><p>
					KIE session pools typically apply to stateful KIE sessions, but KIE session pools can also affect stateless KIE sessions that you reuse with multiple <code class="literal">execute()</code> calls. When you create a stateless KIE session directly from a KIE container, the KIE session continues to internally create a new KIE session for each <code class="literal">execute()</code> invocation. Conversely, when you create a stateless KIE session from a KIE session pool, the KIE session internally uses only the specific KIE sessions provided by the pool.
				</p><p>
					When you finish using a KIE session pool, you can call the <code class="literal">shutdown()</code> method on it to avoid memory leaks. Alternatively, you can call <code class="literal">dispose()</code> on the KIE container to shut down all the pools created from the KIE container.
				</p></section></section><section class="chapter" id="inference-and-truth-maintenance_decision-engine"><div class="titlepage"><div><div><h2 class="title">Chapter 80. Inference and truth maintenance in the decision engine</h2></div></div></div><p>
				The basic function of the decision engine is to match data to business rules and determine whether and how to execute rules. To ensure that relevant data is applied to the appropriate rules, the decision engine makes <span class="emphasis"><em>inferences</em></span> based on existing knowledge and performs the actions based on the inferred information.
			</p><p>
				For example, the following DRL rule determines the age requirements for adults, such as in a bus pass policy:
			</p><div class="formalpara"><p class="title"><strong>Rule to define age requirement</strong></p><p>
					
<pre class="screen">rule "Infer Adult"
when
  $p : Person(age &gt;= 18)
then
  insert(new IsAdult($p))
end</pre>
				</p></div><p>
				Based on this rule, the decision engine infers whether a person is an adult or a child and performs the specified action (the <code class="literal">then</code> consequence). Every person who is 18 years old or older has an instance of <code class="literal">IsAdult</code> inserted for them in the working memory. This inferred relation of age and bus pass can then be invoked in any rule, such as in the following rule segment:
			</p><pre class="screen">$p : Person()
IsAdult(person == $p)</pre><p>
				In many cases, new data in a rule system is the result of other rule executions, and this new data can affect the execution of other rules. If the decision engine asserts data as a result of executing a rule, the decision engine uses truth maintenance to justify the assertion and enforce truthfulness when applying inferred information to other rules. Truth maintenance also helps to identify inconsistencies and to handle contradictions. For example, if two rules are executed and result in a contradictory action, the decision engine chooses the action based on assumptions from previously calculated conclusions.
			</p><p>
				The decision engine inserts facts using either stated or logical insertions:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="strong strong"><strong>Stated insertions:</strong></span> Defined with <code class="literal">insert()</code>. After stated insertions, facts are generally retracted explicitly. (The term <span class="emphasis"><em>insertion</em></span>, when used generically, refers to <span class="emphasis"><em>stated insertion</em></span>.)
					</li><li class="listitem">
						<span class="strong strong"><strong>Logical insertions:</strong></span> Defined with <code class="literal">insertLogical()</code>. After logical insertions, the facts that were inserted are automatically retracted when the conditions in the rules that inserted the facts are no longer true. The facts are retracted when no condition supports the logical insertion. A fact that is logically inserted is considered to be <span class="emphasis"><em>justified</em></span> by the decision engine.
					</li></ul></div><p>
				For example, the following sample DRL rules use stated fact insertion to determine the age requirements for issuing a child bus pass or an adult bus pass:
			</p><div class="formalpara"><p class="title"><strong>Rules to issue bus pass, stated insertion</strong></p><p>
					
<pre class="screen">rule "Issue Child Bus Pass"
when
  $p : Person(age &lt; 18)
then
  insert(new ChildBusPass($p));
end

rule "Issue Adult Bus Pass"
when
  $p : Person(age &gt;= 18)
then
  insert(new AdultBusPass($p));
end</pre>
				</p></div><p>
				These rules are not easily maintained in the decision engine as bus riders increase in age and move from child to adult bus pass. As an alternative, these rules can be separated into rules for bus rider age and rules for bus pass type using logical fact insertion. The logical insertion of the fact makes the fact dependent on the truth of the <code class="literal">when</code> clause.
			</p><p>
				The following DRL rules use logical insertion to determine the age requirements for children and adults:
			</p><div class="formalpara"><p class="title"><strong>Children and adult age requirements, logical insertion</strong></p><p>
					
<pre class="screen">rule "Infer Child"
when
  $p : Person(age &lt; 18)
then
  insertLogical(new IsChild($p))
end

rule "Infer Adult"
when
  $p : Person(age &gt;= 18)
then
  insertLogical(new IsAdult($p))
end</pre>
				</p></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					For logical insertions, your fact objects must override the <code class="literal">equals</code> and <code class="literal">hashCode</code> methods from the <code class="literal">java.lang.Object</code> object according to the Java standard. Two objects are equal if their <code class="literal">equals</code> methods return <code class="literal">true</code> for each other and if their <code class="literal">hashCode</code> methods return the same values. For more information, see the Java API documentation for your Java version.
				</p></div></div><p>
				When the condition in the rule is false, the fact is automatically retracted. This behavior is helpful in this example because the two rules are mutually exclusive. In this example, if the person is younger than 18 years old, the rule logically inserts an <code class="literal">IsChild</code> fact. After the person is 18 years old or older, the <code class="literal">IsChild</code> fact is automatically retracted and the <code class="literal">IsAdult</code> fact is inserted.
			</p><p>
				The following DRL rules then determine whether to issue a child bus pass or an adult bus pass and logically insert the <code class="literal">ChildBusPass</code> and <code class="literal">AdultBusPass</code> facts. This rule configuration is possible because the truth maintenance system in the decision engine supports chaining of logical insertions for a cascading set of retracts.
			</p><div class="formalpara"><p class="title"><strong>Rules to issue bus pass, logical insertion</strong></p><p>
					
<pre class="screen">rule "Issue Child Bus Pass"
when
  $p : Person()
    IsChild(person == $p)
then
  insertLogical(new ChildBusPass($p));
end

rule "Issue Adult Bus Pass"
when
  $p : Person()
    IsAdult(person =$p)
then
  insertLogical(new AdultBusPass($p));
end</pre>
				</p></div><p>
				When a person turns 18 years old, the <code class="literal">IsChild</code> fact and the person’s <code class="literal">ChildBusPass</code> fact is retracted. To these set of conditions, you can relate another rule that states that a person must return the child pass after turning 18 years old. When the decision engine automatically retracts the <code class="literal">ChildBusPass</code> object, the following rule is executed to send a request to the person:
			</p><div class="formalpara"><p class="title"><strong>Rule to notify bus pass holder of new pass</strong></p><p>
					
<pre class="screen">rule "Return ChildBusPass Request"
when
  $p : Person()
    not(ChildBusPass(person == $p))
then
  requestChildBusPass($p);
end</pre>
				</p></div><p>
				The following flowcharts illustrate the life cycle of stated and logical insertions:
			</p><div class="figure" id="idm139921818222368"><p class="title"><strong>Figure 80.1. Stated insertion</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/HybridReasoning/Stated_Assertion_enterprise.png" alt="Stated Assertion enterprise"/></div></div></div><div class="figure" id="idm139921818218496"><p class="title"><strong>Figure 80.2. Logical insertion</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/_images/HybridReasoning/Logical_Assertion_enterprise.png" alt="Logical Assertion enterprise"/></div></div></div><p>
				When the decision engine logically inserts an object during a rule execution, the decision engine <span class="emphasis"><em>justifies</em></span> the object by executing the rule. For each logical insertion, only one equal object can exist, and each subsequent equal logical insertion increases the justification counter for that logical insertion. A justification is removed when the conditions of the rule become untrue. When no more justifications exist, the logical object is automatically retracted.
			</p><section class="section" id="fact-equality-modes-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">80.1. Fact equality modes in the decision engine</h2></div></div></div><p>
					The decision engine supports the following fact equality modes that determine how the decision engine stores and compares inserted facts:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">identity</code>: (Default) The decision engine uses an <code class="literal">IdentityHashMap</code> to store all inserted facts. For every new fact insertion, the decision engine returns a new <code class="literal">FactHandle</code> object. If a fact is inserted again, the decision engine returns the original <code class="literal">FactHandle</code> object, ignoring repeated insertions for the same fact. In this mode, two facts are the same for the decision engine only if they are the very same object with the same identity.
						</li><li class="listitem">
							<code class="literal">equality</code>: The decision engine uses a <code class="literal">HashMap</code> to store all inserted facts. The decision engine returns a new <code class="literal">FactHandle</code> object only if the inserted fact is not equal to an existing fact, according to the <code class="literal">equals()</code> method of the inserted fact. In this mode, two facts are the same for the decision engine if they are composed the same way, regardless of identity. Use this mode when you want objects to be assessed based on feature equality instead of explicit identity.
						</li></ul></div><p>
					As an illustration of fact equality modes, consider the following example facts:
				</p><div class="formalpara"><p class="title"><strong>Example facts</strong></p><p>
						
<pre class="screen">Person p1 = new Person("John", 45);
Person p2 = new Person("John", 45);</pre>
					</p></div><p>
					In <code class="literal">identity</code> mode, facts <code class="literal">p1</code> and <code class="literal">p2</code> are different instances of a <code class="literal">Person</code> class and are treated as separate objects because they have separate identities. In <code class="literal">equality</code> mode, facts <code class="literal">p1</code> and <code class="literal">p2</code> are treated as the same object because they are composed the same way. This difference in behavior affects how you can interact with fact handles.
				</p><p>
					For example, assume that you insert facts <code class="literal">p1</code> and <code class="literal">p2</code> into the decision engine and later you want to retrieve the fact handle for <code class="literal">p1</code>. In <code class="literal">identity</code> mode, you must specify <code class="literal">p1</code> to return the fact handle for that exact object, whereas in <code class="literal">equality</code> mode, you can specify <code class="literal">p1</code>, <code class="literal">p2</code>, or <code class="literal">new Person("John", 45)</code> to return the fact handle.
				</p><div class="formalpara"><p class="title"><strong>Example code to insert a fact and return the fact handle in <code class="literal">identity</code> mode</strong></p><p>
						
<pre class="screen">ksession.insert(p1);

ksession.getFactHandle(p1);</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Example code to insert a fact and return the fact handle in <code class="literal">equality</code> mode</strong></p><p>
						
<pre class="screen">ksession.insert(p1);

ksession.getFactHandle(p1);

// Alternate option:
ksession.getFactHandle(new Person("John", 45));</pre>
					</p></div><p>
					To set the fact equality mode, use one of the following options:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Set the system property <code class="literal">drools.equalityBehavior</code> to <code class="literal">identity</code> (default) or <code class="literal">equality</code>.
						</li><li class="listitem"><p class="simpara">
							Set the equality mode while creating the KIE base programmatically:
						</p><pre class="programlisting language-java">KieServices ks = KieServices.get();
KieBaseConfiguration kieBaseConf = ks.newKieBaseConfiguration();
kieBaseConf.setOption(EqualityBehaviorOption.EQUALITY);
KieBase kieBase = kieContainer.newKieBase(kieBaseConf);</pre></li><li class="listitem"><p class="simpara">
							Set the equality mode in the KIE module descriptor file (<code class="literal">kmodule.xml</code>) for a specific Red Hat Process Automation Manager project:
						</p><pre class="programlisting language-xml">&lt;kmodule&gt;
  ...
  &lt;kbase name="KBase2" default="false" equalsBehavior="equality" packages="org.domain.pkg2, org.domain.pkg3" includes="KBase1"&gt;
    ...
  &lt;/kbase&gt;
  ...
&lt;/kmodule&gt;</pre></li></ul></div></section></section><section class="chapter" id="execution-control-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">Chapter 81. Execution control in the decision engine</h2></div></div></div><p>
				When new rule data enters the working memory of the decision engine, rules may become fully matched and eligible for execution. A single working memory action can result in multiple eligible rule executions. When a rule is fully matched, the decision engine creates an activation instance, referencing the rule and the matched facts, and adds the activation onto the decision engine agenda. The agenda controls the execution order of these rule activations using a conflict resolution strategy.
			</p><p>
				After the first call of <code class="literal">fireAllRules()</code> in the Java application, the decision engine cycles repeatedly through two phases:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="strong strong"><strong>Agenda evaluation.</strong></span> In this phase, the decision engine selects all rules that can be executed. If no executable rules exist, the execution cycle ends. If an executable rule is found, the decision engine registers the activation in the agenda and then moves on to the working memory actions phase to perform rule consequence actions.
					</li><li class="listitem">
						<span class="strong strong"><strong>Working memory actions.</strong></span> In this phase, the decision engine performs the rule consequence actions (the <code class="literal">then</code> portion of each rule) for all activated rules previously registered in the agenda. After all the consequence actions are complete or the main Java application process calls <code class="literal">fireAllRules()</code> again, the decision engine returns to the agenda evaluation phase to reassess rules.
					</li></ul></div><div class="figure" id="idm139921818169824"><p class="title"><strong>Figure 81.1. Two-phase execution process in the decision engine</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/HybridReasoning/Two_Phase_enterprise.png" alt="Two Phase enterprise"/></div></div></div><p>
				When multiple rules exist on the agenda, the execution of one rule may cause another rule to be removed from the agenda. To avoid this, you can define how and when rules are executed in the decision engine. Some common methods for defining rule execution order are by using rule salience, agenda groups, activation groups, or rule units for DRL rule sets.
			</p><section class="section" id="salience_for_rules"><div class="titlepage"><div><div><h2 class="title">81.1. Salience for rules</h2></div></div></div><p>
					Each rule has an integer <code class="literal">salience</code> attribute that determines the order of execution. Rules with a higher salience value are given higher priority when ordered in the activation queue. The default salience value for rules is zero, but the salience can be negative or positive.
				</p><p>
					For example, the following sample DRL rules are listed in the decision engine stack in the order shown:
				</p><pre class="screen">rule "RuleA"
salience 95
when
    $fact : MyFact( field1 == true )
then
    System.out.println("Rule2 : " + $fact);
    update($fact);
end

rule "RuleB"
salience 100
when
   $fact : MyFact( field1 == false )
then
   System.out.println("Rule1 : " + $fact);
   $fact.setField1(true);
   update($fact);
end</pre><p>
					The <code class="literal">RuleB</code> rule is listed second, but it has a higher salience value than the <code class="literal">RuleA</code> rule and is therefore executed first.
				</p></section><section class="section" id="agenda_groups_for_rules"><div class="titlepage"><div><div><h2 class="title">81.2. Agenda groups for rules</h2></div></div></div><p>
					An agenda group is a set of rules bound together by the same <code class="literal">agenda-group</code> rule attribute. Agenda groups partition rules on the decision engine agenda. At any one time, only one group has a <span class="emphasis"><em>focus</em></span> that gives that group of rules priority for execution before rules in other agenda groups. You determine the focus with a <code class="literal">setFocus()</code> call for the agenda group. You can also define rules with an <code class="literal">auto-focus</code> attribute so that the next time the rule is activated, the focus is automatically given to the entire agenda group to which the rule is assigned.
				</p><p>
					Each time the <code class="literal">setFocus()</code> call is made in a Java application, the decision engine adds the specified agenda group to the top of the rule stack. The default agenda group <code class="literal">"MAIN"</code> contains all rules that do not belong to a specified agenda group and is executed first in the stack unless another group has the focus.
				</p><p>
					For example, the following sample DRL rules belong to specified agenda groups and are listed in the decision engine stack in the order shown:
				</p><div class="formalpara"><p class="title"><strong>Sample DRL rules for banking application</strong></p><p>
						
<pre class="screen">rule "Increase balance for credits"
  agenda-group "calculation"
when
  ap : AccountPeriod()
  acc : Account( $accountNo : accountNo )
  CashFlow( type == CREDIT,
            accountNo == $accountNo,
            date &gt;= ap.start &amp;&amp; &lt;= ap.end,
            $amount : amount )
then
  acc.balance  += $amount;
end</pre>
					</p></div><pre class="screen">rule "Print balance for AccountPeriod"
  agenda-group "report"
when
  ap : AccountPeriod()
  acc : Account()
then
  System.out.println( acc.accountNo +
                      " : " + acc.balance );
end</pre><p>
					For this example, the rules in the <code class="literal">"report"</code> agenda group must always be executed first and the rules in the <code class="literal">"calculation"</code> agenda group must always be executed second. Any remaining rules in other agenda groups can then be executed. Therefore, the <code class="literal">"report"</code> and <code class="literal">"calculation"</code> groups must receive the focus to be executed in that order, before other rules can be executed:
				</p><div class="formalpara"><p class="title"><strong>Set the focus for the order of agenda group execution</strong></p><p>
						
<pre class="programlisting language-java">Agenda agenda = ksession.getAgenda();
agenda.getAgendaGroup( "report" ).setFocus();
agenda.getAgendaGroup( "calculation" ).setFocus();
ksession.fireAllRules();</pre>
					</p></div><p>
					You can also use the <code class="literal">clear()</code> method to cancel all the activations generated by the rules belonging to a given agenda group before each has had a chance to be executed:
				</p><div class="formalpara"><p class="title"><strong>Cancel all other rule activations</strong></p><p>
						
<pre class="programlisting language-java">ksession.getAgenda().getAgendaGroup( "Group A" ).clear();</pre>
					</p></div></section><section class="section" id="activation_groups_for_rules"><div class="titlepage"><div><div><h2 class="title">81.3. Activation groups for rules</h2></div></div></div><p>
					An activation group is a set of rules bound together by the same <code class="literal">activation-group</code> rule attribute. In this group, only one rule can be executed. After conditions are met for a rule in that group to be executed, all other pending rule executions from that activation group are removed from the agenda.
				</p><p>
					For example, the following sample DRL rules belong to the specified activation group and are listed in the decision engine stack in the order shown:
				</p><div class="formalpara"><p class="title"><strong>Sample DRL rules for banking</strong></p><p>
						
<pre class="screen">rule "Print balance for AccountPeriod1"
  activation-group "report"
when
  ap : AccountPeriod1()
  acc : Account()
then
  System.out.println( acc.accountNo +
                      " : " + acc.balance );
end</pre>
					</p></div><pre class="screen">rule "Print balance for AccountPeriod2"
  activation-group "report"
when
  ap : AccountPeriod2()
  acc : Account()
then
  System.out.println( acc.accountNo +
                      " : " + acc.balance );
end</pre><p>
					For this example, if the first rule in the <code class="literal">"report"</code> activation group is executed, the second rule in the group and all other executable rules on the agenda are removed from the agenda.
				</p></section><section class="section" id="rule-execution-modes-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">81.4. Rule execution modes and thread safety in the decision engine</h2></div></div></div><p>
					The decision engine supports the following rule execution modes that determine how and when the decision engine executes rules:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>Passive mode</strong></span>: (Default) The decision engine evaluates rules when a user or an application explicitly calls <code class="literal">fireAllRules()</code>. Passive mode in the decision engine is best for applications that require direct control over rule evaluation and execution, or for complex event processing (CEP) applications that use the pseudo clock implementation in the decision engine.
						</p><div class="formalpara"><p class="title"><strong>Example CEP application code with the decision engine in passive mode</strong></p><p>
								
<pre class="programlisting language-java">KieSessionConfiguration config = KieServices.Factory.get().newKieSessionConfiguration();
config.setOption( ClockTypeOption.get("pseudo") );
KieSession session = kbase.newKieSession( conf, null );
SessionPseudoClock clock = session.getSessionClock();

session.insert( tick1 );
session.fireAllRules();

clock.advanceTime(1, TimeUnit.SECONDS);
session.insert( tick2 );
session.fireAllRules();

clock.advanceTime(1, TimeUnit.SECONDS);
session.insert( tick3 );
session.fireAllRules();

session.dispose();</pre>
							</p></div></li><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>Active mode</strong></span>: If a user or application calls <code class="literal">fireUntilHalt()</code>, the decision engine starts in active mode and evaluates rules continually until the user or application explicitly calls <code class="literal">halt()</code>. Active mode in the decision engine is best for applications that delegate control of rule evaluation and execution to the decision engine, or for complex event processing (CEP) applications that use the real-time clock implementation in the decision engine. Active mode is also optimal for CEP applications that use active queries.
						</p><div class="formalpara"><p class="title"><strong>Example CEP application code with the decision engine in active mode</strong></p><p>
								
<pre class="programlisting language-java">KieSessionConfiguration config = KieServices.Factory.get().newKieSessionConfiguration();
config.setOption( ClockTypeOption.get("realtime") );
KieSession session = kbase.newKieSession( conf, null );

new Thread( new Runnable() {
  @Override
  public void run() {
      session.fireUntilHalt();
  }
} ).start();

session.insert( tick1 );

... Thread.sleep( 1000L ); ...

session.insert( tick2 );

... Thread.sleep( 1000L ); ...

session.insert( tick3 );

session.halt();
session.dispose();</pre>
							</p></div><p class="simpara">
							This example calls <code class="literal">fireUntilHalt()</code> from a dedicated execution thread to prevent the current thread from being blocked indefinitely while the decision engine continues evaluating rules. The dedicated thread also enables you to call <code class="literal">halt()</code> at a later stage in the application code.
						</p></li></ul></div><p>
					Although you should avoid using both <code class="literal">fireAllRules()</code> and <code class="literal">fireUntilHalt()</code> calls, especially from different threads, the decision engine can handle such situations safely using thread-safety logic and an internal state machine. If a <code class="literal">fireAllRules()</code> call is in progress and you call <code class="literal">fireUntilHalt()</code>, the decision engine continues to run in passive mode until the <code class="literal">fireAllRules()</code> operation is complete and then starts in active mode in response to the <code class="literal">fireUntilHalt()</code> call. However, if the decision engine is running in active mode following a <code class="literal">fireUntilHalt()</code> call and you call <code class="literal">fireAllRules()</code>, the <code class="literal">fireAllRules()</code> call is ignored and the decision engine continues to run in active mode until you call <code class="literal">halt()</code>.
				</p><p>
					For added thread safety in active mode, the decision engine supports a <code class="literal">submit()</code> method that you can use to group and perform operations on a KIE session in a thread-safe, atomic action:
				</p><div class="formalpara"><p class="title"><strong>Example application code with <code class="literal">submit()</code> method to perform atomic operations in active mode</strong></p><p>
						
<pre class="programlisting language-java">KieSession session = ...;

new Thread( new Runnable() {
  @Override
  public void run() {
      session.fireUntilHalt();
  }
} ).start();

final FactHandle fh = session.insert( fact_a );

... Thread.sleep( 1000L ); ...

session.submit( new KieSession.AtomicAction() {
  @Override
  public void execute( KieSession kieSession ) {
    fact_a.setField("value");
    kieSession.update( fh, fact_a );
    kieSession.insert( fact_1 );
    kieSession.insert( fact_2 );
    kieSession.insert( fact_3 );
  }
} );

... Thread.sleep( 1000L ); ...

session.insert( fact_z );

session.halt();
session.dispose();</pre>
					</p></div><p>
					Thread safety and atomic operations are also helpful from a client-side perspective. For example, you might need to insert more than one fact at a given time, but require the decision engine to consider the insertions as an atomic operation and to wait until all the insertions are complete before evaluating the rules again.
				</p></section><section class="section" id="fact-propagation-modes-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">81.5. Fact propagation modes in the decision engine</h2></div></div></div><p>
					The decision engine supports the following fact propagation modes that determine how the decision engine progresses inserted facts through the engine network in preparation for rule execution:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Lazy</strong></span>: (Default) Facts are propagated in batch collections at rule execution, not in real time as the facts are individually inserted by a user or application. As a result, the order in which the facts are ultimately propagated through the decision engine may be different from the order in which the facts were individually inserted.
						</li><li class="listitem">
							<span class="strong strong"><strong>Immediate</strong></span>: Facts are propagated immediately in the order that they are inserted by a user or application.
						</li><li class="listitem">
							<span class="strong strong"><strong>Eager</strong></span>: Facts are propagated lazily (in batch collections), but before rule execution. The decision engine uses this propagation behavior for rules that have the <code class="literal">no-loop</code> or <code class="literal">lock-on-active</code> attribute.
						</li></ul></div><p>
					By default, the Phreak rule algorithm in the decision engine uses lazy fact propagation for improved rule evaluation overall. However, in few cases, this lazy propagation behavior can alter the expected result of certain rule executions that may require immediate or eager propagation.
				</p><p>
					For example, the following rule uses a specified query with a <code class="literal">?</code> prefix to invoke the query in pull-only or passive fashion:
				</p><div class="formalpara"><p class="title"><strong>Example rule with a passive query</strong></p><p>
						
<pre class="screen">query Q (Integer i)
    String( this == i.toString() )
end

rule "Rule"
  when
    $i : Integer()
    ?Q( $i; )
  then
    System.out.println( $i );
end</pre>
					</p></div><p>
					For this example, the rule should be executed only when a <code class="literal">String</code> that satisfies the query is inserted before the <code class="literal">Integer</code>, such as in the following example commands:
				</p><div class="formalpara"><p class="title"><strong>Example commands that should trigger the rule execution</strong></p><p>
						
<pre class="programlisting language-java">KieSession ksession = ...
ksession.insert("1");
ksession.insert(1);
ksession.fireAllRules();</pre>
					</p></div><p>
					However, due to the default lazy propagation behavior in Phreak, the decision engine does not detect the insertion sequence of the two facts in this case, so this rule is executed regardless of <code class="literal">String</code> and <code class="literal">Integer</code> insertion order. For this example, immediate propagation is required for the expected rule evaluation.
				</p><p>
					To alter the decision engine propagation mode to achieve the expected rule evaluation in this case, you can add the <code class="literal">@Propagation(&lt;type&gt;)</code> tag to your rule and set <code class="literal">&lt;type&gt;</code> to <code class="literal">LAZY</code>, <code class="literal">IMMEDIATE</code>, or <code class="literal">EAGER</code>.
				</p><p>
					In the same example rule, the immediate propagation annotation enables the rule to be evaluated only when a <code class="literal">String</code> that satisfies the query is inserted before the <code class="literal">Integer</code>, as expected:
				</p><div class="formalpara"><p class="title"><strong>Example rule with a passive query and specified propagation mode</strong></p><p>
						
<pre class="screen">query Q (Integer i)
    String( this == i.toString() )
end

rule "Rule" @Propagation(IMMEDIATE)
  when
    $i : Integer()
    ?Q( $i; )
  then
    System.out.println( $i );
end</pre>
					</p></div></section><section class="section" id="agenda-filters-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">81.6. Agenda evaluation filters</h2></div></div></div><p>
					The decision engine supports an <code class="literal">AgendaFilter</code> object in the filter interface that you can use to allow or deny the evaluation of specified rules during agenda evaluation. You can specify an agenda filter as part of a <code class="literal">fireAllRules()</code> call.
				</p><p>
					The following example code permits only rules ending with the string <code class="literal">"Test"</code> to be evaluated and executed. All other rules are filtered out of the decision engine agenda.
				</p><div class="formalpara"><p class="title"><strong>Example agenda filter definition</strong></p><p>
						
<pre class="programlisting language-java">ksession.fireAllRules( new RuleNameEndsWithAgendaFilter( "Test" ) );</pre>
					</p></div></section><section class="section" id="drl-rule-units-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">81.7. Rule units in DRL rule sets</h2></div></div></div><p>
					Rule units are groups of data sources, global variables, and DRL rules that function together for a specific purpose. You can use rule units to partition a rule set into smaller units, bind different data sources to those units, and then execute the individual unit. Rule units are an enhanced alternative to rule-grouping DRL attributes such as rule agenda groups or activation groups for execution control.
				</p><p>
					Rule units are helpful when you want to coordinate rule execution so that the complete execution of one rule unit triggers the start of another rule unit and so on. For example, assume that you have a set of rules for data enrichment, another set of rules that processes that data, and another set of rules that extract the output from the processed data. If you add these rule sets into three distinct rule units, you can coordinate those rule units so that complete execution of the first unit triggers the start of the second unit and the complete execution of the second unit triggers the start of third unit.
				</p><p>
					To define a rule unit, implement the <code class="literal">RuleUnit</code> interface as shown in the following example:
				</p><div class="formalpara"><p class="title"><strong>Example rule unit class</strong></p><p>
						
<pre class="programlisting language-java">package org.mypackage.myunit;

public static class AdultUnit implements RuleUnit {
    private int adultAge;
    private DataSource&lt;Person&gt; persons;

    public AdultUnit( ) { }

    public AdultUnit( DataSource&lt;Person&gt; persons, int age ) {
        this.persons = persons;
        this.age = age;
    }

    // A data source of `Persons` in this rule unit:
    public DataSource&lt;Person&gt; getPersons() {
        return persons;
    }

    // A global variable in this rule unit:
    public int getAdultAge() {
        return adultAge;
    }

    // Life-cycle methods:
    @Override
    public void onStart() {
        System.out.println("AdultUnit started.");
    }

    @Override
    public void onEnd() {
        System.out.println("AdultUnit ended.");
    }
}</pre>
					</p></div><p>
					In this example, <code class="literal">persons</code> is a source of facts of type <code class="literal">Person</code>. A rule unit data source is a source of the data processed by a given rule unit and represents the entry point that the decision engine uses to evaluate the rule unit. The <code class="literal">adultAge</code> global variable is accessible from all the rules belonging to this rule unit. The last two methods are part of the rule unit life cycle and are invoked by the decision engine.
				</p><p>
					The decision engine supports the following optional life-cycle methods for rule units:
				</p><div class="table" id="idm139921818061184"><p class="title"><strong>Table 81.1. Rule unit life-cycle methods</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 50%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921818056336" scope="col">Method</th><th align="left" valign="top" id="idm139921818055248" scope="col">Invoked when</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921818056336">
								<p>
									<code class="literal">onStart()</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921818055248">
								<p>
									Rule unit execution starts
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921818056336">
								<p>
									<code class="literal">onEnd()</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921818055248">
								<p>
									Rule unit execution ends
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921818056336">
								<p>
									<code class="literal">onSuspend()</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921818055248">
								<p>
									Rule unit execution is suspended (used only with <code class="literal">runUntilHalt()</code>)
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921818056336">
								<p>
									<code class="literal">onResume()</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921818055248">
								<p>
									Rule unit execution is resumed (used only with <code class="literal">runUntilHalt()</code>)
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm139921818056336">
								<p>
									<code class="literal">onYield(RuleUnit other)</code>
								</p>
								</td><td align="left" valign="top" headers="idm139921818055248">
								<p>
									The consequence of a rule in the rule unit triggers the execution of a different rule unit
								</p>
								</td></tr></tbody></table></div></div><p>
					You can add one or more rules to a rule unit. By default, all the rules in a DRL file are automatically associated with a rule unit that follows the naming convention of the DRL file name. If the DRL file is in the same package and has the same name as a class that implements the <code class="literal">RuleUnit</code> interface, then all of the rules in that DRL file implicitly belong to that rule unit. For example, all the rules in the <code class="literal">AdultUnit.drl</code> file in the <code class="literal">org.mypackage.myunit</code> package are automatically part of the rule unit <code class="literal">org.mypackage.myunit.AdultUnit</code>.
				</p><p>
					To override this naming convention and explicitly declare the rule unit that the rules in a DRL file belong to, use the <code class="literal">unit</code> keyword in the DRL file. The <code class="literal">unit</code> declaration must immediately follow the package declaration and contain the name of the class in that package that the rules in the DRL file are part of.
				</p><div class="formalpara"><p class="title"><strong>Example rule unit declaration in a DRL file</strong></p><p>
						
<pre class="screen">package org.mypackage.myunit
unit AdultUnit

rule Adult
  when
    $p : Person(age &gt;= adultAge) from persons
  then
    System.out.println($p.getName() + " is adult and greater than " + adultAge);
end</pre>
					</p></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						Do not mix rules with and without a rule unit in the same KIE base. Mixing two rule paradigms in a KIE base results in a compilation error.
					</p></div></div><p>
					You can also rewrite the same pattern in a more convenient way using OOPath notation, as shown in the following example:
				</p><div class="formalpara"><p class="title"><strong>Example rule unit declaration in a DRL file that uses OOPath notation</strong></p><p>
						
<pre class="screen">package org.mypackage.myunit
unit AdultUnit

rule Adult
  when
    $p : /persons[age &gt;= adultAge]
  then
    System.out.println($p.getName() + " is adult and greater than " + adultAge);
end</pre>
					</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						OOPath is an object-oriented syntax extension of XPath that is designed for browsing graphs of objects in DRL rule condition constraints. OOPath uses the compact notation from XPath for navigating through related elements while handling collections and filtering constraints, and is specifically useful for graphs of objects.
					</p></div></div><p>
					In this example, any matching facts in the rule conditions are retrieved from the <code class="literal">persons</code> data source defined in the <code class="literal">DataSource</code> definition in the rule unit class. The rule condition and action use the <code class="literal">adultAge</code> variable in the same way that a global variable is defined at the DRL file level.
				</p><p>
					To execute one or more rule units defined in a KIE base, create a new <code class="literal">RuleUnitExecutor</code> class bound to the KIE base, create the rule unit from the relevant data source, and run the rule unit executer:
				</p><div class="formalpara"><p class="title"><strong>Example rule unit execution</strong></p><p>
						
<pre class="programlisting language-java">// Create a `RuleUnitExecutor` class and bind it to the KIE base:
KieBase kbase = kieContainer.getKieBase();
RuleUnitExecutor executor = RuleUnitExecutor.create().bind( kbase );

// Create the `AdultUnit` rule unit using the `persons` data source and run the executor:
RuleUnit adultUnit = new AdultUnit(persons, 18);
executor.run( adultUnit );</pre>
					</p></div><p>
					Rules are executed by the <code class="literal">RuleUnitExecutor</code> class. The <code class="literal">RuleUnitExecutor</code> class creates KIE sessions and adds the required <code class="literal">DataSource</code> objects to those sessions, and then executes the rules based on the <code class="literal">RuleUnit</code> that is passed as a parameter to the <code class="literal">run()</code> method.
				</p><p>
					The example execution code produces the following output when the relevant <code class="literal">Person</code> facts are inserted in the <code class="literal">persons</code> data source:
				</p><div class="formalpara"><p class="title"><strong>Example rule unit execution output</strong></p><p>
						
<pre class="screen">org.mypackage.myunit.AdultUnit started.
Jane is adult and greater than 18
John is adult and greater than 18
org.mypackage.myunit.AdultUnit ended.</pre>
					</p></div><p>
					Instead of explicitly creating the rule unit instance, you can register the rule unit variables in the executor and pass to the executor the rule unit class that you want to run, and then the executor creates an instance of the rule unit. You can then set the <code class="literal">DataSource</code> definition and other variables as needed before running the rule unit.
				</p><div class="formalpara"><p class="title"><strong>Alternate rule unit execution option with registered variables</strong></p><p>
						
<pre class="programlisting language-java">executor.bindVariable( "persons", persons );
        .bindVariable( "adultAge", 18 );
executor.run( AdultUnit.class );</pre>
					</p></div><p>
					The name that you pass to the <code class="literal">RuleUnitExecutor.bindVariable()</code> method is used at run time to bind the variable to the field of the rule unit class with the same name. In the previous example, the <code class="literal">RuleUnitExecutor</code> inserts into the new rule unit the data source bound to the <code class="literal">"persons"</code> name and inserts the value <code class="literal">18</code> bound to the String <code class="literal">"adultAge"</code> into the fields with the corresponding names inside the <code class="literal">AdultUnit</code> class.
				</p><p>
					To override this default variable-binding behavior, use the <code class="literal">@UnitVar</code> annotation to explicitly define a logical binding name for each field of the rule unit class. For example, the field bindings in the following class are redefined with alternative names:
				</p><div class="formalpara"><p class="title"><strong>Example code to modify variable binding names with <code class="literal">@UnitVar</code></strong></p><p>
						
<pre class="programlisting language-java">package org.mypackage.myunit;

public static class AdultUnit implements RuleUnit {
    @UnitVar("minAge")
    private int adultAge = 18;

    @UnitVar("data")
    private DataSource&lt;Person&gt; persons;
}</pre>
					</p></div><p>
					You can then bind the variables to the executor using those alternative names and run the rule unit:
				</p><div class="formalpara"><p class="title"><strong>Example rule unit execution with modified variable names</strong></p><p>
						
<pre class="programlisting language-java">executor.bindVariable( "data", persons );
        .bindVariable( "minAge", 18 );
executor.run( AdultUnit.class );</pre>
					</p></div><p>
					You can execute a rule unit in <span class="emphasis"><em>passive mode</em></span> by using the <code class="literal">run()</code> method (equivalent to invoking <code class="literal">fireAllRules()</code> on a KIE session) or in <span class="emphasis"><em>active mode</em></span> using the <code class="literal">runUntilHalt()</code> method (equivalent to invoking <code class="literal">fireUntilHalt()</code> on a KIE session). By default, the decision engine runs in <span class="emphasis"><em>passive mode</em></span> and evaluates rule units only when a user or an application explicitly calls <code class="literal">run()</code> (or <code class="literal">fireAllRules()</code> for standard rules). If a user or application calls <code class="literal">runUntilHalt()</code> for rule units (or <code class="literal">fireUntilHalt()</code> for standard rules), the decision engine starts in <span class="emphasis"><em>active mode</em></span> and evaluates rule units continually until the user or application explicitly calls <code class="literal">halt()</code>.
				</p><p>
					If you use the <code class="literal">runUntilHalt()</code> method, invoke the method on a separate execution thread to avoid blocking the main thread:
				</p><div class="formalpara"><p class="title"><strong>Example rule unit execution with <code class="literal">runUntilHalt()</code> on a separate thread</strong></p><p>
						
<pre class="programlisting language-java">new Thread( () -&gt; executor.runUntilHalt( adultUnit ) ).start();</pre>
					</p></div><section class="section" id="data_sources_for_rule_units_2"><div class="titlepage"><div><div><h3 class="title">81.7.1. Data sources for rule units</h3></div></div></div><p>
						A rule unit data source is a source of the data processed by a given rule unit and represents the entry point that the decision engine uses to evaluate the rule unit. A rule unit can have zero or more data sources and each <code class="literal">DataSource</code> definition declared inside a rule unit can correspond to a different entry point into the rule unit executor. Multiple rule units can share a single data source, but each rule unit must use different entry points through which the same objects are inserted.
					</p><p>
						You can create a <code class="literal">DataSource</code> definition with a fixed set of data in a rule unit class, as shown in the following example:
					</p><div class="formalpara"><p class="title"><strong>Example data source definition</strong></p><p>
							
<pre class="programlisting language-java">DataSource&lt;Person&gt; persons = DataSource.create( new Person( "John", 42 ),
                                                new Person( "Jane", 44 ),
                                                new Person( "Sally", 4 ) );</pre>
						</p></div><p>
						Because a data source represents the entry point of the rule unit, you can insert, update, or delete facts in a rule unit:
					</p><div class="formalpara"><p class="title"><strong>Example code to insert, modify, and delete a fact in a rule unit</strong></p><p>
							
<pre class="programlisting language-java">// Insert a fact:
Person john = new Person( "John", 42 );
FactHandle johnFh = persons.insert( john );

// Modify the fact and optionally specify modified properties (for property reactivity):
john.setAge( 43 );
persons.update( johnFh, john, "age" );

// Delete the fact:
persons.delete( johnFh );</pre>
						</p></div></section><section class="section" id="rule_unit_execution_control_2"><div class="titlepage"><div><div><h3 class="title">81.7.2. Rule unit execution control</h3></div></div></div><p>
						Rule units are helpful when you want to coordinate rule execution so that the execution of one rule unit triggers the start of another rule unit and so on.
					</p><p>
						To facilitate rule unit execution control, the decision engine supports the following rule unit methods that you can use in DRL rule actions to coordinate the execution of rule units:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">drools.run()</code>: Triggers the execution of a specified rule unit class. This method imperatively interrupts the execution of the rule unit and activates the other specified rule unit.
							</li><li class="listitem">
								<code class="literal">drools.guard()</code>: Prevents (guards) a specified rule unit class from being executed until the associated rule condition is met. This method declaratively schedules the execution of the other specified rule unit. When the decision engine produces at least one match for the condition in the guarding rule, the guarded rule unit is considered active. A rule unit can contain multiple guarding rules.
							</li></ul></div><p>
						As an example of the <code class="literal">drools.run()</code> method, consider the following DRL rules that each belong to a specified rule unit. The <code class="literal">NotAdult</code> rule uses the <code class="literal">drools.run( AdultUnit.class )</code> method to trigger the execution of the <code class="literal">AdultUnit</code> rule unit:
					</p><div class="formalpara"><p class="title"><strong>Example DRL rules with controlled execution using <code class="literal">drools.run()</code></strong></p><p>
							
<pre class="screen">package org.mypackage.myunit
unit AdultUnit

rule Adult
  when
    Person(age &gt;= 18, $name : name) from persons
  then
    System.out.println($name + " is adult");
end</pre>
						</p></div><pre class="screen">package org.mypackage.myunit
unit NotAdultUnit

rule NotAdult
  when
    $p : Person(age &lt; 18, $name : name) from persons
  then
    System.out.println($name + " is NOT adult");
    modify($p) { setAge(18); }
    drools.run( AdultUnit.class );
end</pre><p>
						The example also uses a <code class="literal">RuleUnitExecutor</code> class created from the KIE base that was built from these rules and a <code class="literal">DataSource</code> definition of <code class="literal">persons</code> bound to it:
					</p><div class="formalpara"><p class="title"><strong>Example rule executor and data source definitions</strong></p><p>
							
<pre class="programlisting language-java">RuleUnitExecutor executor = RuleUnitExecutor.create().bind( kbase );
DataSource&lt;Person&gt; persons = executor.newDataSource( "persons",
                                                     new Person( "John", 42 ),
                                                     new Person( "Jane", 44 ),
                                                     new Person( "Sally", 4 ) );</pre>
						</p></div><p>
						In this case, the example creates the <code class="literal">DataSource</code> definition directly from the <code class="literal">RuleUnitExecutor</code> class and binds it to the <code class="literal">"persons"</code> variable in a single statement.
					</p><p>
						The example execution code produces the following output when the relevant <code class="literal">Person</code> facts are inserted in the <code class="literal">persons</code> data source:
					</p><div class="formalpara"><p class="title"><strong>Example rule unit execution output</strong></p><p>
							
<pre class="screen">Sally is NOT adult
John is adult
Jane is adult
Sally is adult</pre>
						</p></div><p>
						The <code class="literal">NotAdult</code> rule detects a match when evaluating the person <code class="literal">"Sally"</code>, who is under 18 years old. The rule then modifies her age to <code class="literal">18</code> and uses the <code class="literal">drools.run( AdultUnit.class )</code> method to trigger the execution of the <code class="literal">AdultUnit</code> rule unit. The <code class="literal">AdultUnit</code> rule unit contains a rule that can now be executed for all of the 3 <code class="literal">persons</code> in the <code class="literal">DataSource</code> definition.
					</p><p>
						As an example of the <code class="literal">drools.guard()</code> method, consider the following <code class="literal">BoxOffice</code> class and <code class="literal">BoxOfficeUnit</code> rule unit class:
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">BoxOffice</code> class</strong></p><p>
							
<pre class="programlisting language-java">public class BoxOffice {
    private boolean open;

    public BoxOffice( boolean open ) {
        this.open = open;
    }

    public boolean isOpen() {
        return open;
    }

    public void setOpen( boolean open ) {
        this.open = open;
    }
}</pre>
						</p></div><div class="formalpara"><p class="title"><strong>Example <code class="literal">BoxOfficeUnit</code> rule unit class</strong></p><p>
							
<pre class="programlisting language-java">public class BoxOfficeUnit implements RuleUnit {
    private DataSource&lt;BoxOffice&gt; boxOffices;

    public DataSource&lt;BoxOffice&gt; getBoxOffices() {
        return boxOffices;
    }
}</pre>
						</p></div><p>
						The example also uses the following <code class="literal">TicketIssuerUnit</code> rule unit class to keep selling box office tickets for the event as long as at least one box office is open. This rule unit uses <code class="literal">DataSource</code> definitions of <code class="literal">persons</code> and <code class="literal">tickets</code>:
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">TicketIssuerUnit</code> rule unit class</strong></p><p>
							
<pre class="programlisting language-java">public class TicketIssuerUnit implements RuleUnit {
    private DataSource&lt;Person&gt; persons;
    private DataSource&lt;AdultTicket&gt; tickets;

    private List&lt;String&gt; results;

    public TicketIssuerUnit() { }

    public TicketIssuerUnit( DataSource&lt;Person&gt; persons, DataSource&lt;AdultTicket&gt; tickets ) {
        this.persons = persons;
        this.tickets = tickets;
    }

    public DataSource&lt;Person&gt; getPersons() {
        return persons;
    }

    public DataSource&lt;AdultTicket&gt; getTickets() {
        return tickets;
    }

    public List&lt;String&gt; getResults() {
        return results;
    }
}</pre>
						</p></div><p>
						The <code class="literal">BoxOfficeUnit</code> rule unit contains a <code class="literal">BoxOfficeIsOpen</code> DRL rule that uses the <code class="literal">drools.guard( TicketIssuerUnit.class )</code> method to guard the execution of the <code class="literal">TicketIssuerUnit</code> rule unit that distributes the event tickets, as shown in the following DRL rule examples:
					</p><div class="formalpara"><p class="title"><strong>Example DRL rules with controlled execution using <code class="literal">drools.guard()</code></strong></p><p>
							
<pre class="screen">package org.mypackage.myunit;
unit TicketIssuerUnit;

rule IssueAdultTicket when
    $p: /persons[ age &gt;= 18 ]
then
    tickets.insert(new AdultTicket($p));
end
rule RegisterAdultTicket when
    $t: /tickets
then
    results.add( $t.getPerson().getName() );
end</pre>
						</p></div><pre class="screen">package org.mypackage.myunit;
unit BoxOfficeUnit;

rule BoxOfficeIsOpen
  when
    $box: /boxOffices[ open ]
  then
    drools.guard( TicketIssuerUnit.class );
end</pre><p>
						In this example, so long as at least one box office is <code class="literal">open</code>, the guarded <code class="literal">TicketIssuerUnit</code> rule unit is active and distributes event tickets. When no more box offices are in <code class="literal">open</code> state, the guarded <code class="literal">TicketIssuerUnit</code> rule unit is prevented from being executed.
					</p><p>
						The following example class illustrates a more complete box office scenario:
					</p><div class="formalpara"><p class="title"><strong>Example class for the box office scenario</strong></p><p>
							
<pre class="programlisting language-java">DataSource&lt;Person&gt; persons = executor.newDataSource( "persons" );
DataSource&lt;BoxOffice&gt; boxOffices = executor.newDataSource( "boxOffices" );
DataSource&lt;AdultTicket&gt; tickets = executor.newDataSource( "tickets" );

List&lt;String&gt; list = new ArrayList&lt;&gt;();
executor.bindVariable( "results", list );

// Two box offices are open:
BoxOffice office1 = new BoxOffice(true);
FactHandle officeFH1 = boxOffices.insert( office1 );
BoxOffice office2 = new BoxOffice(true);
FactHandle officeFH2 = boxOffices.insert( office2 );

persons.insert(new Person("John", 40));

// Execute `BoxOfficeIsOpen` rule, run `TicketIssuerUnit` rule unit, and execute `RegisterAdultTicket` rule:
executor.run(BoxOfficeUnit.class);

assertEquals( 1, list.size() );
assertEquals( "John", list.get(0) );
list.clear();

persons.insert(new Person("Matteo", 30));

// Execute `RegisterAdultTicket` rule:
executor.run(BoxOfficeUnit.class);

assertEquals( 1, list.size() );
assertEquals( "Matteo", list.get(0) );
list.clear();

// One box office is closed, the other is open:
office1.setOpen(false);
boxOffices.update(officeFH1, office1);
persons.insert(new Person("Mark", 35));
executor.run(BoxOfficeUnit.class);

assertEquals( 1, list.size() );
assertEquals( "Mark", list.get(0) );
list.clear();

// All box offices are closed:
office2.setOpen(false);
boxOffices.update(officeFH2, office2); // Guarding rule is no longer true.
persons.insert(new Person("Edson", 35));
executor.run(BoxOfficeUnit.class); // No execution

assertEquals( 0, list.size() );</pre>
						</p></div></section><section class="section" id="rule_unit_identity_conflicts_2"><div class="titlepage"><div><div><h3 class="title">81.7.3. Rule unit identity conflicts</h3></div></div></div><p>
						In rule unit execution scenarios with guarded rule units, a rule can guard multiple rule units and at the same time a rule unit can be guarded and then activated by multiple rules. For these two-way guarding scenarios, rule units must have a clearly defined identity to avoid identity conflicts.
					</p><p>
						By default, the identity of a rule unit is the rule unit class name and is treated as a singleton class by the <code class="literal">RuleUnitExecutor</code>. This identification behavior is encoded in the <code class="literal">getUnitIdentity()</code> default method of the <code class="literal">RuleUnit</code> interface:
					</p><div class="formalpara"><p class="title"><strong>Default identity method in the <code class="literal">RuleUnit</code> interface</strong></p><p>
							
<pre class="programlisting language-java">default Identity getUnitIdentity() {
    return new Identity( getClass() );
}</pre>
						</p></div><p>
						In some cases, you may need to override this default identification behavior to avoid conflicting identities between rule units.
					</p><p>
						For example, the following <code class="literal">RuleUnit</code> class contains a <code class="literal">DataSource</code> definition that accepts any kind of object:
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">Unit0</code> rule unit class</strong></p><p>
							
<pre class="programlisting language-java">public class Unit0 implements RuleUnit {
    private DataSource&lt;Object&gt; input;

    public DataSource&lt;Object&gt; getInput() {
        return input;
    }
}</pre>
						</p></div><p>
						This rule unit contains the following DRL rule that guards another rule unit based on two conditions (in OOPath notation):
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">GuardAgeCheck</code> DRL rule in the rule unit</strong></p><p>
							
<pre class="screen">package org.mypackage.myunit
unit Unit0

rule GuardAgeCheck
  when
    $i: /input#Integer
    $s: /input#String
  then
    drools.guard( new AgeCheckUnit($i) );
    drools.guard( new AgeCheckUnit($s.length()) );
end</pre>
						</p></div><p>
						The guarded <code class="literal">AgeCheckUnit</code> rule unit verifies the age of a set of <code class="literal">persons</code>. The <code class="literal">AgeCheckUnit</code> contains a <code class="literal">DataSource</code> definition of the <code class="literal">persons</code> to check, a <code class="literal">minAge</code> variable that it verifies against, and a <code class="literal">List</code> for gathering the results:
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">AgeCheckUnit</code> rule unit</strong></p><p>
							
<pre class="programlisting language-java">public class AgeCheckUnit implements RuleUnit {
    private final int minAge;
    private DataSource&lt;Person&gt; persons;
    private List&lt;String&gt; results;

    public AgeCheckUnit( int minAge ) {
        this.minAge = minAge;
    }

    public DataSource&lt;Person&gt; getPersons() {
        return persons;
    }

    public int getMinAge() {
        return minAge;
    }

    public List&lt;String&gt; getResults() {
        return results;
    }
}</pre>
						</p></div><p>
						The <code class="literal">AgeCheckUnit</code> rule unit contains the following DRL rule that performs the verification of the <code class="literal">persons</code> in the data source:
					</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">CheckAge</code> DRL rule in the rule unit</strong></p><p>
							
<pre class="screen">package org.mypackage.myunit
unit AgeCheckUnit

rule CheckAge
  when
    $p : /persons{ age &gt; minAge }
  then
    results.add($p.getName() + "&gt;" + minAge);
end</pre>
						</p></div><p>
						This example creates a <code class="literal">RuleUnitExecutor</code> class, binds the class to the KIE base that contains these two rule units, and creates the two <code class="literal">DataSource</code> definitions for the same rule units:
					</p><div class="formalpara"><p class="title"><strong>Example executor and data source definitions</strong></p><p>
							
<pre class="programlisting language-java">RuleUnitExecutor executor = RuleUnitExecutor.create().bind( kbase );

DataSource&lt;Object&gt; input = executor.newDataSource( "input" );
DataSource&lt;Person&gt; persons = executor.newDataSource( "persons",
                                                     new Person( "John", 42 ),
                                                     new Person( "Sally", 4 ) );

List&lt;String&gt; results = new ArrayList&lt;&gt;();
executor.bindVariable( "results", results );</pre>
						</p></div><p>
						You can now insert some objects into the input data source and execute the <code class="literal">Unit0</code> rule unit:
					</p><div class="formalpara"><p class="title"><strong>Example rule unit execution with inserted objects</strong></p><p>
							
<pre class="programlisting language-java">ds.insert("test");
ds.insert(3);
ds.insert(4);
executor.run(Unit0.class);</pre>
						</p></div><div class="formalpara"><p class="title"><strong>Example results list from the execution</strong></p><p>
							
<pre class="programlisting language-java">[Sally&gt;3, John&gt;3]</pre>
						</p></div><p>
						In this example, the rule unit named <code class="literal">AgeCheckUnit</code> is considered a singleton class and then executed only once, with the <code class="literal">minAge</code> variable set to <code class="literal">3</code>. Both the String <code class="literal">"test"</code> and the Integer <code class="literal">4</code> inserted into the input data source can also trigger a second execution with the <code class="literal">minAge</code> variable set to <code class="literal">4</code>. However, the second execution does not occur because another rule unit with the same identity has already been evaluated.
					</p><p>
						To resolve this rule unit identity conflict, override the <code class="literal">getUnitIdentity()</code> method in the <code class="literal">AgeCheckUnit</code> class to include also the <code class="literal">minAge</code> variable in the rule unit identity:
					</p><div class="formalpara"><p class="title"><strong>Modified <code class="literal">AgeCheckUnit</code> rule unit to override the <code class="literal">getUnitIdentity()</code> method</strong></p><p>
							
<pre class="programlisting language-java">public class AgeCheckUnit implements RuleUnit {

    ...

    @Override
    public Identity getUnitIdentity() {
        return new Identity(getClass(), minAge);
    }
}</pre>
						</p></div><p>
						With this override in place, the previous example rule unit execution produces the following output:
					</p><div class="formalpara"><p class="title"><strong>Example results list from executing the modified rule unit</strong></p><p>
							
<pre class="programlisting language-java">[John&gt;4, Sally&gt;3, John&gt;3]</pre>
						</p></div><p>
						The rule units with <code class="literal">minAge</code> set to <code class="literal">3</code> and <code class="literal">4</code> are now considered two different rule units and both are executed.
					</p></section></section></section><section class="chapter" id="phreak-algorithm-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">Chapter 82. Phreak rule algorithm in the decision engine</h2></div></div></div><p>
				The decision engine in Red Hat Process Automation Manager uses the Phreak algorithm for rule evaluation. Phreak evolved from the Rete algorithm, including the enhanced Rete algorithm ReteOO that was introduced in previous versions of Red Hat Process Automation Manager for object-oriented systems. Overall, Phreak is more scalable than Rete and ReteOO, and is faster in large systems.
			</p><p>
				While Rete is considered eager (immediate rule evaluation) and data oriented, Phreak is considered lazy (delayed rule evaluation) and goal oriented. The Rete algorithm performs many actions during the insert, update, and delete actions in order to find partial matches for all rules. This eagerness of the Rete algorithm during rule matching requires a lot of time before eventually executing rules, especially in large systems. With Phreak, this partial matching of rules is delayed deliberately to handle large amounts of data more efficiently.
			</p><p>
				The Phreak algorithm adds the following set of enhancements to previous Rete algorithms:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Three layers of contextual memory: Node, segment, and rule memory types
					</li><li class="listitem">
						Rule-based, segment-based, and node-based linking
					</li><li class="listitem">
						Lazy (delayed) rule evaluation
					</li><li class="listitem">
						Stack-based evaluations with pause and resume
					</li><li class="listitem">
						Isolated rule evaluation
					</li><li class="listitem">
						Set-oriented propagations
					</li></ul></div><section class="section" id="phreak-rule-evaluation-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">82.1. Rule evaluation in Phreak</h2></div></div></div><p>
					When the decision engine starts, all rules are considered to be <span class="emphasis"><em>unlinked</em></span> from pattern-matching data that can trigger the rules. At this stage, the Phreak algorithm in the decision engine does not evaluate the rules. The <code class="literal">insert</code>, <code class="literal">update</code>, and <code class="literal">delete</code> actions are queued, and Phreak uses a heuristic, based on the rule most likely to result in execution, to calculate and select the next rule for evaluation. When all the required input values are populated for a rule, the rule is considered to be <span class="emphasis"><em>linked</em></span> to the relevant pattern-matching data. Phreak then creates a goal that represents this rule and places the goal into a priority queue that is ordered by rule salience. Only the rule for which the goal was created is evaluated, and other potential rule evaluations are delayed. While individual rules are evaluated, node sharing is still achieved through the process of segmentation.
				</p><p>
					Unlike the tuple-oriented Rete, the Phreak propagation is collection oriented. For the rule that is being evaluated, the decision engine accesses the first node and processes all queued insert, update, and delete actions. The results are added to a set, and the set is propagated to the child node. In the child node, all queued insert, update, and delete actions are processed, adding the results to the same set. The set is then propagated to the next child node and the same process repeats until it reaches the terminal node. This cycle creates a batch process effect that can provide performance advantages for certain rule constructs.
				</p><p>
					The linking and unlinking of rules happens through a layered bit-mask system, based on network segmentation. When the rule network is built, segments are created for rule network nodes that are shared by the same set of rules. A rule is composed of a path of segments. In case a rule does not share any node with any other rule, it becomes a single segment.
				</p><p>
					A bit-mask offset is assigned to each node in the segment. Another bit mask is assigned to each segment in the path of the rule according to these requirements:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							If at least one input for a node exists, the node bit is set to the <code class="literal">on</code> state.
						</li><li class="listitem">
							If each node in a segment has the bit set to the <code class="literal">on</code> state, the segment bit is also set to the <code class="literal">on</code> state.
						</li><li class="listitem">
							If any node bit is set to the <code class="literal">off</code> state, the segment is also set to the <code class="literal">off</code> state.
						</li><li class="listitem">
							If each segment in the path of the rule is set to the <code class="literal">on</code> state, the rule is considered linked, and a goal is created to schedule the rule for evaluation.
						</li></ul></div><p>
					The same bit-mask technique is used to track modified nodes, segments, and rules. This tracking ability enables an already linked rule to be unscheduled from evaluation if it has been modified since the evaluation goal for it was created. As a result, no rules can ever evaluate partial matches.
				</p><p>
					This process of rule evaluation is possible in Phreak because, as opposed to a single unit of memory in Rete, Phreak has three layers of contextual memory with node, segment, and rule memory types. This layering enables much more contextual understanding during the evaluation of a rule.
				</p><div class="figure" id="idm139921817828608"><p class="title"><strong>Figure 82.1. Phreak three-layered memory system</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/HybridReasoning/LayeredMemory_enterprise.png" alt="LayeredMemory enterprise"/></div></div></div><p>
					The following examples illustrate how rules are organized and evaluated in this three-layered memory system in Phreak.
				</p><p>
					<span class="strong strong"><strong>Example 1:</strong></span> A single rule (R1) with three patterns: A, B and C. The rule forms a single segment, with bits 1, 2, and 4 for the nodes. The single segment has a bit offset of 1.
				</p><div class="figure" id="idm139921817822400"><p class="title"><strong>Figure 82.2. Example 1: Single rule</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/HybridReasoning/segment1_enterprise.png" alt="segment1 enterprise"/></div></div></div><p>
					<span class="strong strong"><strong>Example 2:</strong></span> Rule R2 is added and shares pattern A.
				</p><div class="figure" id="idm139921817816960"><p class="title"><strong>Figure 82.3. Example 2: Two rules with pattern sharing</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/HybridReasoning/segment2_enterprise.png" alt="segment2 enterprise"/></div></div></div><p>
					Pattern A is placed in its own segment, resulting in two segments for each rule. Those two segments form a path for their respective rules. The first segment is shared by both paths. When pattern A is linked, the segment becomes linked. The segment then iterates over each path that the segment is shared by, setting the bit 1 to <code class="literal">on</code>. If patterns B and C are later turned on, the second segment for path R1 is linked, and this causes bit 2 to be turned on for R1. With bit 1 and bit 2 turned on for R1, the rule is now linked and a goal is created to schedule the rule for later evaluation and execution.
				</p><p>
					When a rule is evaluated, the segments enable the results of the matching to be shared. Each segment has a staging memory to queue all inserts, updates, and deletes for that segment. When R1 is evaluated, the rule processes pattern A, and this results in a set of tuples. The algorithm detects a segmentation split, creates peered tuples for each insert, update, and delete in the set, and adds them to the R2 staging memory. Those tuples are then merged with any existing staged tuples and are executed when R2 is eventually evaluated.
				</p><p>
					<span class="strong strong"><strong>Example 3:</strong></span> Rules R3 and R4 are added and share patterns A and B.
				</p><div class="figure" id="idm139921817808928"><p class="title"><strong>Figure 82.4. Example 3: Three rules with pattern sharing</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/HybridReasoning/segment3_enterprise.png" alt="segment3 enterprise"/></div></div></div><p>
					Rules R3 and R4 have three segments and R1 has two segments. Patterns A and B are shared by R1, R3, and R4, while pattern D is shared by R3 and R4.
				</p><p>
					<span class="strong strong"><strong>Example 4:</strong></span> A single rule (R1) with a subnetwork and no pattern sharing.
				</p><div class="figure" id="idm139921817802816"><p class="title"><strong>Figure 82.5. Example 4: Single rule with a subnetwork and no pattern sharing</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/HybridReasoning/segment4_enterprise.png" alt="segment4 enterprise"/></div></div></div><p>
					Subnetworks are formed when a <code class="literal">Not</code>, <code class="literal">Exists</code>, or <code class="literal">Accumulate</code> node contains more than one element. In this example, the element <code class="literal">B not( C )</code> forms the subnetwork. The element <code class="literal">not( C )</code> is a single element that does not require a subnetwork and is therefore merged inside of the <code class="literal">Not</code> node. The subnetwork uses a dedicated segment. Rule R1 still has a path of two segments and the subnetwork forms another inner path. When the subnetwork is linked, it is also linked in the outer segment.
				</p><p>
					<span class="strong strong"><strong>Example 5:</strong></span> Rule R1 with a subnetwork that is shared by rule R2.
				</p><div class="figure" id="idm139921817793600"><p class="title"><strong>Figure 82.6. Example 5: Two rules, one with a subnetwork and pattern sharing</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/HybridReasoning/segment5_enterprise.png" alt="segment5 enterprise"/></div></div></div><p>
					The subnetwork nodes in a rule can be shared by another rule that does not have a subnetwork. This sharing causes the subnetwork segment to be split into two segments.
				</p><p>
					Constrained <code class="literal">Not</code> nodes and <code class="literal">Accumulate</code> nodes can never unlink a segment, and are always considered to have their bits turned on.
				</p><p>
					The Phreak evaluation algorithm is stack based instead of method-recursion based. Rule evaluation can be paused and resumed at any time when a <code class="literal">StackEntry</code> is used to represent the node currently being evaluated.
				</p><p>
					When a rule evaluation reaches a subnetwork, a <code class="literal">StackEntry</code> object is created for the outer path segment and the subnetwork segment. The subnetwork segment is evaluated first, and when the set reaches the end of the subnetwork path, the segment is merged into a staging list for the outer node that the segment feeds into. The previous <code class="literal">StackEntry</code> object is then resumed and can now process the results of the subnetwork. This process has the added benefit, especially for <code class="literal">Accumulate</code> nodes, that all work is completed in a batch, before propagating to the child node.
				</p><p>
					The same stack system is used for efficient backward chaining. When a rule evaluation reaches a query node, the evaluation is paused and the query is added to the stack. The query is then evaluated to produce a result set, which is saved in a memory location for the resumed <code class="literal">StackEntry</code> object to pick up and propagate to the child node. If the query itself called other queries, the process repeats, while the current query is paused and a new evaluation is set up for the current query node.
				</p><section class="section" id="forward-and-backward-chaining-con_decision-engine"><div class="titlepage"><div><div><h3 class="title">82.1.1. Rule evaluation with forward and backward chaining</h3></div></div></div><p>
						The decision engine in Red Hat Process Automation Manager is a hybrid reasoning system that uses both forward chaining and backward chaining to evaluate rules. A forward-chaining rule system is a data-driven system that starts with a fact in the working memory of the decision engine and reacts to changes to that fact. When objects are inserted into working memory, any rule conditions that become true as a result of the change are scheduled for execution by the agenda.
					</p><p>
						In contrast, a backward-chaining rule system is a goal-driven system that starts with a conclusion that the decision engine attempts to satisfy, often using recursion. If the system cannot reach the conclusion or goal, it searches for subgoals, which are conclusions that complete part of the current goal. The system continues this process until either the initial conclusion is satisfied or all subgoals are satisfied.
					</p><p>
						The following diagram illustrates how the decision engine evaluates rules using forward chaining overall with a backward-chaining segment in the logic flow:
					</p><div class="figure" id="idm139921817778384"><p class="title"><strong>Figure 82.7. Rule evaluation logic using forward and backward chaining</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/BackwardChaining/RuleEvaluation_Enterprise.png" alt="RuleEvaluation Enterprise"/></div></div></div></section></section><section class="section" id="rule-base-configuration-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">82.2. Rule base configuration</h2></div></div></div><p>
					Red Hat Process Automation Manager contains a <code class="literal">RuleBaseConfiguration.java</code> object that you can use to configure exception handler settings, multithreaded execution, and sequential mode in the decision engine.
				</p><p>
					For the rule base configuration options, download the <span class="strong strong"><strong>Red Hat Process Automation Manager 7.10.0 Source Distribution</strong></span> ZIP file from the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Red Hat Customer Portal</a> and navigate to <code class="literal">~/rhpam-7.10.0-sources/src/drools-$VERSION/drools-core/src/main/java/org/drools/core/RuleBaseConfiguration.java</code>.
				</p><p>
					The following rule base configuration options are available for the decision engine:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">drools.consequenceExceptionHandler</span></dt><dd><p class="simpara">
								When configured, this system property defines the class that manages the exceptions thrown by rule consequences. You can use this property to specify a custom exception handler for rule evaluation in the decision engine.
							</p><p class="simpara">
								Default value: <code class="literal">org.drools.core.runtime.rule.impl.DefaultConsequenceExceptionHandler</code>
							</p><p class="simpara">
								You can specify the custom exception handler using one of the following options:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										Specify the exception handler in a system property:
									</p><pre class="screen">drools.consequenceExceptionHandler=org.drools.core.runtime.rule.impl.MyCustomConsequenceExceptionHandler</pre></li><li class="listitem"><p class="simpara">
										Specify the exception handler while creating the KIE base programmatically:
									</p><pre class="programlisting language-java">KieServices ks = KieServices.Factory.get();
KieBaseConfiguration kieBaseConf = ks.newKieBaseConfiguration(); kieBaseConf.setOption(ConsequenceExceptionHandlerOption.get(MyCustomConsequenceExceptionHandler.class));
KieBase kieBase = kieContainer.newKieBase(kieBaseConf);</pre></li></ul></div></dd><dt><span class="term">drools.multithreadEvaluation</span></dt><dd><p class="simpara">
								When enabled, this system property enables the decision engine to evaluate rules in parallel by dividing the Phreak rule network into independent partitions. You can use this property to increase the speed of rule evaluation for specific rule bases.
							</p><p class="simpara">
								Default value: <code class="literal">false</code>
							</p><p class="simpara">
								You can enable multithreaded evaluation using one of the following options:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										Enable the multithreaded evaluation system property:
									</p><pre class="screen">drools.multithreadEvaluation=true</pre></li><li class="listitem"><p class="simpara">
										Enable multithreaded evaluation while creating the KIE base programmatically:
									</p><pre class="programlisting language-java">KieServices ks = KieServices.Factory.get();
KieBaseConfiguration kieBaseConf = ks.newKieBaseConfiguration();
kieBaseConf.setOption(MultithreadEvaluationOption.YES);
KieBase kieBase = kieContainer.newKieBase(kieBaseConf);</pre></li></ul></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
									Rules that use queries, salience, or agenda groups are currently not supported by the parallel decision engine. If these rule elements are present in the KIE base, the compiler emits a warning and automatically switches back to single-threaded evaluation. However, in some cases, the decision engine might not detect the unsupported rule elements and rules might be evaluated incorrectly. For example, the decision engine might not detect when rules rely on implicit salience given by rule ordering inside the DRL file, resulting in incorrect evaluation due to the unsupported salience attribute.
								</p></div></div></dd><dt><span class="term">drools.sequential</span></dt><dd><p class="simpara">
								When enabled, this system property enables sequential mode in the decision engine. In sequential mode, the decision engine evaluates rules one time in the order that they are listed in the decision engine agenda without regard to changes in the working memory. This means that the decision engine ignores any <code class="literal">insert</code>, <code class="literal">modify</code>, or <code class="literal">update</code> statements in rules and executes rules in a single sequence. As a result, rule execution may be faster in sequential mode, but important updates may not be applied to your rules. You can use this property if you use stateless KIE sessions and you do not want the execution of rules to influence subsequent rules in the agenda. Sequential mode applies to stateless KIE sessions only.
							</p><p class="simpara">
								Default value: <code class="literal">false</code>
							</p><p class="simpara">
								You can enable sequential mode using one of the following options:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										Enable the sequential mode system property:
									</p><pre class="screen">drools.sequential=true</pre></li><li class="listitem"><p class="simpara">
										Enable sequential mode while creating the KIE base programmatically:
									</p><pre class="programlisting language-java">KieServices ks = KieServices.Factory.get();
KieBaseConfiguration kieBaseConf = ks.newKieBaseConfiguration();
kieBaseConf.setOption(SequentialOption.YES);
KieBase kieBase = kieContainer.newKieBase(kieBaseConf);</pre></li><li class="listitem"><p class="simpara">
										Enable sequential mode in the KIE module descriptor file (<code class="literal">kmodule.xml</code>) for a specific Red Hat Process Automation Manager project:
									</p><pre class="programlisting language-xml">&lt;kmodule&gt;
  ...
  &lt;kbase name="KBase2" default="false" sequential="true" packages="org.domain.pkg2, org.domain.pkg3" includes="KBase1"&gt;
    ...
  &lt;/kbase&gt;
  ...
&lt;/kmodule&gt;</pre></li></ul></div></dd></dl></div></section><section class="section" id="phreak-sequential-mode-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">82.3. Sequential mode in Phreak</h2></div></div></div><p>
					Sequential mode is an advanced rule base configuration in the decision engine, supported by Phreak, that enables the decision engine to evaluate rules one time in the order that they are listed in the decision engine agenda without regard to changes in the working memory. In sequential mode, the decision engine ignores any <code class="literal">insert</code>, <code class="literal">modify</code>, or <code class="literal">update</code> statements in rules and executes rules in a single sequence. As a result, rule execution may be faster in sequential mode, but important updates may not be applied to your rules.
				</p><p>
					Sequential mode applies to only stateless KIE sessions because stateful KIE sessions inherently use data from previously invoked KIE sessions. If you use a stateless KIE session and you want the execution of rules to influence subsequent rules in the agenda, then do not enable sequential mode. Sequential mode is disabled by default in the decision engine.
				</p><p>
					To enable sequential mode, use one of the following options:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Set the system property <code class="literal">drools.sequential</code> to <code class="literal">true</code>.
						</li><li class="listitem"><p class="simpara">
							Enable sequential mode while creating the KIE base programmatically:
						</p><pre class="programlisting language-java">KieServices ks = KieServices.Factory.get();
KieBaseConfiguration kieBaseConf = ks.newKieBaseConfiguration();
kieBaseConf.setOption(SequentialOption.YES);
KieBase kieBase = kieContainer.newKieBase(kieBaseConf);</pre></li><li class="listitem"><p class="simpara">
							Enable sequential mode in the KIE module descriptor file (<code class="literal">kmodule.xml</code>) for a specific Red Hat Process Automation Manager project:
						</p><pre class="programlisting language-xml">&lt;kmodule&gt;
  ...
  &lt;kbase name="KBase2" default="false" sequential="true" packages="org.domain.pkg2, org.domain.pkg3" includes="KBase1"&gt;
    ...
  &lt;/kbase&gt;
  ...
&lt;/kmodule&gt;</pre></li></ul></div><p>
					To configure sequential mode to use a dynamic agenda, use one of the following options:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Set the system property <code class="literal">drools.sequential.agenda</code> to <code class="literal">dynamic</code>.
						</li><li class="listitem"><p class="simpara">
							Set the sequential agenda option while creating the KIE base programmatically:
						</p><pre class="programlisting language-java">KieServices ks = KieServices.Factory.get();
KieBaseConfiguration kieBaseConf = ks.newKieBaseConfiguration();
kieBaseConf.setOption(SequentialAgendaOption.DYNAMIC);
KieBase kieBase = kieContainer.newKieBase(kieBaseConf);</pre></li></ul></div><p>
					When you enable sequential mode, the decision engine evaluates rules in the following way:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Rules are ordered by salience and position in the rule set.
						</li><li class="listitem">
							An element for each possible rule match is created. The element position indicates the execution order.
						</li><li class="listitem">
							Node memory is disabled, with the exception of the right-input object memory.
						</li><li class="listitem">
							The left-input adapter node propagation is disconnected and the object with the node is referenced in a <code class="literal">Command</code> object. The <code class="literal">Command</code> object is added to a list in the working memory for later execution.
						</li><li class="listitem">
							All objects are asserted, and then the list of <code class="literal">Command</code> objects is checked and executed.
						</li><li class="listitem">
							All matches that result from executing the list are added to elements based on the sequence number of the rule.
						</li><li class="listitem">
							The elements that contain matches are executed in a sequence. If you set a maximum number of rule executions, the decision engine activates no more than that number of rules in the agenda for execution.
						</li></ol></div><p>
					In sequential mode, the <code class="literal">LeftInputAdapterNode</code> node creates a <code class="literal">Command</code> object and adds it to a list in the working memory of the decision engine. This <code class="literal">Command</code> object contains references to the <code class="literal">LeftInputAdapterNode</code> node and the propagated object. These references stop any left-input propagations at insertion time so that the right-input propagation never needs to attempt to join the left inputs. The references also avoid the need for the left-input memory.
				</p><p>
					All nodes have their memory turned off, including the left-input tuple memory, but excluding the right-input object memory. After all the assertions are finished and the right-input memory of all the objects is populated, the decision engine iterates over the list of <code class="literal">LeftInputAdatperNode</code> <code class="literal">Command</code> objects. The objects propagate down the network, attempting to join the right-input objects, but they are not retained in the left input.
				</p><p>
					The agenda with a priority queue to schedule the tuples is replaced by an element for each rule. The sequence number of the <code class="literal">RuleTerminalNode</code> node indicates the element where to place the match. After all <code class="literal">Command</code> objects have finished, the elements are checked and existing matches are executed. To improve performance, the first and the last populated cell in the elements are retained.
				</p><p>
					When the network is constructed, each <code class="literal">RuleTerminalNode</code> node receives a sequence number based on its salience number and the order in which it was added to the network.
				</p><p>
					The right-input node memories are typically hash maps for fast object deletion. Because object deletions are not supported, Phreak uses an object list when the values of the object are not indexed. For a large number of objects, indexed hash maps provide a performance increase. If an object has only a few instances, Phreak uses an object list instead of an index.
				</p></section></section><section class="chapter" id="cep-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">Chapter 83. Complex event processing (CEP)</h2></div></div></div><p>
				In Red Hat Process Automation Manager, an event is a record of a significant change of state in the application domain at a point in time. Depending on how the domain is modeled, the change of state may be represented by a single event, multiple atomic events, or hierarchies of correlated events. From a complex event processing (CEP) perspective, an event is a type of fact or object that occurs at a specific point in time, and a business rule is a definition of how to react to the data from that fact or object. For example, in a stock broker application, a change in security prices, a change in ownership from seller to buyer, or a change in an account holder’s balance are all considered to be events because a change has occurred in the state of the application domain at a given time.
			</p><p>
				The decision engine in Red Hat Process Automation Manager uses complex event processing (CEP) to detect and process multiple events within a collection of events, to uncover relationships that exist between events, and to infer new data from the events and their relationships.
			</p><p>
				CEP use cases share several requirements and goals with business rule use cases.
			</p><p>
				From a business perspective, business rule definitions are often defined based on the occurrence of scenarios triggered by events. In the following examples, events form the basis of business rules:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						In an algorithmic trading application, a rule performs an action if the security price increases by X percent above the day opening price. The price increases are denoted by events on a stock trading application.
					</li><li class="listitem">
						In a monitoring application, a rule performs an action if the temperature in the server room increases X degrees in Y minutes. The sensor readings are denoted by events.
					</li></ul></div><p>
				From a technical perspective, business rule evaluation and CEP have the following key similarities:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Both business rule evaluation and CEP require seamless integration with the enterprise infrastructure and applications. This is particularly important with life-cycle management, auditing, and security.
					</li><li class="listitem">
						Both business rule evaluation and CEP have functional requirements such as pattern matching, and non-functional requirements such as response time limits and query-rule explanations.
					</li></ul></div><p>
				CEP scenarios have the following key characteristics:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Scenarios usually process large numbers of events, but only a small percentage of the events are relevant.
					</li><li class="listitem">
						Events are usually immutable and represent a record of change in state.
					</li><li class="listitem">
						Rules and queries run against events and must react to detected event patterns.
					</li><li class="listitem">
						Related events usually have a strong temporal relationship.
					</li><li class="listitem">
						Individual events are not prioritized. The CEP system prioritizes patterns of related events and the relationships between them.
					</li><li class="listitem">
						Events usually need to be composed and aggregated.
					</li></ul></div><p>
				Given these common CEP scenario characteristics, the CEP system in Red Hat Process Automation Manager supports the following features and functions to optimize event processing:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Event processing with proper semantics
					</li><li class="listitem">
						Event detection, correlation, aggregation, and composition
					</li><li class="listitem">
						Event stream processing
					</li><li class="listitem">
						Temporal constraints to model the temporal relationships between events
					</li><li class="listitem">
						Sliding windows of significant events
					</li><li class="listitem">
						Session-scoped unified clock
					</li><li class="listitem">
						Required volumes of events for CEP use cases
					</li><li class="listitem">
						Reactive rules
					</li><li class="listitem">
						Adapters for event input into the decision engine (pipeline)
					</li></ul></div><section class="section" id="cep-events-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">83.1. Events in complex event processing</h2></div></div></div><p>
					In Red Hat Process Automation Manager, an event is a record of a significant change of state in the application domain at a point in time. Depending on how the domain is modeled, the change of state may be represented by a single event, multiple atomic events, or hierarchies of correlated events. From a complex event processing (CEP) perspective, an event is a type of fact or object that occurs at a specific point in time, and a business rule is a definition of how to react to the data from that fact or object. For example, in a stock broker application, a change in security prices, a change in ownership from seller to buyer, or a change in an account holder’s balance are all considered to be events because a change has occurred in the state of the application domain at a given time.
				</p><p>
					Events have the following key characteristics:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>Are immutable:</strong></span> An event is a record of change that has occurred at some time in the past and cannot be changed.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The decision engine does not enforce immutability on the Java objects that represent events. This behavior makes event data enrichment possible. Your application should be able to populate unpopulated event attributes, and these attributes are used by the decision engine to enrich the event with inferred data. However, you should not change event attributes that have already been populated.
							</p></div></div></li><li class="listitem">
							<span class="strong strong"><strong>Have strong temporal constraints:</strong></span> Rules involving events usually require the correlation of multiple events that occur at different points in time relative to each other.
						</li><li class="listitem">
							<span class="strong strong"><strong>Have managed life cycles:</strong></span> Because events are immutable and have temporal constraints, they are usually only relevant for a specified period of time. This means that the decision engine can automatically manage the life cycle of events.
						</li><li class="listitem">
							<span class="strong strong"><strong>Can use sliding windows:</strong></span> You can define sliding windows of time or length with events. A sliding time window is a specified period of time during which events can be processed. A sliding length window is a specified number of events that can be processed.
						</li></ul></div></section><section class="section" id="cep-events-proc_decision-engine"><div class="titlepage"><div><div><h2 class="title">83.2. Declaring facts as events</h2></div></div></div><p>
					You can declare facts as events in your Java class or DRL rule file so that the decision engine handles the facts as events during complex event processing. You can declare the facts as interval-based events or point-in-time events. Interval-based events have a duration time and persist in the working memory of the decision engine until their duration time has lapsed. Point-in-time events have no duration and are essentially interval-based events with a duration of zero.
				</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						For the relevant fact type in your Java class or DRL rule file, enter the <code class="literal">@role( event )</code> metadata tag and parameter. The <code class="literal">@role</code> metadata tag accepts the following two values:
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">fact</code>: (Default) Declares the type as a regular fact
						</li><li class="listitem">
							<code class="literal">event</code>: Declares the type as an event
						</li></ul></div><p>
					For example, the following snippet declares that the <code class="literal">StockPoint</code> fact type in a stock broker application must be handled as an event:
				</p><div class="formalpara"><p class="title"><strong>Declare fact type as an event</strong></p><p>
						
<pre class="screen">import some.package.StockPoint

declare StockPoint
  @role( event )
end</pre>
					</p></div><p>
					If <code class="literal">StockPoint</code> is a fact type declared in the DRL rule file instead of in a pre-existing class, you can declare the event in-line in your application code:
				</p><div class="formalpara"><p class="title"><strong>Declare fact type in-line and assign it to event role</strong></p><p>
						
<pre class="screen">declare StockPoint
  @role( event )

  datetime : java.util.Date
  symbol : String
  price : double
end</pre>
					</p></div></section><section class="section" id="drl-declarations-metadata-tags-ref_decision-engine"><div class="titlepage"><div><div><h2 class="title">83.3. Metadata tags for events</h2></div></div></div><p>
					The decision engine uses the following metadata tags for events that are inserted into the working memory of the decision engine. You can change the default metadata tag values in your Java class or DRL rule file as needed.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The examples in this section that refer to the <code class="literal">VoiceCall</code> class assume that the sample application domain model includes the following class details:
					</p><div class="formalpara"><p class="title"><strong>VoiceCall fact class in an example Telecom domain model</strong></p><p>
							
<pre class="programlisting language-java">public class VoiceCall {
  private String  originNumber;
  private String  destinationNumber;
  private Date    callDateTime;
  private long    callDuration;  // in milliseconds

  // Constructors, getters, and setters
}</pre>
						</p></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">@role</span></dt><dd><p class="simpara">
								This tag determines whether a given fact type is handled as a regular fact or an event in the decision engine during complex event processing.
							</p><p class="simpara">
								Default parameter: <code class="literal">fact</code>
							</p><p class="simpara">
								Supported parameters: <code class="literal">fact</code>, <code class="literal">event</code>
							</p><pre class="screen">@role( fact | event )</pre><div class="formalpara"><p class="title"><strong>Example: Declare VoiceCall as event type</strong></p><p>
									
<pre class="screen">declare VoiceCall
  @role( event )
end</pre>
								</p></div></dd><dt><span class="term">@timestamp</span></dt><dd><p class="simpara">
								This tag is automatically assigned to every event in the decision engine. By default, the time is provided by the session clock and assigned to the event when it is inserted into the working memory of the decision engine. You can specify a custom time stamp attribute instead of the default time stamp added by the session clock.
							</p><p class="simpara">
								Default parameter: The time added by the decision engine session clock
							</p><p class="simpara">
								Supported parameters: Session clock time or custom time stamp attribute
							</p><pre class="screen">@timestamp( &lt;attributeName&gt; )</pre><div class="formalpara"><p class="title"><strong>Example: Declare VoiceCall timestamp attribute</strong></p><p>
									
<pre class="screen">declare VoiceCall
  @role( event )
  @timestamp( callDateTime )
end</pre>
								</p></div></dd><dt><span class="term">@duration</span></dt><dd><p class="simpara">
								This tag determines the duration time for events in the decision engine. Events can be interval-based events or point-in-time events. Interval-based events have a duration time and persist in the working memory of the decision engine until their duration time has lapsed. Point-in-time events have no duration and are essentially interval-based events with a duration of zero. By default, every event in the decision engine has a duration of zero. You can specify a custom duration attribute instead of the default.
							</p><p class="simpara">
								Default parameter: Null (zero)
							</p><p class="simpara">
								Supported parameters: Custom duration attribute
							</p><pre class="screen">@duration( &lt;attributeName&gt; )</pre><div class="formalpara"><p class="title"><strong>Example: Declare VoiceCall duration attribute</strong></p><p>
									
<pre class="screen">declare VoiceCall
  @role( event )
  @timestamp( callDateTime )
  @duration( callDuration )
end</pre>
								</p></div></dd><dt><span class="term">@expires</span></dt><dd><p class="simpara">
								This tag determines the time duration before an event expires in the working memory of the decision engine. By default, an event expires when the event can no longer match and activate any of the current rules. You can define an amount of time after which an event should expire. This tag definition also overrides the implicit expiration offset calculated from temporal constraints and sliding windows in the KIE base. This tag is available only when the decision engine is running in stream mode.
							</p><p class="simpara">
								Default parameter: Null (event expires after event can no longer match and activate rules)
							</p><p class="simpara">
								Supported parameters: Custom <code class="literal">timeOffset</code> attribute in the format <code class="literal">[<span class="marked marked">#d][#h][#m][#s][</span>[ms]]</code>
							</p><pre class="screen">@expires( &lt;timeOffset&gt; )</pre><div class="formalpara"><p class="title"><strong>Example: Declare expiration offset for VoiceCall events</strong></p><p>
									
<pre class="screen">declare VoiceCall
  @role( event )
  @timestamp( callDateTime )
  @duration( callDuration )
  @expires( 1h35m )
end</pre>
								</p></div></dd></dl></div></section><section class="section" id="cep-modes-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">83.4. Event processing modes in the decision engine</h2></div></div></div><p>
					The decision engine runs in either cloud mode or stream mode. In cloud mode, the decision engine processes facts as facts with no temporal constraints, independent of time, and in no particular order. In stream mode, the decision engine processes facts as events with strong temporal constraints, in real time or near real time. Stream mode uses synchronization to make event processing possible in Red Hat Process Automation Manager.
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Cloud mode</span></dt><dd><p class="simpara">
								Cloud mode is the default operating mode of the decision engine. In cloud mode, the decision engine treats events as an unordered cloud. Events still have time stamps, but the decision engine running in cloud mode cannot draw relevance from the time stamp because cloud mode ignores the present time. This mode uses the rule constraints to find the matching tuples to activate and execute rules.
							</p><p class="simpara">
								Cloud mode does not impose any kind of additional requirements on facts. However, because the decision engine in this mode has no concept of time, it cannot use temporal features such as sliding windows or automatic life-cycle management. In cloud mode, events must be explicitly retracted when they are no longer needed.
							</p><p class="simpara">
								The following requirements are not imposed in cloud mode:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										No clock synchronization because the decision engine has no notion of time
									</li><li class="listitem">
										No ordering of events because the decision engine processes events as an unordered cloud, against which the decision engine match rules
									</li></ul></div><p class="simpara">
								You can specify cloud mode either by setting the system property in the relevant configuration files or by using the Java client API:
							</p><div class="formalpara"><p class="title"><strong>Set cloud mode using system property</strong></p><p>
									
<pre class="screen">drools.eventProcessingMode=cloud</pre>
								</p></div><div class="formalpara"><p class="title"><strong>Set cloud mode using Java client API</strong></p><p>
									
<pre class="programlisting language-java">import org.kie.api.conf.EventProcessingOption;
import org.kie.api.KieBaseConfiguration;
import org.kie.api.KieServices.Factory;

KieBaseConfiguration config = KieServices.Factory.get().newKieBaseConfiguration();

config.setOption(EventProcessingOption.CLOUD);</pre>
								</p></div><p class="simpara">
								You can also specify cloud mode using the <code class="literal">eventProcessingMode="&lt;mode&gt;"</code> KIE base attribute in the KIE module descriptor file (<code class="literal">kmodule.xml</code>) for a specific Red Hat Process Automation Manager project:
							</p><div class="formalpara"><p class="title"><strong>Set cloud mode using project <code class="literal">kmodule.xml</code> file</strong></p><p>
									
<pre class="programlisting language-xml">&lt;kmodule&gt;
  ...
  &lt;kbase name="KBase2" default="false" eventProcessingMode="cloud" packages="org.domain.pkg2, org.domain.pkg3" includes="KBase1"&gt;
    ...
  &lt;/kbase&gt;
  ...
&lt;/kmodule&gt;</pre>
								</p></div></dd><dt><span class="term">Stream mode</span></dt><dd><p class="simpara">
								Stream mode enables the decision engine to process events chronologically and in real time as they are inserted into the decision engine. In stream mode, the decision engine synchronizes streams of events (so that events in different streams can be processed in chronological order), implements sliding windows of time or length, and enables automatic life-cycle management.
							</p><p class="simpara">
								The following requirements apply to stream mode:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Events in each stream must be ordered chronologically.
									</li><li class="listitem">
										A session clock must be present to synchronize event streams.
									</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Your application does not need to enforce ordering events between streams, but using event streams that have not been synchronized may cause unexpected results.
								</p></div></div><p class="simpara">
								You can specify stream mode either by setting the system property in the relevant configuration files or by using the Java client API:
							</p><div class="formalpara"><p class="title"><strong>Set stream mode using system property</strong></p><p>
									
<pre class="screen">drools.eventProcessingMode=stream</pre>
								</p></div><div class="formalpara"><p class="title"><strong>Set stream mode using Java client API</strong></p><p>
									
<pre class="programlisting language-java">import org.kie.api.conf.EventProcessingOption;
import org.kie.api.KieBaseConfiguration;
import org.kie.api.KieServices.Factory;

KieBaseConfiguration config = KieServices.Factory.get().newKieBaseConfiguration();

config.setOption(EventProcessingOption.STREAM);</pre>
								</p></div><p class="simpara">
								You can also specify stream mode using the <code class="literal">eventProcessingMode="&lt;mode&gt;"</code> KIE base attribute in the KIE module descriptor file (<code class="literal">kmodule.xml</code>) for a specific Red Hat Process Automation Manager project:
							</p><div class="formalpara"><p class="title"><strong>Set stream mode using project <code class="literal">kmodule.xml</code> file</strong></p><p>
									
<pre class="programlisting language-xml">&lt;kmodule&gt;
  ...
  &lt;kbase name="KBase2" default="false" eventProcessingMode="stream" packages="org.domain.pkg2, org.domain.pkg3" includes="KBase1"&gt;
    ...
  &lt;/kbase&gt;
  ...
&lt;/kmodule&gt;</pre>
								</p></div></dd></dl></div><section class="section" id="cep-negative-patterns_decision-engine"><div class="titlepage"><div><div><h3 class="title">83.4.1. Negative patterns in decision engine stream mode</h3></div></div></div><p>
						A negative pattern is a pattern for conditions that are not met. For example, the following DRL rule activates a fire alarm if a fire is detected and the sprinkler is not activated:
					</p><div class="formalpara"><p class="title"><strong>Fire alarm rule with a negative pattern</strong></p><p>
							
<pre class="screen">rule "Sound the alarm"
when
  $f : FireDetected()
  not(SprinklerActivated())
then
  // Sound the alarm.
end</pre>
						</p></div><p>
						In cloud mode, the decision engine assumes all facts (regular facts and events) are known in advance and evaluates negative patterns immediately. In stream mode, the decision engine can support temporal constraints on facts to wait for a set time before activating a rule.
					</p><p>
						The same example rule in stream mode activates the fire alarm as usual, but applies a 10-second delay.
					</p><div class="formalpara"><p class="title"><strong>Fire alarm rule with a negative pattern and time delay (stream mode only)</strong></p><p>
							
<pre class="screen">rule "Sound the alarm"
when
  $f : FireDetected()
  not(SprinklerActivated(this after[0s,10s] $f))
then
  // Sound the alarm.
end</pre>
						</p></div><p>
						The following modified fire alarm rule expects one <code class="literal">Heartbeat</code> event to occur every 10 seconds. If the expected event does not occur, the rule is executed. This rule uses the same type of object in both the first pattern and in the negative pattern. The negative pattern has the temporal constraint to wait 0 to 10 seconds before executing and excludes the <code class="literal">Heartbeat</code> event bound to <code class="literal">$h</code> so that the rule can be executed. The bound event <code class="literal">$h</code> must be explicitly excluded in order for the rule to be executed because the temporal constraint <code class="literal">[0s, …​]</code> does not inherently exclude that event from being matched again.
					</p><div class="formalpara"><p class="title"><strong>Fire alarm rule excluding a bound event in a negative pattern (stream mode only)</strong></p><p>
							
<pre class="screen">rule "Sound the alarm"
when
  $h: Heartbeat() from entry-point "MonitoringStream"
  not(Heartbeat(this != $h, this after[0s,10s] $h) from entry-point "MonitoringStream")
then
  // Sound the alarm.
end</pre>
						</p></div></section></section><section class="section" id="property-change-listeners-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">83.5. Property-change settings and listeners for fact types</h2></div></div></div><p>
					By default, the decision engine does not re-evaluate all fact patterns for fact types each time a rule is triggered, but instead reacts only to modified properties that are constrained or bound inside a given pattern. For example, if a rule calls <code class="literal">modify()</code> as part of the rule actions but the action does not generate new data in the KIE base, the decision engine does not automatically re-evaluate all fact patterns because no data was modified. This property reactivity behavior prevents unwanted recursions in the KIE base and results in more efficient rule evaluation. This behavior also means that you do not always need to use the <code class="literal">no-loop</code> rule attribute to avoid infinite recursion.
				</p><p>
					You can modify or disable this property reactivity behavior with the following <code class="literal">KnowledgeBuilderConfiguration</code> options, and then use a property-change setting in your Java class or DRL files to fine-tune property reactivity as needed:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">ALWAYS</code>: (Default) All types are property reactive, but you can disable property reactivity for a specific type by using the <code class="literal">@classReactive</code> property-change setting.
						</li><li class="listitem">
							<code class="literal">ALLOWED</code>: No types are property reactive, but you can enable property reactivity for a specific type by using the <code class="literal">@propertyReactive</code> property-change setting.
						</li><li class="listitem">
							<code class="literal">DISABLED</code>: No types are property reactive. All property-change listeners are ignored.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Example property reactivity setting in KnowledgeBuilderConfiguration</strong></p><p>
						
<pre class="screen">KnowledgeBuilderConfiguration config = KnowledgeBuilderFactory.newKnowledgeBuilderConfiguration();
config.setOption(PropertySpecificOption.ALLOWED);
KnowledgeBuilder kbuilder = KnowledgeBuilderFactory.newKnowledgeBuilder(config);</pre>
					</p></div><p>
					Alternatively, you can update the <code class="literal">drools.propertySpecific</code> system property in the <code class="literal">standalone.xml</code> file of your Red Hat Process Automation Manager distribution:
				</p><div class="formalpara"><p class="title"><strong>Example property reactivity setting in system properties</strong></p><p>
						
<pre class="programlisting language-xml">&lt;system-properties&gt;
  ...
  &lt;property name="drools.propertySpecific" value="ALLOWED"/&gt;
  ...
&lt;/system-properties&gt;</pre>
					</p></div><p>
					The decision engine supports the following property-change settings and listeners for fact classes or declared DRL fact types:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">@classReactive</span></dt><dd><p class="simpara">
								If property reactivity is set to <code class="literal">ALWAYS</code> in the decision engine (all types are property reactive), this tag disables the default property reactivity behavior for a specific Java class or a declared DRL fact type. You can use this tag if you want the decision engine to re-evaluate all fact patterns for the specified fact type each time the rule is triggered, instead of reacting only to modified properties that are constrained or bound inside a given pattern.
							</p><div class="formalpara"><p class="title"><strong>Example: Disable default property reactivity in a DRL type declaration</strong></p><p>
									
<pre class="screen">declare Person
  @classReactive
    firstName : String
    lastName : String
end</pre>
								</p></div><div class="formalpara"><p class="title"><strong>Example: Disable default property reactivity in a Java class</strong></p><p>
									
<pre class="programlisting language-java">@classReactive
public static class Person {
    private String firstName;
    private String lastName;
}</pre>
								</p></div></dd><dt><span class="term">@propertyReactive</span></dt><dd><p class="simpara">
								If property reactivity is set to <code class="literal">ALLOWED</code> in the decision engine (no types are property reactive unless specified), this tag enables property reactivity for a specific Java class or a declared DRL fact type. You can use this tag if you want the decision engine to react only to modified properties that are constrained or bound inside a given pattern for the specified fact type, instead of re-evaluating all fact patterns for the fact each time the rule is triggered.
							</p><div class="formalpara"><p class="title"><strong>Example: Enable property reactivity in a DRL type declaration (when reactivity is disabled globally)</strong></p><p>
									
<pre class="screen">declare Person
  @propertyReactive
    firstName : String
    lastName : String
end</pre>
								</p></div><div class="formalpara"><p class="title"><strong>Example: Enable property reactivity in a Java class (when reactivity is disabled globally)</strong></p><p>
									
<pre class="programlisting language-java">@propertyReactive
public static class Person {
    private String firstName;
    private String lastName;
}</pre>
								</p></div></dd><dt><span class="term">@watch</span></dt><dd><p class="simpara">
								This tag enables property reactivity for additional properties that you specify in-line in fact patterns in DRL rules. This tag is supported only if property reactivity is set to <code class="literal">ALWAYS</code> in the decision engine, or if property reactivity is set to <code class="literal">ALLOWED</code> and the relevant fact type uses the <code class="literal">@propertyReactive</code> tag. You can use this tag in DRL rules to add or exclude specific properties in fact property reactivity logic.
							</p><p class="simpara">
								Default parameter: None
							</p><p class="simpara">
								Supported parameters: Property name, <code class="literal">*</code> (all), <code class="literal">!</code> (not), <code class="literal">!*</code> (no properties)
							</p><pre class="screen">&lt;factPattern&gt; @watch ( &lt;property&gt; )</pre><div class="formalpara"><p class="title"><strong>Example: Enable or disable property reactivity in fact patterns</strong></p><p>
									
<pre class="screen">// Listens for changes in both `firstName` (inferred) and `lastName`:
Person(firstName == $expectedFirstName) @watch( lastName )

// Listens for changes in all properties of the `Person` fact:
Person(firstName == $expectedFirstName) @watch( * )

// Listens for changes in `lastName` and explicitly excludes changes in `firstName`:
Person(firstName == $expectedFirstName) @watch( lastName, !firstName )

// Listens for changes in all properties of the `Person` fact except `age`:
Person(firstName == $expectedFirstName) @watch( *, !age )

// Excludes changes in all properties of the `Person` fact (equivalent to using `@classReactivity` tag):
Person(firstName == $expectedFirstName) @watch( !* )</pre>
								</p></div><p class="simpara">
								The decision engine generates a compilation error if you use the <code class="literal">@watch</code> tag for properties in a fact type that uses the <code class="literal">@classReactive</code> tag (disables property reactivity) or when property reactivity is set to <code class="literal">ALLOWED</code> in the decision engine and the relevant fact type does not use the <code class="literal">@propertyReactive</code> tag. Compilation errors also arise if you duplicate properties in listener annotations, such as <code class="literal">@watch( firstName, ! firstName )</code>.
							</p></dd><dt><span class="term">@propertyChangeSupport</span></dt><dd><p class="simpara">
								For facts that implement support for property changes as defined in the <a class="link" href="https://download.oracle.com/otndocs/jcp/7224-javabeans-1.01-fr-spec-oth-JSpec/">JavaBeans Specification</a>, this tag enables the decision engine to monitor changes in the fact properties.
							</p><div class="formalpara"><p class="title"><strong>Example: Declare property change support in JavaBeans object</strong></p><p>
									
<pre class="screen">declare Person
    @propertyChangeSupport
end</pre>
								</p></div></dd></dl></div></section><section class="section" id="cep-temporal-operators_decision-engine"><div class="titlepage"><div><div><h2 class="title">83.6. Temporal operators for events</h2></div></div></div><p>
					In stream mode, the decision engine supports the following temporal operators for events that are inserted into the working memory of the decision engine. You can use these operators to define the temporal reasoning behavior of the events that you declare in your Java class or DRL rule file. Temporal operators are not supported when the decision engine is running in cloud mode.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">after</code>
						</li><li class="listitem">
							<code class="literal">before</code>
						</li><li class="listitem">
							<code class="literal">coincides</code>
						</li><li class="listitem">
							<code class="literal">during</code>
						</li><li class="listitem">
							<code class="literal">includes</code>
						</li><li class="listitem">
							<code class="literal">finishes</code>
						</li><li class="listitem">
							<code class="literal">finished by</code>
						</li><li class="listitem">
							<code class="literal">meets</code>
						</li><li class="listitem">
							<code class="literal">met by</code>
						</li><li class="listitem">
							<code class="literal">overlaps</code>
						</li><li class="listitem">
							<code class="literal">overlapped by</code>
						</li><li class="listitem">
							<code class="literal">starts</code>
						</li><li class="listitem"><p class="simpara">
							<code class="literal">started by</code>
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">after</span></dt><dd><p class="simpara">
										This operator specifies if the current event occurs after the correlated event. This operator can also define an amount of time after which the current event can follow the correlated event, or a delimiting time range during which the current event can follow the correlated event.
									</p><p class="simpara">
										For example, the following pattern matches if <code class="literal">$eventA</code> starts between 3 minutes and 30 seconds and 4 minutes after <code class="literal">$eventB</code> finishes. If <code class="literal">$eventA</code> starts earlier than 3 minutes and 30 seconds after <code class="literal">$eventB</code> finishes, or later than 4 minutes after <code class="literal">$eventB</code> finishes, then the pattern is not matched.
									</p><pre class="screen">$eventA : EventA(this after[3m30s, 4m] $eventB)</pre><p class="simpara">
										You can also express this operator in the following way:
									</p><pre class="screen">3m30s &lt;= $eventA.startTimestamp - $eventB.endTimeStamp &lt;= 4m</pre><p class="simpara">
										The <code class="literal">after</code> operator supports up to two parameter values:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												If two values are defined, the interval starts on the first value (3 minutes and 30 seconds in the example) and ends on the second value (4 minutes in the example).
											</li><li class="listitem">
												If only one value is defined, the interval starts on the provided value and runs indefinitely with no end time.
											</li><li class="listitem">
												If no value is defined, the interval starts at 1 millisecond and runs indefinitely with no end time.
											</li></ul></div><p class="simpara">
										The <code class="literal">after</code> operator also supports negative time ranges:
									</p><pre class="screen">$eventA : EventA(this after[-3m30s, -2m] $eventB)</pre><p class="simpara">
										If the first value is greater than the second value, the decision engine automatically reverses them. For example, the following two patterns are interpreted by the decision engine in the same way:
									</p><pre class="screen">$eventA : EventA(this after[-3m30s, -2m] $eventB)
$eventA : EventA(this after[-2m, -3m30s] $eventB)</pre></dd><dt><span class="term">before</span></dt><dd><p class="simpara">
										This operator specifies if the current event occurs before the correlated event. This operator can also define an amount of time before which the current event can precede the correlated event, or a delimiting time range during which the current event can precede the correlated event.
									</p><p class="simpara">
										For example, the following pattern matches if <code class="literal">$eventA</code> finishes between 3 minutes and 30 seconds and 4 minutes before <code class="literal">$eventB</code> starts. If <code class="literal">$eventA</code> finishes earlier than 3 minutes and 30 seconds before <code class="literal">$eventB</code> starts, or later than 4 minutes before <code class="literal">$eventB</code> starts, then the pattern is not matched.
									</p><pre class="screen">$eventA : EventA(this before[3m30s, 4m] $eventB)</pre><p class="simpara">
										You can also express this operator in the following way:
									</p><pre class="screen">3m30s &lt;= $eventB.startTimestamp - $eventA.endTimeStamp &lt;= 4m</pre><p class="simpara">
										The <code class="literal">before</code> operator supports up to two parameter values:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												If two values are defined, the interval starts on the first value (3 minutes and 30 seconds in the example) and ends on the second value (4 minutes in the example).
											</li><li class="listitem">
												If only one value is defined, the interval starts on the provided value and runs indefinitely with no end time.
											</li><li class="listitem">
												If no value is defined, the interval starts at 1 millisecond and runs indefinitely with no end time.
											</li></ul></div><p class="simpara">
										The <code class="literal">before</code> operator also supports negative time ranges:
									</p><pre class="screen">$eventA : EventA(this before[-3m30s, -2m] $eventB)</pre><p class="simpara">
										If the first value is greater than the second value, the decision engine automatically reverses them. For example, the following two patterns are interpreted by the decision engine in the same way:
									</p><pre class="screen">$eventA : EventA(this before[-3m30s, -2m] $eventB)
$eventA : EventA(this before[-2m, -3m30s] $eventB)</pre></dd><dt><span class="term">coincides</span></dt><dd><p class="simpara">
										This operator specifies if the two events occur at the same time, with the same start and end times.
									</p><p class="simpara">
										For example, the following pattern matches if both the start and end time stamps of <code class="literal">$eventA</code> and <code class="literal">$eventB</code> are identical:
									</p><pre class="screen">$eventA : EventA(this coincides $eventB)</pre><p class="simpara">
										The <code class="literal">coincides</code> operator supports up to two parameter values for the distance between the event start and end times, if they are not identical:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												If only one parameter is given, the parameter is used to set the threshold for both the start and end times of both events.
											</li><li class="listitem">
												If two parameters are given, the first is used as a threshold for the start time and the second is used as a threshold for the end time.
											</li></ul></div><p class="simpara">
										The following pattern uses start and end time thresholds:
									</p><pre class="screen">$eventA : EventA(this coincides[15s, 10s] $eventB)</pre><p class="simpara">
										The pattern matches if the following conditions are met:
									</p><pre class="screen">abs($eventA.startTimestamp - $eventB.startTimestamp) &lt;= 15s
&amp;&amp;
abs($eventA.endTimestamp - $eventB.endTimestamp) &lt;= 10s</pre><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
											The decision engine does not support negative intervals for the <code class="literal">coincides</code> operator. If you use negative intervals, the decision engine generates an error.
										</p></div></div></dd><dt><span class="term">during</span></dt><dd><p class="simpara">
										This operator specifies if the current event occurs within the time frame of when the correlated event starts and ends. The current event must start after the correlated event starts and must end before the correlated event ends. (With the <code class="literal">coincides</code> operator, the start and end times are the same or nearly the same.)
									</p><p class="simpara">
										For example, the following pattern matches if <code class="literal">$eventA</code> starts after <code class="literal">$eventB</code> starts and ends before <code class="literal">$eventB</code> ends:
									</p><pre class="screen">$eventA : EventA(this during $eventB)</pre><p class="simpara">
										You can also express this operator in the following way:
									</p><pre class="screen">$eventB.startTimestamp &lt; $eventA.startTimestamp &lt;= $eventA.endTimestamp &lt; $eventB.endTimestamp</pre><p class="simpara">
										The <code class="literal">during</code> operator supports one, two, or four optional parameters:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												If one value is defined, this value is the maximum distance between the start times of the two events and the maximum distance between the end times of the two events.
											</li><li class="listitem"><p class="simpara">
												If two values are defined, these values are a threshold between which the current event start time and end time must occur in relation to the correlated event start and end times.
											</p><p class="simpara">
												For example, if the values are <code class="literal">5s</code> and <code class="literal">10s</code>, the current event must start between 5 and 10 seconds after the correlated event starts and must end between 5 and 10 seconds before the correlated event ends.
											</p></li><li class="listitem">
												If four values are defined, the first and second values are the minimum and maximum distances between the start times of the events, and the third and fourth values are the minimum and maximum distances between the end times of the two events.
											</li></ul></div></dd><dt><span class="term">includes</span></dt><dd><p class="simpara">
										This operator specifies if the correlated event occurs within the time frame of when the current event occurs. The correlated event must start after the current event starts and must end before the current event ends. (The behavior of this operator is the reverse of the <code class="literal">during</code> operator behavior.)
									</p><p class="simpara">
										For example, the following pattern matches if <code class="literal">$eventB</code> starts after <code class="literal">$eventA</code> starts and ends before <code class="literal">$eventA</code> ends:
									</p><pre class="screen">$eventA : EventA(this includes $eventB)</pre><p class="simpara">
										You can also express this operator in the following way:
									</p><pre class="screen">$eventA.startTimestamp &lt; $eventB.startTimestamp &lt;= $eventB.endTimestamp &lt; $eventA.endTimestamp</pre><p class="simpara">
										The <code class="literal">includes</code> operator supports one, two, or four optional parameters:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												If one value is defined, this value is the maximum distance between the start times of the two events and the maximum distance between the end times of the two events.
											</li><li class="listitem"><p class="simpara">
												If two values are defined, these values are a threshold between which the correlated event start time and end time must occur in relation to the current event start and end times.
											</p><p class="simpara">
												For example, if the values are <code class="literal">5s</code> and <code class="literal">10s</code>, the correlated event must start between 5 and 10 seconds after the current event starts and must end between 5 and 10 seconds before the current event ends.
											</p></li><li class="listitem">
												If four values are defined, the first and second values are the minimum and maximum distances between the start times of the events, and the third and fourth values are the minimum and maximum distances between the end times of the two events.
											</li></ul></div></dd><dt><span class="term">finishes</span></dt><dd><p class="simpara">
										This operator specifies if the current event starts after the correlated event but both events end at the same time.
									</p><p class="simpara">
										For example, the following pattern matches if <code class="literal">$eventA</code> starts after <code class="literal">$eventB</code> starts and ends at the same time when <code class="literal">$eventB</code> ends:
									</p><pre class="screen">$eventA : EventA(this finishes $eventB)</pre><p class="simpara">
										You can also express this operator in the following way:
									</p><pre class="screen">$eventB.startTimestamp &lt; $eventA.startTimestamp
&amp;&amp;
$eventA.endTimestamp == $eventB.endTimestamp</pre><p class="simpara">
										The <code class="literal">finishes</code> operator supports one optional parameter that sets the maximum time allowed between the end times of the two events:
									</p><pre class="screen">$eventA : EventA(this finishes[5s] $eventB)</pre><p class="simpara">
										This pattern matches if these conditions are met:
									</p><pre class="screen">$eventB.startTimestamp &lt; $eventA.startTimestamp
&amp;&amp;
abs($eventA.endTimestamp - $eventB.endTimestamp) &lt;= 5s</pre><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
											The decision engine does not support negative intervals for the <code class="literal">finishes</code> operator. If you use negative intervals, the decision engine generates an error.
										</p></div></div></dd><dt><span class="term">finished by</span></dt><dd><p class="simpara">
										This operator specifies if the correlated event starts after the current event but both events end at the same time. (The behavior of this operator is the reverse of the <code class="literal">finishes</code> operator behavior.)
									</p><p class="simpara">
										For example, the following pattern matches if <code class="literal">$eventB</code> starts after <code class="literal">$eventA</code> starts and ends at the same time when <code class="literal">$eventA</code> ends:
									</p><pre class="screen">$eventA : EventA(this finishedby $eventB)</pre><p class="simpara">
										You can also express this operator in the following way:
									</p><pre class="screen">$eventA.startTimestamp &lt; $eventB.startTimestamp
&amp;&amp;
$eventA.endTimestamp == $eventB.endTimestamp</pre><p class="simpara">
										The <code class="literal">finished by</code> operator supports one optional parameter that sets the maximum time allowed between the end times of the two events:
									</p><pre class="screen">$eventA : EventA(this finishedby[5s] $eventB)</pre><p class="simpara">
										This pattern matches if these conditions are met:
									</p><pre class="screen">$eventA.startTimestamp &lt; $eventB.startTimestamp
&amp;&amp;
abs($eventA.endTimestamp - $eventB.endTimestamp) &lt;= 5s</pre><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
											The decision engine does not support negative intervals for the <code class="literal">finished by</code> operator. If you use negative intervals, the decision engine generates an error.
										</p></div></div></dd><dt><span class="term">meets</span></dt><dd><p class="simpara">
										This operator specifies if the current event ends at the same time when the correlated event starts.
									</p><p class="simpara">
										For example, the following pattern matches if <code class="literal">$eventA</code> ends at the same time when <code class="literal">$eventB</code> starts:
									</p><pre class="screen">$eventA : EventA(this meets $eventB)</pre><p class="simpara">
										You can also express this operator in the following way:
									</p><pre class="screen">abs($eventB.startTimestamp - $eventA.endTimestamp) == 0</pre><p class="simpara">
										The <code class="literal">meets</code> operator supports one optional parameter that sets the maximum time allowed between the end time of the current event and the start time of the correlated event:
									</p><pre class="screen">$eventA : EventA(this meets[5s] $eventB)</pre><p class="simpara">
										This pattern matches if these conditions are met:
									</p><pre class="screen">abs($eventB.startTimestamp - $eventA.endTimestamp) &lt;= 5s</pre><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
											The decision engine does not support negative intervals for the <code class="literal">meets</code> operator. If you use negative intervals, the decision engine generates an error.
										</p></div></div></dd><dt><span class="term">met by</span></dt><dd><p class="simpara">
										This operator specifies if the correlated event ends at the same time when the current event starts. (The behavior of this operator is the reverse of the <code class="literal">meets</code> operator behavior.)
									</p><p class="simpara">
										For example, the following pattern matches if <code class="literal">$eventB</code> ends at the same time when <code class="literal">$eventA</code> starts:
									</p><pre class="screen">$eventA : EventA(this metby $eventB)</pre><p class="simpara">
										You can also express this operator in the following way:
									</p><pre class="screen">abs($eventA.startTimestamp - $eventB.endTimestamp) == 0</pre><p class="simpara">
										The <code class="literal">met by</code> operator supports one optional parameter that sets the maximum distance between the end time of the correlated event and the start time of the current event:
									</p><pre class="screen">$eventA : EventA(this metby[5s] $eventB)</pre><p class="simpara">
										This pattern matches if these conditions are met:
									</p><pre class="screen">abs($eventA.startTimestamp - $eventB.endTimestamp) &lt;= 5s</pre><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
											The decision engine does not support negative intervals for the <code class="literal">met by</code> operator. If you use negative intervals, the decision engine generates an error.
										</p></div></div></dd><dt><span class="term">overlaps</span></dt><dd><p class="simpara">
										This operator specifies if the current event starts before the correlated event starts and it ends during the time frame that the correlated event occurs. The current event must end between the start and end times of the correlated event.
									</p><p class="simpara">
										For example, the following pattern matches if <code class="literal">$eventA</code> starts before <code class="literal">$eventB</code> starts and then ends while <code class="literal">$eventB</code> occurs, before <code class="literal">$eventB</code> ends:
									</p><pre class="screen">$eventA : EventA(this overlaps $eventB)</pre><p class="simpara">
										The <code class="literal">overlaps</code> operator supports up to two parameters:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												If one parameter is defined, the value is the maximum distance between the start time of the correlated event and the end time of the current event.
											</li><li class="listitem">
												If two parameters are defined, the values are the minimum distance (first value) and the maximum distance (second value) between the start time of the correlated event and the end time of the current event.
											</li></ul></div></dd><dt><span class="term">overlapped by</span></dt><dd><p class="simpara">
										This operator specifies if the correlated event starts before the current event starts and it ends during the time frame that the current event occurs. The correlated event must end between the start and end times of the current event. (The behavior of this operator is the reverse of the <code class="literal">overlaps</code> operator behavior.)
									</p><p class="simpara">
										For example, the following pattern matches if <code class="literal">$eventB</code> starts before <code class="literal">$eventA</code> starts and then ends while <code class="literal">$eventA</code> occurs, before <code class="literal">$eventA</code> ends:
									</p><pre class="screen">$eventA : EventA(this overlappedby $eventB)</pre><p class="simpara">
										The <code class="literal">overlapped by</code> operator supports up to two parameters:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												If one parameter is defined, the value is the maximum distance between the start time of the current event and the end time of the correlated event.
											</li><li class="listitem">
												If two parameters are defined, the values are the minimum distance (first value) and the maximum distance (second value) between the start time of the current event and the end time of the correlated event.
											</li></ul></div></dd><dt><span class="term">starts</span></dt><dd><p class="simpara">
										This operator specifies if the two events start at the same time but the current event ends before the correlated event ends.
									</p><p class="simpara">
										For example, the following pattern matches if <code class="literal">$eventA</code> and <code class="literal">$eventB</code> start at the same time, and <code class="literal">$eventA</code> ends before <code class="literal">$eventB</code> ends:
									</p><pre class="screen">$eventA : EventA(this starts $eventB)</pre><p class="simpara">
										You can also express this operator in the following way:
									</p><pre class="screen">$eventA.startTimestamp == $eventB.startTimestamp
&amp;&amp;
$eventA.endTimestamp &lt; $eventB.endTimestamp</pre><p class="simpara">
										The <code class="literal">starts</code> operator supports one optional parameter that sets the maximum distance between the start times of the two events:
									</p><pre class="screen">$eventA : EventA(this starts[5s] $eventB)</pre><p class="simpara">
										This pattern matches if these conditions are met:
									</p><pre class="screen">abs($eventA.startTimestamp - $eventB.startTimestamp) &lt;= 5s
&amp;&amp;
$eventA.endTimestamp &lt; $eventB.endTimestamp</pre><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
											The decision engine does not support negative intervals for the <code class="literal">starts</code> operator. If you use negative intervals, the decision engine generates an error.
										</p></div></div></dd><dt><span class="term">started by</span></dt><dd><p class="simpara">
										This operator specifies if the two events start at the same time but the correlated event ends before the current event ends. (The behavior of this operator is the reverse of the <code class="literal">starts</code> operator behavior.)
									</p><p class="simpara">
										For example, the following pattern matches if <code class="literal">$eventA</code> and <code class="literal">$eventB</code> start at the same time, and <code class="literal">$eventB</code> ends before <code class="literal">$eventA</code> ends:
									</p><pre class="screen">$eventA : EventA(this startedby $eventB)</pre><p class="simpara">
										You can also express this operator in the following way:
									</p><pre class="screen">$eventA.startTimestamp == $eventB.startTimestamp
&amp;&amp;
$eventA.endTimestamp &gt; $eventB.endTimestamp</pre><p class="simpara">
										The <code class="literal">started by</code> operator supports one optional parameter that sets the maximum distance between the start times of the two events:
									</p><pre class="screen">$eventA : EventA( this starts[5s] $eventB)</pre><p class="simpara">
										This pattern matches if these conditions are met:
									</p><pre class="screen">abs( $eventA.startTimestamp - $eventB.startTimestamp ) &lt;= 5s
&amp;&amp;
$eventA.endTimestamp &gt; $eventB.endTimestamp</pre><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
											The decision engine does not support negative intervals for the <code class="literal">started by</code> operator. If you use negative intervals, the decision engine generates an error.
										</p></div></div></dd></dl></div></li></ul></div></section><section class="section" id="cep-clock-ref_decision-engine"><div class="titlepage"><div><div><h2 class="title">83.7. Session clock implementations in the decision engine</h2></div></div></div><p>
					During complex event processing, events in the decision engine may have temporal constraints and therefore require a session clock that provides the current time. For example, if a rule needs to determine the average price of a given stock over the last 60 minutes, the decision engine must be able to compare the stock price event time stamp with the current time in the session clock.
				</p><p>
					The decision engine supports a real-time clock and a pseudo clock. You can use one or both clock types depending on the scenario:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Rules testing:</strong></span> Testing requires a controlled environment, and when the tests include rules with temporal constraints, you must be able to control the input rules and facts and the flow of time.
						</li><li class="listitem">
							<span class="strong strong"><strong>Regular execution:</strong></span> The decision engine reacts to events in real time and therefore requires a real-time clock.
						</li><li class="listitem">
							<span class="strong strong"><strong>Special environments:</strong></span> Specific environments may have specific time control requirements. For example, clustered environments may require clock synchronization or Java Enterprise Edition (JEE) environments may require a clock provided by the application server.
						</li><li class="listitem">
							<span class="strong strong"><strong>Rules replay or simulation:</strong></span> In order to replay or simulate scenarios, the application must be able to control the flow of time.
						</li></ul></div><p>
					Consider your environment requirements as you decide whether to use a real-time clock or pseudo clock in the decision engine.
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Real-time clock</span></dt><dd><p class="simpara">
								The real-time clock is the default clock implementation in the decision engine and uses the system clock to determine the current time for time stamps. To configure the decision engine to use the real-time clock, set the KIE session configuration parameter to <code class="literal">realtime</code>:
							</p><div class="formalpara"><p class="title"><strong>Configure real-time clock in KIE session</strong></p><p>
									
<pre class="programlisting language-java">import org.kie.api.KieServices.Factory;
import org.kie.api.runtime.conf.ClockTypeOption;
import org.kie.api.runtime.KieSessionConfiguration;

KieSessionConfiguration config = KieServices.Factory.get().newKieSessionConfiguration();

config.setOption(ClockTypeOption.get("realtime"));</pre>
								</p></div></dd><dt><span class="term">Pseudo clock</span></dt><dd><p class="simpara">
								The pseudo clock implementation in the decision engine is helpful for testing temporal rules and it can be controlled by the application. To configure the decision engine to use the pseudo clock, set the KIE session configuration parameter to <code class="literal">pseudo</code>:
							</p><div class="formalpara"><p class="title"><strong>Configure pseudo clock in KIE session</strong></p><p>
									
<pre class="programlisting language-java">import org.kie.api.runtime.conf.ClockTypeOption;
import org.kie.api.runtime.KieSessionConfiguration;
import org.kie.api.KieServices.Factory;

KieSessionConfiguration config = KieServices.Factory.get().newKieSessionConfiguration();

config.setOption(ClockTypeOption.get("pseudo"));</pre>
								</p></div><p class="simpara">
								You can also use additional configurations and fact handlers to control the pseudo clock:
							</p><div class="formalpara"><p class="title"><strong>Control pseudo clock behavior in KIE session</strong></p><p>
									
<pre class="programlisting language-java">import java.util.concurrent.TimeUnit;

import org.kie.api.runtime.KieSessionConfiguration;
import org.kie.api.KieServices.Factory;
import org.kie.api.runtime.KieSession;
import org.drools.core.time.SessionPseudoClock;
import org.kie.api.runtime.rule.FactHandle;
import org.kie.api.runtime.conf.ClockTypeOption;

KieSessionConfiguration conf = KieServices.Factory.get().newKieSessionConfiguration();

conf.setOption( ClockTypeOption.get("pseudo"));
KieSession session = kbase.newKieSession(conf, null);

SessionPseudoClock clock = session.getSessionClock();

// While inserting facts, advance the clock as necessary.
FactHandle handle1 = session.insert(tick1);
clock.advanceTime(10, TimeUnit.SECONDS);

FactHandle handle2 = session.insert(tick2);
clock.advanceTime(30, TimeUnit.SECONDS);

FactHandle handle3 = session.insert(tick3);</pre>
								</p></div></dd></dl></div></section><section class="section" id="cep-event-streams-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">83.8. Event streams and entry points</h2></div></div></div><p>
					The decision engine can process high volumes of events in the form of event streams. In DRL rule declarations, a stream is also known as an <span class="emphasis"><em>entry point</em></span>. When you declare an entry point in a DRL rule or Java application, the decision engine, at compile time, identifies and creates the proper internal structures to use data from only that entry point to evaluate that rule.
				</p><p>
					Facts from one entry point, or stream, can join facts from any other entry point in addition to facts already in the working memory of the decision engine. Facts always remain associated with the entry point through which they entered the decision engine. Facts of the same type can enter the decision engine through several entry points, but facts that enter the decision engine through entry point A can never match a pattern from entry point B.
				</p><p>
					Event streams have the following characteristics:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Events in the stream are ordered by time stamp. The time stamps may have different semantics for different streams, but they are always ordered internally.
						</li><li class="listitem">
							Event streams usually have a high volume of events.
						</li><li class="listitem">
							Atomic events in streams are usually not useful individually, only collectively in a stream.
						</li><li class="listitem">
							Event streams can be homogeneous and contain a single type of event, or heterogeneous and contain events of different types.
						</li></ul></div><section class="section" id="cep-event-streams-proc_decision-engine"><div class="titlepage"><div><div><h3 class="title">83.8.1. Declaring entry points for rule data</h3></div></div></div><p>
						You can declare an entry point (event stream) for events so that the decision engine uses data from only that entry point to evaluate the rules. You can declare an entry point either implicitly by referencing it in DRL rules or explicitly in your Java application.
					</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
							Use one of the following methods to declare the entry point:
						</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								In the DRL rule file, specify <code class="literal">from entry-point "&lt;name&gt;"</code> for the inserted fact:
							</p><div class="formalpara"><p class="title"><strong>Authorize withdrawal rule with "ATM Stream" entry point</strong></p><p>
									
<pre class="screen">rule "Authorize withdrawal"
when
  WithdrawRequest($ai : accountId, $am : amount) from entry-point "ATM Stream"
  CheckingAccount(accountId == $ai, balance &gt; $am)
then
  // Authorize withdrawal.
end</pre>
								</p></div><div class="formalpara"><p class="title"><strong>Apply fee rule with "Branch Stream" entry point</strong></p><p>
									
<pre class="screen">rule "Apply fee on withdraws on branches"
when
  WithdrawRequest($ai : accountId, processed == true) from entry-point "Branch Stream"
  CheckingAccount(accountId == $ai)
then
  // Apply a $2 fee on the account.
end</pre>
								</p></div><p class="simpara">
								Both example DRL rules from a banking application insert the event <code class="literal">WithdrawalRequest</code> with the fact <code class="literal">CheckingAccount</code>, but from different entry points. At run time, the decision engine evaluates the <code class="literal">Authorize withdrawal</code> rule using data from only the <code class="literal">"ATM Stream"</code> entry point, and evaluates the <code class="literal">Apply fee</code> rule using data from only the <code class="literal">"Branch Stream"</code> entry point. Any events inserted into the <code class="literal">"ATM Stream"</code> can never match patterns for the <code class="literal">"Apply fee"</code> rule, and any events inserted into the <code class="literal">"Branch Stream"</code> can never match patterns for the <code class="literal">"Authorize withdrawal rule"</code>.
							</p></li><li class="listitem"><p class="simpara">
								In the Java application code, use the <code class="literal">getEntryPoint()</code> method to specify and obtain an <code class="literal">EntryPoint</code> object and insert facts into that entry point accordingly:
							</p><div class="formalpara"><p class="title"><strong>Java application code with EntryPoint object and inserted facts</strong></p><p>
									
<pre class="programlisting language-java">import org.kie.api.runtime.KieSession;
import org.kie.api.runtime.rule.EntryPoint;

// Create your KIE base and KIE session as usual.
KieSession session = ...

// Create a reference to the entry point.
EntryPoint atmStream = session.getEntryPoint("ATM Stream");

// Start inserting your facts into the entry point.
atmStream.insert(aWithdrawRequest);</pre>
								</p></div><p class="simpara">
								Any DRL rules that specify <code class="literal">from entry-point "ATM Stream"</code> are then evaluated based on the data in this entry point only.
							</p></li></ul></div></section></section><section class="section" id="cep-sliding-windows-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">83.9. Sliding windows of time or length</h2></div></div></div><p>
					In stream mode, the decision engine can process events from a specified sliding window of time or length. A sliding time window is a specified period of time during which events can be processed. A sliding length window is a specified number of events that can be processed. When you declare a sliding window in a DRL rule or Java application, the decision engine, at compile time, identifies and creates the proper internal structures to use data from only that sliding window to evaluate that rule.
				</p><p>
					For example, the following DRL rule snippets instruct the decision engine to process only the stock points from the last 2 minutes (sliding time window) or to process only the last 10 stock points (sliding length window):
				</p><div class="formalpara"><p class="title"><strong>Process stock points from the last 2 minutes (sliding time window)</strong></p><p>
						
<pre class="screen">StockPoint() over window:time(2m)</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Process the last 10 stock points (sliding length window)</strong></p><p>
						
<pre class="screen">StockPoint() over window:length(10)</pre>
					</p></div><section class="section" id="cep-sliding-windows-proc_decision-engine"><div class="titlepage"><div><div><h3 class="title">83.9.1. Declaring sliding windows for rule data</h3></div></div></div><p>
						You can declare a sliding window of time (flow of time) or length (number of occurrences) for events so that the decision engine uses data from only that window to evaluate the rules.
					</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
							In the DRL rule file, specify <code class="literal">over window:&lt;time_or_length&gt;(&lt;value&gt;)</code> for the inserted fact.
						</p></div><p>
						For example, the following two DRL rules activate a fire alarm based on an average temperature. However, the first rule uses a sliding time window to calculate the average over the last 10 minutes while the second rule uses a sliding length window to calculate the average over the last one hundred temperature readings.
					</p><div class="formalpara"><p class="title"><strong>Average temperature over sliding time window</strong></p><p>
							
<pre class="screen">rule "Sound the alarm if temperature rises above threshold"
when
  TemperatureThreshold($max : max)
  Number(doubleValue &gt; $max) from accumulate(
    SensorReading($temp : temperature) over window:time(10m),
    average($temp))
then
  // Sound the alarm.
end</pre>
						</p></div><div class="formalpara"><p class="title"><strong>Average temperature over sliding length window</strong></p><p>
							
<pre class="screen">rule "Sound the alarm if temperature rises above threshold"
when
  TemperatureThreshold($max : max)
  Number(doubleValue &gt; $max) from accumulate(
    SensorReading($temp : temperature) over window:length(100),
    average($temp))
then
  // Sound the alarm.
end</pre>
						</p></div><p>
						The decision engine discards any <code class="literal">SensorReading</code> events that are more than 10 minutes old or that are not part of the last one hundred readings, and continues recalculating the average as the minutes or readings "slide" forward in real time.
					</p><p>
						The decision engine does not automatically remove outdated events from the KIE session because other rules without sliding window declarations might depend on those events. The decision engine stores events in the KIE session until the events expire either by explicit rule declarations or by implicit reasoning within the decision engine based on inferred data in the KIE base.
					</p></section></section><section class="section" id="cep-memory-management-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">83.10. Memory management for events</h2></div></div></div><p>
					In stream mode, the decision engine uses automatic memory management to maintain events that are stored in KIE sessions. The decision engine can retract from a KIE session any events that no longer match any rule due to their temporal constraints and release any resources held by the retracted events.
				</p><p>
					The decision engine uses either explicit or inferred expiration to retract outdated events:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>Explicit expiration:</strong></span> The decision engine removes events that are explicitly set to expire in rules that declare the <code class="literal">@expires</code> tag:
						</p><div class="formalpara"><p class="title"><strong>DRL rule snippet with explicit expiration</strong></p><p>
								
<pre class="screen">declare StockPoint
  @expires( 30m )
end</pre>
							</p></div><p class="simpara">
							This example rule sets any <code class="literal">StockPoint</code> events to expire after 30 minutes and to be removed from the KIE session if no other rules use the events.
						</p></li><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>Inferred expiration:</strong></span> The decision engine can calculate the expiration offset for a given event implicitly by analyzing the temporal constraints in the rules:
						</p><div class="formalpara"><p class="title"><strong>DRL rule with temporal constraints</strong></p><p>
								
<pre class="screen">rule "Correlate orders"
when
  $bo : BuyOrder($id : id)
  $ae : AckOrder(id == $id, this after[0,10s] $bo)
then
  // Perform an action.
end</pre>
							</p></div><p class="simpara">
							For this example rule, the decision engine automatically calculates that whenever a <code class="literal">BuyOrder</code> event occurs, the decision engine needs to store the event for up to 10 seconds and wait for the matching <code class="literal">AckOrder</code> event. After 10 seconds, the decision engine infers the expiration and removes the event from the KIE session. An <code class="literal">AckOrder</code> event can only match an existing <code class="literal">BuyOrder</code> event, so the decision engine infers the expiration if no match occurs and removes the event immediately.
						</p><p class="simpara">
							The decision engine analyzes the entire KIE base to find the offset for every event type and to ensure that no other rules use the events that are pending removal. Whenever an implicit expiration clashes with an explicit expiration value, the decision engine uses the greater time frame of the two to store the event longer.
						</p></li></ul></div></section></section><section class="chapter" id="engine-queries-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">Chapter 84. Decision engine queries and live queries</h2></div></div></div><p>
				You can use queries with the decision engine to retrieve fact sets based on fact patterns as they are used in rules. The patterns might also use optional parameters.
			</p><p>
				To use queries with the decision engine, you add the query definitions in DRL files and then obtain the matching results in your application code. While a query iterates over a result collection, you can use any identifier that is bound to the query to access the corresponding fact or fact field by calling the <code class="literal">get()</code> method with the binding variable name as the argument. If the binding refers to a fact object, you can retrieve the fact handle by calling <code class="literal">getFactHandle()</code> with the variable name as the parameter.
			</p><div class="formalpara"><p class="title"><strong>Example query definition in a DRL file</strong></p><p>
					
<pre class="screen">query "people under the age of 21"
    $person : Person( age &lt; 21 )
end</pre>
				</p></div><div class="formalpara"><p class="title"><strong>Example application code to obtain and iterate over query results</strong></p><p>
					
<pre class="programlisting language-java">QueryResults results = ksession.getQueryResults( "people under the age of 21" );
System.out.println( "we have " + results.size() + " people under the age of 21" );

System.out.println( "These people are under the age of 21:" );

for ( QueryResultsRow row : results ) {
    Person person = ( Person ) row.get( "person" );
    System.out.println( person.getName() + "\n" );
}</pre>
				</p></div><p>
				Invoking queries and processing the results by iterating over the returned set can be difficult when you are monitoring changes over time. To alleviate this difficulty with ongoing queries, Red Hat Process Automation Manager provides <span class="emphasis"><em>live queries</em></span>, which use an attached listener for change events instead of returning an iterable result set. Live queries remain open by creating a view and publishing change events for the contents of this view.
			</p><p>
				To activate a live query, start your query with parameters and monitor changes in the resulting view. You can use the <code class="literal">dispose()</code> method to terminate the query and discontinue this reactive scenario.
			</p><div class="formalpara"><p class="title"><strong>Example query definition in a DRL file</strong></p><p>
					
<pre class="screen">query colors(String $color1, String $color2)
    TShirt(mainColor = $color1, secondColor = $color2, $price: manufactureCost)
end</pre>
				</p></div><div class="formalpara"><p class="title"><strong>Example application code with an event listener and a live query</strong></p><p>
					
<pre class="programlisting language-java">final List updated = new ArrayList();
final List removed = new ArrayList();
final List added = new ArrayList();

ViewChangedEventListener listener = new ViewChangedEventListener() {
 public void rowUpdated(Row row) {
  updated.add( row.get( "$price" ) );
 }

 public void rowRemoved(Row row) {
  removed.add( row.get( "$price" ) );
 }

 public void rowAdded(Row row) {
  added.add( row.get( "$price" ) );
 }
};

// Open the live query:
LiveQuery query = ksession.openLiveQuery( "colors",
                                          new Object[] { "red", "blue" },
                                          listener );
...
...

// Terminate the live query:
query.dispose()</pre>
				</p></div></section><section class="chapter" id="engine-event-listeners-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">Chapter 85. Decision engine event listeners and debug logging</h2></div></div></div><p>
				In Red Hat Process Automation Manager, you can add or remove listeners for decision engine events, such as fact insertions and rule executions. With decision engine event listeners, you can be notified of decision engine activity and separate your logging and auditing work from the core of your application.
			</p><p>
				The decision engine supports the following default event listeners for the agenda and working memory:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">AgendaEventListener</code>
					</li><li class="listitem">
						<code class="literal">WorkingMemoryEventListener</code>
					</li></ul></div><p>
				For each event listener, the decision engine also supports the following specific events that you can specify to be monitored:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">MatchCreatedEvent</code>
					</li><li class="listitem">
						<code class="literal">MatchCancelledEvent</code>
					</li><li class="listitem">
						<code class="literal">BeforeMatchFiredEvent</code>
					</li><li class="listitem">
						<code class="literal">AfterMatchFiredEvent</code>
					</li><li class="listitem">
						<code class="literal">AgendaGroupPushedEvent</code>
					</li><li class="listitem">
						<code class="literal">AgendaGroupPoppedEvent</code>
					</li><li class="listitem">
						<code class="literal">ObjectInsertEvent</code>
					</li><li class="listitem">
						<code class="literal">ObjectDeletedEvent</code>
					</li><li class="listitem">
						<code class="literal">ObjectUpdatedEvent</code>
					</li><li class="listitem">
						<code class="literal">ProcessCompletedEvent</code>
					</li><li class="listitem">
						<code class="literal">ProcessNodeLeftEvent</code>
					</li><li class="listitem">
						<code class="literal">ProcessNodeTriggeredEvent</code>
					</li><li class="listitem">
						<code class="literal">ProcessStartEvent</code>
					</li></ul></div><p>
				For example, the following code uses a <code class="literal">DefaultAgendaEventListener</code> listener attached to a KIE session and specifies the <code class="literal">AfterMatchFiredEvent</code> event to be monitored. The code prints pattern matches after the rules are executed (fired):
			</p><div class="formalpara"><p class="title"><strong>Example code to monitor and print <code class="literal">AfterMatchFiredEvent</code> events in the agenda</strong></p><p>
					
<pre class="programlisting language-java">ksession.addEventListener( new DefaultAgendaEventListener() {
   public void afterMatchFired(AfterMatchFiredEvent event) {
       super.afterMatchFired( event );
       System.out.println( event );
   }
});</pre>
				</p></div><p>
				The decision engine also supports the following agenda and working memory event listeners for debug logging:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">DebugAgendaEventListener</code>
					</li><li class="listitem">
						<code class="literal">DebugRuleRuntimeEventListener</code>
					</li></ul></div><p>
				These event listeners implement the same supported event-listener methods and include a debug print statement by default. You can add a specific supported event to be monitored and documented, or monitor all agenda or working memory activity.
			</p><p>
				For example, the following code uses the <code class="literal">DebugRuleRuntimeEventListener</code> event listener to monitor and print all working memory events:
			</p><div class="formalpara"><p class="title"><strong>Example code to monitor and print all working memory events</strong></p><p>
					
<pre class="programlisting language-java">ksession.addEventListener( new DebugRuleRuntimeEventListener() );</pre>
				</p></div><section class="section" id="logging-proc_decision-engine"><div class="titlepage"><div><div><h2 class="title">85.1. Configuring a logging utility in the decision engine</h2></div></div></div><p>
					The decision engine uses the Java logging API SLF4J for system logging. You can use one of the following logging utilities with the decision engine to investigate decision engine activity, such as for troubleshooting or data gathering:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Logback
						</li><li class="listitem">
							Apache Commons Logging
						</li><li class="listitem">
							Apache Log4j
						</li><li class="listitem">
							<code class="literal">java.util.logging</code> package
						</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						For the logging utility that you want to use, add the relevant dependency to your Maven project or save the relevant XML configuration file in the <code class="literal">org.drools</code> package of your Red Hat Process Automation Manager distribution:
					</p></div><div class="formalpara"><p class="title"><strong>Example Maven dependency for Logback</strong></p><p>
						
<pre class="programlisting language-xml">&lt;dependency&gt;
  &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
  &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;
  &lt;version&gt;${logback.version}&lt;/version&gt;
&lt;/dependency&gt;</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Example logback.xml configuration file in org.drools package</strong></p><p>
						
<pre class="programlisting language-xml">&lt;configuration&gt;
  &lt;logger name="org.drools" level="debug"/&gt;
  ...
&lt;configuration&gt;</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Example log4j.xml configuration file in org.drools package</strong></p><p>
						
<pre class="programlisting language-xml">&lt;log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/"&gt;
  &lt;category name="org.drools"&gt;
    &lt;priority value="debug" /&gt;
  &lt;/category&gt;
  ...
&lt;/log4j:configuration&gt;</pre>
					</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you are developing for an ultra light environment, use the <code class="literal">slf4j-nop</code> or <code class="literal">slf4j-simple</code> logger.
					</p></div></div></section></section><section class="chapter" id="decision-examples-IDE-con_decision-engine"><div class="titlepage"><div><div><h2 class="title">Chapter 86. Example decisions in Red Hat Process Automation Manager for an IDE</h2></div></div></div><p>
				Red Hat Process Automation Manager provides example decisions distributed as Java classes that you can import into your integrated development environment (IDE). You can use these examples to better understand decision engine capabilities or use them as a reference for the decisions that you define in your own Red Hat Process Automation Manager projects.
			</p><p>
				The following example decision sets are some of the examples available in Red Hat Process Automation Manager:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="strong strong"><strong>Hello World example</strong></span>: Demonstrates basic rule execution and use of debug output
					</li><li class="listitem">
						<span class="strong strong"><strong>State example</strong></span>: Demonstrates forward chaining and conflict resolution through rule salience and agenda groups
					</li><li class="listitem">
						<span class="strong strong"><strong>Fibonacci example</strong></span>: Demonstrates recursion and conflict resolution through rule salience
					</li><li class="listitem">
						<span class="strong strong"><strong>Banking example</strong></span>: Demonstrates pattern matching, basic sorting, and calculation
					</li><li class="listitem">
						<span class="strong strong"><strong>Pet Store example</strong></span>: Demonstrates rule agenda groups, global variables, callbacks, and GUI integration
					</li><li class="listitem">
						<span class="strong strong"><strong>Sudoku example</strong></span>: Demonstrates complex pattern matching, problem solving, callbacks, and GUI integration
					</li><li class="listitem">
						<span class="strong strong"><strong>House of Doom example</strong></span>: Demonstrates backward chaining and recursion
					</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					For optimization examples provided with Red Hat Business Optimizer, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/getting_started_with_red_hat_process_automation_manager#examples-con"><span class="emphasis"><em>Getting started with Red Hat Business Optimizer</em></span></a>.
				</p></div></div><section class="section" id="decision-examples-IDE-proc_decision-engine"><div class="titlepage"><div><div><h2 class="title">86.1. Importing and executing Red Hat Process Automation Manager example decisions in an IDE</h2></div></div></div><p>
					You can import Red Hat Process Automation Manager example decisions into your integrated development environment (IDE) and execute them to explore how the rules and code function. You can use these examples to better understand decision engine capabilities or use them as a reference for the decisions that you define in your own Red Hat Process Automation Manager projects.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Java 8 or later is installed.
						</li><li class="listitem">
							Maven 3.5.x or later is installed.
						</li><li class="listitem">
							An IDE is installed, such as Red Hat CodeReady Studio.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Download and unzip the <span class="strong strong"><strong>Red Hat Process Automation Manager 7.10.0 Source Distribution</strong></span> from the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Red Hat Customer Portal</a> to a temporary directory, such as <code class="literal">/rhpam-7.10.0-sources</code>.
						</li><li class="listitem">
							Open your IDE and select <span class="strong strong"><strong>File</strong></span> → <span class="strong strong"><strong>Import</strong></span> → <span class="strong strong"><strong>Maven</strong></span> → <span class="strong strong"><strong>Existing Maven Projects</strong></span>, or the equivalent option for importing a Maven project.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Browse</strong></span>, navigate to <code class="literal">~/rhpam-7.10.0-sources/src/drools-$VERSION/drools-examples</code> (or, for the Conway’s Game of Life example, <code class="literal">~/rhpam-7.10.0-sources/src/droolsjbpm-integration-$VERSION/droolsjbpm-integration-examples</code>), and import the project.
						</li><li class="listitem">
							Navigate to the example package that you want to run and find the Java class with the <code class="literal">main</code> method.
						</li><li class="listitem"><p class="simpara">
							Right-click the Java class and select <span class="strong strong"><strong>Run As</strong></span> → <span class="strong strong"><strong>Java Application</strong></span> to run the example.
						</p><p class="simpara">
							To run all examples through a basic user interface, run the <code class="literal">DroolsExamplesApp.java</code> class (or, for Conway’s Game of Life, the <code class="literal">DroolsJbpmIntegrationExamplesApp.java</code> class) in the <code class="literal">org.drools.examples</code> main class.
						</p><div class="figure" id="idm139921811511456"><p class="title"><strong>Figure 86.1. Interface for all examples in drools-examples (DroolsExamplesApp.java)</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/All/drools-examples-run-all.png" alt="drools examples run all"/></div></div></div><div class="figure" id="idm139921811507264"><p class="title"><strong>Figure 86.2. Interface for all examples in droolsjbpm-integration-examples (DroolsJbpmIntegrationExamplesApp.java)</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/All/droolsjbpm-examples-run-all.png" alt="droolsjbpm examples run all"/></div></div></div></li></ol></div></section><section class="section" id="decision-examples-helloworld-ref_decision-engine"><div class="titlepage"><div><div><h2 class="title">86.2. Hello World example decisions (basic rules and debugging)</h2></div></div></div><p>
					The Hello World example decision set demonstrates how to insert objects into the decision engine working memory, how to match the objects using rules, and how to configure logging to trace the internal activity of the decision engine.
				</p><p>
					The following is an overview of the Hello World example:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Name</strong></span>: <code class="literal">helloworld</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Main class</strong></span>: <code class="literal">org.drools.examples.helloworld.HelloWorldExample</code> (in <code class="literal">src/main/java</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Module</strong></span>: <code class="literal">drools-examples</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Type</strong></span>: Java application
						</li><li class="listitem">
							<span class="strong strong"><strong>Rule file</strong></span>: <code class="literal">org.drools.examples.helloworld.HelloWorld.drl</code> (in <code class="literal">src/main/resources</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Objective</strong></span>: Demonstrates basic rule execution and use of debug output
						</li></ul></div><p>
					In the Hello World example, a KIE session is generated to enable rule execution. All rules require a KIE session for execution.
				</p><div class="formalpara"><p class="title"><strong>KIE session for rule execution</strong></p><p>
						
<pre class="programlisting language-java">KieServices ks = KieServices.Factory.get(); <span id="CO14-1"/><span class="callout">1</span>
KieContainer kc = ks.getKieClasspathContainer(); <span id="CO14-2"/><span class="callout">2</span>
KieSession ksession = kc.newKieSession("HelloWorldKS"); <span id="CO14-3"/><span class="callout">3</span></pre>
					</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO14-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							Obtains the <code class="literal">KieServices</code> factory. This is the main interface that applications use to interact with the decision engine.
						</div></dd><dt><a href="#CO14-2"><span class="callout">2</span></a> </dt><dd><div class="para">
							Creates a <code class="literal">KieContainer</code> from the project class path. This detects a <span class="strong strong"><strong>/META-INF/kmodule.xml</strong></span> file from which it configures and instantiates a <code class="literal">KieContainer</code> with a <code class="literal">KieModule</code>.
						</div></dd><dt><a href="#CO14-3"><span class="callout">3</span></a> </dt><dd><div class="para">
							Creates a <code class="literal">KieSession</code> based on the <code class="literal">"HelloWorldKS"</code> KIE session configuration defined in the <span class="strong strong"><strong>/META-INF/kmodule.xml</strong></span> file.
						</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						For more information about Red Hat Process Automation Manager project packaging, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>.
					</p></div></div><p>
					Red Hat Process Automation Manager has an event model that exposes internal engine activity. Two default debug listeners, <code class="literal">DebugAgendaEventListener</code> and <code class="literal">DebugRuleRuntimeEventListener</code>, print debug event information to the <code class="literal">System.err</code> output. The <code class="literal">KieRuntimeLogger</code> provides execution auditing, the result of which you can view in a graphical viewer.
				</p><div class="formalpara"><p class="title"><strong>Debug listeners and audit loggers</strong></p><p>
						
<pre class="programlisting language-java">// Set up listeners.
ksession.addEventListener( new DebugAgendaEventListener() );
ksession.addEventListener( new DebugRuleRuntimeEventListener() );

// Set up a file-based audit logger.
KieRuntimeLogger logger = KieServices.get().getLoggers().newFileLogger( ksession, "./target/helloworld" );

// Set up a ThreadedFileLogger so that the audit view reflects events while debugging.
KieRuntimeLogger logger = ks.getLoggers().newThreadedFileLogger( ksession, "./target/helloworld", 1000 );</pre>
					</p></div><p>
					The logger is a specialized implementation built on the <code class="literal">Agenda</code> and <code class="literal">RuleRuntime</code> listeners. When the decision engine has finished executing, <code class="literal">logger.close()</code> is called.
				</p><p>
					The example creates a single <code class="literal">Message</code> object with the message <code class="literal">"Hello World"</code>, inserts the status <code class="literal">HELLO</code> into the <code class="literal">KieSession</code>, executes rules with <code class="literal">fireAllRules()</code>.
				</p><div class="formalpara"><p class="title"><strong>Data insertion and execution</strong></p><p>
						
<pre class="programlisting language-java">// Insert facts into the KIE session.
final Message message = new Message();
message.setMessage( "Hello World" );
message.setStatus( Message.HELLO );
ksession.insert( message );

// Fire the rules.
ksession.fireAllRules();</pre>
					</p></div><p>
					Rule execution uses a data model to pass data as inputs and outputs to the <code class="literal">KieSession</code>. The data model in this example has two fields: the <code class="literal">message</code>, which is a <code class="literal">String</code>, and the <code class="literal">status</code>, which can be <code class="literal">HELLO</code> or <code class="literal">GOODBYE</code>.
				</p><div class="formalpara"><p class="title"><strong>Data model class</strong></p><p>
						
<pre class="programlisting language-java">public static class Message {
    public static final int HELLO   = 0;
    public static final int GOODBYE = 1;

    private String          message;
    private int             status;
    ...
}</pre>
					</p></div><p>
					The two rules are located in the file <code class="literal">src/main/resources/org/drools/examples/helloworld/HelloWorld.drl</code>.
				</p><p>
					The <code class="literal">when</code> condition of the <code class="literal">"Hello World"</code> rule states that the rule is activated for each <code class="literal">Message</code> object inserted into the KIE session that has the status <code class="literal">Message.HELLO</code>. Additionally, two variable bindings are created: the variable <code class="literal">message</code> is bound to the <code class="literal">message</code> attribute and the variable <code class="literal">m</code> is bound to the matched <code class="literal">Message</code> object itself.
				</p><p>
					The <code class="literal">then</code> action of the rule specifies to print the content of the bound variable <code class="literal">message</code> to <code class="literal">System.out</code>, and then changes the values of the <code class="literal">message</code> and <code class="literal">status</code> attributes of the <code class="literal">Message</code> object bound to <code class="literal">m</code>. The rule uses the <code class="literal">modify</code> statement to apply a block of assignments in one statement and to notify the decision engine of the changes at the end of the block.
				</p><div class="formalpara"><p class="title"><strong>"Hello World" rule</strong></p><p>
						
<pre class="screen">rule "Hello World"
  when
    m : Message( status == Message.HELLO, message : message )
  then
    System.out.println( message );
    modify ( m ) { message = "Goodbye cruel world",
                   status = Message.GOODBYE };
end</pre>
					</p></div><p>
					The <code class="literal">"Good Bye"</code> rule is similar to the <code class="literal">"Hello World"</code> rule except that it matches <code class="literal">Message</code> objects that have the status <code class="literal">Message.GOODBYE</code>.
				</p><div class="formalpara"><p class="title"><strong>"Good Bye" rule</strong></p><p>
						
<pre class="screen">rule "Good Bye"
  when
    Message( status == Message.GOODBYE, message : message )
  then
    System.out.println( message );
end</pre>
					</p></div><p>
					To execute the example, run the <code class="literal">org.drools.examples.helloworld.HelloWorldExample</code> class as a Java application in your IDE. The rule writes to <code class="literal">System.out</code>, the debug listener writes to <code class="literal">System.err</code>, and the audit logger creates a log file in <code class="literal">target/helloworld.log</code>.
				</p><div class="formalpara"><p class="title"><strong>System.out output in the IDE console</strong></p><p>
						
<pre class="screen">Hello World
Goodbye cruel world</pre>
					</p></div><div class="formalpara"><p class="title"><strong>System.err output in the IDE console</strong></p><p>
						
<pre class="screen">==&gt;[ActivationCreated(0): rule=Hello World;
                   tuple=[fid:1:1:org.drools.examples.helloworld.HelloWorldExample$Message@17cec96]]
[ObjectInserted: handle=[fid:1:1:org.drools.examples.helloworld.HelloWorldExample$Message@17cec96];
                 object=org.drools.examples.helloworld.HelloWorldExample$Message@17cec96]
[BeforeActivationFired: rule=Hello World;
                   tuple=[fid:1:1:org.drools.examples.helloworld.HelloWorldExample$Message@17cec96]]
==&gt;[ActivationCreated(4): rule=Good Bye;
                   tuple=[fid:1:2:org.drools.examples.helloworld.HelloWorldExample$Message@17cec96]]
[ObjectUpdated: handle=[fid:1:2:org.drools.examples.helloworld.HelloWorldExample$Message@17cec96];
                old_object=org.drools.examples.helloworld.HelloWorldExample$Message@17cec96;
                new_object=org.drools.examples.helloworld.HelloWorldExample$Message@17cec96]
[AfterActivationFired(0): rule=Hello World]
[BeforeActivationFired: rule=Good Bye;
                   tuple=[fid:1:2:org.drools.examples.helloworld.HelloWorldExample$Message@17cec96]]
[AfterActivationFired(4): rule=Good Bye]</pre>
					</p></div><p>
					To better understand the execution flow of this example, you can load the audit log file from <code class="literal">target/helloworld.log</code> into your IDE debug view or <span class="strong strong"><strong>Audit View</strong></span>, if available (for example, in <span class="strong strong"><strong>Window</strong></span> → <span class="strong strong"><strong>Show View</strong></span> in some IDEs).
				</p><p>
					In this example, the <span class="strong strong"><strong>Audit view</strong></span> shows that the object is inserted, which creates an activation for the <code class="literal">"Hello World"</code> rule. The activation is then executed, which updates the <code class="literal">Message</code> object and causes the <code class="literal">"Good Bye"</code> rule to activate. Finally, the <code class="literal">"Good Bye"</code> rule is executed. When you select an event in the <span class="strong strong"><strong>Audit View</strong></span>, the origin event, which is the <code class="literal">"Activation created"</code> event in this example, is highlighted in green.
				</p><div class="figure" id="idm139921811415536"><p class="title"><strong>Figure 86.3. Hello World example Audit View</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/HelloWorldExample/helloworld_auditview1.png" alt="helloworld auditview1"/></div></div></div></section><section class="section" id="decision-examples-state-ref_decision-engine"><div class="titlepage"><div><div><h2 class="title">86.3. State example decisions (forward chaining and conflict resolution)</h2></div></div></div><p>
					The State example decision set demonstrates how the decision engine uses forward chaining and any changes to facts in the working memory to resolve execution conflicts for rules in a sequence. The example focuses on resolving conflicts through salience values or through agenda groups that you can define in rules.
				</p><p>
					The following is an overview of the State example:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Name</strong></span>: <code class="literal">state</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Main classes</strong></span>: <code class="literal">org.drools.examples.state.StateExampleUsingSalience</code>, <code class="literal">org.drools.examples.state.StateExampleUsingAgendaGroup</code> (in <code class="literal">src/main/java</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Module</strong></span>: <code class="literal">drools-examples</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Type</strong></span>: Java application
						</li><li class="listitem">
							<span class="strong strong"><strong>Rule files</strong></span>: <code class="literal">org.drools.examples.state.*.drl</code> (in <code class="literal">src/main/resources</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Objective</strong></span>: Demonstrates forward chaining and conflict resolution through rule salience and agenda groups
						</li></ul></div><p>
					A forward-chaining rule system is a data-driven system that starts with a fact in the working memory of the decision engine and reacts to changes to that fact. When objects are inserted into working memory, any rule conditions that become true as a result of the change are scheduled for execution by the agenda.
				</p><p>
					In contrast, a backward-chaining rule system is a goal-driven system that starts with a conclusion that the decision engine attempts to satisfy, often using recursion. If the system cannot reach the conclusion or goal, it searches for subgoals, which are conclusions that complete part of the current goal. The system continues this process until either the initial conclusion is satisfied or all subgoals are satisfied.
				</p><p>
					The decision engine in Red Hat Process Automation Manager uses both forward and backward chaining to evaluate rules.
				</p><p>
					The following diagram illustrates how the decision engine evaluates rules using forward chaining overall with a backward-chaining segment in the logic flow:
				</p><div class="figure" id="idm139921811391072"><p class="title"><strong>Figure 86.4. Rule evaluation logic using forward and backward chaining</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/BackwardChaining/RuleEvaluation_Enterprise.png" alt="RuleEvaluation Enterprise"/></div></div></div><p>
					In the State example, each <code class="literal">State</code> class has fields for its name and its current state (see the class <code class="literal">org.drools.examples.state.State</code>). The following states are the two possible states for each object:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">NOTRUN</code>
						</li><li class="listitem">
							<code class="literal">FINISHED</code>
						</li></ul></div><div class="formalpara"><p class="title"><strong>State class</strong></p><p>
						
<pre class="programlisting language-java">public class State {
    public static final int NOTRUN   = 0;
    public static final int FINISHED = 1;

    private final PropertyChangeSupport changes =
        new PropertyChangeSupport( this );

    private String name;
    private int    state;

    ... setters and getters go here...
}</pre>
					</p></div><p>
					The State example contains two versions of the same example to resolve rule execution conflicts:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							A <code class="literal">StateExampleUsingSalience</code> version that resolves conflicts by using rule salience
						</li><li class="listitem">
							A <code class="literal">StateExampleUsingAgendaGroups</code> version that resolves conflicts by using rule agenda groups
						</li></ul></div><p>
					Both versions of the state example involve four <code class="literal">State</code> objects: <code class="literal">A</code>, <code class="literal">B</code>, <code class="literal">C</code>, and <code class="literal">D</code>. Initially, their states are set to <code class="literal">NOTRUN</code>, which is the default value for the constructor that the example uses.
				</p><h4 id="state_example_using_salience_2">State example using salience</h4><p>
					The <code class="literal">StateExampleUsingSalience</code> version of the State example uses salience values in rules to resolve rule execution conflicts. Rules with a higher salience value are given higher priority when ordered in the activation queue.
				</p><p>
					The example inserts each <code class="literal">State</code> instance into the KIE session and then calls <code class="literal">fireAllRules()</code>.
				</p><div class="formalpara"><p class="title"><strong>Salience State example execution</strong></p><p>
						
<pre class="programlisting language-java">final State a = new State( "A" );
final State b = new State( "B" );
final State c = new State( "C" );
final State d = new State( "D" );

ksession.insert( a );
ksession.insert( b );
ksession.insert( c );
ksession.insert( d );

ksession.fireAllRules();

// Dispose KIE session if stateful (not required if stateless).
ksession.dispose();</pre>
					</p></div><p>
					To execute the example, run the <code class="literal">org.drools.examples.state.StateExampleUsingSalience</code> class as a Java application in your IDE.
				</p><p>
					After the execution, the following output appears in the IDE console window:
				</p><div class="formalpara"><p class="title"><strong>Salience State example output in the IDE console</strong></p><p>
						
<pre class="screen">A finished
B finished
C finished
D finished</pre>
					</p></div><p>
					Four rules are present.
				</p><p>
					First, the <code class="literal">"Bootstrap"</code> rule fires, setting <code class="literal">A</code> to state <code class="literal">FINISHED</code>, which then causes <code class="literal">B</code> to change its state to <code class="literal">FINISHED</code>. Objects <code class="literal">C</code> and <code class="literal">D</code> are both dependent on <code class="literal">B</code>, causing a conflict that is resolved by the salience values.
				</p><p>
					To better understand the execution flow of this example, you can load the audit log file from <code class="literal">target/state.log</code> into your IDE debug view or <span class="strong strong"><strong>Audit View</strong></span>, if available (for example, in <span class="strong strong"><strong>Window</strong></span> → <span class="strong strong"><strong>Show View</strong></span> in some IDEs).
				</p><p>
					In this example, the <span class="strong strong"><strong>Audit View</strong></span> shows that the assertion of the object <code class="literal">A</code> in the state <code class="literal">NOTRUN</code> activates the <code class="literal">"Bootstrap"</code> rule, while the assertions of the other objects have no immediate effect.
				</p><div class="figure" id="idm139921811349696"><p class="title"><strong>Figure 86.5. Salience State example Audit View</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/StateExample/state_example_audit1.png" alt="state example audit1"/></div></div></div><div class="formalpara"><p class="title"><strong>Rule "Bootstrap" in salience State example</strong></p><p>
						
<pre class="screen">rule "Bootstrap"
  when
    a : State(name == "A", state == State.NOTRUN )
  then
    System.out.println(a.getName() + " finished" );
    a.setState( State.FINISHED );
end</pre>
					</p></div><p>
					The execution of the <code class="literal">"Bootstrap"</code> rule changes the state of <code class="literal">A</code> to <code class="literal">FINISHED</code>, which activates rule <code class="literal">"A to B"</code>.
				</p><div class="formalpara"><p class="title"><strong>Rule "A to B" in salience State example</strong></p><p>
						
<pre class="screen">rule "A to B"
  when
    State(name == "A", state == State.FINISHED )
    b : State(name == "B", state == State.NOTRUN )
  then
    System.out.println(b.getName() + " finished" );
    b.setState( State.FINISHED );
end</pre>
					</p></div><p>
					The execution of rule <code class="literal">"A to B"</code> changes the state of <code class="literal">B</code> to <code class="literal">FINISHED</code>, which activates both rules <code class="literal">"B to C"</code> and <code class="literal">"B to D"</code>, placing their activations onto the decision engine agenda.
				</p><div class="formalpara"><p class="title"><strong>Rules "B to C" and "B to D" in salience State example</strong></p><p>
						
<pre class="screen">rule "B to C"
    salience 10
  when
    State(name == "B", state == State.FINISHED )
    c : State(name == "C", state == State.NOTRUN )
  then
    System.out.println(c.getName() + " finished" );
    c.setState( State.FINISHED );
end

rule "B to D"
  when
    State(name == "B", state == State.FINISHED )
    d : State(name == "D", state == State.NOTRUN )
  then
    System.out.println(d.getName() + " finished" );
    d.setState( State.FINISHED );
end</pre>
					</p></div><p>
					From this point on, both rules may fire and, therefore, the rules are in conflict. The conflict resolution strategy enables the decision engine agenda to decide which rule to fire. Rule <code class="literal">"B to C"</code> has the higher salience value (<code class="literal">10</code> versus the default salience value of <code class="literal">0</code>), so it fires first, modifying object <code class="literal">C</code> to state <code class="literal">FINISHED</code>.
				</p><p>
					The <span class="strong strong"><strong>Audit View</strong></span> in your IDE shows the modification of the <code class="literal">State</code> object in the rule <code class="literal">"A to B"</code>, which results in two activations being in conflict.
				</p><p>
					You can also use the <span class="strong strong"><strong>Agenda View</strong></span> in your IDE to investigate the state of the decision engine agenda. In this example, the <span class="strong strong"><strong>Agenda View</strong></span> shows the breakpoint in the rule <code class="literal">"A to B"</code> and the state of the agenda with the two conflicting rules. Rule <code class="literal">"B to D"</code> fires last, modifying object <code class="literal">D</code> to state <code class="literal">FINISHED</code>.
				</p><div class="figure" id="idm139921811323936"><p class="title"><strong>Figure 86.6. Salience State example Agenda View</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/StateExample/state_example_agenda1.png" alt="state example agenda1"/></div></div></div><h4 id="state_example_using_agenda_groups_2">State example using agenda groups</h4><p>
					The <code class="literal">StateExampleUsingAgendaGroups</code> version of the State example uses agenda groups in rules to resolve rule execution conflicts. Agenda groups enable you to partition the decision engine agenda to provide more execution control over groups of rules. By default, all rules are in the agenda group <code class="literal">MAIN</code>. You can use the <code class="literal">agenda-group</code> attribute to specify a different agenda group for the rule.
				</p><p>
					Initially, a working memory has its focus on the agenda group <code class="literal">MAIN</code>. Rules in an agenda group only fire when the group receives the focus. You can set the focus either by using the method <code class="literal">setFocus()</code> or the rule attribute <code class="literal">auto-focus</code>. The <code class="literal">auto-focus</code> attribute enables the rule to be given a focus automatically for its agenda group when the rule is matched and activated.
				</p><p>
					In this example, the <code class="literal">auto-focus</code> attribute enables rule <code class="literal">"B to C"</code> to fire before <code class="literal">"B to D"</code>.
				</p><div class="formalpara"><p class="title"><strong>Rule "B to C" in agenda group State example</strong></p><p>
						
<pre class="screen">rule "B to C"
    agenda-group "B to C"
    auto-focus true
  when
    State(name == "B", state == State.FINISHED )
    c : State(name == "C", state == State.NOTRUN )
  then
    System.out.println(c.getName() + " finished" );
    c.setState( State.FINISHED );
    kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup( "B to D" ).setFocus();
end</pre>
					</p></div><p>
					The rule <code class="literal">"B to C"</code> calls <code class="literal">setFocus()</code> on the agenda group <code class="literal">"B to D"</code>, enabling its active rules to fire, which then enables the rule <code class="literal">"B to D"</code> to fire.
				</p><div class="formalpara"><p class="title"><strong>Rule "B to D" in agenda group State example</strong></p><p>
						
<pre class="screen">rule "B to D"
    agenda-group "B to D"
  when
    State(name == "B", state == State.FINISHED )
    d : State(name == "D", state == State.NOTRUN )
  then
    System.out.println(d.getName() + " finished" );
    d.setState( State.FINISHED );
end</pre>
					</p></div><p>
					To execute the example, run the <code class="literal">org.drools.examples.state.StateExampleUsingAgendaGroups</code> class as a Java application in your IDE.
				</p><p>
					After the execution, the following output appears in the IDE console window (same as the salience version of the State example):
				</p><div class="formalpara"><p class="title"><strong>Agenda group State example output in the IDE console</strong></p><p>
						
<pre class="screen">A finished
B finished
C finished
D finished</pre>
					</p></div><h4 id="dynamic_facts_in_the_state_example_2">Dynamic facts in the State example</h4><p>
					Another notable concept in this State example is the use of <span class="emphasis"><em>dynamic facts</em></span>, based on objects that implement a <code class="literal">PropertyChangeListener</code> object. In order for the decision engine to see and react to changes of fact properties, the application must notify the decision engine that changes occurred. You can configure this communication explicitly in the rules by using the <code class="literal">modify</code> statement, or implicitly by specifying that the facts implement the <code class="literal">PropertyChangeSupport</code> interface as defined by the JavaBeans specification.
				</p><p>
					This example demonstrates how to use the <code class="literal">PropertyChangeSupport</code> interface to avoid the need for explicit <code class="literal">modify</code> statements in the rules. To make use of this interface, ensure that your facts implement <code class="literal">PropertyChangeSupport</code> in the same way that the class <code class="literal">org.drools.example.State</code> implements it, and then use the following code in the DRL rule file to configure the decision engine to listen for property changes on those facts:
				</p><div class="formalpara"><p class="title"><strong>Declaring a dynamic fact</strong></p><p>
						
<pre class="screen">declare type State
  @propertyChangeSupport
end</pre>
					</p></div><p>
					When you use <code class="literal">PropertyChangeListener</code> objects, each setter must implement additional code for the notification. For example, the following setter for <code class="literal">state</code> is in the class <code class="literal">org.drools.examples</code>:
				</p><div class="formalpara"><p class="title"><strong>Setter example with PropertyChangeSupport</strong></p><p>
						
<pre class="programlisting language-java">public void setState(final int newState) {
    int oldState = this.state;
    this.state = newState;
    this.changes.firePropertyChange( "state",
                                     oldState,
                                     newState );
}</pre>
					</p></div></section><section class="section" id="decision-examples-fibonacci-ref_decision-engine"><div class="titlepage"><div><div><h2 class="title">86.4. Fibonacci example decisions (recursion and conflict resolution)</h2></div></div></div><p>
					The Fibonacci example decision set demonstrates how the decision engine uses recursion to resolve execution conflicts for rules in a sequence. The example focuses on resolving conflicts through salience values that you can define in rules.
				</p><p>
					The following is an overview of the Fibonacci example:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Name</strong></span>: <code class="literal">fibonacci</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Main class</strong></span>: <code class="literal">org.drools.examples.fibonacci.FibonacciExample</code> (in <code class="literal">src/main/java</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Module</strong></span>: <code class="literal">drools-examples</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Type</strong></span>: Java application
						</li><li class="listitem">
							<span class="strong strong"><strong>Rule file</strong></span>: <code class="literal">org.drools.examples.fibonacci.Fibonacci.drl</code> (in <code class="literal">src/main/resources</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Objective</strong></span>: Demonstrates recursion and conflict resolution through rule salience
						</li></ul></div><p>
					The Fibonacci Numbers form a sequence starting with 0 and 1. The next Fibonacci number is obtained by adding the two preceding Fibonacci numbers: 0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610, 987, 1597, 2584, 4181, 6765, 10946, and so on.
				</p><p>
					The Fibonacci example uses the single fact class <code class="literal">Fibonacci</code> with the following two fields:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">sequence</code>
						</li><li class="listitem">
							<code class="literal">value</code>
						</li></ul></div><p>
					The <code class="literal">sequence</code> field indicates the position of the object in the Fibonacci number sequence. The <code class="literal">value</code> field shows the value of that Fibonacci object for that sequence position, where <code class="literal">-1</code> indicates a value that still needs to be computed.
				</p><div class="formalpara"><p class="title"><strong>Fibonacci class</strong></p><p>
						
<pre class="programlisting language-java">public static class Fibonacci {
    private int  sequence;
    private long value;

    public Fibonacci( final int sequence ) {
        this.sequence = sequence;
        this.value = -1;
    }

    ... setters and getters go here...
}</pre>
					</p></div><p>
					To execute the example, run the <code class="literal">org.drools.examples.fibonacci.FibonacciExample</code> class as a Java application in your IDE.
				</p><p>
					After the execution, the following output appears in the IDE console window:
				</p><div class="formalpara"><p class="title"><strong>Fibonacci example output in the IDE console</strong></p><p>
						
<pre class="screen">recurse for 50
recurse for 49
recurse for 48
recurse for 47
...
recurse for 5
recurse for 4
recurse for 3
recurse for 2
1 == 1
2 == 1
3 == 2
4 == 3
5 == 5
6 == 8
...
47 == 2971215073
48 == 4807526976
49 == 7778742049
50 == 12586269025</pre>
					</p></div><p>
					To achieve this behavior in Java, the example inserts a single <code class="literal">Fibonacci</code> object with a sequence field of <code class="literal">50</code>. The example then uses a recursive rule to insert the other 49 <code class="literal">Fibonacci</code> objects.
				</p><p>
					Instead of implementing the <code class="literal">PropertyChangeSupport</code> interface to use dynamic facts, this example uses the MVEL dialect <code class="literal">modify</code> keyword to enable a block setter action and notify the decision engine of changes.
				</p><div class="formalpara"><p class="title"><strong>Fibonacci example execution</strong></p><p>
						
<pre class="programlisting language-java">ksession.insert( new Fibonacci( 50 ) );
ksession.fireAllRules();</pre>
					</p></div><p>
					This example uses the following three rules:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">"Recurse"</code>
						</li><li class="listitem">
							<code class="literal">"Bootstrap"</code>
						</li><li class="listitem">
							<code class="literal">"Calculate"</code>
						</li></ul></div><p>
					The rule <code class="literal">"Recurse"</code> matches each asserted <code class="literal">Fibonacci</code> object with a value of <code class="literal">-1</code>, creating and asserting a new <code class="literal">Fibonacci</code> object with a sequence of one less than the currently matched object. Each time a Fibonacci object is added while the one with a sequence field equal to <code class="literal">1</code> does not exist, the rule re-matches and fires again. The <code class="literal">not</code> conditional element is used to stop the rule matching once you have all 50 Fibonacci objects in memory. The rule also has a <code class="literal">salience</code> value because you need to have all 50 <code class="literal">Fibonacci</code> objects asserted before you execute the <code class="literal">"Bootstrap"</code> rule.
				</p><div class="formalpara"><p class="title"><strong>Rule "Recurse"</strong></p><p>
						
<pre class="screen">rule "Recurse"
    salience 10
  when
    f : Fibonacci ( value == -1 )
    not ( Fibonacci ( sequence == 1 ) )
  then
    insert( new Fibonacci( f.sequence - 1 ) );
    System.out.println( "recurse for " + f.sequence );
end</pre>
					</p></div><p>
					To better understand the execution flow of this example, you can load the audit log file from <code class="literal">target/fibonacci.log</code> into your IDE debug view or <span class="strong strong"><strong>Audit View</strong></span>, if available (for example, in <span class="strong strong"><strong>Window</strong></span> → <span class="strong strong"><strong>Show View</strong></span> in some IDEs).
				</p><p>
					In this example, the <span class="strong strong"><strong>Audit View</strong></span> shows the original assertion of the <code class="literal">Fibonacci</code> object with a <code class="literal">sequence</code> field of <code class="literal">50</code>, done from Java code. From there on, the <span class="strong strong"><strong>Audit View</strong></span> shows the continual recursion of the rule, where each asserted <code class="literal">Fibonacci</code> object causes the <code class="literal">"Recurse"</code> rule to become activated and to fire again.
				</p><div class="figure" id="idm139921811229456"><p class="title"><strong>Figure 86.7. Rule "Recurse" in Audit View</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/FibonacciExample/fibonacci1.png" alt="fibonacci1"/></div></div></div><p>
					When a <code class="literal">Fibonacci</code> object with a <code class="literal">sequence</code> field of <code class="literal">2</code> is asserted, the <code class="literal">"Bootstrap"</code> rule is matched and activated along with the <code class="literal">"Recurse"</code> rule. Notice the multiple restrictions on field <code class="literal">sequence</code> that test for equality with <code class="literal">1</code> or <code class="literal">2</code>:
				</p><div class="formalpara"><p class="title"><strong>Rule "Bootstrap"</strong></p><p>
						
<pre class="screen">rule "Bootstrap"
  when
    f : Fibonacci( sequence == 1 || == 2, value == -1 ) // multi-restriction
  then
    modify ( f ){ value = 1 };
    System.out.println( f.sequence + " == " + f.value );
end</pre>
					</p></div><p>
					You can also use the <span class="strong strong"><strong>Agenda View</strong></span> in your IDE to investigate the state of the decision engine agenda. The <code class="literal">"Bootstrap"</code> rule does not fire yet because the <code class="literal">"Recurse"</code> rule has a higher salience value.
				</p><div class="figure" id="idm139921811216464"><p class="title"><strong>Figure 86.8. Rules "Recurse" and "Bootstrap" in Agenda View 1</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/FibonacciExample/fibonacci_agenda1.png" alt="fibonacci agenda1"/></div></div></div><p>
					When a <code class="literal">Fibonacci</code> object with a <code class="literal">sequence</code> of <code class="literal">1</code> is asserted, the <code class="literal">"Bootstrap"</code> rule is matched again, causing two activations for this rule. The <code class="literal">"Recurse"</code> rule does not match and activate because the <code class="literal">not</code> conditional element stops the rule matching as soon as a <code class="literal">Fibonacci</code> object with a <code class="literal">sequence</code> of <code class="literal">1</code> exists.
				</p><div class="figure" id="idm139921811207344"><p class="title"><strong>Figure 86.9. Rules "Recurse" and "Bootstrap" in Agenda View 2</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/FibonacciExample/fibonacci_agenda2.png" alt="fibonacci agenda2"/></div></div></div><p>
					The <code class="literal">"Bootstrap"</code> rule sets the objects with a <code class="literal">sequence</code> of <code class="literal">1</code> and <code class="literal">2</code> to a value of <code class="literal">1</code>. Now that you have two <code class="literal">Fibonacci</code> objects with values not equal to <code class="literal">-1</code>, the <code class="literal">"Calculate"</code> rule is able to match.
				</p><p>
					At this point in the example, nearly 50 <code class="literal">Fibonacci</code> objects exist in the working memory. You need to select a suitable triple to calculate each of their values in turn. If you use three Fibonacci patterns in a rule without field constraints to confine the possible cross products, the result would be 50x49x48 possible combinations, leading to about 125,000 possible rule firings, most of them incorrect.
				</p><p>
					The <code class="literal">"Calculate"</code> rule uses field constraints to evaluate the three Fibonacci patterns in the correct order. This technique is called <span class="emphasis"><em>cross-product matching</em></span>.
				</p><p>
					The first pattern finds any <code class="literal">Fibonacci</code> object with a value <code class="literal">!= -1</code> and binds both the pattern and the field. The second <code class="literal">Fibonacci</code> object does the same thing, but adds an additional field constraint to ensure that its sequence is greater by one than the <code class="literal">Fibonacci</code> object bound to <code class="literal">f1</code>. When this rule fires for the first time, you know that only sequences <code class="literal">1</code> and <code class="literal">2</code> have values of <code class="literal">1</code>, and the two constraints ensure that <code class="literal">f1</code> references sequence <code class="literal">1</code> and that <code class="literal">f2</code> references sequence <code class="literal">2</code>.
				</p><p>
					The final pattern finds the <code class="literal">Fibonacci</code> object with a value equal to <code class="literal">-1</code> and with a sequence one greater than <code class="literal">f2</code>.
				</p><p>
					At this point in the example, three <code class="literal">Fibonacci</code> objects are correctly selected from the available cross products, and you can calculate the value for the third <code class="literal">Fibonacci</code> object that is bound to <code class="literal">f3</code>.
				</p><div class="formalpara"><p class="title"><strong>Rule "Calculate"</strong></p><p>
						
<pre class="screen">rule "Calculate"
  when
    // Bind f1 and s1.
    f1 : Fibonacci( s1 : sequence, value != -1 )
    // Bind f2 and v2, refer to bound variable s1.
    f2 : Fibonacci( sequence == (s1 + 1), v2 : value != -1 )
    // Bind f3 and s3, alternative reference of f2.sequence.
    f3 : Fibonacci( s3 : sequence == (f2.sequence + 1 ), value == -1 )
  then
    // Note the various referencing techniques.
    modify ( f3 ) { value = f1.value + v2 };
    System.out.println( s3 + " == " + f3.value );
end</pre>
					</p></div><p>
					The <code class="literal">modify</code> statement updates the value of the <code class="literal">Fibonacci</code> object bound to <code class="literal">f3</code>. This means that you now have another new <code class="literal">Fibonacci</code> object with a value not equal to <code class="literal">-1</code>, which allows the <code class="literal">"Calculate"</code> rule to re-match and calculate the next Fibonacci number.
				</p><p>
					The debug view or <span class="strong strong"><strong>Audit View</strong></span> of your IDE shows how the firing of the last <code class="literal">"Bootstrap"</code> rule modifies the <code class="literal">Fibonacci</code> object, enabling the <code class="literal">"Calculate"</code> rule to match, which then modifies another <code class="literal">Fibonacci</code> object that enables the <code class="literal">"Calculate"</code> rule to match again. This process continues until the value is set for all <code class="literal">Fibonacci</code> objects.
				</p><div class="figure" id="idm139921811175216"><p class="title"><strong>Figure 86.10. Rules in Audit View</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/FibonacciExample/fibonacci4.png" alt="fibonacci4"/></div></div></div></section><section class="section" id="decision-examples-pricing-ref_decision-engine"><div class="titlepage"><div><div><h2 class="title">86.5. Pricing example decisions (decision tables)</h2></div></div></div><p>
					The Pricing example decision set demonstrates how to use a spreadsheet decision table for calculating the retail cost of an insurance policy in tabular format instead of directly in a DRL file.
				</p><p>
					The following is an overview of the Pricing example:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Name</strong></span>: <code class="literal">decisiontable</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Main class</strong></span>: <code class="literal">org.drools.examples.decisiontable.PricingRuleDTExample</code> (in <code class="literal">src/main/java</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Module</strong></span>: <code class="literal">drools-examples</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Type</strong></span>: Java application
						</li><li class="listitem">
							<span class="strong strong"><strong>Rule file</strong></span>: <code class="literal">org.drools.examples.decisiontable.ExamplePolicyPricing.xls</code> (in <code class="literal">src/main/resources</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Objective</strong></span>: Demonstrates use of spreadsheet decision tables to define rules
						</li></ul></div><p>
					Spreadsheet decision tables are XLS or XLSX spreadsheets that contain business rules defined in a tabular format. You can include spreadsheet decision tables with standalone Red Hat Process Automation Manager projects or upload them to projects in Business Central. Each row in a decision table is a rule, and each column is a condition, an action, or another rule attribute. After you create and upload your decision tables into your Red Hat Process Automation Manager project, the rules you defined are compiled into Drools Rule Language (DRL) rules as with all other rule assets.
				</p><p>
					The purpose of the Pricing example is to provide a set of business rules to calculate the base price and a discount for a car driver applying for a specific type of insurance policy. The driver’s age and history and the policy type all contribute to calculate the basic premium, and additional rules calculate potential discounts for which the driver might be eligible.
				</p><p>
					To execute the example, run the <code class="literal">org.drools.examples.decisiontable.PricingRuleDTExample</code> class as a Java application in your IDE.
				</p><p>
					After the execution, the following output appears in the IDE console window:
				</p><pre class="screen">Cheapest possible
BASE PRICE IS: 120
DISCOUNT IS: 20</pre><p>
					The code to execute the example follows the typical execution pattern: the rules are loaded, the facts are inserted, and a stateless KIE session is created. The difference in this example is that the rules are defined in an <code class="literal">ExamplePolicyPricing.xls</code> file instead of a DRL file or other source. The spreadsheet file is loaded into the decision engine using templates and DRL rules.
				</p><h4 id="spreadsheet_decision_table_setup_2">Spreadsheet decision table setup</h4><p>
					The <code class="literal">ExamplePolicyPricing.xls</code> spreadsheet contains two decision tables in the first tab:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">Base pricing rules</code>
						</li><li class="listitem">
							<code class="literal">Promotional discount rules</code>
						</li></ul></div><p>
					As the example spreadsheet demonstrates, you can use only the first tab of a spreadsheet to create decision tables, but multiple tables can be within a single tab. Decision tables do not necessarily follow top-down logic, but are more of a means to capture data resulting in rules. The evaluation of the rules is not necessarily in the given order, because all of the normal mechanics of the decision engine still apply. This is why you can have multiple decision tables in the same tab of a spreadsheet.
				</p><p>
					The decision tables are executed through the corresponding rule template files <code class="literal">BasePricing.drt</code> and <code class="literal">PromotionalPricing.drt</code>. These template files reference the decision tables through their template parameter and directly reference the various headers for the conditions and actions in the decision tables.
				</p><div class="formalpara"><p class="title"><strong>BasePricing.drt rule template file</strong></p><p>
						
<pre class="screen">template header
age[]
profile
priorClaims
policyType
base
reason

package org.drools.examples.decisiontable;

template "Pricing bracket"
age
policyType
base

rule "Pricing bracket_@{row.rowNumber}"
  when
    Driver(age &gt;= @{age0}, age &lt;= @{age1}
        , priorClaims == "@{priorClaims}"
        , locationRiskProfile == "@{profile}"
    )
    policy: Policy(type == "@{policyType}")
  then
    policy.setBasePrice(@{base});
    System.out.println("@{reason}");
end
end template</pre>
					</p></div><div class="formalpara"><p class="title"><strong>PromotionalPricing.drt rule template file</strong></p><p>
						
<pre class="screen">template header
age[]
priorClaims
policyType
discount

package org.drools.examples.decisiontable;

template "discounts"
age
priorClaims
policyType
discount

rule "Discounts_@{row.rowNumber}"
  when
    Driver(age &gt;= @{age0}, age &lt;= @{age1}, priorClaims == "@{priorClaims}")
    policy: Policy(type == "@{policyType}")
  then
    policy.applyDiscount(@{discount});
end
end template</pre>
					</p></div><p>
					The rules are executed through the <code class="literal">kmodule.xml</code> reference of the KIE Session <code class="literal">DTableWithTemplateKB</code>, which specifically mentions the <code class="literal">ExamplePolicyPricing.xls</code> spreadsheet and is required for successful execution of the rules. This execution method enables you to execute the rules as a standalone unit (as in this example) or to include the rules in a packaged knowledge JAR (KJAR) file, so that the spreadsheet is packaged along with the rules for execution.
				</p><p>
					The following section of the <code class="literal">kmodule.xml</code> file is required for the execution of the rules and spreadsheet to work successfully:
				</p><pre class="programlisting language-xml">    &lt;kbase name="DecisionTableKB" packages="org.drools.examples.decisiontable"&gt;
        &lt;ksession name="DecisionTableKS" type="stateless"/&gt;
    &lt;/kbase&gt;

    &lt;kbase name="DTableWithTemplateKB" packages="org.drools.examples.decisiontable-template"&gt;
        &lt;ruleTemplate dtable="org/drools/examples/decisiontable-template/ExamplePolicyPricingTemplateData.xls"
                      template="org/drools/examples/decisiontable-template/BasePricing.drt"
                      row="3" col="3"/&gt;
        &lt;ruleTemplate dtable="org/drools/examples/decisiontable-template/ExamplePolicyPricingTemplateData.xls"
                      template="org/drools/examples/decisiontable-template/PromotionalPricing.drt"
                      row="18" col="3"/&gt;
        &lt;ksession name="DTableWithTemplateKS"/&gt;
    &lt;/kbase&gt;</pre><p>
					As an alternative to executing the decision tables using rule template files, you can use the <code class="literal">DecisionTableConfiguration</code> object and specify an input spreadsheet as the input type, such as <code class="literal">DecisionTableInputType.xls</code>:
				</p><pre class="programlisting language-java">DecisionTableConfiguration dtableconfiguration =
    KnowledgeBuilderFactory.newDecisionTableConfiguration();
        dtableconfiguration.setInputType( DecisionTableInputType.XLS );

        KnowledgeBuilder kbuilder = KnowledgeBuilderFactory.newKnowledgeBuilder();

        Resource xlsRes = ResourceFactory.newClassPathResource( "ExamplePolicyPricing.xls",
                                                                getClass() );
        kbuilder.add( xlsRes,
                      ResourceType.DTABLE,
                      dtableconfiguration );</pre><p>
					The Pricing example uses two fact types:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">Driver</code>
						</li><li class="listitem">
							<code class="literal">Policy</code>.
						</li></ul></div><p>
					The example sets the default values for both facts in their respective Java classes <code class="literal">Driver.java</code> and <code class="literal">Policy.java</code>. The <code class="literal">Driver</code> is 30 years old, has had no prior claims, and currently has a risk profile of <code class="literal">LOW</code>. The <code class="literal">Policy</code> that the driver is applying for is <code class="literal">COMPREHENSIVE</code>.
				</p><p>
					In any decision table, each row is considered a different rule and each column is a condition or an action. Each row is evaluated in a decision table unless the agenda is cleared upon execution.
				</p><p>
					Decision table spreadsheets (XLS or XLSX) require two key areas that define rule data:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							A <code class="literal">RuleSet</code> area
						</li><li class="listitem">
							A <code class="literal">RuleTable</code> area
						</li></ul></div><p>
					The <code class="literal">RuleSet</code> area of the spreadsheet defines elements that you want to apply globally to all rules in the same package (not only the spreadsheet), such as a rule set name or universal rule attributes. The <code class="literal">RuleTable</code> area defines the actual rules (rows) and the conditions, actions, and other rule attributes (columns) that constitute that rule table within the specified rule set. A decision table spreadsheet can contain multiple <code class="literal">RuleTable</code> areas, but only one <code class="literal">RuleSet</code> area.
				</p><div class="figure" id="idm139921811109712"><p class="title"><strong>Figure 86.11. Decision table configuration</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/PricingExample/DT_Config.png" alt="DT Config"/></div></div></div><p>
					The <code class="literal">RuleTable</code> area also defines the objects to which the rule attributes apply, in this case <code class="literal">Driver</code> and <code class="literal">Policy</code>, followed by constraints on the objects. For example, the <code class="literal">Driver</code> object constraint that defines the <code class="literal">Age Bracket</code> column is <code class="literal">age &gt;= $1, age &lt;= $2</code>, where the comma-separated range is defined in the table column values, such as <code class="literal">18,24</code>.
				</p><h4 id="base_pricing_rules_2">Base pricing rules</h4><p>
					The <code class="literal">Base pricing rules</code> decision table in the Pricing example evaluates the age, risk profile, number of claims, and policy type of the driver and produces the base price of the policy based on these conditions.
				</p><div class="figure" id="idm139921811098768"><p class="title"><strong>Figure 86.12. Base price calculation</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/PricingExample/DT_Table1.png" alt="DT Table1"/></div></div></div><p>
					The <code class="literal">Driver</code> attributes are defined in the following table columns:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">Age Bracket</code>: The age bracket has a definition for the condition <code class="literal">age &gt;=$1, age &lt;=$2</code>, which defines the condition boundaries for the driver’s age. This condition column highlights the use of <code class="literal">$1 and $2</code>, which is comma delimited in the spreadsheet. You can write these values as <code class="literal">18,24</code> or <code class="literal">18, 24</code> and both formats work in the execution of the business rules.
						</li><li class="listitem">
							<code class="literal">Location risk profile</code>: The risk profile is a string that the example program passes always as <code class="literal">LOW</code> but can be changed to reflect <code class="literal">MED</code> or <code class="literal">HIGH</code>.
						</li><li class="listitem">
							<code class="literal">Number of prior claims</code>: The number of claims is defined as an integer that the condition column must exactly equal to trigger the action. The value is not a range, only exact matches.
						</li></ul></div><p>
					The <code class="literal">Policy</code> of the decision table is used in both the conditions and the actions of the rule and has attributes defined in the following table columns:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">Policy type applying for</code>: The policy type is a condition that is passed as a string that defines the type of coverage: <code class="literal">COMPREHENSIVE</code>, <code class="literal">FIRE_THEFT</code>, or <code class="literal">THIRD_PARTY</code>.
						</li><li class="listitem">
							<code class="literal">Base $ AUD</code>: The <code class="literal">basePrice</code> is defined as an <code class="literal">ACTION</code> that sets the price through the constraint <code class="literal">policy.setBasePrice($param);</code> based on the spreadsheet cells corresponding to this value. When you execute the corresponding DRL rule for this decision table, the <code class="literal">then</code> portion of the rule executes this action statement on the true conditions matching the facts and sets the base price to the corresponding value.
						</li><li class="listitem">
							<code class="literal">Record Reason</code>: When the rule successfully executes, this action generates an output message to the <code class="literal">System.out</code> console reflecting which rule fired. This is later captured in the application and printed.
						</li></ul></div><p>
					The example also uses the first column on the left to categorize rules. This column is for annotation only and has no affect on rule execution.
				</p><h4 id="promotional_discount_rules_2">Promotional discount rules</h4><p>
					The <code class="literal">Promotional discount rules</code> decision table in the Pricing example evaluates the age, number of prior claims, and policy type of the driver to generate a potential discount on the price of the insurance policy.
				</p><div class="figure" id="idm139921811071120"><p class="title"><strong>Figure 86.13. Discount calculation</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/PricingExample/DT_Table2.png" alt="DT Table2"/></div></div></div><p>
					This decision table contains the conditions for the discount for which the driver might be eligible. Similar to the base price calculation, this table evaluates the <code class="literal">Age</code>, <code class="literal">Number of prior claims</code> of the driver, and the <code class="literal">Policy type applying for</code> to determine a <code class="literal">Discount %</code> rate to be applied. For example, if the driver is 30 years old, has no prior claims, and is applying for a <code class="literal">COMPREHENSIVE</code> policy, the driver is given a discount of <code class="literal">20</code> percent.
				</p></section><section class="section" id="decision-examples-petstore-ref_decision-engine"><div class="titlepage"><div><div><h2 class="title">86.6. Pet Store example decisions (agenda groups, global variables, callbacks, and GUI integration)</h2></div></div></div><p>
					The Pet Store example decision set demonstrates how to use agenda groups and global variables in rules and how to integrate Red Hat Process Automation Manager rules with a graphical user interface (GUI), in this case a Swing-based desktop application. The example also demonstrates how to use callbacks to interact with a running decision engine to update the GUI based on changes in the working memory at run time.
				</p><p>
					The following is an overview of the Pet Store example:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Name</strong></span>: <code class="literal">petstore</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Main class</strong></span>: <code class="literal">org.drools.examples.petstore.PetStoreExample</code> (in <code class="literal">src/main/java</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Module</strong></span>: <code class="literal">drools-examples</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Type</strong></span>: Java application
						</li><li class="listitem">
							<span class="strong strong"><strong>Rule file</strong></span>: <code class="literal">org.drools.examples.petstore.PetStore.drl</code> (in <code class="literal">src/main/resources</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Objective</strong></span>: Demonstrates rule agenda groups, global variables, callbacks, and GUI integration
						</li></ul></div><p>
					In the Pet Store example, the sample <code class="literal">PetStoreExample.java</code> class defines the following principal classes (in addition to several classes to handle Swing events):
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">Petstore</code> contains the <code class="literal">main()</code> method.
						</li><li class="listitem">
							<code class="literal">PetStoreUI</code> is responsible for creating and displaying the Swing-based GUI. This class contains several smaller classes, mainly for responding to various GUI events, such as user mouse clicks.
						</li><li class="listitem">
							<code class="literal">TableModel</code> holds the table data. This class is essentially a JavaBean that extends the Swing class <code class="literal">AbstractTableModel</code>.
						</li><li class="listitem">
							<code class="literal">CheckoutCallback</code> enables the GUI to interact with the rules.
						</li><li class="listitem">
							<code class="literal">Ordershow</code> keeps the items that you want to buy.
						</li><li class="listitem">
							<code class="literal">Purchase</code> stores details of the order and the products that you are buying.
						</li><li class="listitem">
							<code class="literal">Product</code> is a JavaBean containing details of the product available for purchase and its price.
						</li></ul></div><p>
					Much of the Java code in this example is either plain JavaBean or Swing based. For more information about Swing components, see the Java tutorial on <a class="link" href="https://docs.oracle.com/javase/tutorial/uiswing/">Creating a GUI with JFC/Swing</a>.
				</p><h4 id="rule_execution_behavior_in_the_pet_store_example_2">Rule execution behavior in the Pet Store example</h4><p>
					Unlike other example decision sets where the facts are asserted and fired immediately, the Pet Store example does not execute the rules until more facts are gathered based on user interaction. The example executes rules through a <code class="literal">PetStoreUI</code> object, created by a constructor, that accepts the <code class="literal">Vector</code> object <code class="literal">stock</code> for collecting the products. The example then uses an instance of the <code class="literal">CheckoutCallback</code> class containing the rule base that was previously loaded.
				</p><div class="formalpara"><p class="title"><strong>Pet Store KIE container and fact execution setup</strong></p><p>
						
<pre class="programlisting language-java">// KieServices is the factory for all KIE services.
KieServices ks = KieServices.Factory.get();

// Create a KIE container on the class path.
KieContainer kc = ks.getKieClasspathContainer();

// Create the stock.
Vector&lt;Product&gt; stock = new Vector&lt;Product&gt;();
stock.add( new Product( "Gold Fish", 5 ) );
stock.add( new Product( "Fish Tank", 25 ) );
stock.add( new Product( "Fish Food", 2 ) );

// A callback is responsible for populating the working memory and for firing all rules.
PetStoreUI ui = new PetStoreUI( stock,
                                new CheckoutCallback( kc ) );
ui.createAndShowGUI();</pre>
					</p></div><p>
					The Java code that fires the rules is in the <code class="literal">CheckoutCallBack.checkout()</code> method. This method is triggered when the user clicks <span class="strong strong"><strong>Checkout</strong></span> in the UI.
				</p><div class="formalpara"><p class="title"><strong>Rule execution from CheckoutCallBack.checkout()</strong></p><p>
						
<pre class="programlisting language-java">public String checkout(JFrame frame, List&lt;Product&gt; items) {
    Order order = new Order();

    // Iterate through list and add to cart.
    for ( Product p: items ) {
        order.addItem( new Purchase( order, p ) );
    }

    // Add the JFrame to the ApplicationData to allow for user interaction.

    // From the KIE container, a KIE session is created based on
    // its definition and configuration in the META-INF/kmodule.xml file.
    KieSession ksession = kcontainer.newKieSession("PetStoreKS");

    ksession.setGlobal( "frame", frame );
    ksession.setGlobal( "textArea", this.output );

    ksession.insert( new Product( "Gold Fish", 5 ) );
    ksession.insert( new Product( "Fish Tank", 25 ) );
    ksession.insert( new Product( "Fish Food", 2 ) );

    ksession.insert( new Product( "Fish Food Sample", 0 ) );

    ksession.insert( order );

    // Execute rules.
    ksession.fireAllRules();

    // Return the state of the cart
    return order.toString();
}</pre>
					</p></div><p>
					The example code passes two elements into the <code class="literal">CheckoutCallBack.checkout()</code> method. One element is the handle for the <code class="literal">JFrame</code> Swing component surrounding the output text frame, found at the bottom of the GUI. The second element is a list of order items, which comes from the <code class="literal">TableModel</code> that stores the information from the <code class="literal">Table</code> area at the upper-right section of the GUI.
				</p><p>
					The <code class="literal">for</code> loop transforms the list of order items coming from the GUI into the <code class="literal">Order</code> JavaBean, also contained in the file <code class="literal">PetStoreExample.java</code>.
				</p><p>
					In this case, the rule is firing in a stateless KIE session because all of the data is stored in Swing components and is not executed until the user clicks <span class="strong strong"><strong>Checkout</strong></span> in the UI. Each time the user clicks <span class="strong strong"><strong>Checkout</strong></span>, the content of the list is moved from the Swing <code class="literal">TableModel</code> into the KIE session working memory and is then executed with the <code class="literal">ksession.fireAllRules()</code> method.
				</p><p>
					Within this code, there are nine calls to <code class="literal">KieSession</code>. The first of these creates a new <code class="literal">KieSession</code> from the <code class="literal">KieContainer</code> (the example passed in this <code class="literal">KieContainer</code> from the <code class="literal">CheckoutCallBack</code> class in the <code class="literal">main()</code> method). The next two calls pass in the two objects that hold the global variables in the rules: the Swing text area and the Swing frame used for writing messages. More inserts put information on products into the <code class="literal">KieSession</code>, as well as the order list. The final call is the standard <code class="literal">fireAllRules()</code>.
				</p><h4 id="pet_store_rule_file_imports_global_variables_and_java_functions_2">Pet Store rule file imports, global variables, and Java functions</h4><p>
					The <code class="literal">PetStore.drl</code> file contains the standard package and import statements to make various Java classes available to the rules. The rule file also includes <span class="emphasis"><em>global variables</em></span> to be used within the rules, defined as <code class="literal">frame</code> and <code class="literal">textArea</code>. The global variables hold references to the Swing components <code class="literal">JFrame</code> and <code class="literal">JTextArea</code> components that were previously passed on by the Java code that called the <code class="literal">setGlobal()</code> method. Unlike standard variables in rules, which expire as soon as the rule has fired, global variables retain their value for the lifetime of the KIE session. This means the contents of these global variables are available for evaluation on all subsequent rules.
				</p><div class="formalpara"><p class="title"><strong>PetStore.drl package, imports, and global variables</strong></p><p>
						
<pre class="programlisting language-java">package org.drools.examples;

import org.kie.api.runtime.KieRuntime;
import org.drools.examples.petstore.PetStoreExample.Order;
import org.drools.examples.petstore.PetStoreExample.Purchase;
import org.drools.examples.petstore.PetStoreExample.Product;
import java.util.ArrayList;
import javax.swing.JOptionPane;

import javax.swing.JFrame;

global JFrame frame
global javax.swing.JTextArea textArea</pre>
					</p></div><p>
					The <code class="literal">PetStore.drl</code> file also contains two functions that the rules in the file use:
				</p><div class="formalpara"><p class="title"><strong>PetStore.drl Java functions</strong></p><p>
						
<pre class="programlisting language-java">function void doCheckout(JFrame frame, KieRuntime krt) {
        Object[] options = {"Yes",
                            "No"};

        int n = JOptionPane.showOptionDialog(frame,
                                             "Would you like to checkout?",
                                             "",
                                             JOptionPane.YES_NO_OPTION,
                                             JOptionPane.QUESTION_MESSAGE,
                                             null,
                                             options,
                                             options[0]);

       if (n == 0) {
            krt.getAgenda().getAgendaGroup( "checkout" ).setFocus();
       }
}

function boolean requireTank(JFrame frame, KieRuntime krt, Order order, Product fishTank, int total) {
        Object[] options = {"Yes",
                            "No"};

        int n = JOptionPane.showOptionDialog(frame,
                                             "Would you like to buy a tank for your " + total + " fish?",
                                             "Purchase Suggestion",
                                             JOptionPane.YES_NO_OPTION,
                                             JOptionPane.QUESTION_MESSAGE,
                                             null,
                                             options,
                                             options[0]);

       System.out.print( "SUGGESTION: Would you like to buy a tank for your "
                           + total + " fish? - " );

       if (n == 0) {
             Purchase purchase = new Purchase( order, fishTank );
             krt.insert( purchase );
             order.addItem( purchase );
             System.out.println( "Yes" );
       } else {
            System.out.println( "No" );
       }
       return true;
}</pre>
					</p></div><p>
					The two functions perform the following actions:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">doCheckout()</code> displays a dialog that asks the user if she or he wants to check out. If the user does, the focus is set to the <code class="literal">checkout</code> agenda group, enabling rules in that group to (potentially) fire.
						</li><li class="listitem">
							<code class="literal">requireTank()</code> displays a dialog that asks the user if she or he wants to buy a fish tank. If the user does, a new fish tank <code class="literal">Product</code> is added to the order list in the working memory.
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						For this example, all rules and functions are within the same rule file for efficiency. In a production environment, you typically separate the rules and functions in different files or build a static Java method and import the files using the import function, such as <code class="literal">import function my.package.name.hello</code>.
					</p></div></div><h4 id="pet_store_rules_with_agenda_groups_2">Pet Store rules with agenda groups</h4><p>
					Most of the rules in the Pet Store example use agenda groups to control rule execution. Agenda groups allow you to partition the decision engine agenda to provide more execution control over groups of rules. By default, all rules are in the agenda group <code class="literal">MAIN</code>. You can use the <code class="literal">agenda-group</code> attribute to specify a different agenda group for the rule.
				</p><p>
					Initially, a working memory has its focus on the agenda group <code class="literal">MAIN</code>. Rules in an agenda group only fire when the group receives the focus. You can set the focus either by using the method <code class="literal">setFocus()</code> or the rule attribute <code class="literal">auto-focus</code>. The <code class="literal">auto-focus</code> attribute enables the rule to be given a focus automatically for its agenda group when the rule is matched and activated.
				</p><p>
					The Pet Store example uses the following agenda groups for rules:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">"init"</code>
						</li><li class="listitem">
							<code class="literal">"evaluate"</code>
						</li><li class="listitem">
							<code class="literal">"show items"</code>
						</li><li class="listitem">
							<code class="literal">"checkout"</code>
						</li></ul></div><p>
					For example, the sample rule <code class="literal">"Explode Cart"</code> uses the <code class="literal">"init"</code> agenda group to ensure that it has the option to fire and insert shopping cart items into the KIE session working memory:
				</p><div class="formalpara"><p class="title"><strong>Rule "Explode Cart"</strong></p><p>
						
<pre class="screen">// Insert each item in the shopping cart into the working memory.
rule "Explode Cart"
    agenda-group "init"
    auto-focus true
    salience 10
  when
    $order : Order( grossTotal == -1 )
    $item : Purchase() from $order.items
  then
    insert( $item );
    kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup( "show items" ).setFocus();
    kcontext.getKnowledgeRuntime().getAgenda().getAgendaGroup( "evaluate" ).setFocus();
end</pre>
					</p></div><p>
					This rule matches against all orders that do not yet have their <code class="literal">grossTotal</code> calculated. The execution loops for each purchase item in that order.
				</p><p>
					The rule uses the following features related to its agenda group:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">agenda-group "init"</code> defines the name of the agenda group. In this case, only one rule is in the group. However, neither the Java code nor a rule consequence sets the focus to this group, and therefore it relies on the <code class="literal">auto-focus</code> attribute for its chance to fire.
						</li><li class="listitem">
							<code class="literal">auto-focus true</code> ensures that this rule, while being the only rule in the agenda group, gets a chance to fire when <code class="literal">fireAllRules()</code> is called from the Java code.
						</li><li class="listitem">
							<code class="literal">kcontext…​.setFocus()</code> sets the focus to the <code class="literal">"show items"</code> and <code class="literal">"evaluate"</code> agenda groups, enabling their rules to fire. In practice, you loop through all items in the order, insert them into memory, and then fire the other rules after each insertion.
						</li></ul></div><p>
					The <code class="literal">"show items"</code> agenda group contains only one rule, <code class="literal">"Show Items"</code>. For each purchase in the order currently in the KIE session working memory, the rule logs details to the text area at the bottom of the GUI, based on the <code class="literal">textArea</code> variable defined in the rule file.
				</p><div class="formalpara"><p class="title"><strong>Rule "Show Items"</strong></p><p>
						
<pre class="screen">rule "Show Items"
    agenda-group "show items"
  when
    $order : Order()
    $p : Purchase( order == $order )
  then
   textArea.append( $p.product + "\n");
end</pre>
					</p></div><p>
					The <code class="literal">"evaluate"</code> agenda group also gains focus from the <code class="literal">"Explode Cart"</code> rule. This agenda group contains two rules, <code class="literal">"Free Fish Food Sample"</code> and <code class="literal">"Suggest Tank"</code>, which are executed in that order.
				</p><div class="formalpara"><p class="title"><strong>Rule "Free Fish Food Sample"</strong></p><p>
						
<pre class="screen">// Free fish food sample when users buy a goldfish if they did not already buy
// fish food and do not already have a fish food sample.
rule "Free Fish Food Sample"
    agenda-group "evaluate" <span id="CO15-1"/><span class="callout">1</span>
  when
    $order : Order()
    not ( $p : Product( name == "Fish Food") &amp;&amp; Purchase( product == $p ) ) <span id="CO15-2"/><span class="callout">2</span>
    not ( $p : Product( name == "Fish Food Sample") &amp;&amp; Purchase( product == $p ) ) <span id="CO15-3"/><span class="callout">3</span>
    exists ( $p : Product( name == "Gold Fish") &amp;&amp; Purchase( product == $p ) ) <span id="CO15-4"/><span class="callout">4</span>
    $fishFoodSample : Product( name == "Fish Food Sample" );
  then
    System.out.println( "Adding free Fish Food Sample to cart" );
    purchase = new Purchase($order, $fishFoodSample);
    insert( purchase );
    $order.addItem( purchase );
end</pre>
					</p></div><p>
					The rule <code class="literal">"Free Fish Food Sample"</code> fires only if all of the following conditions are true:
				</p><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO15-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							The agenda group <code class="literal">"evaluate"</code> is being evaluated in the rules execution.
						</div></dd><dt><a href="#CO15-2"><span class="callout">2</span></a> </dt><dd><div class="para">
							User does not already have fish food.
						</div></dd><dt><a href="#CO15-3"><span class="callout">3</span></a> </dt><dd><div class="para">
							User does not already have a free fish food sample.
						</div></dd><dt><a href="#CO15-4"><span class="callout">4</span></a> </dt><dd><div class="para">
							User has a goldfish in the order.
						</div></dd></dl></div><p>
					If the order facts meet all of these requirements, then a new product is created (Fish Food Sample) and is added to the order in working memory.
				</p><div class="formalpara"><p class="title"><strong>Rule "Suggest Tank"</strong></p><p>
						
<pre class="screen">// Suggest a fish tank if users buy more than five goldfish and
// do not already have a tank.
rule "Suggest Tank"
    agenda-group "evaluate"
  when
    $order : Order()
    not ( $p : Product( name == "Fish Tank") &amp;&amp; Purchase( product == $p ) ) <span id="CO16-1"/><span class="callout">1</span>
    ArrayList( $total : size &gt; 5 ) from collect( Purchase( product.name == "Gold Fish" ) ) <span id="CO16-2"/><span class="callout">2</span>
    $fishTank : Product( name == "Fish Tank" )
  then
    requireTank(frame, kcontext.getKieRuntime(), $order, $fishTank, $total);
end</pre>
					</p></div><p>
					The rule <code class="literal">"Suggest Tank"</code> fires only if the following conditions are true:
				</p><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO16-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							User does not have a fish tank in the order.
						</div></dd><dt><a href="#CO16-2"><span class="callout">2</span></a> </dt><dd><div class="para">
							User has more than five fish in the order.
						</div></dd></dl></div><p>
					When the rule fires, it calls the <code class="literal">requireTank()</code> function defined in the rule file. This function displays a dialog that asks the user if she or he wants to buy a fish tank. If the user does, a new fish tank <code class="literal">Product</code> is added to the order list in the working memory. When the rule calls the <code class="literal">requireTank()</code> function, the rule passes the <code class="literal">frame</code> global variable so that the function has a handle for the Swing GUI.
				</p><p>
					The <code class="literal">"do checkout"</code> rule in the Pet Store example has no agenda group and no <code class="literal">when</code> conditions, so the rule is always executed and considered part of the default <code class="literal">MAIN</code> agenda group.
				</p><div class="formalpara"><p class="title"><strong>Rule "do checkout"</strong></p><p>
						
<pre class="screen">rule "do checkout"
  when
  then
    doCheckout(frame, kcontext.getKieRuntime());
end</pre>
					</p></div><p>
					When the rule fires, it calls the <code class="literal">doCheckout()</code> function defined in the rule file. This function displays a dialog that asks the user if she or he wants to check out. If the user does, the focus is set to the <code class="literal">checkout</code> agenda group, enabling rules in that group to (potentially) fire. When the rule calls the <code class="literal">doCheckout()</code> function, the rule passes the <code class="literal">frame</code> global variable so that the function has a handle for the Swing GUI.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						This example also demonstrates a troubleshooting technique if results are not executing as you expect: You can remove the conditions from the <code class="literal">when</code> statement of a rule and test the action in the <code class="literal">then</code> statement to verify that the action is performed correctly.
					</p></div></div><p>
					The <code class="literal">"checkout"</code> agenda group contains three rules for processing the order checkout and applying any discounts: <code class="literal">"Gross Total"</code>, <code class="literal">"Apply 5% Discount"</code>, and <code class="literal">"Apply 10% Discount"</code>.
				</p><div class="formalpara"><p class="title"><strong>Rules "Gross Total", "Apply 5% Discount", and "Apply 10% Discount"</strong></p><p>
						
<pre class="screen">rule "Gross Total"
    agenda-group "checkout"
  when
    $order : Order( grossTotal == -1)
    Number( total : doubleValue ) from accumulate( Purchase( $price : product.price ),
                                                              sum( $price ) )
  then
    modify( $order ) { grossTotal = total }
    textArea.append( "\ngross total=" + total + "\n" );
end

rule "Apply 5% Discount"
    agenda-group "checkout"
  when
    $order : Order( grossTotal &gt;= 10 &amp;&amp; &lt; 20 )
  then
    $order.discountedTotal = $order.grossTotal * 0.95;
    textArea.append( "discountedTotal total=" + $order.discountedTotal + "\n" );
end

rule "Apply 10% Discount"
    agenda-group "checkout"
  when
    $order : Order( grossTotal &gt;= 20 )
  then
    $order.discountedTotal = $order.grossTotal * 0.90;
    textArea.append( "discountedTotal total=" + $order.discountedTotal + "\n" );
end</pre>
					</p></div><p>
					If the user has not already calculated the gross total, the <code class="literal">Gross Total</code> accumulates the product prices into a total, puts this total into the KIE session, and displays it through the Swing <code class="literal">JTextArea</code> using the <code class="literal">textArea</code> global variable.
				</p><p>
					If the gross total is between <code class="literal">10</code> and <code class="literal">20</code> (currency units), the <code class="literal">"Apply 5% Discount"</code> rule calculates the discounted total, adds it to the KIE session, and displays it in the text area.
				</p><p>
					If the gross total is not less than <code class="literal">20</code>, the <code class="literal">"Apply 10% Discount"</code> rule calculates the discounted total, adds it to the KIE session, and displays it in the text area.
				</p><h4 id="pet_store_example_execution_2">Pet Store example execution</h4><p>
					Similar to other Red Hat Process Automation Manager decision examples, you execute the Pet Store example by running the <code class="literal">org.drools.examples.petstore.PetStoreExample</code> class as a Java application in your IDE.
				</p><p>
					When you execute the Pet Store example, the <code class="literal">Pet Store Demo</code> GUI window appears. This window displays a list of available products (upper left), an empty list of selected products (upper right), <span class="strong strong"><strong>Checkout</strong></span> and <span class="strong strong"><strong>Reset</strong></span> buttons (middle), and an empty system messages area (bottom).
				</p><div class="figure" id="idm139921810900432"><p class="title"><strong>Figure 86.14. Pet Store example GUI after launch</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/PetStoreExample/1-PetStore-Start-Screen.png" alt="1 PetStore Start Screen"/></div></div></div><p>
					The following events occurred in this example to establish this execution behavior:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							The <code class="literal">main()</code> method has run and loaded the rule base but has not yet fired the rules. So far, this is the only code in connection with rules that has been run.
						</li><li class="listitem">
							A new <code class="literal">PetStoreUI</code> object has been created and given a handle for the rule base, for later use.
						</li><li class="listitem">
							Various Swing components have performed their functions, and the initial UI screen is displayed and waits for user input.
						</li></ol></div><p>
					You can click various products from the list to explore the UI setup:
				</p><div class="figure" id="idm139921810890192"><p class="title"><strong>Figure 86.15. Explore the Pet Store example GUI</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/PetStoreExample/2-stock-added-to-order-list.png" alt="2 stock added to order list"/></div></div></div><p>
					No rules code has been fired yet. The UI uses Swing code to detect user mouse clicks and add selected products to the <code class="literal">TableModel</code> object for display in the upper-right corner of the UI. This example illustrates the Model-View-Controller design pattern.
				</p><p>
					When you click <span class="strong strong"><strong>Checkout</strong></span>, the rules are then fired in the following way:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Method <code class="literal">CheckOutCallBack.checkout()</code> is called (eventually) by the Swing class waiting for a user to click <span class="strong strong"><strong>Checkout</strong></span>. This inserts the data from the <code class="literal">TableModel</code> object (upper-right corner of the UI) into the KIE session working memory. The method then fires the rules.
						</li><li class="listitem"><p class="simpara">
							The <code class="literal">"Explode Cart"</code> rule is the first to fire, with the <code class="literal">auto-focus</code> attribute set to <code class="literal">true</code>. The rule loops through all of the products in the cart, ensures that the products are in the working memory, and then gives the <code class="literal">"show Items"</code> and <code class="literal">"evaluate"</code> agenda groups the option to fire. The rules in these groups add the contents of the cart to the text area (bottom of the UI), evaluate if you are eligible for free fish food, and determine whether to ask if you want to buy a fish tank.
						</p><div class="figure" id="idm139921810876464"><p class="title"><strong>Figure 86.16. Fish tank qualification</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/PetStoreExample/3-purchase-suggestion.png" alt="3 purchase suggestion"/></div></div></div></li><li class="listitem">
							The <code class="literal">"do checkout"</code> rule is the next to fire because no other agenda group currently has focus and because it is part of the default <code class="literal">MAIN</code> agenda group. This rule always calls the <code class="literal">doCheckout()</code> function, which asks you if you want to check out.
						</li><li class="listitem">
							The <code class="literal">doCheckout()</code> function sets the focus to the <code class="literal">"checkout"</code> agenda group, giving the rules in that group the option to fire.
						</li><li class="listitem">
							The rules in the <code class="literal">"checkout"</code> agenda group display the contents of the cart and apply the appropriate discount.
						</li><li class="listitem"><p class="simpara">
							Swing then waits for user input to either select more products (and cause the rules to fire again) or to close the UI.
						</p><div class="figure" id="idm139921810865120"><p class="title"><strong>Figure 86.17. Pet Store example GUI after all rules have fired</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/PetStoreExample/4-Petstore-final-screen.png" alt="4 Petstore final screen"/></div></div></div></li></ol></div><p>
					You can add more <code class="literal">System.out</code> calls to demonstrate this flow of events in your IDE console:
				</p><div class="formalpara"><p class="title"><strong>System.out output in the IDE console</strong></p><p>
						
<pre class="screen">Adding free Fish Food Sample to cart
SUGGESTION: Would you like to buy a tank for your 6 fish? - Yes</pre>
					</p></div></section><section class="section" id="decision-examples-politician-ref_decision-engine"><div class="titlepage"><div><div><h2 class="title">86.7. Honest Politician example decisions (truth maintenance and salience)</h2></div></div></div><p>
					The Honest Politician example decision set demonstrates the concept of truth maintenance with logical insertions and the use of salience in rules.
				</p><p>
					The following is an overview of the Honest Politician example:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Name</strong></span>: <code class="literal">honestpolitician</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Main class</strong></span>: <code class="literal">org.drools.examples.honestpolitician.HonestPoliticianExample</code> (in <code class="literal">src/main/java</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Module</strong></span>: <code class="literal">drools-examples</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Type</strong></span>: Java application
						</li><li class="listitem">
							<span class="strong strong"><strong>Rule file</strong></span>: <code class="literal">org.drools.examples.honestpolitician.HonestPolitician.drl</code> (in <code class="literal">src/main/resources</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Objective</strong></span>: Demonstrates the concept of truth maintenance based on the logical insertion of facts and the use of salience in rules
						</li></ul></div><p>
					The basic premise of the Honest Politician example is that an object can only exist while a statement is true. A rule consequence can logically insert an object with the <code class="literal">insertLogical()</code> method. This means the object remains in the KIE session working memory as long as the rule that logically inserted it remains true. When the rule is no longer true, the object is automatically retracted.
				</p><p>
					In this example, rule execution causes a group of politicians to change from being honest to being dishonest as a result of a corrupt corporation. As each politician is evaluated, they start out with their honesty attribute being set to <code class="literal">true</code>, but a rule fires that makes the politicians no longer honest. As they switch their state from being honest to dishonest, they are then removed from the working memory. The rule salience notifies the decision engine how to prioritize any rules that have a salience defined for them, otherwise utilizing the default salience value of <code class="literal">0</code>. Rules with a higher salience value are given higher priority when ordered in the activation queue.
				</p><h4 id="politician_and_hope_classes_2">Politician and Hope classes</h4><p>
					The sample class <code class="literal">Politician</code> in the example is configured for an honest politician. The <code class="literal">Politician</code> class is made up of a String item <code class="literal">name</code> and a Boolean item <code class="literal">honest</code>:
				</p><div class="formalpara"><p class="title"><strong>Politician class</strong></p><p>
						
<pre class="programlisting language-java">public class Politician {
    private String name;
    private boolean honest;
    ...
}</pre>
					</p></div><p>
					The <code class="literal">Hope</code> class determines if a <code class="literal">Hope</code> object exists. This class has no meaningful members, but is present in the working memory as long as society has hope.
				</p><div class="formalpara"><p class="title"><strong>Hope class</strong></p><p>
						
<pre class="programlisting language-java">public class Hope {

    public Hope() {

    }
  }</pre>
					</p></div><h4 id="rule_definitions_for_politician_honesty_2">Rule definitions for politician honesty</h4><p>
					In the Honest Politician example, when at least one honest politician exists in the working memory, the <code class="literal">"We have an honest Politician"</code> rule logically inserts a new <code class="literal">Hope</code> object. As soon as all politicians become dishonest, the <code class="literal">Hope</code> object is automatically retracted. This rule has a <code class="literal">salience</code> attribute with a value of <code class="literal">10</code> to ensure that it fires before any other rule, because at that stage the <code class="literal">"Hope is Dead"</code> rule is true.
				</p><div class="formalpara"><p class="title"><strong>Rule "We have an honest politician"</strong></p><p>
						
<pre class="screen">rule "We have an honest Politician"
    salience 10
  when
    exists( Politician( honest == true ) )
  then
    insertLogical( new Hope() );
end</pre>
					</p></div><p>
					As soon as a <code class="literal">Hope</code> object exists, the <code class="literal">"Hope Lives"</code> rule matches and fires. This rule also has a <code class="literal">salience</code> value of <code class="literal">10</code> so that it takes priority over the <code class="literal">"Corrupt the Honest"</code> rule.
				</p><div class="formalpara"><p class="title"><strong>Rule "Hope Lives"</strong></p><p>
						
<pre class="screen">rule "Hope Lives"
    salience 10
  when
    exists( Hope() )
  then
    System.out.println("Hurrah!!! Democracy Lives");
end</pre>
					</p></div><p>
					Initially, four honest politicians exist so this rule has four activations, all in conflict. Each rule fires in turn, corrupting each politician so that they are no longer honest. When all four politicians have been corrupted, no politicians have the property <code class="literal">honest == true</code>. The rule <code class="literal">"We have an honest Politician"</code> is no longer true and the object it logically inserted (due to the last execution of <code class="literal">new Hope()</code>) is automatically retracted.
				</p><div class="formalpara"><p class="title"><strong>Rule "Corrupt the Honest"</strong></p><p>
						
<pre class="screen">rule "Corrupt the Honest"
  when
    politician : Politician( honest == true )
    exists( Hope() )
  then
    System.out.println( "I'm an evil corporation and I have corrupted " + politician.getName() );
    modify ( politician ) { honest = false };
end</pre>
					</p></div><p>
					With the <code class="literal">Hope</code> object automatically retracted through the truth maintenance system, the conditional element <code class="literal">not</code> applied to <code class="literal">Hope</code> is no longer true so that the <code class="literal">"Hope is Dead"</code> rule matches and fires.
				</p><div class="formalpara"><p class="title"><strong>Rule "Hope is Dead"</strong></p><p>
						
<pre class="screen">rule "Hope is Dead"
  when
    not( Hope() )
  then
    System.out.println( "We are all Doomed!!! Democracy is Dead" );
end</pre>
					</p></div><h4 id="example_execution_and_audit_trail_2">Example execution and audit trail</h4><p>
					In the <code class="literal">HonestPoliticianExample.java</code> class, the four politicians with the honest state set to <code class="literal">true</code> are inserted for evaluation against the defined business rules:
				</p><div class="formalpara"><p class="title"><strong>HonestPoliticianExample.java class execution</strong></p><p>
						
<pre class="programlisting language-java">public static void execute( KieContainer kc ) {
        KieSession ksession = kc.newKieSession("HonestPoliticianKS");

        final Politician p1 = new Politician( "President of Umpa Lumpa", true );
        final Politician p2 = new Politician( "Prime Minster of Cheeseland", true );
        final Politician p3 = new Politician( "Tsar of Pringapopaloo", true );
        final Politician p4 = new Politician( "Omnipotence Om", true );

        ksession.insert( p1 );
        ksession.insert( p2 );
        ksession.insert( p3 );
        ksession.insert( p4 );

        ksession.fireAllRules();

        ksession.dispose();
    }</pre>
					</p></div><p>
					To execute the example, run the <code class="literal">org.drools.examples.honestpolitician.HonestPoliticianExample</code> class as a Java application in your IDE.
				</p><p>
					After the execution, the following output appears in the IDE console window:
				</p><div class="formalpara"><p class="title"><strong>Execution output in the IDE console</strong></p><p>
						
<pre class="screen">Hurrah!!! Democracy Lives
I'm an evil corporation and I have corrupted President of Umpa Lumpa
I'm an evil corporation and I have corrupted Prime Minster of Cheeseland
I'm an evil corporation and I have corrupted Tsar of Pringapopaloo
I'm an evil corporation and I have corrupted Omnipotence Om
We are all Doomed!!! Democracy is Dead</pre>
					</p></div><p>
					The output shows that, while there is at least one honest politician, democracy lives. However, as each politician is corrupted by some corporation, all politicians become dishonest, and democracy is dead.
				</p><p>
					To better understand the execution flow of this example, you can modify the <code class="literal">HonestPoliticianExample.java</code> class to include a <code class="literal">DebugRuleRuntimeEventListener</code> listener and an audit logger to view execution details:
				</p><div class="formalpara"><p class="title"><strong>HonestPoliticianExample.java class with an audit logger</strong></p><p>
						
<pre class="programlisting language-java">package org.drools.examples.honestpolitician;

import org.kie.api.KieServices;
import org.kie.api.event.rule.DebugAgendaEventListener; <span id="CO17-1"/><span class="callout">1</span>
import org.kie.api.event.rule.DebugRuleRuntimeEventListener;
import org.kie.api.runtime.KieContainer;
import org.kie.api.runtime.KieSession;

public class HonestPoliticianExample {

    /**
     * @param args
     */
    public static void main(final String[] args) {
    	KieServices ks = KieServices.Factory.get(); <span id="CO17-2"/><span class="callout">2</span>
    	//ks = KieServices.Factory.get();
        KieContainer kc = KieServices.Factory.get().getKieClasspathContainer();
        System.out.println(kc.verify().getMessages().toString());
        //execute( kc );
        execute( ks, kc); <span id="CO17-3"/><span class="callout">3</span>
    }

    public static void execute( KieServices ks, KieContainer kc ) { <span id="CO17-4"/><span class="callout">4</span>
        KieSession ksession = kc.newKieSession("HonestPoliticianKS");

        final Politician p1 = new Politician( "President of Umpa Lumpa", true );
        final Politician p2 = new Politician( "Prime Minster of Cheeseland", true );
        final Politician p3 = new Politician( "Tsar of Pringapopaloo", true );
        final Politician p4 = new Politician( "Omnipotence Om", true );

        ksession.insert( p1 );
        ksession.insert( p2 );
        ksession.insert( p3 );
        ksession.insert( p4 );

        // The application can also setup listeners <span id="CO17-5"/><span class="callout">5</span>
        ksession.addEventListener( new DebugAgendaEventListener() );
        ksession.addEventListener( new DebugRuleRuntimeEventListener() );

        // Set up a file-based audit logger.
        ks.getLoggers().newFileLogger( ksession, "./target/honestpolitician" ); <span id="CO17-6"/><span class="callout">6</span>

        ksession.fireAllRules();

        ksession.dispose();
    }

}</pre>
					</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO17-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							Adds to your imports the packages that handle the <code class="literal">DebugAgendaEventListener</code> and <code class="literal">DebugRuleRuntimeEventListener</code>
						</div></dd><dt><a href="#CO17-2"><span class="callout">2</span></a> </dt><dd><div class="para">
							Creates a <code class="literal">KieServices Factory</code> and a <code class="literal">ks</code> element to produce the logs because this audit log is not available at the <code class="literal">KieContainer</code> level
						</div></dd><dt><a href="#CO17-3"><span class="callout">3</span></a> </dt><dd><div class="para">
							Modifies the <code class="literal">execute</code> method to use both <code class="literal">KieServices</code> and <code class="literal">KieContainer</code>
						</div></dd><dt><a href="#CO17-4"><span class="callout">4</span></a> </dt><dd><div class="para">
							Modifies the <code class="literal">execute</code> method to pass in <code class="literal">KieServices</code> in addition to the <code class="literal">KieContainer</code>
						</div></dd><dt><a href="#CO17-5"><span class="callout">5</span></a> </dt><dd><div class="para">
							Creates the listeners
						</div></dd><dt><a href="#CO17-6"><span class="callout">6</span></a> </dt><dd><div class="para">
							Builds the log that can be passed into the debug view or <span class="strong strong"><strong>Audit View</strong></span> or your IDE after executing of the rules
						</div></dd></dl></div><p>
					When you run the Honest Politician with this modified logging capability, you can load the audit log file from <code class="literal">target/honestpolitician.log</code> into your IDE debug view or <span class="strong strong"><strong>Audit View</strong></span>, if available (for example, in <span class="strong strong"><strong>Window</strong></span> → <span class="strong strong"><strong>Show View</strong></span> in some IDEs).
				</p><p>
					In this example, the <span class="strong strong"><strong>Audit View</strong></span> shows the flow of executions, insertions, and retractions as defined in the example classes and rules:
				</p><div class="figure" id="idm139921810764400"><p class="title"><strong>Figure 86.18. Honest Politician example Audit View</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/HonestPoliticianExample/honest_politician_audit.png" alt="honest politician audit"/></div></div></div><p>
					When the first politician is inserted, two activations occur. The rule <code class="literal">"We have an honest Politician"</code> is activated only one time for the first inserted politician because it uses an <code class="literal">exists</code> conditional element, which matches when at least one politician is inserted. The rule <code class="literal">"Hope is Dead"</code> is also activated at this stage because the <code class="literal">Hope</code> object is not yet inserted. The rule <code class="literal">"We have an honest Politician"</code> fires first because it has a higher <code class="literal">salience</code> value than the rule <code class="literal">"Hope is Dead"</code>, and inserts the <code class="literal">Hope</code> object (highlighted in green). The insertion of the <code class="literal">Hope</code> object activates the rule <code class="literal">"Hope Lives"</code> and deactivates the rule <code class="literal">"Hope is Dead"</code>. The insertion also activates the rule <code class="literal">"Corrupt the Honest"</code> for each inserted honest politician. The rule <code class="literal">"Hope Lives"</code> is executed and prints <code class="literal">"Hurrah!!! Democracy Lives"</code>.
				</p><p>
					Next, for each politician, the rule <code class="literal">"Corrupt the Honest"</code> fires, printing <code class="literal">"I’m an evil corporation and I have corrupted X"</code>, where <code class="literal">X</code> is the name of the politician, and modifies the politician honesty value to <code class="literal">false</code>. When the last honest politician is corrupted, <code class="literal">Hope</code> is automatically retracted by the truth maintenance system (highlighted in blue). The green highlighted area shows the origin of the currently selected blue highlighted area. After the <code class="literal">Hope</code> fact is retracted, the rule <code class="literal">"Hope is dead"</code> fires, printing <code class="literal">"We are all Doomed!!! Democracy is Dead"</code>.
				</p></section><section class="section" id="decision-examples-sudoku-ref_decision-engine"><div class="titlepage"><div><div><h2 class="title">86.8. Sudoku example decisions (complex pattern matching, callbacks, and GUI integration)</h2></div></div></div><p>
					The Sudoku example decision set, based on the popular number puzzle Sudoku, demonstrates how to use rules in Red Hat Process Automation Manager to find a solution in a large potential solution space based on various constraints. This example also shows how to integrate Red Hat Process Automation Manager rules into a graphical user interface (GUI), in this case a Swing-based desktop application, and how to use callbacks to interact with a running decision engine to update the GUI based on changes in the working memory at run time.
				</p><p>
					The following is an overview of the Sudoku example:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Name</strong></span>: <code class="literal">sudoku</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Main class</strong></span>: <code class="literal">org.drools.examples.sudoku.SudokuExample</code> (in <code class="literal">src/main/java</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Module</strong></span>: <code class="literal">drools-examples</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Type</strong></span>: Java application
						</li><li class="listitem">
							<span class="strong strong"><strong>Rule files</strong></span>: <code class="literal">org.drools.examples.sudoku.*.drl</code> (in <code class="literal">src/main/resources</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Objective</strong></span>: Demonstrates complex pattern matching, problem solving, callbacks, and GUI integration
						</li></ul></div><p>
					Sudoku is a logic-based number placement puzzle. The objective is to fill a 9x9 grid so that each column, each row, and each of the nine 3x3 zones contains the digits from 1 to 9 only one time. The puzzle setter provides a partially completed grid and the puzzle solver’s task is to complete the grid with these constraints.
				</p><p>
					The general strategy to solve the problem is to ensure that when you insert a new number, it must be unique in its particular 3x3 zone, row, and column. This Sudoku example decision set uses Red Hat Process Automation Manager rules to solve Sudoku puzzles from a range of difficulty levels, and to attempt to resolve flawed puzzles that contain invalid entries.
				</p><h4 id="sudoku_example_execution_and_interaction_2">Sudoku example execution and interaction</h4><p>
					Similar to other Red Hat Process Automation Manager decision examples, you execute the Sudoku example by running the <code class="literal">org.drools.examples.sudoku.SudokuExample</code> class as a Java application in your IDE.
				</p><p>
					When you execute the Sudoku example, the <code class="literal">Drools Sudoku Example</code> GUI window appears. This window contains an empty grid, but the program comes with various grids stored internally that you can load and solve.
				</p><p>
					Click <span class="strong strong"><strong>File</strong></span> → <span class="strong strong"><strong>Samples</strong></span> → <span class="strong strong"><strong>Simple</strong></span> to load one of the examples. Notice that all buttons are disabled until a grid is loaded.
				</p><div class="figure" id="idm139921810721936"><p class="title"><strong>Figure 86.19. Sudoku example GUI after launch</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/SudokuExample/sudoku1.png" alt="sudoku1"/></div></div></div><p>
					When you load the <span class="strong strong"><strong>Simple</strong></span> example, the grid is filled according to the puzzle’s initial state.
				</p><div class="figure" id="idm139921810716352"><p class="title"><strong>Figure 86.20. Sudoku example GUI after loading Simple sample</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/SudokuExample/sudoku2.png" alt="sudoku2"/></div></div></div><p>
					Choose from the following options:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Solve</strong></span> to fire the rules defined in the Sudoku example that fill out the remaining values and that make the buttons inactive again.
						</p><div class="figure" id="idm139921810709648"><p class="title"><strong>Figure 86.21. Simple sample solved</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/SudokuExample/sudoku3.png" alt="sudoku3"/></div></div></div></li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Step</strong></span> to see the next digit found by the rule set. The console window in your IDE displays detailed information about the rules that are executing to solve the step.
						</p><div class="formalpara"><p class="title"><strong>Step execution output in the IDE console</strong></p><p>
								
<pre class="screen">single 8 at [0,1]
column elimination due to [1,2]: remove 9 from [4,2]
hidden single 9 at [1,2]
row elimination due to [2,8]: remove 7 from [2,4]
remove 6 from [3,8] due to naked pair at [3,2] and [3,7]
hidden pair in row at [4,6] and [4,4]</pre>
							</p></div></li><li class="listitem"><p class="simpara">
							Click <span class="strong strong"><strong>Dump</strong></span> to see the state of the grid, with cells showing either the established value or the remaining possibilities.
						</p><div class="formalpara"><p class="title"><strong>Dump execution output in the IDE console</strong></p><p>
								
<pre class="screen">        Col: 0     Col: 1     Col: 2     Col: 3     Col: 4     Col: 5     Col: 6     Col: 7     Col: 8
Row 0:  123456789  --- 5 ---  --- 6 ---  --- 8 ---  123456789  --- 1 ---  --- 9 ---  --- 4 ---  123456789
Row 1:  --- 9 ---  123456789  123456789  --- 6 ---  123456789  --- 5 ---  123456789  123456789  --- 3 ---
Row 2:  --- 7 ---  123456789  123456789  --- 4 ---  --- 9 ---  --- 3 ---  123456789  123456789  --- 8 ---
Row 3:  --- 8 ---  --- 9 ---  --- 7 ---  123456789  --- 4 ---  123456789  --- 6 ---  --- 3 ---  --- 5 ---
Row 4:  123456789  123456789  --- 3 ---  --- 9 ---  123456789  --- 6 ---  --- 8 ---  123456789  123456789
Row 5:  --- 4 ---  --- 6 ---  --- 5 ---  123456789  --- 8 ---  123456789  --- 2 ---  --- 9 ---  --- 1 ---
Row 6:  --- 5 ---  123456789  123456789  --- 2 ---  --- 6 ---  --- 9 ---  123456789  123456789  --- 7 ---
Row 7:  --- 6 ---  123456789  123456789  --- 5 ---  123456789  --- 4 ---  123456789  123456789  --- 9 ---
Row 8:  123456789  --- 4 ---  --- 9 ---  --- 7 ---  123456789  --- 8 ---  --- 3 ---  --- 5 ---  123456789</pre>
							</p></div></li></ul></div><p>
					The Sudoku example includes a deliberately broken sample file that the rules defined in the example can resolve.
				</p><p>
					Click <span class="strong strong"><strong>File</strong></span> → <span class="strong strong"><strong>Samples</strong></span> → <span class="strong strong"><strong>!DELIBERATELY BROKEN!</strong></span> to load the broken sample. The grid starts with some issues, for example, the value <code class="literal">5</code> appears two times in the first row, which is not allowed.
				</p><div class="figure" id="idm139921810692272"><p class="title"><strong>Figure 86.22. Broken Sudoku example initial state</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/SudokuExample/sudoku4.png" alt="sudoku4"/></div></div></div><p>
					Click <span class="strong strong"><strong>Solve</strong></span> to apply the solving rules to this invalid grid. The associated solving rules in the Sudoku example detect the issues in the sample and attempts to solve the puzzle as far as possible. This process does not complete and leaves some cells empty.
				</p><p>
					The solving rule activity is displayed in the IDE console window:
				</p><div class="formalpara"><p class="title"><strong>Detected issues in the broken sample</strong></p><p>
						
<pre class="screen">cell [0,8]: 5 has a duplicate in row 0
cell [0,0]: 5 has a duplicate in row 0
cell [6,0]: 8 has a duplicate in col 0
cell [4,0]: 8 has a duplicate in col 0
Validation complete.</pre>
					</p></div><div class="figure" id="idm139921810683968"><p class="title"><strong>Figure 86.23. Broken sample solution attempt</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/SudokuExample/sudoku5.png" alt="sudoku5"/></div></div></div><p>
					The sample Sudoku files labeled <span class="strong strong"><strong>Hard</strong></span> are more complex and the solving rules might not be able to solve them. The unsuccessful solution attempt is displayed in the IDE console window:
				</p><div class="formalpara"><p class="title"><strong>Hard sample unresolved</strong></p><p>
						
<pre class="screen">Validation complete.
...
Sorry - can't solve this grid.</pre>
					</p></div><p>
					The rules that work to solve the broken sample implement standard solving techniques based on the sets of values that are still candidates for a cell. For example, if a set contains a single value, then this is the value for the cell. For a single occurrence of a value in one of the groups of nine cells, the rules insert a fact of type <code class="literal">Setting</code> with the solution value for some specific cell. This fact causes the elimination of this value from all other cells in any of the groups the cell belongs to and the value is retracted.
				</p><p>
					Other rules in the example reduce the permissible values for some cells. The rules <code class="literal">"naked pair"</code>, <code class="literal">"hidden pair in row"</code>, <code class="literal">"hidden pair in column"</code>, and <code class="literal">"hidden pair in square"</code> eliminate possibilities but do not establish solutions. The rules <code class="literal">"X-wings in rows"</code>, "`X-wings in columns"`, <code class="literal">"intersection removal row"</code>, and <code class="literal">"intersection removal column"</code> perform more sophisticated eliminations.
				</p><h4 id="sudoku_example_classes_2">Sudoku example classes</h4><p>
					The package <code class="literal">org.drools.examples.sudoku.swing</code> contains the following core set of classes that implement a framework for Sudoku puzzles:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal">SudokuGridModel</code> class defines an interface that is implemented to store a Sudoku puzzle as a 9x9 grid of <code class="literal">Cell</code> objects.
						</li><li class="listitem">
							The <code class="literal">SudokuGridView</code> class is a Swing component that can visualize any implementation of the <code class="literal">SudokuGridModel</code> class.
						</li><li class="listitem">
							The <code class="literal">SudokuGridEvent</code> and <code class="literal">SudokuGridListener</code> classes communicate state changes between the model and the view. Events are fired when a cell value is resolved or changed.
						</li><li class="listitem">
							The <code class="literal">SudokuGridSamples</code> class provides partially filled Sudoku puzzles for demonstration purposes.
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						This package does not have any dependencies on Red Hat Process Automation Manager libraries.
					</p></div></div><p>
					The package <code class="literal">org.drools.examples.sudoku</code> contains the following core set of classes that implement the elementary <code class="literal">Cell</code> object and its various aggregations:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal">CellFile</code> class, with subtypes <code class="literal">CellRow</code>, <code class="literal">CellCol</code>, and <code class="literal">CellSqr</code>, all of which are subtypes of the <code class="literal">CellGroup</code> class.
						</li><li class="listitem"><p class="simpara">
							The <code class="literal">Cell</code> and <code class="literal">CellGroup</code> subclasses of <code class="literal">SetOfNine</code>, which provides a property <code class="literal">free</code> with the type <code class="literal">Set&lt;Integer&gt;</code>. For a <code class="literal">Cell</code> class, the set represents the individual candidate set. For a <code class="literal">CellGroup</code> class, the set is the union of all candidate sets of its cells (the set of digits that still need to be allocated).
						</p><p class="simpara">
							In the Sudoku example are 81 <code class="literal">Cell</code> and 27 <code class="literal">CellGroup</code> objects and a linkage provided by the <code class="literal">Cell</code> properties <code class="literal">cellRow</code>, <code class="literal">cellCol</code>, and <code class="literal">cellSqr</code>, and by the <code class="literal">CellGroup</code> property <code class="literal">cells</code> (a list of <code class="literal">Cell</code> objects). With these components, you can write rules that detect the specific situations that permit the allocation of a value to a cell or the elimination of a value from some candidate set.
						</p></li><li class="listitem">
							The <code class="literal">Setting</code> class is used to trigger the operations that accompany the allocation of a value. The presence of a <code class="literal">Setting</code> fact is used in all rules that detect a new situation in order to avoid reactions to inconsistent intermediary states.
						</li><li class="listitem">
							The <code class="literal">Stepping</code> class is used in a low priority rule to execute an emergency halt when a <code class="literal">"Step"</code> does not terminate regularly. This behavior indicates that the program cannot solve the puzzle.
						</li><li class="listitem">
							The main class <code class="literal">org.drools.examples.sudoku.SudokuExample</code> implements a Java application combining all of these components.
						</li></ul></div><h4 id="sudoku_validation_rules_validate_drl_2">Sudoku validation rules (validate.drl)</h4><p>
					The <code class="literal">validate.drl</code> file in the Sudoku example contains validation rules that detect duplicate numbers in cell groups. They are combined in a <code class="literal">"validate"</code> agenda group that enables the rules to be explicitly activated after a user loads the puzzle.
				</p><p>
					The <code class="literal">when</code> conditions of the three rules <code class="literal">"duplicate in cell …​"</code> all function in the following ways:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The first condition in the rule locates a cell with an allocated value.
						</li><li class="listitem">
							The second condition in the rule pulls in any of the three cell groups to which the cell belongs.
						</li><li class="listitem">
							The final condition finds a cell (other than the first one) with the same value as the first cell and in the same row, column, or square, depending on the rule.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Rules "duplicate in cell …​"</strong></p><p>
						
<pre class="screen">rule "duplicate in cell row"
  when
    $c: Cell( $v: value != null )
    $cr: CellRow( cells contains $c )
    exists Cell( this != $c, value == $v, cellRow == $cr )
  then
    System.out.println( "cell " + $c.toString() + " has a duplicate in row " + $cr.getNumber() );
end

rule "duplicate in cell col"
  when
    $c: Cell( $v: value != null )
    $cc: CellCol( cells contains $c )
    exists Cell( this != $c, value == $v, cellCol == $cc )
  then
    System.out.println( "cell " + $c.toString() + " has a duplicate in col " + $cc.getNumber() );
end

rule "duplicate in cell sqr"
  when
    $c: Cell( $v: value != null )
    $cs: CellSqr( cells contains $c )
    exists Cell( this != $c, value == $v, cellSqr == $cs )
  then
    System.out.println( "cell " + $c.toString() + " has duplicate in its square of nine." );
end</pre>
					</p></div><p>
					The rule <code class="literal">"terminate group"</code> is the last to fire. This rule prints a message and stops the sequence.
				</p><div class="formalpara"><p class="title"><strong>Rule "terminate group"</strong></p><p>
						
<pre class="screen">rule "terminate group"
    salience -100
  when
  then
    System.out.println( "Validation complete." );
    drools.halt();
end</pre>
					</p></div><h4 id="sudoku_solving_rules_sudoku_drl_2">Sudoku solving rules (sudoku.drl)</h4><p>
					The <code class="literal">sudoku.drl</code> file in the Sudoku example contains three types of rules: one group handles the allocation of a number to a cell, another group detects feasible allocations, and the third group eliminates values from candidate sets.
				</p><p>
					The rules <code class="literal">"set a value"</code>, <code class="literal">"eliminate a value from Cell"</code>, and <code class="literal">"retract setting"</code> depend on the presence of a <code class="literal">Setting</code> object. The first rule handles the assignment to the cell and the operations for removing the value from the <code class="literal">free</code> sets of the three groups of the cell. This group also reduces a counter that, when zero, returns control to the Java application that has called <code class="literal">fireUntilHalt()</code>.
				</p><p>
					The purpose of the rule <code class="literal">"eliminate a value from Cell"</code> is to reduce the candidate lists of all cells that are related to the newly assigned cell. Finally, when all eliminations have been made, the rule <code class="literal">"retract setting"</code> retracts the triggering <code class="literal">Setting</code> fact.
				</p><div class="formalpara"><p class="title"><strong>Rules "set a value", "eliminate a value from a Cell", and "retract setting"</strong></p><p>
						
<pre class="screen">// A Setting object is inserted to define the value of a Cell.
// Rule for updating the cell and all cell groups that contain it
rule "set a value"
  when
    // A Setting with row and column number, and a value
    $s: Setting( $rn: rowNo, $cn: colNo, $v: value )

    // A matching Cell, with no value set
    $c: Cell( rowNo == $rn, colNo == $cn, value == null,
              $cr: cellRow, $cc: cellCol, $cs: cellSqr )

    // Count down
    $ctr: Counter( $count: count )
  then
    // Modify the Cell by setting its value.
    modify( $c ){ setValue( $v ) }
    // System.out.println( "set cell " + $c.toString() );
    modify( $cr ){ blockValue( $v ) }
    modify( $cc ){ blockValue( $v ) }
    modify( $cs ){ blockValue( $v ) }
    modify( $ctr ){ setCount( $count - 1 ) }
end

// Rule for removing a value from all cells that are siblings
// in one of the three cell groups
rule "eliminate a value from Cell"
  when
    // A Setting with row and column number, and a value
    $s: Setting( $rn: rowNo, $cn: colNo, $v: value )

    // The matching Cell, with the value already set
    Cell( rowNo == $rn, colNo == $cn, value == $v, $exCells: exCells )

    // For all Cells that are associated with the updated cell
    $c: Cell( free contains $v ) from $exCells
  then
    // System.out.println( "clear " + $v + " from cell " + $c.posAsString()  );
    // Modify a related Cell by blocking the assigned value.
    modify( $c ){ blockValue( $v ) }
end

// Rule for eliminating the Setting fact
rule "retract setting"
  when
    // A Setting with row and column number, and a value
    $s: Setting( $rn: rowNo, $cn: colNo, $v: value )

    // The matching Cell, with the value already set
    $c: Cell( rowNo == $rn, colNo == $cn, value == $v )

    // This is the negation of the last pattern in the previous rule.
    // Now the Setting fact can be safely retracted.
    not( $x: Cell( free contains $v )
         and
         Cell( this == $c, exCells contains $x ) )
  then
    // System.out.println( "done setting cell " + $c.toString() );
    // Discard the Setter fact.
    delete( $s );
    // Sudoku.sudoku.consistencyCheck();
end</pre>
					</p></div><p>
					Two solving rules detect a situation where an allocation of a number to a cell is possible. The rule <code class="literal">"single"</code> fires for a <code class="literal">Cell</code> with a candidate set containing a single number. The rule <code class="literal">"hidden single"</code> fires when no cell exists with a single candidate, but when a cell exists containing a candidate, this candidate is absent from all other cells in one of the three groups to which the cell belongs. Both rules create and insert a <code class="literal">Setting</code> fact.
				</p><div class="formalpara"><p class="title"><strong>Rules "single" and "hidden single"</strong></p><p>
						
<pre class="screen">// Detect a set of candidate values with cardinality 1 for some Cell.
// This is the value to be set.
rule "single"
  when
    // Currently no setting underway
    not Setting()

    // One element in the "free" set
    $c: Cell( $rn: rowNo, $cn: colNo, freeCount == 1 )
  then
    Integer i = $c.getFreeValue();
    if (explain) System.out.println( "single " + i + " at " + $c.posAsString() );
    // Insert another Setter fact.
    insert( new Setting( $rn, $cn, i ) );
end

// Detect a set of candidate values with a value that is the only one
// in one of its groups. This is the value to be set.
rule "hidden single"
  when
    // Currently no setting underway
    not Setting()
    not Cell( freeCount == 1 )

    // Some integer
    $i: Integer()

    // The "free" set contains this number
    $c: Cell( $rn: rowNo, $cn: colNo, freeCount &gt; 1, free contains $i )

    // A cell group contains this cell $c.
    $cg: CellGroup( cells contains $c )
    // No other cell from that group contains $i.
    not ( Cell( this != $c, free contains $i ) from $cg.getCells() )
  then
    if (explain) System.out.println( "hidden single " + $i + " at " + $c.posAsString() );
    // Insert another Setter fact.
    insert( new Setting( $rn, $cn, $i ) );
end</pre>
					</p></div><p>
					Rules from the largest group, either individually or in groups of two or three, implement various solving techniques used for solving Sudoku puzzles manually.
				</p><p>
					The rule <code class="literal">"naked pair"</code> detects identical candidate sets of size <code class="literal">2</code> in two cells of a group. These two values may be removed from all other candidate sets of that group.
				</p><div class="formalpara"><p class="title"><strong>Rule "naked pair"</strong></p><p>
						
<pre class="screen">// A "naked pair" is two cells in some cell group with their sets of
// permissible values being equal with cardinality 2. These two values
// can be removed from all other candidate lists in the group.
rule "naked pair"
  when
    // Currently no setting underway
    not Setting()
    not Cell( freeCount == 1 )

    // One cell with two candidates
    $c1: Cell( freeCount == 2, $f1: free, $r1: cellRow, $rn1: rowNo, $cn1: colNo, $b1: cellSqr )

    // The containing cell group
    $cg: CellGroup( freeCount &gt; 2, cells contains $c1 )

    // Another cell with two candidates, not the one we already have
    $c2: Cell( this != $c1, free == $f1 /*** , rowNo &gt;= $rn1, colNo &gt;= $cn1 ***/ ) from $cg.cells

    // Get one of the "naked pair".
    Integer( $v: intValue ) from $c1.getFree()

    // Get some other cell with a candidate equal to one from the pair.
    $c3: Cell( this != $c1 &amp;&amp; != $c2, freeCount &gt; 1, free contains $v ) from $cg.cells
  then
    if (explain) System.out.println( "remove " + $v + " from " + $c3.posAsString() + " due to naked pair at " + $c1.posAsString() + " and " + $c2.posAsString() );
    // Remove the value.
    modify( $c3 ){ blockValue( $v ) }
end</pre>
					</p></div><p>
					The three rules <code class="literal">"hidden pair in …​"</code> functions similarly to the rule <code class="literal">"naked pair"</code>. These rules detect a subset of two numbers in exactly two cells of a group, with neither value occurring in any of the other cells of the group. This means that all other candidates can be eliminated from the two cells harboring the hidden pair.
				</p><div class="formalpara"><p class="title"><strong>Rules "hidden pair in …​"</strong></p><p>
						
<pre class="screen">// If two cells within the same cell group contain candidate sets with more than
// two values, with two values being in both of them but in none of the other
// cells, then we have a "hidden pair". We can remove all other candidates from
// these two cells.
rule "hidden pair in row"
  when
    // Currently no setting underway
    not Setting()
    not Cell( freeCount == 1 )

    // Establish a pair of Integer facts.
    $i1: Integer()
    $i2: Integer( this &gt; $i1 )

    // Look for a Cell with these two among its candidates. (The upper bound on
    // the number of candidates avoids a lot of useless work during startup.)
    $c1: Cell( $rn1: rowNo, $cn1: colNo, freeCount &gt; 2 &amp;&amp; &lt; 9, free contains $i1 &amp;&amp; contains $i2, $cellRow: cellRow )

    // Get another one from the same row, with the same pair among its candidates.
    $c2: Cell( this != $c1, cellRow == $cellRow, freeCount &gt; 2, free contains $i1 &amp;&amp; contains $i2 )

    // Ascertain that no other cell in the group has one of these two values.
    not( Cell( this != $c1 &amp;&amp; != $c2, free contains $i1 || contains $i2 ) from $cellRow.getCells() )
  then
    if( explain) System.out.println( "hidden pair in row at " + $c1.posAsString() + " and " + $c2.posAsString() );
    // Set the candidate lists of these two Cells to the "hidden pair".
    modify( $c1 ){ blockExcept( $i1, $i2 ) }
    modify( $c2 ){ blockExcept( $i1, $i2 ) }
end

rule "hidden pair in column"
  when
    not Setting()
    not Cell( freeCount == 1 )

    $i1: Integer()
    $i2: Integer( this &gt; $i1 )
    $c1: Cell( $rn1: rowNo, $cn1: colNo, freeCount &gt; 2 &amp;&amp; &lt; 9, free contains $i1 &amp;&amp; contains $i2, $cellCol: cellCol )
    $c2: Cell( this != $c1, cellCol == $cellCol, freeCount &gt; 2, free contains $i1 &amp;&amp; contains $i2 )
    not( Cell( this != $c1 &amp;&amp; != $c2, free contains $i1 || contains $i2 ) from $cellCol.getCells() )
  then
    if (explain) System.out.println( "hidden pair in column at " + $c1.posAsString() + " and " + $c2.posAsString() );
    modify( $c1 ){ blockExcept( $i1, $i2 ) }
    modify( $c2 ){ blockExcept( $i1, $i2 ) }
end

rule "hidden pair in square"
  when
    not Setting()
    not Cell( freeCount == 1 )

    $i1: Integer()
    $i2: Integer( this &gt; $i1 )
    $c1: Cell( $rn1: rowNo, $cn1: colNo, freeCount &gt; 2 &amp;&amp; &lt; 9, free contains $i1 &amp;&amp; contains $i2,
               $cellSqr: cellSqr )
    $c2: Cell( this != $c1, cellSqr == $cellSqr, freeCount &gt; 2, free contains $i1 &amp;&amp; contains $i2 )
    not( Cell( this != $c1 &amp;&amp; != $c2, free contains $i1 || contains $i2 ) from $cellSqr.getCells() )
  then
    if (explain) System.out.println( "hidden pair in square " + $c1.posAsString() + " and " + $c2.posAsString() );
    modify( $c1 ){ blockExcept( $i1, $i2 ) }
    modify( $c2 ){ blockExcept( $i1, $i2 ) }
end</pre>
					</p></div><p>
					Two rules deal with <code class="literal">"X-wings"</code> in rows and columns. When only two possible cells for a value exist in each of two different rows (or columns) and these candidates lie also in the same columns (or rows), then all other candidates for this value in the columns (or rows) can be eliminated. When you follow the pattern sequence in one of these rules, notice how the conditions that are conveniently expressed by words such as <code class="literal">same</code> or <code class="literal">only</code> result in patterns with suitable constraints or that are prefixed with <code class="literal">not</code>.
				</p><div class="formalpara"><p class="title"><strong>Rules "X-wings in …​"</strong></p><p>
						
<pre class="screen">rule "X-wings in rows"
  when
    not Setting()
    not Cell( freeCount == 1 )

    $i: Integer()
    $ca1: Cell( freeCount &gt; 1, free contains $i,
                $ra: cellRow, $rano: rowNo,         $c1: cellCol,        $c1no: colNo )
    $cb1: Cell( freeCount &gt; 1, free contains $i,
                $rb: cellRow, $rbno: rowNo &gt; $rano,      cellCol == $c1 )
    not( Cell( this != $ca1 &amp;&amp; != $cb1, free contains $i ) from $c1.getCells() )

    $ca2: Cell( freeCount &gt; 1, free contains $i,
                cellRow == $ra, $c2: cellCol,       $c2no: colNo &gt; $c1no )
    $cb2: Cell( freeCount &gt; 1, free contains $i,
                cellRow == $rb,      cellCol == $c2 )
    not( Cell( this != $ca2 &amp;&amp; != $cb2, free contains $i ) from $c2.getCells() )

    $cx: Cell( rowNo == $rano || == $rbno, colNo != $c1no &amp;&amp; != $c2no,
               freeCount &gt; 1, free contains $i )
  then
    if (explain) {
        System.out.println( "X-wing with " + $i + " in rows " +
            $ca1.posAsString() + " - " + $cb1.posAsString() +
            $ca2.posAsString() + " - " + $cb2.posAsString() + ", remove from " + $cx.posAsString() );
    }
    modify( $cx ){ blockValue( $i ) }
end

rule "X-wings in columns"
  when
    not Setting()
    not Cell( freeCount == 1 )

    $i: Integer()
    $ca1: Cell( freeCount &gt; 1, free contains $i,
                $c1: cellCol, $c1no: colNo,         $ra: cellRow,        $rano: rowNo )
    $ca2: Cell( freeCount &gt; 1, free contains $i,
                $c2: cellCol, $c2no: colNo &gt; $c1no,      cellRow == $ra )
    not( Cell( this != $ca1 &amp;&amp; != $ca2, free contains $i ) from $ra.getCells() )

    $cb1: Cell( freeCount &gt; 1, free contains $i,
                cellCol == $c1, $rb: cellRow,  $rbno: rowNo &gt; $rano )
    $cb2: Cell( freeCount &gt; 1, free contains $i,
                cellCol == $c2,      cellRow == $rb )
    not( Cell( this != $cb1 &amp;&amp; != $cb2, free contains $i ) from $rb.getCells() )

    $cx: Cell( colNo == $c1no || == $c2no, rowNo != $rano &amp;&amp; != $rbno,
               freeCount &gt; 1, free contains $i )
  then
    if (explain) {
        System.out.println( "X-wing with " + $i + " in columns " +
            $ca1.posAsString() + " - " + $ca2.posAsString() +
            $cb1.posAsString() + " - " + $cb2.posAsString() + ", remove from " + $cx.posAsString()  );
    }
    modify( $cx ){ blockValue( $i ) }
end</pre>
					</p></div><p>
					The two rules <code class="literal">"intersection removal …​"</code> are based on the restricted occurrence of some number within one square, either in a single row or in a single column. This means that this number must be in one of those two or three cells of the row or column and can be removed from the candidate sets of all other cells of the group. The pattern establishes the restricted occurrence and then fires for each cell outside of the square and within the same cell file.
				</p><div class="formalpara"><p class="title"><strong>Rules "intersection removal …​"</strong></p><p>
						
<pre class="screen">rule "intersection removal column"
  when
    not Setting()
    not Cell( freeCount == 1 )

    $i: Integer()
    // Occurs in a Cell
    $c: Cell( free contains $i, $cs: cellSqr, $cc: cellCol )
    // Does not occur in another cell of the same square and a different column
    not Cell( this != $c, free contains $i, cellSqr == $cs, cellCol != $cc )

    // A cell exists in the same column and another square containing this value.
    $cx: Cell( freeCount &gt; 1, free contains $i, cellCol == $cc, cellSqr != $cs )
  then
    // Remove the value from that other cell.
    if (explain) {
        System.out.println( "column elimination due to " + $c.posAsString() +
                            ": remove " + $i + " from " + $cx.posAsString() );
    }
    modify( $cx ){ blockValue( $i ) }
end

rule "intersection removal row"
  when
    not Setting()
    not Cell( freeCount == 1 )

    $i: Integer()
    // Occurs in a Cell
    $c: Cell( free contains $i, $cs: cellSqr, $cr: cellRow )
    // Does not occur in another cell of the same square and a different row.
    not Cell( this != $c, free contains $i, cellSqr == $cs, cellRow != $cr )

    // A cell exists in the same row and another square containing this value.
    $cx: Cell( freeCount &gt; 1, free contains $i, cellRow == $cr, cellSqr != $cs )
  then
    // Remove the value from that other cell.
    if (explain) {
        System.out.println( "row elimination due to " + $c.posAsString() +
                            ": remove " + $i + " from " + $cx.posAsString() );
    }
    modify( $cx ){ blockValue( $i ) }
end</pre>
					</p></div><p>
					These rules are sufficient for many but not all Sudoku puzzles. To solve very difficult grids, the rule set requires more complex rules. (Ultimately, some puzzles can be solved only by trial and error.)
				</p></section><section class="section" id="decision-examples-conway-ref_decision-engine"><div class="titlepage"><div><div><h2 class="title">86.9. Conway’s Game of Life example decisions (ruleflow groups and GUI integration)</h2></div></div></div><p>
					The Conway’s Game of Life example decision set, based on the famous cellular automaton by John Conway, demonstrates how to use ruleflow groups in rules to control rule execution. The example also demonstrates how to integrate Red Hat Process Automation Manager rules with a graphical user interface (GUI), in this case a Swing-based implementation of Conway’s Game of Life.
				</p><p>
					The following is an overview of the Conway’s Game of Life (Conway) example:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Name</strong></span>: <code class="literal">conway</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Main classes</strong></span>: <code class="literal">org.drools.examples.conway.ConwayRuleFlowGroupRun</code>, <code class="literal">org.drools.examples.conway.ConwayAgendaGroupRun</code> (in <code class="literal">src/main/java</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Module</strong></span>: <code class="literal">droolsjbpm-integration-examples</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Type</strong></span>: Java application
						</li><li class="listitem">
							<span class="strong strong"><strong>Rule files</strong></span>: <code class="literal">org.drools.examples.conway.*.drl</code> (in <code class="literal">src/main/resources</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Objective</strong></span>: Demonstrates ruleflow groups and GUI integration
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The Conway’s Game of Life example is separate from most of the other example decision sets in Red Hat Process Automation Manager and is located in <code class="literal">~/rhpam-7.10.0-sources/src/droolsjbpm-integration-$VERSION/droolsjbpm-integration-examples</code> of the <span class="strong strong"><strong>Red Hat Process Automation Manager 7.10.0 Source Distribution</strong></span> from the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Red Hat Customer Portal</a>.
					</p></div></div><p>
					In Conway’s Game of Life, a user interacts with the game by creating an initial configuration or an advanced pattern with defined properties and then observing how the initial state evolves. The objective of the game is to show the development of a population, generation by generation. Each generation results from the preceding one, based on the simultaneous evaluation of all cells.
				</p><p>
					The following basic rules govern what the next generation looks like:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							If a live cell has fewer than two live neighbors, it dies of loneliness.
						</li><li class="listitem">
							If a live cell has more than three live neighbors, it dies from overcrowding.
						</li><li class="listitem">
							If a dead cell has exactly three live neighbors, it comes to life.
						</li></ul></div><p>
					Any cell that does not meet any of those criteria is left as is for the next generation.
				</p><p>
					The Conway’s Game of Life example uses Red Hat Process Automation Manager rules with <code class="literal">ruleflow-group</code> attributes to define the pattern implemented in the game. The example also contains a version of the decision set that achieves the same behavior using agenda groups. Agenda groups enable you to partition the decision engine agenda to provide execution control over groups of rules. By default, all rules are in the agenda group <code class="literal">MAIN</code>. You can use the <code class="literal">agenda-group</code> attribute to specify a different agenda group for the rule.
				</p><p>
					This overview does not explore the version of the Conway example using agenda groups. For more information about agenda groups, see the Red Hat Process Automation Manager example decision sets that specifically address agenda groups.
				</p><h4 id="conway_example_execution_and_interaction_2">Conway example execution and interaction</h4><p>
					Similar to other Red Hat Process Automation Manager decision examples, you execute the Conway ruleflow example by running the <code class="literal">org.drools.examples.conway.ConwayRuleFlowGroupRun</code> class as a Java application in your IDE.
				</p><p>
					When you execute the Conway example, the <code class="literal">Conway’s Game of Life</code> GUI window appears. This window contains an empty grid, or "arena" where the life simulation takes place. Initially the grid is empty because no live cells are in the system yet.
				</p><div class="figure" id="idm139921810539376"><p class="title"><strong>Figure 86.24. Conway example GUI after launch</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/ConwaysGameOfLifeExample/conway1.png" alt="conway1"/></div></div></div><p>
					Select a predefined pattern from the <span class="strong strong"><strong>Pattern</strong></span> drop-down menu and click <span class="strong strong"><strong>Next Generation</strong></span> to click through each population generation. Each cell is either alive or dead, where live cells contain a green ball. As the population evolves from the initial pattern, cells live or die relative to neighboring cells, according to the rules of the game.
				</p><div class="figure" id="idm139921810532864"><p class="title"><strong>Figure 86.25. Generation evolution in Conway example</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/ConwaysGameOfLifeExample/conway2.png" alt="conway2"/></div></div></div><p>
					Neighbors include not only cells to the left, right, top, and bottom but also cells that are connected diagonally, so that each cell has a total of eight neighbors. Exceptions are the corner cells, which have only three neighbors, and the cells along the four borders, with five neighbors each.
				</p><p>
					You can manually intervene to create or kill cells by clicking the cell.
				</p><p>
					To run through an evolution automatically from the initial pattern, click <span class="strong strong"><strong>Start</strong></span>.
				</p><h4 id="conway_example_rules_with_ruleflow_groups_2">Conway example rules with ruleflow groups</h4><p>
					The rules in the <code class="literal">ConwayRuleFlowGroupRun</code> example use ruleflow groups to control rule execution. A ruleflow group is a group of rules associated by the <code class="literal">ruleflow-group</code> rule attribute. These rules can only fire when the group is activated. The group itself can only become active when the elaboration of the ruleflow diagram reaches the node representing the group.
				</p><p>
					The Conway example uses the following ruleflow groups for rules:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">"register neighbor"</code>
						</li><li class="listitem">
							<code class="literal">"evaluate"</code>
						</li><li class="listitem">
							<code class="literal">"calculate"</code>
						</li><li class="listitem">
							<code class="literal">"reset calculate"</code>
						</li><li class="listitem">
							<code class="literal">"birth"</code>
						</li><li class="listitem">
							<code class="literal">"kill"</code>
						</li><li class="listitem">
							<code class="literal">"kill all"</code>
						</li></ul></div><p>
					All of the <code class="literal">Cell</code> objects are inserted into the KIE session and the <code class="literal">"register …​"</code> rules in the ruleflow group <code class="literal">"register neighbor"</code> are allowed to execute by the ruleflow process. This group of four rules creates <code class="literal">Neighbor</code> relations between some cell and its northeastern, northern, northwestern, and western neighbors.
				</p><p>
					This relation is bidirectional and handles the other four directions. Border cells do not require any special treatment. These cells are not paired with neighboring cells where there is not any.
				</p><p>
					By the time all activations have fired for these rules, all cells are related to all their neighboring cells.
				</p><div class="formalpara"><p class="title"><strong>Rules "register …​"</strong></p><p>
						
<pre class="screen">rule "register north east"
    ruleflow-group "register neighbor"
  when
    $cell: Cell( $row : row, $col : col )
    $northEast : Cell( row  == ($row - 1), col == ( $col + 1 ) )
  then
    insert( new Neighbor( $cell, $northEast ) );
    insert( new Neighbor( $northEast, $cell ) );
end

rule "register north"
    ruleflow-group "register neighbor"
  when
    $cell: Cell( $row : row, $col : col )
    $north : Cell( row  == ($row - 1), col == $col )
  then
    insert( new Neighbor( $cell, $north ) );
    insert( new Neighbor( $north, $cell ) );
end

rule "register north west"
    ruleflow-group "register neighbor"
  when
    $cell: Cell( $row : row, $col : col )
    $northWest : Cell( row  == ($row - 1), col == ( $col - 1 ) )
  then
    insert( new Neighbor( $cell, $northWest ) );
    insert( new Neighbor( $northWest, $cell ) );
end

rule "register west"
    ruleflow-group "register neighbor"
  when
    $cell: Cell( $row : row, $col : col )
    $west : Cell( row  == $row, col == ( $col - 1 ) )
  then
    insert( new Neighbor( $cell, $west ) );
    insert( new Neighbor( $west, $cell ) );
end</pre>
					</p></div><p>
					After all the cells are inserted, some Java code applies the pattern to the grid, setting certain cells to <code class="literal">Live</code>. Then, when the user clicks <span class="strong strong"><strong>Start</strong></span> or <span class="strong strong"><strong>Next Generation</strong></span>, the example executes the <code class="literal">Generation</code> ruleflow. This ruleflow manages all changes of cells in each generation cycle.
				</p><div class="figure" id="idm139921810501360"><p class="title"><strong>Figure 86.26. Generation ruleflow</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/ConwaysGameOfLifeExample/conway_ruleflow_generation.png" alt="conway ruleflow generation"/></div></div></div><p>
					The ruleflow process enters the <code class="literal">"evaluate"</code> ruleflow group and any active rules in the group can fire. The rules <code class="literal">"Kill the …​"</code> and <code class="literal">"Give Birth"</code> in this group apply the game rules to birth or kill cells. The example uses the <code class="literal">phase</code> attribute to drive the reasoning of the <code class="literal">Cell</code> object by specific groups of rules. Typically, the phase is tied to a ruleflow group in the ruleflow process definition.
				</p><p>
					Notice that the example does not change the state of any <code class="literal">Cell</code> objects at this point because it must complete the full evaluation before those changes can be applied. The example sets the cell to a <code class="literal">phase</code> that is either <code class="literal">Phase.KILL</code> or <code class="literal">Phase.BIRTH</code>, which is used later to control actions applied to the <code class="literal">Cell</code> object.
				</p><div class="formalpara"><p class="title"><strong>Rules "Kill the …​" and "Give Birth"</strong></p><p>
						
<pre class="screen">rule "Kill The Lonely"
    ruleflow-group "evaluate"
    no-loop
  when
    // A live cell has fewer than 2 live neighbors.
    theCell: Cell( liveNeighbors &lt; 2, cellState == CellState.LIVE,
                   phase == Phase.EVALUATE )
  then
    modify( theCell ){
        setPhase( Phase.KILL );
    }
end

rule "Kill The Overcrowded"
    ruleflow-group "evaluate"
    no-loop
  when
    // A live cell has more than 3 live neighbors.
    theCell: Cell( liveNeighbors &gt; 3, cellState == CellState.LIVE,
                   phase == Phase.EVALUATE )
  then
    modify( theCell ){
        setPhase( Phase.KILL );
    }
end

rule "Give Birth"
    ruleflow-group "evaluate"
    no-loop
  when
    // A dead cell has 3 live neighbors.
    theCell: Cell( liveNeighbors == 3, cellState == CellState.DEAD,
                   phase == Phase.EVALUATE )
  then
    modify( theCell ){
        theCell.setPhase( Phase.BIRTH );
    }
end</pre>
					</p></div><p>
					After all <code class="literal">Cell</code> objects in the grid have been evaluated, the example uses the <code class="literal">"reset calculate"</code> rule to clear any activations in the <code class="literal">"calculate"</code> ruleflow group. The example then enters a split in the ruleflow that enables the rules <code class="literal">"kill"</code> and <code class="literal">"birth"</code> to fire, if the ruleflow group is activated. These rules apply the state change.
				</p><div class="formalpara"><p class="title"><strong>Rules "reset calculate", "kill", and "birth"</strong></p><p>
						
<pre class="screen">rule "reset calculate"
    ruleflow-group "reset calculate"
  when
  then
    WorkingMemory wm = drools.getWorkingMemory();
    wm.clearRuleFlowGroup( "calculate" );
end

rule "kill"
    ruleflow-group "kill"
    no-loop
  when
    theCell: Cell( phase == Phase.KILL )
  then
    modify( theCell ){
        setCellState( CellState.DEAD ),
        setPhase( Phase.DONE );
    }
end

rule "birth"
    ruleflow-group "birth"
    no-loop
  when
    theCell: Cell( phase == Phase.BIRTH )
  then
    modify( theCell ){
        setCellState( CellState.LIVE ),
        setPhase( Phase.DONE );
    }
end</pre>
					</p></div><p>
					At this stage, several <code class="literal">Cell</code> objects have been modified with the state changed to either <code class="literal">LIVE</code> or <code class="literal">DEAD</code>. When a cell becomes live or dead, the example uses the <code class="literal">Neighbor</code> relation in the rules <code class="literal">"Calculate …​"</code> to iterate over all surrounding cells, increasing or decreasing the <code class="literal">liveNeighbor</code> count. Any cell that has its count changed is also set to the <code class="literal">EVALUATE</code> phase to make sure it is included in the reasoning during the evaluation stage of the ruleflow process.
				</p><p>
					After the live count has been determined and set for all cells, the ruleflow process ends. If the user initially clicked <span class="strong strong"><strong>Start</strong></span>, the decision engine restarts the ruleflow at that point. If the user initially clicked <span class="strong strong"><strong>Next Generation</strong></span>, the user can request another generation.
				</p><div class="formalpara"><p class="title"><strong>Rules "Calculate …​"</strong></p><p>
						
<pre class="screen">rule "Calculate Live"
    ruleflow-group "calculate"
    lock-on-active
  when
    theCell: Cell( cellState == CellState.LIVE )
    Neighbor( cell == theCell, $neighbor : neighbor )
  then
    modify( $neighbor ){
        setLiveNeighbors( $neighbor.getLiveNeighbors() + 1 ),
        setPhase( Phase.EVALUATE );
    }
end

rule "Calculate Dead"
    ruleflow-group "calculate"
    lock-on-active
  when
    theCell: Cell( cellState == CellState.DEAD )
    Neighbor( cell == theCell, $neighbor : neighbor )
  then
    modify( $neighbor ){
        setLiveNeighbors( $neighbor.getLiveNeighbors() - 1 ),
        setPhase( Phase.EVALUATE );
    }
end</pre>
					</p></div></section><section class="section" id="decision-examples-doom-ref_decision-engine"><div class="titlepage"><div><div><h2 class="title">86.10. House of Doom example decisions (backward chaining and recursion)</h2></div></div></div><p>
					The House of Doom example decision set demonstrates how the decision engine uses backward chaining and recursion to reach defined goals or subgoals in a hierarchical system.
				</p><p>
					The following is an overview of the House of Doom example:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Name</strong></span>: <code class="literal">backwardchaining</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Main class</strong></span>: <code class="literal">org.drools.examples.backwardchaining.HouseOfDoomMain</code> (in <code class="literal">src/main/java</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Module</strong></span>: <code class="literal">drools-examples</code>
						</li><li class="listitem">
							<span class="strong strong"><strong>Type</strong></span>: Java application
						</li><li class="listitem">
							<span class="strong strong"><strong>Rule file</strong></span>: <code class="literal">org.drools.examples.backwardchaining.BC-Example.drl</code> (in <code class="literal">src/main/resources</code>)
						</li><li class="listitem">
							<span class="strong strong"><strong>Objective</strong></span>: Demonstrates backward chaining and recursion
						</li></ul></div><p>
					A backward-chaining rule system is a goal-driven system that starts with a conclusion that the decision engine attempts to satisfy, often using recursion. If the system cannot reach the conclusion or goal, it searches for subgoals, which are conclusions that complete part of the current goal. The system continues this process until either the initial conclusion is satisfied or all subgoals are satisfied.
				</p><p>
					In contrast, a forward-chaining rule system is a data-driven system that starts with a fact in the working memory of the decision engine and reacts to changes to that fact. When objects are inserted into working memory, any rule conditions that become true as a result of the change are scheduled for execution by the agenda.
				</p><p>
					The decision engine in Red Hat Process Automation Manager uses both forward and backward chaining to evaluate rules.
				</p><p>
					The following diagram illustrates how the decision engine evaluates rules using forward chaining overall with a backward-chaining segment in the logic flow:
				</p><div class="figure" id="idm139921810453424"><p class="title"><strong>Figure 86.27. Rule evaluation logic using forward and backward chaining</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/BackwardChaining/RuleEvaluation_Enterprise.png" alt="RuleEvaluation Enterprise"/></div></div></div><p>
					The House of Doom example uses rules with various types of queries to find the location of rooms and items within the house. The sample class <code class="literal">Location.java</code> contains the <code class="literal">item</code> and <code class="literal">location</code> elements used in the example. The sample class <code class="literal">HouseOfDoomMain.java</code> inserts the items or rooms in their respective locations in the house and executes the rules.
				</p><div class="formalpara"><p class="title"><strong>Items and locations in HouseOfDoomMain.java class</strong></p><p>
						
<pre class="programlisting language-java">ksession.insert( new Location("Office", "House") );
ksession.insert( new Location("Kitchen", "House") );
ksession.insert( new Location("Knife", "Kitchen") );
ksession.insert( new Location("Cheese", "Kitchen") );
ksession.insert( new Location("Desk", "Office") );
ksession.insert( new Location("Chair", "Office") );
ksession.insert( new Location("Computer", "Desk") );
ksession.insert( new Location("Drawer", "Desk") );</pre>
					</p></div><p>
					The example rules rely on backward chaining and recursion to determine the location of all items and rooms in the house structure.
				</p><p>
					The following diagram illustrates the structure of the House of Doom and the items and rooms within it:
				</p><div class="figure" id="idm139921810442000"><p class="title"><strong>Figure 86.28. House of Doom structure</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/Examples/BackwardChaining/TransitiveReasoning_Enterprise.png" alt="TransitiveReasoning Enterprise"/></div></div></div><p>
					To execute the example, run the <code class="literal">org.drools.examples.backwardchaining.HouseOfDoomMain</code> class as a Java application in your IDE.
				</p><p>
					After the execution, the following output appears in the IDE console window:
				</p><div class="formalpara"><p class="title"><strong>Execution output in the IDE console</strong></p><p>
						
<pre class="screen">go1
Office is in the House
---
go2
Drawer is in the House
---
go3
---
Key is in the Office
---
go4
Chair is in the Office
Desk is in the Office
Key is in the Office
Computer is in the Office
Drawer is in the Office
---
go5
Chair is in Office
Desk is in Office
Drawer is in Desk
Key is in Drawer
Kitchen is in House
Cheese is in Kitchen
Knife is in Kitchen
Computer is in Desk
Office is in House
Key is in Office
Drawer is in House
Computer is in House
Key is in House
Desk is in House
Chair is in House
Knife is in House
Cheese is in House
Computer is in Office
Drawer is in Office
Key is in Desk</pre>
					</p></div><p>
					All rules in the example have fired to detect the location of all items in the house and to print the location of each in the output.
				</p><h4 id="recursive_query_and_related_rules_2">Recursive query and related rules</h4><p>
					A recursive query repeatedly searches through the hierarchy of a data structure for relationships between elements.
				</p><p>
					In the House of Doom example, the <code class="literal">BC-Example.drl</code> file contains an <code class="literal">isContainedIn</code> query that most of the rules in the example use to recursively evaluate the house data structure for data inserted into the decision engine:
				</p><div class="formalpara"><p class="title"><strong>Recursive query in BC-Example.drl</strong></p><p>
						
<pre class="screen">query isContainedIn( String x, String y )
  Location( x, y; )
  or
  ( Location( z, y; ) and isContainedIn( x, z; ) )
end</pre>
					</p></div><p>
					The rule <code class="literal">"go"</code> prints every string inserted into the system to determine how items are implemented, and the rule <code class="literal">"go1"</code> calls the query <code class="literal">isContainedIn</code>:
				</p><div class="formalpara"><p class="title"><strong>Rules "go" and "go1"</strong></p><p>
						
<pre class="screen">rule "go" salience 10
  when
    $s : String()
  then
    System.out.println( $s );
end

rule "go1"
  when
    String( this == "go1" )
    isContainedIn("Office", "House"; )
  then
    System.out.println( "Office is in the House" );
end</pre>
					</p></div><p>
					The example inserts the <code class="literal">"go1"</code> string into the decision engine and activates the <code class="literal">"go1"</code> rule to detect that item <code class="literal">Office</code> is in the location <code class="literal">House</code>:
				</p><div class="formalpara"><p class="title"><strong>Insert string and fire rules</strong></p><p>
						
<pre class="screen">ksession.insert( "go1" );
ksession.fireAllRules();</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Rule "go1" output in the IDE console</strong></p><p>
						
<pre class="screen">go1
Office is in the House</pre>
					</p></div><h4 id="transitive_closure_rule_2">Transitive closure rule</h4><p>
					Transitive closure is a relationship between an element contained in a parent element that is multiple levels higher in a hierarchical structure.
				</p><p>
					The rule <code class="literal">"go2"</code> identifies the transitive closure relationship of the <code class="literal">Drawer</code> and the <code class="literal">House</code>: The <code class="literal">Drawer</code> is in the <code class="literal">Desk</code> in the <code class="literal">Office</code> in the <code class="literal">House</code>.
				</p><pre class="screen">rule "go2"
  when
    String( this == "go2" )
    isContainedIn("Drawer", "House"; )
  then
    System.out.println( "Drawer is in the House" );
end</pre><p>
					The example inserts the <code class="literal">"go2"</code> string into the decision engine and activates the <code class="literal">"go2"</code> rule to detect that item <code class="literal">Drawer</code> is ultimately within the location <code class="literal">House</code>:
				</p><div class="formalpara"><p class="title"><strong>Insert string and fire rules</strong></p><p>
						
<pre class="screen">ksession.insert( "go2" );
ksession.fireAllRules();</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Rule "go2" output in the IDE console</strong></p><p>
						
<pre class="screen">go2
Drawer is in the House</pre>
					</p></div><p>
					The decision engine determines this outcome based on the following logic:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							The query recursively searches through several levels in the house to detect the transitive closure between <code class="literal">Drawer</code> and <code class="literal">House</code>.
						</li><li class="listitem">
							Instead of using <code class="literal">Location( x, y; )</code>, the query uses the value of <code class="literal">(z, y; )</code> because <code class="literal">Drawer</code> is not directly in <code class="literal">House</code>.
						</li><li class="listitem">
							The <code class="literal">z</code> argument is currently unbound, which means it has no value and returns everything that is in the argument.
						</li><li class="listitem">
							The <code class="literal">y</code> argument is currently bound to <code class="literal">House</code>, so <code class="literal">z</code> returns <code class="literal">Office</code> and <code class="literal">Kitchen</code>.
						</li><li class="listitem">
							The query gathers information from the <code class="literal">Office</code> and checks recursively if the <code class="literal">Drawer</code> is in the <code class="literal">Office</code>. The query line <code class="literal">isContainedIn( x, z; )</code> is called for these parameters.
						</li><li class="listitem">
							No instance of <code class="literal">Drawer</code> exists directly in <code class="literal">Office</code>, so no match is found.
						</li><li class="listitem"><p class="simpara">
							With <code class="literal">z</code> unbound, the query returns data within the <code class="literal">Office</code> and determines that <span class="strong strong"><strong>z == Desk</strong></span>.
						</p><pre class="screen">isContainedIn(x==drawer, z==desk)</pre></li><li class="listitem"><p class="simpara">
							The <code class="literal">isContainedIn</code> query recursively searches three times, and on the third time, the query detects an instance of <code class="literal">Drawer</code> in <code class="literal">Desk</code>.
						</p><pre class="screen">Location(x==drawer, y==desk)</pre></li><li class="listitem">
							After this match on the first location, the query recursively searches back up the structure to determine that the <code class="literal">Drawer</code> is in the <code class="literal">Desk</code>, the <code class="literal">Desk</code> is in the <code class="literal">Office</code>, and the <code class="literal">Office</code> is in the <code class="literal">House</code>. Therefore, the <code class="literal">Drawer</code> is in the <code class="literal">House</code> and the rule is satisfied.
						</li></ol></div><h4 id="reactive_query_rule_2">Reactive query rule</h4><p>
					A reactive query searches through the hierarchy of a data structure for relationships between elements and is dynamically updated when elements in the structure are modified.
				</p><p>
					The rule <code class="literal">"go3"</code> functions as a reactive query that detects if a new item <code class="literal">Key</code> ever becomes present in the <code class="literal">Office</code> by transitive closure: A <code class="literal">Key</code> in the <code class="literal">Drawer</code> in the <code class="literal">Office</code>.
				</p><div class="formalpara"><p class="title"><strong>Rule "go3"</strong></p><p>
						
<pre class="screen">rule "go3"
  when
    String( this == "go3" )
    isContainedIn("Key", "Office"; )
  then
    System.out.println( "Key is in the Office" );
end</pre>
					</p></div><p>
					The example inserts the <code class="literal">"go3"</code> string into the decision engine and activates the <code class="literal">"go3"</code> rule. Initially, this rule is not satisfied because no item <code class="literal">Key</code> exists in the house structure, so the rule produces no output.
				</p><div class="formalpara"><p class="title"><strong>Insert string and fire rules</strong></p><p>
						
<pre class="screen">ksession.insert( "go3" );
ksession.fireAllRules();</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Rule "go3" output in the IDE console (unsatisfied)</strong></p><p>
						
<pre class="screen">go3</pre>
					</p></div><p>
					The example then inserts a new item <code class="literal">Key</code> in the location <code class="literal">Drawer</code>, which is in <code class="literal">Office</code>. This change satisfies the transitive closure in the <code class="literal">"go3"</code> rule and the output is populated accordingly.
				</p><div class="formalpara"><p class="title"><strong>Insert new item location and fire rules</strong></p><p>
						
<pre class="screen">ksession.insert( new Location("Key", "Drawer") );
ksession.fireAllRules();</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Rule "go3" output in the IDE console (satisfied)</strong></p><p>
						
<pre class="screen">Key is in the Office</pre>
					</p></div><p>
					This change also adds another level in the structure that the query includes in subsequent recursive searches.
				</p><h4 id="queries_with_unbound_arguments_in_rules_2">Queries with unbound arguments in rules</h4><p>
					A query with one or more unbound arguments returns all undefined (unbound) items within a defined (bound) argument of the query. If all arguments in a query are unbound, then the query returns all items within the scope of the query.
				</p><p>
					The rule <code class="literal">"go4"</code> uses an unbound argument <code class="literal">thing</code> to search for all items within the bound argument <code class="literal">Office</code>, instead of using a bound argument to search for a specific item in the <code class="literal">Office</code>:
				</p><div class="formalpara"><p class="title"><strong>Rule "go4"</strong></p><p>
						
<pre class="screen">rule "go4"
  when
    String( this == "go4" )
    isContainedIn(thing, "Office"; )
  then
    System.out.println( thing + "is in the Office" );
end</pre>
					</p></div><p>
					The example inserts the <code class="literal">"go4"</code> string into the decision engine and activates the <code class="literal">"go4"</code> rule to return all items in the <code class="literal">Office</code>:
				</p><div class="formalpara"><p class="title"><strong>Insert string and fire rules</strong></p><p>
						
<pre class="screen">ksession.insert( "go4" );
ksession.fireAllRules();</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Rule "go4" output in the IDE console</strong></p><p>
						
<pre class="screen">go4
Chair is in the Office
Desk is in the Office
Key is in the Office
Computer is in the Office
Drawer is in the Office</pre>
					</p></div><p>
					The rule <code class="literal">"go5"</code> uses both unbound arguments <code class="literal">thing</code> and <code class="literal">location</code> to search for all items and their locations in the entire <code class="literal">House</code> data structure:
				</p><div class="formalpara"><p class="title"><strong>Rule "go5"</strong></p><p>
						
<pre class="screen">rule "go5"
  when
    String( this == "go5" )
    isContainedIn(thing, location; )
  then
    System.out.println(thing + " is in " + location );
end</pre>
					</p></div><p>
					The example inserts the <code class="literal">"go5"</code> string into the decision engine and activates the <code class="literal">"go5"</code> rule to return all items and their locations in the <code class="literal">House</code> data structure:
				</p><div class="formalpara"><p class="title"><strong>Insert string and fire rules</strong></p><p>
						
<pre class="screen">ksession.insert( "go5" );
ksession.fireAllRules();</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Rule "go5" output in the IDE console</strong></p><p>
						
<pre class="screen">go5
Chair is in Office
Desk is in Office
Drawer is in Desk
Key is in Drawer
Kitchen is in House
Cheese is in Kitchen
Knife is in Kitchen
Computer is in Desk
Office is in House
Key is in Office
Drawer is in House
Computer is in House
Key is in House
Desk is in House
Chair is in House
Knife is in House
Cheese is in House
Computer is in Office
Drawer is in Office
Key is in Desk</pre>
					</p></div></section></section><section class="chapter" id="performance-tuning-decision-engine-ref_decision-engine"><div class="titlepage"><div><div><h2 class="title">Chapter 87. Performance tuning considerations with the decision engine</h2></div></div></div><p>
				The following key concepts or suggested practices can help you optimize decision engine performance. These concepts are summarized in this section as a convenience and are explained in more detail in the cross-referenced documentation, where applicable. This section will expand or change as needed with new releases of Red Hat Process Automation Manager.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Use sequential mode for stateless KIE sessions that do not require important decision engine updates</span></dt><dd><p class="simpara">
							Sequential mode is an advanced rule base configuration in the decision engine that enables the decision engine to evaluate rules one time in the order that they are listed in the decision engine agenda without regard to changes in the working memory. As a result, rule execution may be faster in sequential mode, but important updates may not be applied to your rules. Sequential mode applies to stateless KIE sessions only.
						</p><p class="simpara">
							To enable sequential mode, set the system property <code class="literal">drools.sequential</code> to <code class="literal">true</code>.
						</p><p class="simpara">
							For more information about sequential mode or other options for enabling it, see <a class="xref" href="#phreak-sequential-mode-con_decision-engine" title="82.3. Sequential mode in Phreak">Section 82.3, “Sequential mode in Phreak”</a>.
						</p></dd><dt><span class="term">Use simple operations with event listeners</span></dt><dd><p class="simpara">
							Limit the number of event listeners and the type of operations they perform. Use event listeners for simple operations, such as debug logging and setting properties. Complicated operations, such as network calls, in listeners can impede rule execution. After you finish working with a KIE session, remove the attached event listeners so that the session can be cleaned, as shown in the following example:
						</p><div class="formalpara"><p class="title"><strong>Example event listener removed after use</strong></p><p>
								
<pre class="programlisting language-java">Listener listener = ...;
StatelessKnowledgeSession ksession = createSession();
try {
    ksession.insert(fact);
    ksession.fireAllRules();
    ...
} finally {
    if (session != null) {
        ksession.detachListener(listener);
        ksession.dispose();
    }
}</pre>
							</p></div><p class="simpara">
							For information about built-in event listeners and debug logging in the decision engine, see <a class="xref" href="#engine-event-listeners-con_decision-engine" title="Chapter 85. Decision engine event listeners and debug logging">Chapter 85, <em>Decision engine event listeners and debug logging</em></a>.
						</p></dd><dt><span class="term">Configure <code class="literal">LambdaIntrospector</code> cache size for an executable model build</span></dt><dd>
							You can configure the size of <code class="literal">LambdaIntrospector.methodFingerprintsMap</code> cache, which is used in an executable model build. The default size of the cache is <code class="literal">32</code>. When you configure smaller value for the cache size, it reduces memory usage. For example, you can configure system property <code class="literal">drools.lambda.introspector.cache.size</code> to <code class="literal">0</code> for minimum memory usage. Note that smaller cache size also slows down the build performance.
						</dd><dt><span class="term">Use lambda externalization for executable model</span></dt><dd><p class="simpara">
							Enable lambda externalization to optimize the memory consumption during runtime. It rewrites lambdas that are generated and used in the executable model. This enables you to reuse the same lambda multiple times with all the patterns and the same constraint. When the rete or phreak is instantiated, the executable model becomes garbage collectible.
						</p><p class="simpara">
							To enable lambda externalization for the executable model, include the following property:
						</p><pre class="screen">-Ddrools.externaliseCanonicalModelLambda=true</pre></dd><dt><span class="term">Configure alpha node range index threshold</span></dt><dd><p class="simpara">
							Alpha node range index is used to evaluate the rule constraint. You can configure the threshold of the alpha node range index using the <code class="literal">drools.alphaNodeRangeIndexThreshold</code> system property. The default value of the threshold is <code class="literal">9</code>, indicating that the alpha node range index is enabled when a precedent node contains more than nine alpha nodes with inequality constraints. For example, when you have nine rules similar to <code class="literal">Person(age &gt; 10)</code>, <code class="literal">Person(age &gt; 20)</code>, …​, <code class="literal">Person(age &gt; 90)</code>, then you can have similar nine alpha nodes.
						</p><p class="simpara">
							The default value of the threshold is based on the related advantages and overhead. However, if you configure a smaller value for the threshold, then the performance can be improved depending on your rules. For example, you can configure the <code class="literal">drools.alphaNodeRangeIndexThreshold</code> value to <code class="literal">6</code>, enabling the alpha node range index when you have more than six alpha nodes for a precedent node. You can set a suitable value for the threshold based on the performance test results of your rules.
						</p></dd></dl></div></section><section class="chapter" id="additional_resources_3"><div class="titlepage"><div><div><h2 class="title">Chapter 88. Additional resources</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/designing_your_decision_management_architecture_for_red_hat_process_automation_manager"><span class="emphasis"><em>Designing your decision management architecture for Red Hat Process Automation Manager</em></span></a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/getting_started_with_red_hat_process_automation_manager#assembly-getting-started-decision-services"><span class="emphasis"><em>Getting started with decision services</em></span></a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-drl-rules"><span class="emphasis"><em>Designing a decision service using DRL rules</em></span></a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/deploying_and_managing_red_hat_process_automation_manager_services#assembly-packaging-deploying"><span class="emphasis"><em>Packaging and deploying a Red Hat Process Automation Manager project</em></span></a>
					</li></ul></div></section></div><div class="part" id="assembly-ba-artificial-intelligence"><div class="titlepage"><div><div><h1 class="title">Part X. Integrating machine learning with Red Hat Process Automation Manager</h1></div></div></div><div class="partintro" id="idm139921810290032"><div/><p>
				As a business analyst or business rules developer, you can integrate machine learning with Red Hat Process Automation Manager by using PMML files with Decision Model and Notation (DMN) models.
			</p><div class="toc"><p><strong>Table of Contents</strong></p><ul class="toc"><li><span class="chapter"><a href="#ai-con_artificial-intelligence">89. Pragmatic AI</a></span></li><li><span class="chapter"><a href="#ai-credit-card-con_artificial-intelligence">90. Credit card fraud dispute use case</a></span><ul><li><span class="section"><a href="#ai-gsg_artificial-intelligence">90.1. Using a PMML model with a DMN model to resolve credit card transaction disputes</a></span></li><li><span class="section"><a href="#ai-pmml-ref_artificial-intelligence">90.2. Credit card transaction dispute exercise PMML file</a></span></li></ul></li><li><span class="chapter"><a href="#additional_resources_4">91. Additional resources</a></span></li></ul></div></div><section class="chapter" id="ai-con_artificial-intelligence"><div class="titlepage"><div><div><h2 class="title">Chapter 89. Pragmatic AI</h2></div></div></div><p>
				When you think about artificial intelligence (AI), machine learning and big data might come to mind. But machine learning is only part of the picture. Artificial intelligence includes the following technologies:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Robotics: The integration of technology, science, and engineering that produces machines that can perform physical tasks that are performed by humans
					</li><li class="listitem">
						Machine learning: The ability of a collection of algorithms to learn or improve when exposed to data without being explicitly programmed to do so
					</li><li class="listitem">
						Natural language processing: A subset of machine learning that processes human speech
					</li><li class="listitem">
						Mathematical optimization: The use of conditions and constraints to find the optimal solution to a problem
					</li><li class="listitem">
						Digital decisioning: The use of defined criteria, conditions, and a series of machine and human tasks to make decisions
					</li></ul></div><p>
				<span class="inlinemediaobject"><object type="image/svg+xml" class="svg-img" data="images/_images/ai/123_RHPAM_Integrating_AI_1020_building-blocks.svg"><embed type="image/svg+xml" src="images/_images/ai/123_RHPAM_Integrating_AI_1020_building-blocks.svg"/></object></span>
			</p><p>
				While science fiction is filled with what is referred to as artificial general intelligence (AGI), machines that perform better than people and cannot be distinguished from them and learn and evolve without human intervention or control, AGI is decades away. Meanwhile, we have pragmatic AI which is much less frightening and much more useful to us today. Pragmatic AI is a collection of AI technologies that, when combined, provide solutions to problems such as predicting customer behavior, providing automated customer service, and helping customers make purchasing decisions.
			</p><p>
				Leading industry analysts report that previously organizations have struggled with AI technologies because they invested in the potential of AI rather than the reality of what AI can deliver today. AI projects were not productive and as a result investment in AI slowed and budgets for AI projects were reduced. This disillusionment with AI is often referred to as an AI winter. AI has experienced several cycles of AI winters followed by AI springs and we are now decidedly in an AI spring. Organizations are seeing the practical reality of what AI can deliver. Being pragmatic means being practical and realistic. A pragmatic approach to AI considers AI technologies that are available today, combines them where useful, and adds human intervention when needed to create solutions to real-world problems.
			</p><div class="formalpara"><p class="title"><strong>Pragmatic AI solution example</strong></p><p>
					One application of pragmatic AI is in customer support. A customer files a support ticket that reports a problem, for example, a login error. A machine learning algorithm is applied to the ticket to match the ticket content with existing solutions, based on keywords or natural language processing (NLP). The keywords might appear in many solutions, some relevant and some not as relevant. You can use digital decisioning to determine which solutions to present to the customer. However, sometimes none of the solutions proposed by the algorithm are appropriate to propose to the customer. This can be because all solutions have a low confidence score or multiple solutions have a high confidence score. In cases where an appropriate solution cannot be found, the digital decisioning can involve the human support team. To find the best support person based on availability and expertise, mathematical optimization selects the best assignee for the support ticket by considering employee rostering constraints.
				</p></div><p>
				As this example shows, you can combine machine learning to extract information from data analysis and digital decisioning to model the human knowledge and experience. You can then apply mathematical optimization to schedule human assistance. This is a pattern that you can apply to other situations, for example, a credit card dispute and credit card fraud detection.
			</p><p>
				<span class="inlinemediaobject"><object type="image/svg+xml" class="svg-img" data="images/_images/ai/123_RHPAM_Integrating_AI_1020_equation.svg"><embed type="image/svg+xml" src="images/_images/ai/123_RHPAM_Integrating_AI_1020_equation.svg"/></object></span>
				 These technologies use four industry standards:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Case Management Model and Notation (CMMN)
					</p><p class="simpara">
						CMMN is used to model work methods that include various activities that might be performed in an unpredictable order depending on circumstances. CMMN models are event centered. CMMN overcomes limitations of what can be modeled with BPMN2 by supporting less structured work tasks and tasks driven by humans. By combining BPMN and CMMN you can create much more powerful models.
					</p></li><li class="listitem"><p class="simpara">
						Business Process Model and Notation (BPMN2)
					</p><p class="simpara">
						The BPMN2 specification is an Object Management Group (OMG) specification that defines standards for graphically representing a business process, defines execution semantics for the elements, and provides process definitions in XML format. BPMN2 can model computer and human tasks.
					</p></li><li class="listitem"><p class="simpara">
						Decision Model and Notation (DMN)
					</p><p class="simpara">
						Decision Model and Notation (DMN) is a standard established by the OMG for describing and modeling operational decisions. DMN defines an XML schema that enables DMN models to be shared between DMN-compliant platforms and across organizations so that business analysts and business rules developers can collaborate in designing and implementing DMN decision services. The DMN standard is similar to and can be used together with the Business Process Model and Notation (BPMN) standard for designing and modeling business processes.
					</p></li><li class="listitem"><p class="simpara">
						Predictive Model Markup Language (PMML)
					</p><p class="simpara">
						PMML is the language used to represent predictive models, mathematical models that use statistical techniques to uncover, or learn, patterns in large volumes of data. Predictive models use the patterns that they learn to predict the existence of patterns in new data. With PMML, you can share predictive models between applications. This data is exported as a PMML file that can be consumed by a DMN model. As a machine learning framework continues to train the model, the updated data can be saved to the existing PMML file. This means that you can use predictive models created by any application that can save the model as a PMML file. Therefore, DMN and PMML integrate well.
					</p></li></ul></div><div class="formalpara"><p class="title"><strong>Putting it all together</strong></p><p>
					<span class="inlinemediaobject"><object type="image/svg+xml" class="svg-img" data="images/_images/ai/123_RHPAM_Integrating_AI_1020_overview.svg"><embed type="image/svg+xml" src="images/_images/ai/123_RHPAM_Integrating_AI_1020_overview.svg"/></object></span>
				</p></div><p>
				This illustration shows how predictive decision automation works.
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Business data enters the system, for example, data from a loan application.
					</li><li class="listitem">
						A decision model that is integrated with a predictive model decides whether or not to approve the loan or whether additional tasks are required.
					</li><li class="listitem">
						A business action results, for example, a rejection letter or loan offer is sent to the customer.
					</li></ol></div><p>
				The next section demonstrates how predictive decision automation works with Red Hat Process Automation Manager.
			</p></section><section class="chapter" id="ai-credit-card-con_artificial-intelligence"><div class="titlepage"><div><div><h2 class="title">Chapter 90. Credit card fraud dispute use case</h2></div></div></div><p>
				The financial industry uses pragmatic AI for decisioning in several areas. One area is credit card charge disputes. When a customer identifies an incorrect or unrecognized charge on a credit card bill, the customer can dispute the charge. Human intervention in credit card fraud detection is required in some cases but the majority of reported credit card fraud can be completely or partially resolved with pragmatic AI.
			</p><p>
				This use case example is about the fictitious Fortress Bank, the bank’s customer Joe, and the business process management (BPM) developer Michelle. First we will look at how the bank originally used AI through Red Hat Process Automation Manager digital decisioning and then we will see how Michelle enhanced the decision model with a Predictive Model Markup Language (PMML) model created from machine learning.
			</p><p>
				Machine learning models such as Tensorflow™ and R™ produce predictive models. You can save these predictive models in an open standard such as PMML so that you can use the model with Red Hat Process Automation Manager or other products that support the PMML standard.
			</p><div class="formalpara"><p class="title"><strong>Red Hat Process Automation Manager and Red Hat OpenShift Container Platform</strong></p><p>
					Fortress Bank uses Red Hat Process Automation Manager on Red Hat OpenShift Container Platform to develop and run the Fortress Bank decision services. Red Hat OpenShift Container Platform is a cloud platform for developing and running containerized applications. It is designed to enable applications and the data centers that support them to expand from just a few machines and applications to thousands of machines that serve millions of clients. Red Hat Process Automation Manager is the Red Hat middleware platform for creating cloud-native business automation applications and microservices. It enables enterprise business and IT users to document, simulate, manage, automate, and monitor business processes and decisions. Business Central is the Red Hat Process Automation Manager dashboard.
				</p></div><div class="formalpara"><p class="title"><strong>Credit card dispute digital decisioning with Red Hat Process Automation Manager</strong></p><p>
					Joe is a Fortress Bank customer. Each month, he logs in to the Fortress Bank website to review all of the charges on his bill before he pays it. This month, Joe sees a transaction that he recognizes but the amount is incorrect. The vendor has charged him $44.50 instead of $4.50. Joe selects the row that contains the incorrect item and clicks <span class="strong strong"><strong>Dispute</strong></span>.
				</p></div><p>
				<span class="inlinemediaobject"><img src="images/_images/ai/transaction-history.png" alt="transaction history"/></span>
			</p><p>
				This action initiates a series of questions about the dispute:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Why are you disputing these transactions?
					</li><li class="listitem">
						Has your card been with you the entire time?
					</li><li class="listitem">
						Is there anything else you would like to tell us about this dispute?
					</li></ol></div><p>
				After Joe answers the questions, the website provides Joe with an incident number, <code class="literal">000004</code>.
			</p><p>
				Fortress Bank must now decide whether to reimburse the disputed amount without human investigation or whether to investigate the claim manually. Manual investigation requires more resources so automatic processing of the disputed amount costs the bank less in terms of human resources. However, if the bank automatically accepts all disputed amounts the cost will ultimately be greater to the bank because of money paid for fraudulent claims. Someone or something must make the decision whether or not to investigate.
			</p><div class="formalpara"><p class="title"><strong>Credit Card Dispute project</strong></p><p>
					To help with this decisioning, Fortress Bank used Business Central to create the <span class="strong strong"><strong>CreditCardDisputeCase</strong></span> project that contains the <span class="strong strong"><strong>fraudDispute</strong></span> business process that models the dispute process.
				</p></div><p>
				<span class="inlinemediaobject"><img src="images/_images/ai/casefile.png" alt="casefile"/></span>
			</p><div class="formalpara"><p class="title"><strong>Process variables</strong></p><p>
					When Joe reported the dispute, an instance of the <span class="strong strong"><strong>fraudDispute</strong></span> process was created with case ID <code class="literal">FR-00000004</code>. The <span class="strong strong"><strong>Process Variables</strong></span> tab contains several variables and values specific to Joe’s account, including <code class="literal">CaseID</code>, <code class="literal">caseFile_cardholderRIskRating</code> (the creditcard holder risk rating), and <code class="literal">caseFile_disputeRiskRating</code> (the risk rating of this dispute):
				</p></div><p>
				<span class="inlinemediaobject"><img src="images/_images/ai/process-variables-3.png" alt="process variables 3"/></span>
			</p><p>
				The table also has the <code class="literal">casefile_automated</code> variable with the value <code class="literal">true</code>. This indicates that the dispute met the criteria to be automatically processed.
			</p><div class="formalpara"><p class="title"><strong>Process diagram</strong></p><p>
					The <span class="strong strong"><strong>Diagram</strong></span> tab contains the BPMN diagram that shows the decision paths that the bank uses when deciding whether to process a dispute automatically or manually:
				</p></div><p>
				<span class="inlinemediaobject"><img src="images/_images/ai/bpmn.png" alt="bpmn"/></span>
			</p><p>
				The <span class="strong strong"><strong>Decision Task</strong></span> task contains the rules that determine whether the dispute will be automatically charged back to Joe’s account (<span class="strong strong"><strong>Milestone 1</strong></span>) or whether more investigation is required (<span class="strong strong"><strong>Milestone 2</strong></span>) based on the values of the <code class="literal">caseFile_cardholderRiskRating</code> and the <code class="literal">caseFile_disputeRiskRating</code> variables. If Joe’s dispute matches the criteria for automatic approval, <span class="strong strong"><strong>Milestone 1</strong></span> is followed and the disputed amount is charged back to his account. This sub-process is very lean and efficient. If Joe’s dispute requires manual evaluation, the sub-process in <span class="strong strong"><strong>Milestone 2</strong></span> is started, which will require some human actor involvement and will take more resources to process.
			</p><p>
				In this case, the Decision Task task decided to process Joe’s dispute automatically so it followed <span class="strong strong"><strong>Milestone 1: Automatic Chargeback</strong></span>.
			</p><div class="formalpara"><p class="title"><strong>DMN model</strong></p><p>
					The following simplified DMN model shows the decision process that is part of the <span class="strong strong"><strong>fraudDispute</strong></span> <span class="strong strong"><strong>Decision Task</strong></span> task:
				</p></div><p>
				<span class="inlinemediaobject"><img src="images/_images/ai/simple-dmn.png" alt="simple dmn"/></span>
			</p><p>
				The input variables are <span class="strong strong"><strong>Age</strong></span> (cardholder age), <span class="strong strong"><strong>Incident Count</strong></span> (the number of previous disputes for this cardholder), <span class="strong strong"><strong>Cardholder Status</strong></span> (standard, silver, gold, platinum), and <span class="strong strong"><strong>Fraud Amount</strong></span>.
			</p><p>
				Red Hat Process Automation Manager uses input variables in decision tables to support digital decisioning. The decision tables are created by human business analysts. The analyst creates a draft business requirement analysis document or spreadsheet that stakeholders review and approve. The project designer then uses the Business Central DMN editor to transfer the data in the analysis document to the DMN model. The Fortress Bank <span class="strong strong"><strong>Credit Card Dispute</strong></span> process has two decision tables, the <span class="strong strong"><strong>Cardholder Risk Rating</strong></span> table and the <span class="strong strong"><strong>Dispute Risk Rating</strong></span> table. The <span class="strong strong"><strong>Cardholder Risk Rating</strong></span> table contains three input variables: <span class="strong strong"><strong>Incident Count</strong></span>, <span class="strong strong"><strong>Cardholder Status</strong></span>, and <span class="strong strong"><strong>Age</strong></span>. The <span class="strong strong"><strong>Dispute Risk Rating</strong></span> table contains the <span class="strong strong"><strong>Cardholder Status</strong></span> input variable. It calculates the risk of the dispute based on the cardholder status and the amount of the dispute.
			</p><p>
				<span class="inlinemediaobject"><img src="images/_images/ai/riskrating.png" alt="riskrating"/></span>
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>Cardholder Risk Rating</strong></span>
					</p><p class="simpara">
						Joe is a Silver cardholder over the age of 25. He has had more than two previous disputes, so he has a risk rating of 2. If Joe had no previous disputes, he would have a risk rating of 0.
					</p></li><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>Dispute Risk Rating</strong></span>
					</p><p class="simpara">
						Because Joe is a Silver cardholder and the disputed amount is $40, Joe has a rating of 1 on the <span class="strong strong"><strong>Dispute Risk Rating</strong></span> table. If the disputed amount was $140, Joe would have a risk rating of 2.
					</p></li></ul></div><p>
				The following formula, which is implemented as part of the <span class="strong strong"><strong>Process Automatically</strong></span> final decision in the DMN model, uses the scores from the two decision tables to determine whether to automatically charge back the disputed amount (<span class="strong strong"><strong>Milestone 1</strong></span>) or whether more investigation is needed (<span class="strong strong"><strong>Milestone 2</strong></span>).
			</p><pre class="screen">(Cardholder Risk Rating + Dispute Risk Rating) &lt; 5</pre><p>
				If Joe’s overall risk score is less than five, his disputed amount is charged back automatically (<span class="strong strong"><strong>Milestone 1</strong></span>). If the overall score is 5 or greater, then his dispute is processed manually (<span class="strong strong"><strong>Milestone 2</strong></span>).
			</p><div class="formalpara"><p class="title"><strong>Adding machine learning to Red Hat Process Automation Manager digital decisioning</strong></p><p>
					Because Fortress Bank has historical data about its customers, including previous transaction and dispute history, the bank can use that data with machine learning to create predictive models that can be used in the DMN model decision tasks. This results in a more accurate assessment of the risk compared to the decision tables created by business analysts.
				</p></div><p>
				Fortress Bank has two sets of PMML files that contain models which more accurately assess risk predictions. One set is based on the linear regression algorithm and the other is based on the random forests algorithm.
			</p><p>
				<span class="inlinemediaobject"><img src="images/_images/ai/pmml-models.png" alt="pmml models"/></span>
			</p><p>
				Linear regression is one of the most widely used algorithms in both statistics and machine learning. It uses a linear equation that combines a set of numeric input and output values. Random forests use many decision trees as inputs to create prediction models.
			</p><div class="formalpara"><p class="title"><strong>Adding PMML files</strong></p><p>
					Michelle imports the <span class="strong strong"><strong>dispute_risk_linear_regression</strong></span> PMML file into her project. She adds the <span class="strong strong"><strong>Cardholder Risk Model</strong></span> business model knowledge node to the DMN model and associates the <span class="strong strong"><strong>dispute_risk_linear_regression</strong></span> PMML file with the node. Red Hat Process Automation Manager analyzes the PMML file and adds input parameters to the node. Michelle associates the <span class="strong strong"><strong>Cardholder Risk Model</strong></span> node with the <span class="strong strong"><strong>Dispute Risk Rating</strong></span>.
				</p></div><p>
				Michelle then adds the <span class="strong strong"><strong>credit_card_holder_risk_linear_regression</strong></span> PMML model to the projects, creates the <span class="strong strong"><strong>Dispute Risk Model</strong></span> mode DMN file, creates and associates the <span class="strong strong"><strong>credit_card_holder_risk_linear_regression</strong></span> PMML file with the node. Red Hat Process Automation Manager analyzes the PMML file and adds input parameters to the node.
			</p><p>
				The following image is Michelle’s completed DMN model, which replaces analytical decision tables with the predictive models from the PMML files:
			</p><p>
				<span class="inlinemediaobject"><img src="images/_images/ai/DMN-PMML-2.png" alt="DMN PMML 2"/></span>
			</p><p>
				Michelle now returns to the <span class="strong strong"><strong>fraudDispute</strong></span> BPMN model and updates the model with the PMML files that she added. She then redeploys the project.
			</p><div class="formalpara"><p class="title"><strong>Increased score precision</strong></p><p>
					In this new scenario where Michelle has redeployed the Fortress Bank project with PMML models, we can see what happens when Joe logs in to his Fortress Bank account and reports the same transaction as incorrect. In Business Central, Michelle navigates to the <span class="strong strong"><strong>Process Instances</strong></span> window and she sees Joe’s new dispute instance. In the <span class="strong strong"><strong>Process Variables</strong></span> tab, Michelle reviews the values of <span class="strong strong"><strong>cardHolderRiskRating</strong></span> and the <span class="strong strong"><strong>disputeRiskRating</strong></span>. They have changed because the model is now using the PMML files. This give a much more precise prediction of risk by making use of machine learning models based on historical data. At the same time, the policy of the bank is still enforced by the DMN decision model: the risk predictor is below a specified threshold which allows for this dispute to be processed automatically.
				</p></div><p>
				<span class="inlinemediaobject"><img src="images/_images/ai/process-variables-pmml.png" alt="process variables pmml"/></span>
			</p><div class="formalpara"><p class="title"><strong>Monitoring</strong></p><p>
					Finally, Fortress Bank uses Prometheus to gather metrics about credit card disputes and Grafana to visualize those metrics in real time. The upper section of the monitor shows the business metrics key performance indicators (KPIs) and the lower section shows the operational metrics KPIs.
				</p></div><p>
				<span class="inlinemediaobject"><img src="images/_images/ai/grafana.png" alt="grafana"/></span>
			</p><section class="section" id="ai-gsg_artificial-intelligence"><div class="titlepage"><div><div><h2 class="title">90.1. Using a PMML model with a DMN model to resolve credit card transaction disputes</h2></div></div></div><p>
					This example shows you how to use Red Hat Process Automation Manager to create a DMN model that uses a PMML model to resolve credit card transaction disputes. When a customer disputes a credit card transaction, the system decides whether or not to process the transaction automatically.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Red Hat Process Automation Manager is available and the following JAR file has been added to the <code class="literal">~/kie-server.war/WEB-INF/lib</code> and <code class="literal">~/business-central.war/WEB-INF/lib</code> directories in your Red Hat Process Automation Manager installation:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
									<code class="literal">kie-dmn-jpmml-7.48.0.Final-redhat-00002.jar</code>
								</p><p class="simpara">
									This file is available in the Red Hat Decision Manager 7.10 Maven Repository distribution available from the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Software Downloads</a> page in the Red Hat Customer Portal (login required). The group ID, artifact ID, and version (GAV) identifier of this file is <code class="literal">org.kie:kie-dmn-jpmml:7.48.0.Final-redhat-00002</code>. For more information, see the "Including PMML models within a DMN file in Business Central" section of <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-dmn-models"><span class="emphasis"><em>Designing a decision service using DMN models</em></span></a>.
								</p></li><li class="listitem">
									<a class="link" href="https://mvnrepository.com/artifact/org.jpmml/pmml-evaluator/1.5.1">JPMML Evaluator 1.5.1 JAR file</a>
								</li><li class="listitem"><p class="simpara">
									<a class="link" href="https://mvnrepository.com/artifact/org.jpmml/pmml-evaluator-extension/1.5.1">JPMML Evaluator Extensions 1.5.1 JAR file</a>
								</p><p class="simpara">
									These files are required to enable JPMML evaluation in KIE Server and Business Central.
								</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
										Red Hat supports integration with the Java Evaluator API for PMML (JPMML) for PMML execution in Red Hat Process Automation Manager. However, Red Hat does not support the JPMML libraries directly. If you include JPMML libraries in your Red Hat Process Automation Manager distribution, see the <a class="link" href="https://openscoring.io/">Openscoring.io</a> licensing terms for JPMML.
									</p></div></div></li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Create the <code class="literal">dtree_risk_predictor.pmml</code> file with the contents of the XML example in <a class="xref" href="#ai-pmml-ref_artificial-intelligence" title="90.2. Credit card transaction dispute exercise PMML file">Section 90.2, “Credit card transaction dispute exercise PMML file”</a>.
						</li><li class="listitem"><p class="simpara">
							In Business Central, create the <span class="strong strong"><strong>Credit Card Dispute</strong></span> project:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Navigate to <span class="strong strong"><strong>Menu → Design → Projects</strong></span>.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Add Project</strong></span>.
								</li><li class="listitem">
									In the <span class="strong strong"><strong>Name</strong></span> box, enter <code class="literal">Credit Card Dispute</code> and click <span class="strong strong"><strong>Add</strong></span>.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							In the <span class="strong strong"><strong>Assets</strong></span> window of the <span class="strong strong"><strong>Credit Card Dispute</strong></span> project, import the <code class="literal">dtree_risk_predictor.pmml</code> file into the <code class="literal">com</code> package:
						</p><p class="simpara">
							<span class="inlinemediaobject"><img src="images/_images/ai/import-pmml.png" alt="import pmml"/></span>
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Click <span class="strong strong"><strong>Import Asset</strong></span>.
								</li><li class="listitem"><p class="simpara">
									In the <span class="strong strong"><strong>Create new Import Asset</strong></span> dialog, enter <code class="literal">dtree_risk_predictor</code> in the <span class="strong strong"><strong>Name</strong></span> box, select <span class="strong strong"><strong>com</strong></span> from the <span class="strong strong"><strong>Package</strong></span> menu, select the <code class="literal">dtree_risk_predictor.pmml</code> file, and click <span class="strong strong"><strong>OK</strong></span>.
								</p><p class="simpara">
									The content of the <code class="literal">dtree_risk_predictor.pmml</code> file appears in the <span class="strong strong"><strong>Overview</strong></span> window.
								</p></li></ol></div></li><li class="listitem"><p class="simpara">
							Create the <span class="strong strong"><strong>Dispute Transaction Check</strong></span> DMN model in <span class="strong strong"><strong>com</strong></span> package:
						</p><p class="simpara">
							<span class="inlinemediaobject"><img src="images/_images/ai/dmn-asset.png" alt="dmn asset"/></span>
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									To return to the project window, click <span class="strong strong"><strong>Credit Card Dispute</strong></span> in the breadcrumb trail.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Add Asset</strong></span>.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>DMN</strong></span> in the asset library.
								</li><li class="listitem"><p class="simpara">
									In the <span class="strong strong"><strong>Create new DMN</strong></span> dialog, enter enter <code class="literal">Dispute Transaction Check</code> in the <span class="strong strong"><strong>Name</strong></span> box, select <span class="strong strong"><strong>com</strong></span> from the <span class="strong strong"><strong>Package</strong></span> menu, and click <span class="strong strong"><strong>OK</strong></span>.
								</p><p class="simpara">
									The DMN editor opens with the <span class="strong strong"><strong>Dispute Transaction Check</strong></span> DMN model.
								</p></li></ol></div></li><li class="listitem"><p class="simpara">
							Create the <span class="strong strong"><strong>tTransaction</strong></span> custom data type:
						</p><p class="simpara">
							<span class="inlinemediaobject"><img src="images/_images/ai/ttransactions.png" alt="ttransactions"/></span>
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Click the <span class="strong strong"><strong>Data Types</strong></span> tab.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Add a custom Data Type</strong></span>.
								</li><li class="listitem">
									In the <span class="strong strong"><strong>Name</strong></span> box, enter <code class="literal">tTransaction</code>.
								</li><li class="listitem">
									Select <span class="strong strong"><strong>Structure</strong></span> from the <span class="strong strong"><strong>Type</strong></span> menu.
								</li><li class="listitem"><p class="simpara">
									To create the data type, click the check mark.
								</p><p class="simpara">
									The <span class="strong strong"><strong>tTransaction</strong></span> custom data type appears with one variable row.
								</p></li><li class="listitem">
									In the <span class="strong strong"><strong>Name</strong></span> field of the variable row, enter <code class="literal">transaction_amount</code>, select <span class="strong strong"><strong>Number</strong></span> from the <span class="strong strong"><strong>Type</strong></span> menu, and then click the check mark.
								</li><li class="listitem">
									To add a new variable row, click the plus symbol on the <code class="literal">transaction_amount</code> row. A new row appears.
								</li><li class="listitem">
									In the <span class="strong strong"><strong>Name</strong></span> field, enter <code class="literal">cardholder_identifier</code>, select <span class="strong strong"><strong>Number</strong></span> from the <span class="strong strong"><strong>Type</strong></span> menu, and then click the check mark.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							Add the <span class="strong strong"><strong>Risk Predictor</strong></span> <code class="literal">dtree_risk_predictor.pmml</code> model:
						</p><p class="simpara">
							<span class="inlinemediaobject"><img src="images/_images/ai/include-model.png" alt="include model"/></span>
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									In the <span class="strong strong"><strong>Included Models</strong></span> window of the DMN editor, click <span class="strong strong"><strong>Include Model</strong></span>.
								</li><li class="listitem">
									In the <span class="strong strong"><strong>Include Model</strong></span> dialog, select <code class="literal">dtree_risk_predictor.pmml</code> from the <span class="strong strong"><strong>Models</strong></span> menu.
								</li><li class="listitem">
									Enter <code class="literal">Risk Predictor</code> in the <span class="strong strong"><strong>Provide a unique name</strong></span> box and click <span class="strong strong"><strong>OK</strong></span>.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							Create the <span class="strong strong"><strong>Risk Predictor</strong></span> Business Knowledge Model (BKM) node with the <span class="strong strong"><strong>Risk Predictor</strong></span> and <span class="strong strong"><strong>DecisionTreeClassifier</strong></span> model:
						</p><p class="simpara">
							<span class="inlinemediaobject"><img src="images/_images/ai/risk-predictor-function.png" alt="risk predictor function"/></span>
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									In the <span class="strong strong"><strong>Model</strong></span> window of the DMN editor, drag a BKM node to the DMN editor palette.
								</p><p class="simpara">
									<span class="inlinemediaobject"><img src="images/_images/ai/bkm.png" alt="bkm"/></span>
								</p></li><li class="listitem">
									Rename the node <span class="strong strong"><strong>Risk Predictor</strong></span>.
								</li><li class="listitem"><p class="simpara">
									Click the edit icon located below the trash can icon on the left side of the node.
								</p><p class="simpara">
									<span class="inlinemediaobject"><img src="images/_images/ai/risk-predictor-node.png" alt="risk predictor node"/></span>
								</p></li><li class="listitem">
									Click <span class="strong strong"><strong>F</strong></span> in the <span class="strong strong"><strong>Risk Predictor</strong></span> box and select <span class="strong strong"><strong>PMML</strong></span> from the <span class="strong strong"><strong>Select Function Kind</strong></span> menu. The <span class="strong strong"><strong>F</strong></span> changes to <span class="strong strong"><strong>P</strong></span>.
								</li><li class="listitem">
									Double-click the <span class="strong strong"><strong>First select PMML document</strong></span> box and select <span class="strong strong"><strong>Risk Predictor</strong></span>.
								</li><li class="listitem">
									Double-click the <span class="strong strong"><strong>Second select PMML model</strong></span> box and select <span class="strong strong"><strong>DecisionTreeClassifier</strong></span>.
								</li><li class="listitem">
									To return to the DMN editor palette, click <span class="strong strong"><strong>Back to Dispute Transaction Check</strong></span>.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							Create the <span class="strong strong"><strong>Transaction</strong></span> input data node with the data type <span class="strong strong"><strong>tTransaction</strong></span>:
						</p><p class="simpara">
							<span class="inlinemediaobject"><img src="images/_images/ai/risk-transaction.png" alt="risk transaction"/></span>
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									In the <span class="strong strong"><strong>Model</strong></span> window of the DMN editor, drag an input data node to the DMN editor palette.
								</p><p class="simpara">
									<span class="inlinemediaobject"><img src="images/_images/ai/input-node.png" alt="input node"/></span>
								</p></li><li class="listitem">
									Rename the node <span class="strong strong"><strong>Transaction</strong></span>.
								</li><li class="listitem">
									Select the node then click the properties pencil icon in the upper-right corner of the window.
								</li><li class="listitem">
									In the <span class="strong strong"><strong>Properties</strong></span> panel, select <span class="strong strong"><strong>Information Item → Data type → tTransaction</strong></span> then close the panel.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							Create the <span class="strong strong"><strong>Transaction Dispute Risk</strong></span> decision node and add the <span class="strong strong"><strong>Transaction</strong></span> node for data input and the <span class="strong strong"><strong>Risk Predictor</strong></span> node for the function:
						</p><p class="simpara">
							<span class="inlinemediaobject"><img src="images/_images/ai/model3.png" alt="model3"/></span>
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									In the <span class="strong strong"><strong>Model</strong></span> window of the DMN editor, drag a decision data node to the DMN editor palette.
								</p><p class="simpara">
									<span class="inlinemediaobject"><img src="images/_images/ai/decision-node.png" alt="decision node"/></span>
								</p></li><li class="listitem">
									Rename the node <span class="strong strong"><strong>Transaction Dispute Risk</strong></span>.
								</li><li class="listitem">
									Select the <span class="strong strong"><strong>Risk Predictor</strong></span> node and drag the arrow from the top right of the node to the <span class="strong strong"><strong>Transaction Dispute Risk</strong></span> node.
								</li><li class="listitem">
									Select the <span class="strong strong"><strong>Transaction</strong></span> node and drag the arrow from the bottom right of the node to the <span class="strong strong"><strong>Transaction Dispute Risk</strong></span> node.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							In the <span class="strong strong"><strong>Transaction Dispute Risk</strong></span> node, create the <span class="strong strong"><strong>Risk predictor</strong></span> invocation function:
						</p><p class="simpara">
							<span class="inlinemediaobject"><img src="images/_images/ai/transaction-dispute-risk.png" alt="transaction dispute risk"/></span>
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Select the <span class="strong strong"><strong>Transaction Dispute Risk</strong></span> node and click the edit icon on the left side of the node.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Select expression</strong></span> and select <span class="strong strong"><strong>Invocation</strong></span> from the menu.
								</li><li class="listitem">
									Enter <span class="strong strong"><strong>Risk Predictor</strong></span> in the <span class="strong strong"><strong>Enter function</strong></span> box.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>P1</strong></span>.
								</li><li class="listitem">
									In the <span class="strong strong"><strong>Edit Parameter</strong></span> dialog, enter <code class="literal">amount</code> in the <span class="strong strong"><strong>Name</strong></span> box, select <span class="strong strong"><strong>number</strong></span> from the <span class="strong strong"><strong>Data Type</strong></span> menu, and press the Enter key.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Select expression</strong></span> and select <span class="strong strong"><strong>Literal expression</strong></span> from the menu.
								</li><li class="listitem">
									Enter <code class="literal">Transaction.transaction_amount</code> in the box next to <span class="strong strong"><strong>amount</strong></span>.
								</li><li class="listitem">
									Right-click on <span class="strong strong"><strong>1</strong></span> and select <span class="strong strong"><strong>Insert below</strong></span>. The <span class="strong strong"><strong>Edit Parameter</strong></span> dialog opens.
								</li><li class="listitem">
									Enter <span class="strong strong"><strong>holder_index</strong></span> in the <span class="strong strong"><strong>Name</strong></span> box, select <span class="strong strong"><strong>number</strong></span> from the <span class="strong strong"><strong>Data Type</strong></span> menu, and press the Enter key.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Select expression</strong></span> on row <span class="strong strong"><strong>2</strong></span> and select <span class="strong strong"><strong>Literal expression</strong></span> from the menu.
								</li><li class="listitem">
									Enter <code class="literal">Transaction.cardholder_identifier</code> in the box next to <span class="strong strong"><strong>amount</strong></span>.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							Create the <span class="strong strong"><strong>Risk Threshold</strong></span> input data node with the data type <span class="strong strong"><strong>number</strong></span>:
						</p><p class="simpara">
							<span class="inlinemediaobject"><img src="images/_images/ai/model4.png" alt="model4"/></span>
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									In the <span class="strong strong"><strong>Model</strong></span> window of the DMN editor, drag an input data node to the DMN editor palette.
								</li><li class="listitem">
									Rename the node <span class="strong strong"><strong>Risk Threshold</strong></span>.
								</li><li class="listitem">
									Select the node then click the properties pencil icon in the upper-right corner of the window.
								</li><li class="listitem">
									In the <span class="strong strong"><strong>Properties</strong></span> panel, select <span class="strong strong"><strong>Information Item → Data type → number</strong></span> then close the panel.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							Create the <span class="strong strong"><strong>Can be automatically processed?</strong></span> decision node that takes as inputs the <span class="strong strong"><strong>Transaction Dispute Risk</strong></span> and the <span class="strong strong"><strong>Risk threshold</strong></span> nodes:
						</p><p class="simpara">
							<span class="inlinemediaobject"><img src="images/_images/ai/model5.png" alt="model5"/></span>
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Drag a decision node to the DMN editor palette and rename it <span class="strong strong"><strong>Can be automatically processed?</strong></span>.
								</li><li class="listitem">
									Select the node, then click the edit icon on the upper-left side of the node.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Select expression</strong></span> and then select <span class="strong strong"><strong>Literal expression</strong></span> from the menu.
								</li><li class="listitem">
									Enter <code class="literal">Transaction Dispute Risk.predicted_dispute_risk &lt; Risk Threshold</code> in the box.
								</li><li class="listitem">
									Select the <span class="strong strong"><strong>Transaction Dispute Risk</strong></span> node and drag the arrow in the top left of the node to the <span class="strong strong"><strong>Can be automatically processed?</strong></span> node.
								</li><li class="listitem">
									Select the <span class="strong strong"><strong>Risk Threshold</strong></span> node and drag the arrow from the bottom left of the node to the <span class="strong strong"><strong>Can be automatically processed?</strong></span> node.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							Save the model and build the project:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									In the DMN editor, click <span class="strong strong"><strong>Save</strong></span>.
								</li><li class="listitem">
									If necessary, correct any errors that appear.
								</li><li class="listitem">
									To return to the project window, click <span class="strong strong"><strong>Credit Card Dispute</strong></span> in the breadcrumb trail.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Build</strong></span>. The project should successfully build.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							Add and run a test scenario: 
							<span class="inlinemediaobject"><img src="images/_images/ai/AIScenarioSimulations.png" alt="AIScenarioSimulations"/></span>
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Click <span class="strong strong"><strong>Add Asset</strong></span>.
								</li><li class="listitem">
									Select <span class="strong strong"><strong>Test Scenario</strong></span>.
								</li><li class="listitem">
									In the <span class="strong strong"><strong>Create new Test Scenario</strong></span> dialog, enter the name <code class="literal">Test Dispute Transaction Check</code>, select <span class="strong strong"><strong>com</strong></span> from the <span class="strong strong"><strong>Package</strong></span> menu, and select <span class="strong strong"><strong>DMN</strong></span>.
								</li><li class="listitem">
									Select <span class="strong strong"><strong>Dispute Transaction Check.dmn</strong></span> from the <span class="strong strong"><strong>Choose a DMN asset</strong></span> menu and click <span class="strong strong"><strong>OK</strong></span>. The test template builds.
								</li><li class="listitem"><p class="simpara">
									Enter the following values and click <span class="strong strong"><strong>Save</strong></span>:
								</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										Do not add a value to the <span class="strong strong"><strong>Transaction Dispute Risk</strong></span> column. This value is determined by the test scenario.
									</p></div></div><div class="table" id="idm139921809859792"><p class="title"><strong>Table 90.1. Test scenario parameters</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"/><col style="width: 13%; " class="col_2"/><col style="width: 24%; " class="col_3"/><col style="width: 24%; " class="col_4"/><col style="width: 19%; " class="col_5"/></colgroup><thead><tr><th align="left" valign="top" id="idm139921809852160" scope="col"><span class="strong strong"><strong>Description</strong></span></th><th align="left" valign="top" id="idm139921809850608" scope="col"><span class="strong strong"><strong>Risk Threshold</strong></span></th><th align="left" valign="top" id="idm139921809849056" scope="col"><span class="strong strong"><strong>cardholder_identifier</strong></span></th><th align="left" valign="top" id="idm139921809847504" scope="col"><span class="strong strong"><strong>transaction_amount</strong></span></th><th align="left" valign="top" id="idm139921809845952" scope="col"><span class="strong strong"><strong>Can be automatically processed?</strong></span></th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139921809852160">
												<p>
													Risk threshold 5, automatically processed
												</p>
												</td><td align="left" valign="top" headers="idm139921809850608">
												<p>
													5
												</p>
												</td><td align="left" valign="top" headers="idm139921809849056">
												<p>
													1234
												</p>
												</td><td align="left" valign="top" headers="idm139921809847504">
												<p>
													1000
												</p>
												</td><td align="left" valign="top" headers="idm139921809845952">
												<p>
													true
												</p>
												</td></tr><tr><td align="left" valign="top" headers="idm139921809852160">
												<p>
													Risk threshold 4, amount = 1000, not processed
												</p>
												</td><td align="left" valign="top" headers="idm139921809850608">
												<p>
													4
												</p>
												</td><td align="left" valign="top" headers="idm139921809849056">
												<p>
													1234
												</p>
												</td><td align="left" valign="top" headers="idm139921809847504">
												<p>
													1000
												</p>
												</td><td align="left" valign="top" headers="idm139921809845952">
												<p>
													false
												</p>
												</td></tr><tr><td align="left" valign="top" headers="idm139921809852160">
												<p>
													Risk threshold 4, amount = 180, automatically processed
												</p>
												</td><td align="left" valign="top" headers="idm139921809850608">
												<p>
													4
												</p>
												</td><td align="left" valign="top" headers="idm139921809849056">
												<p>
													1234
												</p>
												</td><td align="left" valign="top" headers="idm139921809847504">
												<p>
													180
												</p>
												</td><td align="left" valign="top" headers="idm139921809845952">
												<p>
													true
												</p>
												</td></tr><tr><td align="left" valign="top" headers="idm139921809852160">
												<p>
													Risk threshold 1, amount = 1, not processed
												</p>
												</td><td align="left" valign="top" headers="idm139921809850608">
												<p>
													1
												</p>
												</td><td align="left" valign="top" headers="idm139921809849056">
												<p>
													1234
												</p>
												</td><td align="left" valign="top" headers="idm139921809847504">
												<p>
													1
												</p>
												</td><td align="left" valign="top" headers="idm139921809845952">
												<p>
													false
												</p>
												</td></tr></tbody></table></div></div></li><li class="listitem">
									To run the test, click the <span class="strong strong"><strong>Play</strong></span> button, to the right of <span class="strong strong"><strong>Validate</strong></span>. The results appear in the <span class="strong strong"><strong>Test Report</strong></span> panel on the right of the screen.
								</li></ol></div></li></ol></div></section><section class="section" id="ai-pmml-ref_artificial-intelligence"><div class="titlepage"><div><div><h2 class="title">90.2. Credit card transaction dispute exercise PMML file</h2></div></div></div><p>
					Use the following XML content to create the <code class="literal">dtree_risk_predictor.pmml</code> file in the <a class="xref" href="#ai-gsg_artificial-intelligence" title="90.1. Using a PMML model with a DMN model to resolve credit card transaction disputes">Section 90.1, “Using a PMML model with a DMN model to resolve credit card transaction disputes”</a> exercise.
				</p><pre class="programlisting language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;PMML xmlns="http://www.dmg.org/PMML-4_2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="4.2" xsi:schemaLocation="http://www.dmg.org/PMML-4_2 http://www.dmg.org/v4-2-1/pmml-4-2.xsd"&gt;
  &lt;Header copyright="Copyright (c) 2018 Software AG" description="Default Description"&gt;
    &lt;Application name="Nyoka" version="4.3.0" /&gt;
    &lt;Timestamp&gt;2020-10-09 14:27:26.622723&lt;/Timestamp&gt;
  &lt;/Header&gt;
  &lt;DataDictionary numberOfFields="3"&gt;
    &lt;DataField name="amount" optype="continuous" dataType="double" /&gt;
    &lt;DataField name="holder_index" optype="continuous" dataType="double" /&gt;
    &lt;DataField name="dispute_risk" optype="categorical" dataType="integer"&gt;
      &lt;Value value="1" /&gt;
      &lt;Value value="2" /&gt;
      &lt;Value value="3" /&gt;
      &lt;Value value="4" /&gt;
      &lt;Value value="5" /&gt;
    &lt;/DataField&gt;
  &lt;/DataDictionary&gt;
  &lt;TreeModel modelName="DecisionTreeClassifier" functionName="classification" missingValuePenalty="1.0"&gt;
    &lt;MiningSchema&gt;
      &lt;MiningField name="amount" usageType="active" optype="continuous" /&gt;
      &lt;MiningField name="holder_index" usageType="active" optype="continuous" /&gt;
      &lt;MiningField name="dispute_risk" usageType="target" optype="categorical" /&gt;
    &lt;/MiningSchema&gt;
    &lt;Output&gt;
      &lt;OutputField name="probability_1" optype="continuous" dataType="double" feature="probability" value="1" /&gt;
      &lt;OutputField name="probability_2" optype="continuous" dataType="double" feature="probability" value="2" /&gt;
      &lt;OutputField name="probability_3" optype="continuous" dataType="double" feature="probability" value="3" /&gt;
      &lt;OutputField name="probability_4" optype="continuous" dataType="double" feature="probability" value="4" /&gt;
      &lt;OutputField name="probability_5" optype="continuous" dataType="double" feature="probability" value="5" /&gt;
      &lt;OutputField name="predicted_dispute_risk" optype="categorical" dataType="integer" feature="predictedValue" /&gt;
    &lt;/Output&gt;
    &lt;Node id="0" recordCount="600.0"&gt;
      &lt;True /&gt;
      &lt;Node id="1" recordCount="200.0"&gt;
        &lt;SimplePredicate field="amount" operator="lessOrEqual" value="99.94000244140625" /&gt;
        &lt;Node id="2" score="2" recordCount="55.0"&gt;
          &lt;SimplePredicate field="holder_index" operator="lessOrEqual" value="0.5" /&gt;
          &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
          &lt;ScoreDistribution value="2" recordCount="55.0" confidence="1.0" /&gt;
          &lt;ScoreDistribution value="3" recordCount="0.0" confidence="0.0" /&gt;
          &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
          &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
        &lt;/Node&gt;
        &lt;Node id="3" score="1" recordCount="145.0"&gt;
          &lt;SimplePredicate field="holder_index" operator="greaterThan" value="0.5" /&gt;
          &lt;ScoreDistribution value="1" recordCount="145.0" confidence="1.0" /&gt;
          &lt;ScoreDistribution value="2" recordCount="0.0" confidence="0.0" /&gt;
          &lt;ScoreDistribution value="3" recordCount="0.0" confidence="0.0" /&gt;
          &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
          &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
        &lt;/Node&gt;
      &lt;/Node&gt;
      &lt;Node id="4" recordCount="400.0"&gt;
        &lt;SimplePredicate field="amount" operator="greaterThan" value="99.94000244140625" /&gt;
        &lt;Node id="5" recordCount="105.0"&gt;
          &lt;SimplePredicate field="holder_index" operator="lessOrEqual" value="0.5" /&gt;
          &lt;Node id="6" score="3" recordCount="54.0"&gt;
            &lt;SimplePredicate field="amount" operator="lessOrEqual" value="150.4550018310547" /&gt;
            &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
            &lt;ScoreDistribution value="2" recordCount="0.0" confidence="0.0" /&gt;
            &lt;ScoreDistribution value="3" recordCount="54.0" confidence="1.0" /&gt;
            &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
            &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
          &lt;/Node&gt;
          &lt;Node id="7" recordCount="51.0"&gt;
            &lt;SimplePredicate field="amount" operator="greaterThan" value="150.4550018310547" /&gt;
            &lt;Node id="8" recordCount="40.0"&gt;
              &lt;SimplePredicate field="amount" operator="lessOrEqual" value="200.00499725341797" /&gt;
              &lt;Node id="9" recordCount="36.0"&gt;
                &lt;SimplePredicate field="amount" operator="lessOrEqual" value="195.4949951171875" /&gt;
                &lt;Node id="10" recordCount="2.0"&gt;
                  &lt;SimplePredicate field="amount" operator="lessOrEqual" value="152.2050018310547" /&gt;
                  &lt;Node id="11" score="4" recordCount="1.0"&gt;
                    &lt;SimplePredicate field="amount" operator="lessOrEqual" value="151.31500244140625" /&gt;
                    &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                    &lt;ScoreDistribution value="2" recordCount="0.0" confidence="0.0" /&gt;
                    &lt;ScoreDistribution value="3" recordCount="0.0" confidence="0.0" /&gt;
                    &lt;ScoreDistribution value="4" recordCount="1.0" confidence="1.0" /&gt;
                    &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                  &lt;/Node&gt;
                  &lt;Node id="12" score="3" recordCount="1.0"&gt;
                    &lt;SimplePredicate field="amount" operator="greaterThan" value="151.31500244140625" /&gt;
                    &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                    &lt;ScoreDistribution value="2" recordCount="0.0" confidence="0.0" /&gt;
                    &lt;ScoreDistribution value="3" recordCount="1.0" confidence="1.0" /&gt;
                    &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
                    &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                  &lt;/Node&gt;
                &lt;/Node&gt;
                &lt;Node id="13" recordCount="34.0"&gt;
                  &lt;SimplePredicate field="amount" operator="greaterThan" value="152.2050018310547" /&gt;
                  &lt;Node id="14" recordCount="20.0"&gt;
                    &lt;SimplePredicate field="amount" operator="lessOrEqual" value="176.5050048828125" /&gt;
                    &lt;Node id="15" recordCount="19.0"&gt;
                      &lt;SimplePredicate field="amount" operator="lessOrEqual" value="176.06500244140625" /&gt;
                      &lt;Node id="16" score="4" recordCount="9.0"&gt;
                        &lt;SimplePredicate field="amount" operator="lessOrEqual" value="166.6449966430664" /&gt;
                        &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                        &lt;ScoreDistribution value="2" recordCount="0.0" confidence="0.0" /&gt;
                        &lt;ScoreDistribution value="3" recordCount="0.0" confidence="0.0" /&gt;
                        &lt;ScoreDistribution value="4" recordCount="9.0" confidence="1.0" /&gt;
                        &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                      &lt;/Node&gt;
                      &lt;Node id="17" recordCount="10.0"&gt;
                        &lt;SimplePredicate field="amount" operator="greaterThan" value="166.6449966430664" /&gt;
                        &lt;Node id="18" score="3" recordCount="1.0"&gt;
                          &lt;SimplePredicate field="amount" operator="lessOrEqual" value="167.97999572753906" /&gt;
                          &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                          &lt;ScoreDistribution value="2" recordCount="0.0" confidence="0.0" /&gt;
                          &lt;ScoreDistribution value="3" recordCount="1.0" confidence="1.0" /&gt;
                          &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
                          &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                        &lt;/Node&gt;
                        &lt;Node id="19" score="4" recordCount="9.0"&gt;
                          &lt;SimplePredicate field="amount" operator="greaterThan" value="167.97999572753906" /&gt;
                          &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                          &lt;ScoreDistribution value="2" recordCount="0.0" confidence="0.0" /&gt;
                          &lt;ScoreDistribution value="3" recordCount="0.0" confidence="0.0" /&gt;
                          &lt;ScoreDistribution value="4" recordCount="9.0" confidence="1.0" /&gt;
                          &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                        &lt;/Node&gt;
                      &lt;/Node&gt;
                    &lt;/Node&gt;
                    &lt;Node id="20" score="3" recordCount="1.0"&gt;
                      &lt;SimplePredicate field="amount" operator="greaterThan" value="176.06500244140625" /&gt;
                      &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                      &lt;ScoreDistribution value="2" recordCount="0.0" confidence="0.0" /&gt;
                      &lt;ScoreDistribution value="3" recordCount="1.0" confidence="1.0" /&gt;
                      &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
                      &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                    &lt;/Node&gt;
                  &lt;/Node&gt;
                  &lt;Node id="21" score="4" recordCount="14.0"&gt;
                    &lt;SimplePredicate field="amount" operator="greaterThan" value="176.5050048828125" /&gt;
                    &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                    &lt;ScoreDistribution value="2" recordCount="0.0" confidence="0.0" /&gt;
                    &lt;ScoreDistribution value="3" recordCount="0.0" confidence="0.0" /&gt;
                    &lt;ScoreDistribution value="4" recordCount="14.0" confidence="1.0" /&gt;
                    &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                  &lt;/Node&gt;
                &lt;/Node&gt;
              &lt;/Node&gt;
              &lt;Node id="22" recordCount="4.0"&gt;
                &lt;SimplePredicate field="amount" operator="greaterThan" value="195.4949951171875" /&gt;
                &lt;Node id="23" score="3" recordCount="1.0"&gt;
                  &lt;SimplePredicate field="amount" operator="lessOrEqual" value="195.76499938964844" /&gt;
                  &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                  &lt;ScoreDistribution value="2" recordCount="0.0" confidence="0.0" /&gt;
                  &lt;ScoreDistribution value="3" recordCount="1.0" confidence="1.0" /&gt;
                  &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
                  &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                &lt;/Node&gt;
                &lt;Node id="24" recordCount="3.0"&gt;
                  &lt;SimplePredicate field="amount" operator="greaterThan" value="195.76499938964844" /&gt;
                  &lt;Node id="25" score="4" recordCount="1.0"&gt;
                    &lt;SimplePredicate field="amount" operator="lessOrEqual" value="196.74500274658203" /&gt;
                    &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                    &lt;ScoreDistribution value="2" recordCount="0.0" confidence="0.0" /&gt;
                    &lt;ScoreDistribution value="3" recordCount="0.0" confidence="0.0" /&gt;
                    &lt;ScoreDistribution value="4" recordCount="1.0" confidence="1.0" /&gt;
                    &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                  &lt;/Node&gt;
                  &lt;Node id="26" recordCount="2.0"&gt;
                    &lt;SimplePredicate field="amount" operator="greaterThan" value="196.74500274658203" /&gt;
                    &lt;Node id="27" score="3" recordCount="1.0"&gt;
                      &lt;SimplePredicate field="amount" operator="lessOrEqual" value="197.5800018310547" /&gt;
                      &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                      &lt;ScoreDistribution value="2" recordCount="0.0" confidence="0.0" /&gt;
                      &lt;ScoreDistribution value="3" recordCount="1.0" confidence="1.0" /&gt;
                      &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
                      &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                    &lt;/Node&gt;
                    &lt;Node id="28" score="4" recordCount="1.0"&gt;
                      &lt;SimplePredicate field="amount" operator="greaterThan" value="197.5800018310547" /&gt;
                      &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                      &lt;ScoreDistribution value="2" recordCount="0.0" confidence="0.0" /&gt;
                      &lt;ScoreDistribution value="3" recordCount="0.0" confidence="0.0" /&gt;
                      &lt;ScoreDistribution value="4" recordCount="1.0" confidence="1.0" /&gt;
                      &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                    &lt;/Node&gt;
                  &lt;/Node&gt;
                &lt;/Node&gt;
              &lt;/Node&gt;
            &lt;/Node&gt;
            &lt;Node id="29" score="5" recordCount="11.0"&gt;
              &lt;SimplePredicate field="amount" operator="greaterThan" value="200.00499725341797" /&gt;
              &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
              &lt;ScoreDistribution value="2" recordCount="0.0" confidence="0.0" /&gt;
              &lt;ScoreDistribution value="3" recordCount="0.0" confidence="0.0" /&gt;
              &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
              &lt;ScoreDistribution value="5" recordCount="11.0" confidence="1.0" /&gt;
            &lt;/Node&gt;
          &lt;/Node&gt;
        &lt;/Node&gt;
        &lt;Node id="30" recordCount="295.0"&gt;
          &lt;SimplePredicate field="holder_index" operator="greaterThan" value="0.5" /&gt;
          &lt;Node id="31" score="2" recordCount="170.0"&gt;
            &lt;SimplePredicate field="amount" operator="lessOrEqual" value="150.93499755859375" /&gt;
            &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
            &lt;ScoreDistribution value="2" recordCount="170.0" confidence="1.0" /&gt;
            &lt;ScoreDistribution value="3" recordCount="0.0" confidence="0.0" /&gt;
            &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
            &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
          &lt;/Node&gt;
          &lt;Node id="32" recordCount="125.0"&gt;
            &lt;SimplePredicate field="amount" operator="greaterThan" value="150.93499755859375" /&gt;
            &lt;Node id="33" recordCount="80.0"&gt;
              &lt;SimplePredicate field="holder_index" operator="lessOrEqual" value="2.5" /&gt;
              &lt;Node id="34" recordCount="66.0"&gt;
                &lt;SimplePredicate field="amount" operator="lessOrEqual" value="199.13500213623047" /&gt;
                &lt;Node id="35" score="3" recordCount="10.0"&gt;
                  &lt;SimplePredicate field="amount" operator="lessOrEqual" value="155.56999969482422" /&gt;
                  &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                  &lt;ScoreDistribution value="2" recordCount="0.0" confidence="0.0" /&gt;
                  &lt;ScoreDistribution value="3" recordCount="10.0" confidence="1.0" /&gt;
                  &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
                  &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                &lt;/Node&gt;
                &lt;Node id="36" recordCount="56.0"&gt;
                  &lt;SimplePredicate field="amount" operator="greaterThan" value="155.56999969482422" /&gt;
                  &lt;Node id="37" score="2" recordCount="1.0"&gt;
                    &lt;SimplePredicate field="amount" operator="lessOrEqual" value="155.9000015258789" /&gt;
                    &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                    &lt;ScoreDistribution value="2" recordCount="1.0" confidence="1.0" /&gt;
                    &lt;ScoreDistribution value="3" recordCount="0.0" confidence="0.0" /&gt;
                    &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
                    &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                  &lt;/Node&gt;
                  &lt;Node id="38" recordCount="55.0"&gt;
                    &lt;SimplePredicate field="amount" operator="greaterThan" value="155.9000015258789" /&gt;
                    &lt;Node id="39" recordCount="31.0"&gt;
                      &lt;SimplePredicate field="amount" operator="lessOrEqual" value="176.3699951171875" /&gt;
                      &lt;Node id="40" recordCount="30.0"&gt;
                        &lt;SimplePredicate field="amount" operator="lessOrEqual" value="175.72000122070312" /&gt;
                        &lt;Node id="41" recordCount="19.0"&gt;
                          &lt;SimplePredicate field="amount" operator="lessOrEqual" value="168.06999969482422" /&gt;
                          &lt;Node id="42" recordCount="6.0"&gt;
                            &lt;SimplePredicate field="amount" operator="lessOrEqual" value="158.125" /&gt;
                            &lt;Node id="43" score="3" recordCount="5.0"&gt;
                              &lt;SimplePredicate field="amount" operator="lessOrEqual" value="157.85499572753906" /&gt;
                              &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                              &lt;ScoreDistribution value="2" recordCount="0.0" confidence="0.0" /&gt;
                              &lt;ScoreDistribution value="3" recordCount="5.0" confidence="1.0" /&gt;
                              &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
                              &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                            &lt;/Node&gt;
                            &lt;Node id="44" score="2" recordCount="1.0"&gt;
                              &lt;SimplePredicate field="amount" operator="greaterThan" value="157.85499572753906" /&gt;
                              &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                              &lt;ScoreDistribution value="2" recordCount="1.0" confidence="1.0" /&gt;
                              &lt;ScoreDistribution value="3" recordCount="0.0" confidence="0.0" /&gt;
                              &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
                              &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                            &lt;/Node&gt;
                          &lt;/Node&gt;
                          &lt;Node id="45" score="3" recordCount="13.0"&gt;
                            &lt;SimplePredicate field="amount" operator="greaterThan" value="158.125" /&gt;
                            &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                            &lt;ScoreDistribution value="2" recordCount="0.0" confidence="0.0" /&gt;
                            &lt;ScoreDistribution value="3" recordCount="13.0" confidence="1.0" /&gt;
                            &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
                            &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                          &lt;/Node&gt;
                        &lt;/Node&gt;
                        &lt;Node id="46" recordCount="11.0"&gt;
                          &lt;SimplePredicate field="amount" operator="greaterThan" value="168.06999969482422" /&gt;
                          &lt;Node id="47" score="2" recordCount="1.0"&gt;
                            &lt;SimplePredicate field="amount" operator="lessOrEqual" value="168.69499969482422" /&gt;
                            &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                            &lt;ScoreDistribution value="2" recordCount="1.0" confidence="1.0" /&gt;
                            &lt;ScoreDistribution value="3" recordCount="0.0" confidence="0.0" /&gt;
                            &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
                            &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                          &lt;/Node&gt;
                          &lt;Node id="48" recordCount="10.0"&gt;
                            &lt;SimplePredicate field="amount" operator="greaterThan" value="168.69499969482422" /&gt;
                            &lt;Node id="49" recordCount="4.0"&gt;
                              &lt;SimplePredicate field="holder_index" operator="lessOrEqual" value="1.5" /&gt;
                              &lt;Node id="50" score="2" recordCount="1.0"&gt;
                                &lt;SimplePredicate field="amount" operator="lessOrEqual" value="172.0250015258789" /&gt;
                                &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                                &lt;ScoreDistribution value="2" recordCount="1.0" confidence="1.0" /&gt;
                                &lt;ScoreDistribution value="3" recordCount="0.0" confidence="0.0" /&gt;
                                &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
                                &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                              &lt;/Node&gt;
                              &lt;Node id="51" score="3" recordCount="3.0"&gt;
                                &lt;SimplePredicate field="amount" operator="greaterThan" value="172.0250015258789" /&gt;
                                &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                                &lt;ScoreDistribution value="2" recordCount="0.0" confidence="0.0" /&gt;
                                &lt;ScoreDistribution value="3" recordCount="3.0" confidence="1.0" /&gt;
                                &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
                                &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                              &lt;/Node&gt;
                            &lt;/Node&gt;
                            &lt;Node id="52" score="3" recordCount="6.0"&gt;
                              &lt;SimplePredicate field="holder_index" operator="greaterThan" value="1.5" /&gt;
                              &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                              &lt;ScoreDistribution value="2" recordCount="0.0" confidence="0.0" /&gt;
                              &lt;ScoreDistribution value="3" recordCount="6.0" confidence="1.0" /&gt;
                              &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
                              &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                            &lt;/Node&gt;
                          &lt;/Node&gt;
                        &lt;/Node&gt;
                      &lt;/Node&gt;
                      &lt;Node id="53" score="2" recordCount="1.0"&gt;
                        &lt;SimplePredicate field="amount" operator="greaterThan" value="175.72000122070312" /&gt;
                        &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                        &lt;ScoreDistribution value="2" recordCount="1.0" confidence="1.0" /&gt;
                        &lt;ScoreDistribution value="3" recordCount="0.0" confidence="0.0" /&gt;
                        &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
                        &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                      &lt;/Node&gt;
                    &lt;/Node&gt;
                    &lt;Node id="54" recordCount="24.0"&gt;
                      &lt;SimplePredicate field="amount" operator="greaterThan" value="176.3699951171875" /&gt;
                      &lt;Node id="55" score="3" recordCount="16.0"&gt;
                        &lt;SimplePredicate field="amount" operator="lessOrEqual" value="192.0999984741211" /&gt;
                        &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                        &lt;ScoreDistribution value="2" recordCount="0.0" confidence="0.0" /&gt;
                        &lt;ScoreDistribution value="3" recordCount="16.0" confidence="1.0" /&gt;
                        &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
                        &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                      &lt;/Node&gt;
                      &lt;Node id="56" recordCount="8.0"&gt;
                        &lt;SimplePredicate field="amount" operator="greaterThan" value="192.0999984741211" /&gt;
                        &lt;Node id="57" score="2" recordCount="1.0"&gt;
                          &lt;SimplePredicate field="amount" operator="lessOrEqual" value="192.75499725341797" /&gt;
                          &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                          &lt;ScoreDistribution value="2" recordCount="1.0" confidence="1.0" /&gt;
                          &lt;ScoreDistribution value="3" recordCount="0.0" confidence="0.0" /&gt;
                          &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
                          &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                        &lt;/Node&gt;
                        &lt;Node id="58" score="3" recordCount="7.0"&gt;
                          &lt;SimplePredicate field="amount" operator="greaterThan" value="192.75499725341797" /&gt;
                          &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                          &lt;ScoreDistribution value="2" recordCount="0.0" confidence="0.0" /&gt;
                          &lt;ScoreDistribution value="3" recordCount="7.0" confidence="1.0" /&gt;
                          &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
                          &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                        &lt;/Node&gt;
                      &lt;/Node&gt;
                    &lt;/Node&gt;
                  &lt;/Node&gt;
                &lt;/Node&gt;
              &lt;/Node&gt;
              &lt;Node id="59" recordCount="14.0"&gt;
                &lt;SimplePredicate field="amount" operator="greaterThan" value="199.13500213623047" /&gt;
                &lt;Node id="60" score="5" recordCount="10.0"&gt;
                  &lt;SimplePredicate field="holder_index" operator="lessOrEqual" value="1.5" /&gt;
                  &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                  &lt;ScoreDistribution value="2" recordCount="0.0" confidence="0.0" /&gt;
                  &lt;ScoreDistribution value="3" recordCount="0.0" confidence="0.0" /&gt;
                  &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
                  &lt;ScoreDistribution value="5" recordCount="10.0" confidence="1.0" /&gt;
                &lt;/Node&gt;
                &lt;Node id="61" score="4" recordCount="4.0"&gt;
                  &lt;SimplePredicate field="holder_index" operator="greaterThan" value="1.5" /&gt;
                  &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                  &lt;ScoreDistribution value="2" recordCount="0.0" confidence="0.0" /&gt;
                  &lt;ScoreDistribution value="3" recordCount="0.0" confidence="0.0" /&gt;
                  &lt;ScoreDistribution value="4" recordCount="4.0" confidence="1.0" /&gt;
                  &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
                &lt;/Node&gt;
              &lt;/Node&gt;
            &lt;/Node&gt;
            &lt;Node id="62" recordCount="45.0"&gt;
              &lt;SimplePredicate field="holder_index" operator="greaterThan" value="2.5" /&gt;
              &lt;Node id="63" score="2" recordCount="37.0"&gt;
                &lt;SimplePredicate field="amount" operator="lessOrEqual" value="199.13999938964844" /&gt;
                &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                &lt;ScoreDistribution value="2" recordCount="37.0" confidence="1.0" /&gt;
                &lt;ScoreDistribution value="3" recordCount="0.0" confidence="0.0" /&gt;
                &lt;ScoreDistribution value="4" recordCount="0.0" confidence="0.0" /&gt;
                &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
              &lt;/Node&gt;
              &lt;Node id="64" score="4" recordCount="8.0"&gt;
                &lt;SimplePredicate field="amount" operator="greaterThan" value="199.13999938964844" /&gt;
                &lt;ScoreDistribution value="1" recordCount="0.0" confidence="0.0" /&gt;
                &lt;ScoreDistribution value="2" recordCount="0.0" confidence="0.0" /&gt;
                &lt;ScoreDistribution value="3" recordCount="0.0" confidence="0.0" /&gt;
                &lt;ScoreDistribution value="4" recordCount="8.0" confidence="1.0" /&gt;
                &lt;ScoreDistribution value="5" recordCount="0.0" confidence="0.0" /&gt;
              &lt;/Node&gt;
            &lt;/Node&gt;
          &lt;/Node&gt;
        &lt;/Node&gt;
      &lt;/Node&gt;
    &lt;/Node&gt;
  &lt;/TreeModel&gt;
&lt;/PMML&gt;</pre></section></section><section class="chapter" id="additional_resources_4"><div class="titlepage"><div><div><h2 class="title">Chapter 91. Additional resources</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/getting_started_with_red_hat_process_automation_manager#assembly-getting-started-case-management"><span class="emphasis"><em>Getting started with case management</em></span></a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/getting_started_with_red_hat_process_automation_manager#assembly-getting-started-decision-services"><span class="emphasis"><em>Getting started with decision services</em></span></a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_decision_services_in_red_hat_process_automation_manager#assembly-dmn-models"><span class="emphasis"><em>Designing a decision service using DMN models</em></span></a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_process_automation_manager/7.10/html-single/developing_solvers_with_red_hat_business_optimizer_in_red_hat_process_automation_manager#assembly-getting-started-business-optimizer"><span class="emphasis"><em>Getting started with Red Hat Business Optimizer</em></span></a>
					</li><li class="listitem">
						<a class="link" href="https://go.forrester.com/blogs/predictions-2019-ai-artificial-intelligence/">Predictions 2019: Expect A Pragmatic Vision Of AI</a>
					</li></ul></div></section></div><section class="appendix" id="versioning-information"><div class="titlepage"><div><div><h1 class="title">Appendix A. Versioning information</h1></div></div></div><p>
			Documentation last updated on Monday, January 18, 2021.
		</p></section><section class="appendix" id="author-group"><div class="titlepage"><div><div><h1 class="title">Appendix B. Contact information</h1></div></div></div><p>
			Red Hat Process Automation Manager documentation team: <a class="link" href="mailto:brms-docs@redhat.com">brms-docs@redhat.com</a>
		</p></section><div><div xml:lang="en-US" class="legalnotice" id="idm139921835421024"><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"/>© 2021 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div></div></div><script type="text/javascript">
                        jQuery(document).ready(function() {
                            initSwitchery();
                            jQuery('pre[class*="language-"]').each(function(i, block){hljs.highlightBlock(block);});
                        });
                    </script></body></html>